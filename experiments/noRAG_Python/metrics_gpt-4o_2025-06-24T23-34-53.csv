code_tag,llm_used,prompt_version,query_id,query_run,sql_query,tab_schema,label,query_gen_time,query_gen_date,query_results,query_error,sql_time,sql_date,r_row,p_row,r_col,p_col,N_perfect_row,N_perfect_col
0.18.1,,,8,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygrgk        11      4240  58389.123657  60532.194988      False   
1    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
2    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
3    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
4    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
..            ...       ...       ...           ...           ...        ...   
180  ZTF18aadvuhz         2      4538  59097.500000  60174.500000       True   
181  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
182  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   
183  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
184  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     2      NaN           NaN  ...  60173.182234  60532.194988   
1      False     1      NaN           NaN  ...  60173.176100  60173.176100   
2      False     6      NaN           NaN  ...  60173.180822  60532.194178   
3      False     1      NaN           NaN  ...  60173.169005  60173.169005   
4      False     1      NaN           NaN  ...  60173.169005  60173.169005   
..       ...   ...      ...           ...  ...           ...           ...   
180    False     1      NaN           NaN  ...  60174.505822  60174.505822   
181     True     2      NaN           NaN  ...  60175.185301  60465.343935   
182    False     1      NaN           NaN  ...  60175.194340  60175.194340   
183     True     2      NaN           NaN  ...  60175.189734  60820.339375   
184     True     2      NaN           NaN  ...  60175.192697  60182.239526   

     step_id_corr  diffpos  reference_change   classifier_name  \
0        24.5.2a6     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2        24.5.2a6     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
180         1.2.0     True             False  stamp_classifier   
181        24.5.1     True             False  stamp_classifier   
182         1.2.0     True             False  stamp_classifier   
183        27.5.6     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.416646       1  
1    stamp_classifier_1.0.4          SN     0.526146       1  
2    stamp_classifier_1.0.4          SN     0.306560       1  
3    stamp_classifier_1.0.4          SN     0.639198       1  
4    stamp_classifier_1.0.4          SN     0.514766       1  
..                      ...         ...          ...     ...  
180  stamp_classifier_1.0.4          SN     0.654818       1  
181  stamp_classifier_1.0.4          SN     0.317975       1  
182  stamp_classifier_1.0.4          SN     0.569558       1  
183  stamp_classifier_1.0.4          SN     0.321883       1  
184  stamp_classifier_1.0.4          SN     0.631699       1  

[185 rows x 27 columns]]",,19.12996506690979,2025-06-24T11:43:45,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,8,1,"
# Sub-query to filter objects classified as 'SN' by the 'stamp_classifier' with probability > 0.5
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""

# Sub-query to filter objects with at least two detections
detection_subquery = """"""
SELECT oid
FROM object
WHERE ndet >= 2
""""""

# Final query to join the sub-queries and filter by date range
full_query = """"""
SELECT o.*
FROM object o
INNER JOIN (
    {probability_subquery}
    UNION
    {detection_subquery}
) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
"""""".format(probability_subquery=probability_subquery, detection_subquery=detection_subquery)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,15.343609094619753,2025-06-16T00:43:43,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.*
FROM object o
INNER JOIN (
    
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1

    UNION
    
SELECT oid
FROM object
WHERE ndet >= 2

) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.1558578014373,2025-06-24T11:47:57,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,8,2,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.3977792263031,2025-06-16T00:43:57,[None],"'[' was never closed (<string>, line 1)",131.16760063171387,2025-06-24T11:50:08,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,8,3,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.281793355941772,2025-06-16T00:44:08,[None],"'[' was never closed (<string>, line 1)",131.19742274284363,2025-06-24T11:52:19,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,8,4,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.662756443023682,2025-06-16T00:44:19,[None],"'[' was never closed (<string>, line 1)",133.31403708457947,2025-06-24T11:54:33,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,8,5,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.362526655197144,2025-06-16T00:44:31,[None],"'[' was never closed (<string>, line 1)",131.0380208492279,2025-06-24T11:56:44,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,8,6,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.774812698364258,2025-06-16T00:44:43,[None],"'[' was never closed (<string>, line 1)",132.13493180274963,2025-06-24T11:58:56,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,8,7,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.094489097595217,2025-06-16T00:44:55,[None],"'[' was never closed (<string>, line 1)",130.18861651420593,2025-06-24T12:01:06,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,8,8,"
# Sub-query to filter objects based on the first detection date and number of detections
object_subquery = """"""
SELECT oid
FROM object
WHERE (firstmjd BETWEEN 59800 AND 59804) -- Julian dates for August 17 to August 21, 2023
AND (ndet >= 2)
""""""

# Sub-query to filter probabilities based on class name, classifier name, and probability
probability_subquery = f""""""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
AND probability > 0.5
""""""

# Final query combining the sub-queries with an INNER JOIN
full_query = f""""""
SELECT o.*
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.oid IN ({object_subquery})
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.225887775421144,2025-06-16T00:45:07,"[             oid  ndethist  ncovhist  mjdstarthist   mjdendhist  corrected  \
0   ZTF22abdzlog        69      1552  58292.500000  59845.25000      False   
1   ZTF18adngbfy        36      1651  58364.250000  59809.25000      False   
2   ZTF22abbvtbc         2       811  59800.250000  59812.25000       True   
3   ZTF22abawpqu         3       301  59800.500000  59812.25000       True   
4   ZTF22abbxlen        13       854  59800.500000  59828.50000      False   
..           ...       ...       ...           ...          ...        ...   
57  ZTF22abbxuap         8      1767  59802.500000  59816.50000       True   
58  ZTF19adehksw        73      1642  58723.465903  60643.31787       True   
59  ZTF22abadoir        18       800  59803.500000  59843.50000      False   
60  ZTF19aavnssv        18      1511  58632.250000  59805.50000       True   
61  ZTF22abaxtfy         8       701  59803.500000  59824.50000      False   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False     5       NaN           NaN  ...  322.621189  52.211654   
1     False     9  0.344612           NaN  ...  309.567669  30.155285   
2     False     2 -0.178473      0.575828  ...  346.616009 -11.166852   
3     False     3  0.112837      0.090166  ...  349.059289 -24.865724   
4     False    13 -0.134314           NaN  ...   23.274808  -3.382633   
..      ...   ...       ...           ...  ...         ...        ...   
57    False     5  0.497630      0.865992  ...   23.023469   0.940410   
58    False    21       NaN           NaN  ...   46.687782  46.153577   
59    False    18  0.187775      0.305721  ...   57.200373  74.726056   
60    False     9       NaN           NaN  ...  112.183415  45.327031   
61    False     8  0.141260           NaN  ...   10.120144  -9.625746   

     sigmara  sigmadec     deltajd      firstmjd       lastmjd  step_id_corr  \
0   0.000179  0.000019   44.756377  59800.406667  59845.163044           dev   
1   0.000010  0.000017    8.974583  59800.364375  59809.338958           dev   
2   0.000092  0.000111   11.966181  59800.373692  59812.339873           dev   
3   0.000049  0.000142   11.973588  59800.375776  59812.349363           dev   
4   0.000063  0.000038   28.070776  59800.381065  59828.451840           dev   
..       ...       ...         ...           ...           ...           ...   
57  0.000074  0.000047   13.060058  59803.403461  59816.463518           dev   
58  0.041269  0.028588  839.893137  59803.424734  60643.317870      24.5.2a6   
59  0.000150  0.000030   40.005694  59803.413056  59843.418750           dev   
60  0.000028  0.000023    2.010648  59803.495544  59805.506192           dev   
61  0.000019  0.000015   20.937859  59803.456354  59824.394213           dev   

    diffpos reference_change  
0      True            False  
1      True            False  
2      True            False  
3      True            False  
4      True            False  
..      ...              ...  
57     True            False  
58     True            False  
59     True            False  
60     True            False  
61     True            False  

[62 rows x 22 columns]]",,22.3199405670166,2025-06-24T12:01:28,0.0,0.0,0.8148148148148148,1.0,0.0,0.0
0.18.1,gpt-4o,v3,8,9,"
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,9.683680295944214,2025-06-16T00:45:17,[None],"'[' was never closed (<string>, line 1)",14.003119230270386,2025-06-24T12:01:42,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,8,10,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.74471402168274,2025-06-16T00:45:28,[None],"'[' was never closed (<string>, line 1)",12.307602167129517,2025-06-24T12:01:55,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,27,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
2    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
..            ...       ...       ...           ...           ...        ...   
180  ZTF18aadvuhz         2      4538  59097.500000  60174.500000       True   
181  ZTF23aazhofz         2      1852  59788.250000  60175.250000       True   
182  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
183  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
184  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1      NaN           NaN  ...  60173.169005  60173.169005   
1      False     1      NaN           NaN  ...  60173.176100  60173.176100   
2      False     1      NaN           NaN  ...  60173.169005  60173.169005   
3      False     1      NaN           NaN  ...  60173.178461  60173.178461   
4      False     6      NaN           NaN  ...  60173.180822  60532.194178   
..       ...   ...      ...           ...  ...           ...           ...   
180    False     1      NaN           NaN  ...  60174.505822  60174.505822   
181    False     1      NaN           NaN  ...  60175.181007  60175.181007   
182     True     2      NaN           NaN  ...  60175.189734  60820.339375   
183     True     2      NaN           NaN  ...  60175.192697  60182.239526   
184    False     1      NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
180         1.2.0     True             False  stamp_classifier   
181         1.2.0     True             False  stamp_classifier   
182        27.5.6     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.526146       1  
2    stamp_classifier_1.0.4          SN     0.514766       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.306560       1  
..                      ...         ...          ...     ...  
180  stamp_classifier_1.0.4          SN     0.654818       1  
181  stamp_classifier_1.0.4          SN     0.622088       1  
182  stamp_classifier_1.0.4          SN     0.321883       1  
183  stamp_classifier_1.0.4          SN     0.631699       1  
184  stamp_classifier_1.0.4          SN     0.569558       1  

[185 rows x 27 columns]]",,4.69951319694519,2025-06-24T12:02:00,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,27,1,"
# Sub-query to filter objects classified as 'SN' by the 'stamp_classifier' with probability > 0.5
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""

# Sub-query to filter objects with at least two detections
detection_subquery = """"""
SELECT oid
FROM object
WHERE ndet >= 2
""""""

# Final query to join the sub-queries and filter by date range
full_query = """"""
SELECT o.*
FROM object o
INNER JOIN (
    {probability_subquery}
    UNION
    {detection_subquery}
) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
"""""".format(probability_subquery=probability_subquery, detection_subquery=detection_subquery)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,15.343609094619753,2025-06-16T00:43:43,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.*
FROM object o
INNER JOIN (
    
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1

    UNION
    
SELECT oid
FROM object
WHERE ndet >= 2

) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.85874962806705,2025-06-24T12:06:11,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,27,2,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.3977792263031,2025-06-16T00:43:57,[None],"'[' was never closed (<string>, line 1)",139.2103362083435,2025-06-24T12:08:30,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,27,3,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.281793355941772,2025-06-16T00:44:08,[None],"'[' was never closed (<string>, line 1)",134.83600568771362,2025-06-24T12:10:45,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,27,4,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.662756443023682,2025-06-16T00:44:19,[None],"'[' was never closed (<string>, line 1)",137.17876648902893,2025-06-24T12:13:02,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,27,5,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.362526655197144,2025-06-16T00:44:31,[None],"'[' was never closed (<string>, line 1)",135.0943021774292,2025-06-24T12:15:17,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,27,6,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.774812698364258,2025-06-16T00:44:43,[None],"'[' was never closed (<string>, line 1)",135.27870202064514,2025-06-24T12:17:33,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,27,7,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.094489097595217,2025-06-16T00:44:55,[None],"'[' was never closed (<string>, line 1)",134.25497126579285,2025-06-24T12:19:47,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,27,8,"
# Sub-query to filter objects based on the first detection date and number of detections
object_subquery = """"""
SELECT oid
FROM object
WHERE (firstmjd BETWEEN 59800 AND 59804) -- Julian dates for August 17 to August 21, 2023
AND (ndet >= 2)
""""""

# Sub-query to filter probabilities based on class name, classifier name, and probability
probability_subquery = f""""""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
AND probability > 0.5
""""""

# Final query combining the sub-queries with an INNER JOIN
full_query = f""""""
SELECT o.*
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.oid IN ({object_subquery})
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.225887775421144,2025-06-16T00:45:07,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18adngbfy        36      1651  58364.250000  59809.250000      False   
1   ZTF22abawpqu         3       301  59800.500000  59812.250000       True   
2   ZTF22abbvtbc         2       811  59800.250000  59812.250000       True   
3   ZTF22abbxlen        13       854  59800.500000  59828.500000      False   
4   ZTF22abejyju        82      1892  59471.243623  60533.257269       True   
..           ...       ...       ...           ...           ...        ...   
57  ZTF22abakgeg        33       912  59803.250000  59817.250000       True   
58  ZTF22abbxuap         8      1767  59802.500000  59816.500000       True   
59  ZTF22abadoir        18       800  59803.500000  59843.500000      False   
60  ZTF19adehksw        73      1642  58723.465903  60643.317870       True   
61  ZTF22abaxtfy         8       701  59803.500000  59824.500000      False   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False     9  0.344612           NaN  ...  309.567669  30.155285   
1     False     3  0.112837      0.090166  ...  349.059289 -24.865724   
2     False     2 -0.178473      0.575828  ...  346.616009 -11.166852   
3     False    13 -0.134314           NaN  ...   23.274808  -3.382633   
4     False    22  0.028900      0.161213  ...  330.295943  31.876105   
..      ...   ...       ...           ...  ...         ...        ...   
57    False    11  0.193835      0.570992  ...  266.008950  -5.403843   
58    False     5  0.497630      0.865992  ...   23.023469   0.940410   
59    False    18  0.187775      0.305721  ...   57.200373  74.726056   
60    False    21       NaN           NaN  ...   46.687782  46.153577   
61    False     8  0.141260           NaN  ...   10.120144  -9.625746   

     sigmara  sigmadec     deltajd      firstmjd       lastmjd  step_id_corr  \
0   0.000010  0.000017    8.974583  59800.364375  59809.338958           dev   
1   0.000049  0.000142   11.973588  59800.375776  59812.349363           dev   
2   0.000092  0.000111   11.966181  59800.373692  59812.339873           dev   
3   0.000063  0.000038   28.070776  59800.381065  59828.451840           dev   
4   0.054124  0.045962  732.865532  59800.391736  60533.257269      24.5.2a6   
..       ...       ...         ...           ...           ...           ...   
57  0.000052  0.000033   14.004317  59803.193194  59817.197512           dev   
58  0.000074  0.000047   13.060058  59803.403461  59816.463518           dev   
59  0.000150  0.000030   40.005694  59803.413056  59843.418750           dev   
60  0.041269  0.028588  839.893137  59803.424734  60643.317870      24.5.2a6   
61  0.000019  0.000015   20.937859  59803.456354  59824.394213           dev   

    diffpos reference_change  
0      True            False  
1      True            False  
2      True            False  
3      True            False  
4      True            False  
..      ...              ...  
57     True            False  
58     True            False  
59     True            False  
60     True            False  
61     True            False  

[62 rows x 22 columns]]",,17.963138341903687,2025-06-24T12:20:05,0.0,0.0,0.8148148148148148,1.0,0.0,0.0
0.18.1,gpt-4o,v3,27,9,"
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,9.683680295944214,2025-06-16T00:45:17,[None],"'[' was never closed (<string>, line 1)",13.09998106956482,2025-06-24T12:20:18,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,27,10,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.74471402168274,2025-06-16T00:45:28,[None],"'[' was never closed (<string>, line 1)",14.456608057022097,2025-06-24T12:20:33,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,17,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
3    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
4    ZTF23aawmeys       136      3556  59727.435289  60411.454433       True   
..            ...       ...       ...           ...           ...        ...   
180  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
181  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
182  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
183  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
184  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.178461  60173.178461   
3      False     1       NaN           NaN  ...  60173.176100  60173.176100   
4       True    12  0.064098      0.082246  ...  60173.195602  60411.454433   
..       ...   ...       ...           ...  ...           ...           ...   
180    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
181     True     2       NaN           NaN  ...  60175.192697  60182.239526   
182     True     2       NaN           NaN  ...  60175.185301  60465.343935   
183     True     2       NaN           NaN  ...  60175.189734  60820.339375   
184    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4          24.4.1     True             False  stamp_classifier   
..            ...      ...               ...               ...   
180         1.2.0     True             False  stamp_classifier   
181         1.2.0     True             False  stamp_classifier   
182        24.5.1     True             False  stamp_classifier   
183        27.5.6     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.657241       1  
3    stamp_classifier_1.0.4          SN     0.526146       1  
4    stamp_classifier_1.0.4          SN     0.512658       1  
..                      ...         ...          ...     ...  
180  stamp_classifier_1.0.4          SN     0.698527       1  
181  stamp_classifier_1.0.4          SN     0.631699       1  
182  stamp_classifier_1.0.4          SN     0.317975       1  
183  stamp_classifier_1.0.4          SN     0.321883       1  
184  stamp_classifier_1.0.4          SN     0.569558       1  

[185 rows x 27 columns]]",,6.323700428009033,2025-06-24T12:20:40,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,17,1,"
# Sub-query to filter objects classified as 'SN' by the 'stamp_classifier' with probability > 0.5
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""

# Sub-query to filter objects with at least two detections
detection_subquery = """"""
SELECT oid
FROM object
WHERE ndet >= 2
""""""

# Final query to join the sub-queries and filter by date range
full_query = """"""
SELECT o.*
FROM object o
INNER JOIN (
    {probability_subquery}
    UNION
    {detection_subquery}
) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
"""""".format(probability_subquery=probability_subquery, detection_subquery=detection_subquery)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,15.343609094619753,2025-06-16T00:43:43,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.*
FROM object o
INNER JOIN (
    
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1

    UNION
    
SELECT oid
FROM object
WHERE ndet >= 2

) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.86238360404968,2025-06-24T12:24:53,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,17,2,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.3977792263031,2025-06-16T00:43:57,[None],"'[' was never closed (<string>, line 1)",132.6465015411377,2025-06-24T12:27:06,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,17,3,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.281793355941772,2025-06-16T00:44:08,[None],"'[' was never closed (<string>, line 1)",134.0022246837616,2025-06-24T12:29:20,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,17,4,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.662756443023682,2025-06-16T00:44:19,[None],"'[' was never closed (<string>, line 1)",133.08195304870603,2025-06-24T12:31:33,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,17,5,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.362526655197144,2025-06-16T00:44:31,[None],"'[' was never closed (<string>, line 1)",131.92778062820437,2025-06-24T12:33:45,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,17,6,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.774812698364258,2025-06-16T00:44:43,[None],"'[' was never closed (<string>, line 1)",136.79887104034424,2025-06-24T12:36:02,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,17,7,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.094489097595217,2025-06-16T00:44:55,[None],"'[' was never closed (<string>, line 1)",134.89862203598022,2025-06-24T12:38:17,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,17,8,"
# Sub-query to filter objects based on the first detection date and number of detections
object_subquery = """"""
SELECT oid
FROM object
WHERE (firstmjd BETWEEN 59800 AND 59804) -- Julian dates for August 17 to August 21, 2023
AND (ndet >= 2)
""""""

# Sub-query to filter probabilities based on class name, classifier name, and probability
probability_subquery = f""""""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
AND probability > 0.5
""""""

# Final query combining the sub-queries with an INNER JOIN
full_query = f""""""
SELECT o.*
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.oid IN ({object_subquery})
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.225887775421144,2025-06-16T00:45:07,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18adjztyb       174      2987  58261.461725  60841.338345       True   
1   ZTF18adngbfy        36      1651  58364.250000  59809.250000      False   
2   ZTF22abbvtbc         2       811  59800.250000  59812.250000       True   
3   ZTF22abawpqu         3       301  59800.500000  59812.250000       True   
4   ZTF22abbxlen        13       854  59800.500000  59828.500000      False   
..           ...       ...       ...           ...           ...        ...   
57  ZTF22abazrjk       325      2164  58303.369491  60849.285972       True   
58  ZTF22abazrjk       325      2164  58303.369491  60849.285972       True   
59  ZTF19abzdlax         4      2635  58742.250000  60165.500000       True   
60  ZTF22aauntgm         5      1353  59026.242581  60645.132523       True   
61  ZTF19aavnssv        18      1511  58632.250000  59805.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    20       NaN           NaN  ...  300.891760  29.576847   
1     False     9  0.344612           NaN  ...  309.567669  30.155285   
2     False     2 -0.178473      0.575828  ...  346.616009 -11.166852   
3     False     3  0.112837      0.090166  ...  349.059289 -24.865724   
4     False    13 -0.134314           NaN  ...   23.274808  -3.382633   
..      ...   ...       ...           ...  ...         ...        ...   
57    False   321       NaN           NaN  ...  300.121884  34.885886   
58    False   321       NaN           NaN  ...  300.121884  34.885886   
59    False     2       NaN           NaN  ...  301.699999  59.735808   
60    False     3       NaN           NaN  ...  286.833187  86.132590   
61    False     9       NaN           NaN  ...  112.183415  45.327031   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  step_id_corr  \
0   0.019025  0.016546  1040.926852  59800.411493  60841.338345        27.5.6   
1   0.000010  0.000017     8.974583  59800.364375  59809.338958           dev   
2   0.000092  0.000111    11.966181  59800.373692  59812.339873           dev   
3   0.000049  0.000142    11.973588  59800.375776  59812.349363           dev   
4   0.000063  0.000038    28.070776  59800.381065  59828.451840           dev   
..       ...       ...          ...           ...           ...           ...   
57  0.005058  0.004149  1047.035613  59802.250359  60849.285972        27.5.6   
58  0.005058  0.004149  1047.035613  59802.250359  60849.285972        27.5.6   
59  0.000028  0.000059   362.966840  59802.414572  60165.381412         1.2.0   
60  1.260232  0.085000   842.691146  59802.441377  60645.132523      24.5.2a6   
61  0.000028  0.000023     2.010648  59803.495544  59805.506192           dev   

    diffpos reference_change  
0      True            False  
1      True            False  
2      True            False  
3      True            False  
4      True            False  
..      ...              ...  
57     True            False  
58     True            False  
59     True            False  
60    False            False  
61     True            False  

[62 rows x 22 columns]]",,27.455477476119995,2025-06-24T12:38:44,0.0,0.0,0.8148148148148148,1.0,0.0,0.0
0.18.1,gpt-4o,v3,17,9,"
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,9.683680295944214,2025-06-16T00:45:17,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18adngbfy        36      1651  58364.250000  59809.250000      False   
1   ZTF22abbvtbc         2       811  59800.250000  59812.250000       True   
2   ZTF22abawpqu         3       301  59800.500000  59812.250000       True   
3   ZTF22abbxlen        13       854  59800.500000  59828.500000      False   
4   ZTF22abejyju        82      1892  59471.243623  60533.257269       True   
..           ...       ...       ...           ...           ...        ...   
57  ZTF22abakgeg        33       912  59803.250000  59817.250000       True   
58  ZTF22abadoir        18       800  59803.500000  59843.500000      False   
59  ZTF19adehksw        73      1642  58723.465903  60643.317870       True   
60  ZTF19aavnssv        18      1511  58632.250000  59805.500000       True   
61  ZTF22abaxtfy         8       701  59803.500000  59824.500000      False   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False     9  0.344612           NaN  ...  309.567669  30.155285   
1     False     2 -0.178473      0.575828  ...  346.616009 -11.166852   
2     False     3  0.112837      0.090166  ...  349.059289 -24.865724   
3     False    13 -0.134314           NaN  ...   23.274808  -3.382633   
4     False    22  0.028900      0.161213  ...  330.295943  31.876105   
..      ...   ...       ...           ...  ...         ...        ...   
57    False    11  0.193835      0.570992  ...  266.008950  -5.403843   
58    False    18  0.187775      0.305721  ...   57.200373  74.726056   
59    False    21       NaN           NaN  ...   46.687782  46.153577   
60    False     9       NaN           NaN  ...  112.183415  45.327031   
61    False     8  0.141260           NaN  ...   10.120144  -9.625746   

     sigmara  sigmadec     deltajd      firstmjd       lastmjd  step_id_corr  \
0   0.000010  0.000017    8.974583  59800.364375  59809.338958           dev   
1   0.000092  0.000111   11.966181  59800.373692  59812.339873           dev   
2   0.000049  0.000142   11.973588  59800.375776  59812.349363           dev   
3   0.000063  0.000038   28.070776  59800.381065  59828.451840           dev   
4   0.054124  0.045962  732.865532  59800.391736  60533.257269      24.5.2a6   
..       ...       ...         ...           ...           ...           ...   
57  0.000052  0.000033   14.004317  59803.193194  59817.197512           dev   
58  0.000150  0.000030   40.005694  59803.413056  59843.418750           dev   
59  0.041269  0.028588  839.893137  59803.424734  60643.317870      24.5.2a6   
60  0.000028  0.000023    2.010648  59803.495544  59805.506192           dev   
61  0.000019  0.000015   20.937859  59803.456354  59824.394213           dev   

    diffpos reference_change  
0      True            False  
1      True            False  
2      True            False  
3      True            False  
4      True            False  
..      ...              ...  
57     True            False  
58     True            False  
59     True            False  
60     True            False  
61     True            False  

[62 rows x 22 columns]]",,15.391807317733765,2025-06-24T12:39:00,0.0,0.0,0.8148148148148148,1.0,0.0,0.0
0.18.1,gpt-4o,v3,17,10,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.74471402168274,2025-06-16T00:45:28,[None],"'[' was never closed (<string>, line 1)",12.210342407226562,2025-06-24T12:39:12,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,37,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
3    ZTF23aaygrgk        11      4240  58389.123657  60532.194988      False   
4    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
..            ...       ...       ...           ...           ...        ...   
180  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
181  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
182  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
183  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
184  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.176100  60173.176100   
3      False     2       NaN           NaN  ...  60173.182234  60532.194988   
4      False     6       NaN           NaN  ...  60173.180822  60532.194178   
..       ...   ...       ...           ...  ...           ...           ...   
180    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
181     True     2       NaN           NaN  ...  60175.185301  60465.343935   
182     True     2       NaN           NaN  ...  60175.189734  60820.339375   
183     True     2       NaN           NaN  ...  60175.192697  60182.239526   
184    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
180         1.2.0     True             False  stamp_classifier   
181        24.5.1     True             False  stamp_classifier   
182        27.5.6     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.526146       1  
3    stamp_classifier_1.0.4          SN     0.416646       1  
4    stamp_classifier_1.0.4          SN     0.306560       1  
..                      ...         ...          ...     ...  
180  stamp_classifier_1.0.4          SN     0.698527       1  
181  stamp_classifier_1.0.4          SN     0.317975       1  
182  stamp_classifier_1.0.4          SN     0.321883       1  
183  stamp_classifier_1.0.4          SN     0.631699       1  
184  stamp_classifier_1.0.4          SN     0.569558       1  

[185 rows x 27 columns]]",,7.1539483070373535,2025-06-24T12:39:19,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,37,1,"
# Sub-query to filter objects classified as 'SN' by the 'stamp_classifier' with probability > 0.5
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""

# Sub-query to filter objects with at least two detections
detection_subquery = """"""
SELECT oid
FROM object
WHERE ndet >= 2
""""""

# Final query to join the sub-queries and filter by date range
full_query = """"""
SELECT o.*
FROM object o
INNER JOIN (
    {probability_subquery}
    UNION
    {detection_subquery}
) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
"""""".format(probability_subquery=probability_subquery, detection_subquery=detection_subquery)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,15.343609094619753,2025-06-16T00:43:43,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.*
FROM object o
INNER JOIN (
    
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1

    UNION
    
SELECT oid
FROM object
WHERE ndet >= 2

) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.5421371459961,2025-06-24T12:43:32,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,37,2,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.3977792263031,2025-06-16T00:43:57,[None],"'[' was never closed (<string>, line 1)",136.32994413375854,2025-06-24T12:45:49,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,37,3,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.281793355941772,2025-06-16T00:44:08,[None],"'[' was never closed (<string>, line 1)",139.2130982875824,2025-06-24T12:48:09,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,37,4,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.662756443023682,2025-06-16T00:44:19,[None],"'[' was never closed (<string>, line 1)",131.39581823349,2025-06-24T12:50:20,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,37,5,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.362526655197144,2025-06-16T00:44:31,[None],"'[' was never closed (<string>, line 1)",131.6487259864807,2025-06-24T12:52:32,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,37,6,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.774812698364258,2025-06-16T00:44:43,[None],"'[' was never closed (<string>, line 1)",134.09268999099731,2025-06-24T12:54:47,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,37,7,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.094489097595217,2025-06-16T00:44:55,[None],"'[' was never closed (<string>, line 1)",133.2865390777588,2025-06-24T12:57:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,37,8,"
# Sub-query to filter objects based on the first detection date and number of detections
object_subquery = """"""
SELECT oid
FROM object
WHERE (firstmjd BETWEEN 59800 AND 59804) -- Julian dates for August 17 to August 21, 2023
AND (ndet >= 2)
""""""

# Sub-query to filter probabilities based on class name, classifier name, and probability
probability_subquery = f""""""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
AND probability > 0.5
""""""

# Final query combining the sub-queries with an INNER JOIN
full_query = f""""""
SELECT o.*
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.oid IN ({object_subquery})
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.225887775421144,2025-06-16T00:45:07,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18adngbfy        36      1651  58364.250000  59809.250000      False   
1   ZTF22abbvtbc         2       811  59800.250000  59812.250000       True   
2   ZTF22abawpqu         3       301  59800.500000  59812.250000       True   
3   ZTF22abbxlen        13       854  59800.500000  59828.500000      False   
4   ZTF22abejyju        82      1892  59471.243623  60533.257269       True   
..           ...       ...       ...           ...           ...        ...   
57  ZTF22abbxuap         8      1767  59802.500000  59816.500000       True   
58  ZTF19adehksw        73      1642  58723.465903  60643.317870       True   
59  ZTF22abaxtfy         8       701  59803.500000  59824.500000      False   
60  ZTF22abakgeg        33       912  59803.250000  59817.250000       True   
61  ZTF22abadoir        18       800  59803.500000  59843.500000      False   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False     9  0.344612           NaN  ...  309.567669  30.155285   
1     False     2 -0.178473      0.575828  ...  346.616009 -11.166852   
2     False     3  0.112837      0.090166  ...  349.059289 -24.865724   
3     False    13 -0.134314           NaN  ...   23.274808  -3.382633   
4     False    22  0.028900      0.161213  ...  330.295943  31.876105   
..      ...   ...       ...           ...  ...         ...        ...   
57    False     5  0.497630      0.865992  ...   23.023469   0.940410   
58    False    21       NaN           NaN  ...   46.687782  46.153577   
59    False     8  0.141260           NaN  ...   10.120144  -9.625746   
60    False    11  0.193835      0.570992  ...  266.008950  -5.403843   
61    False    18  0.187775      0.305721  ...   57.200373  74.726056   

     sigmara  sigmadec     deltajd      firstmjd       lastmjd  step_id_corr  \
0   0.000010  0.000017    8.974583  59800.364375  59809.338958           dev   
1   0.000092  0.000111   11.966181  59800.373692  59812.339873           dev   
2   0.000049  0.000142   11.973588  59800.375776  59812.349363           dev   
3   0.000063  0.000038   28.070776  59800.381065  59828.451840           dev   
4   0.054124  0.045962  732.865532  59800.391736  60533.257269      24.5.2a6   
..       ...       ...         ...           ...           ...           ...   
57  0.000074  0.000047   13.060058  59803.403461  59816.463518           dev   
58  0.041269  0.028588  839.893137  59803.424734  60643.317870      24.5.2a6   
59  0.000019  0.000015   20.937859  59803.456354  59824.394213           dev   
60  0.000052  0.000033   14.004317  59803.193194  59817.197512           dev   
61  0.000150  0.000030   40.005694  59803.413056  59843.418750           dev   

    diffpos reference_change  
0      True            False  
1      True            False  
2      True            False  
3      True            False  
4      True            False  
..      ...              ...  
57     True            False  
58     True            False  
59     True            False  
60     True            False  
61     True            False  

[62 rows x 22 columns]]",,19.37044477462769,2025-06-24T12:57:19,0.0,0.0,0.8148148148148148,1.0,0.0,0.0
0.18.1,gpt-4o,v3,37,9,"
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,9.683680295944214,2025-06-16T00:45:17,[None],"'[' was never closed (<string>, line 1)",12.920607566833496,2025-06-24T12:57:33,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,37,10,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.74471402168274,2025-06-16T00:45:28,[None],"'[' was never closed (<string>, line 1)",12.867735862731934,2025-06-24T12:57:46,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,34,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF23aaygxxt         7      1990  60173.250000  60183.250000      False   
..            ...       ...       ...           ...           ...        ...   
180  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
181  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
182  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
183  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
184  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.176100  60173.176100   
3      False     1       NaN           NaN  ...  60173.178461  60173.178461   
4      False     3 -0.024101           NaN  ...  60173.196076  60183.185579   
..       ...   ...       ...           ...  ...           ...           ...   
180    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
181     True     2       NaN           NaN  ...  60175.189734  60820.339375   
182     True     2       NaN           NaN  ...  60175.185301  60465.343935   
183     True     2       NaN           NaN  ...  60175.192697  60182.239526   
184    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
180         1.2.0     True             False  stamp_classifier   
181        27.5.6     True             False  stamp_classifier   
182        24.5.1     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.526146       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.707308       1  
..                      ...         ...          ...     ...  
180  stamp_classifier_1.0.4          SN     0.698527       1  
181  stamp_classifier_1.0.4          SN     0.321883       1  
182  stamp_classifier_1.0.4          SN     0.317975       1  
183  stamp_classifier_1.0.4          SN     0.631699       1  
184  stamp_classifier_1.0.4          SN     0.569558       1  

[185 rows x 27 columns]]",,8.2504723072052,2025-06-24T12:57:57,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,34,1,"
# Sub-query to filter objects classified as 'SN' by the 'stamp_classifier' with probability > 0.5
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""

# Sub-query to filter objects with at least two detections
detection_subquery = """"""
SELECT oid
FROM object
WHERE ndet >= 2
""""""

# Final query to join the sub-queries and filter by date range
full_query = """"""
SELECT o.*
FROM object o
INNER JOIN (
    {probability_subquery}
    UNION
    {detection_subquery}
) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
"""""".format(probability_subquery=probability_subquery, detection_subquery=detection_subquery)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,15.343609094619753,2025-06-16T00:43:43,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.*
FROM object o
INNER JOIN (
    
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1

    UNION
    
SELECT oid
FROM object
WHERE ndet >= 2

) AS filtered_oids ON o.oid = filtered_oids.oid
WHERE o.firstmjd BETWEEN 59806 AND 59810
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.9466679096222,2025-06-24T13:02:14,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,34,2,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.3977792263031,2025-06-16T00:43:57,[None],"'[' was never closed (<string>, line 1)",136.94119238853455,2025-06-24T13:04:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,34,3,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.281793355941772,2025-06-16T00:44:08,[None],"'[' was never closed (<string>, line 1)",139.28675985336304,2025-06-24T13:06:51,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,34,4,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.662756443023682,2025-06-16T00:44:19,[None],"'[' was never closed (<string>, line 1)",135.1869294643402,2025-06-24T13:09:07,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,34,5,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
AND ranking = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.362526655197144,2025-06-16T00:44:31,[None],"'[' was never closed (<string>, line 1)",130.56621479988098,2025-06-24T13:11:18,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,34,6,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.774812698364258,2025-06-16T00:44:43,[None],"'[' was never closed (<string>, line 1)",133.90659976005554,2025-06-24T13:13:32,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,34,7,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.094489097595217,2025-06-16T00:44:55,[None],"'[' was never closed (<string>, line 1)",133.7878336906433,2025-06-24T13:15:46,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,34,8,"
# Sub-query to filter objects based on the first detection date and number of detections
object_subquery = """"""
SELECT oid
FROM object
WHERE (firstmjd BETWEEN 59800 AND 59804) -- Julian dates for August 17 to August 21, 2023
AND (ndet >= 2)
""""""

# Sub-query to filter probabilities based on class name, classifier name, and probability
probability_subquery = f""""""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
AND probability > 0.5
""""""

# Final query combining the sub-queries with an INNER JOIN
full_query = f""""""
SELECT o.*
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.oid IN ({object_subquery})
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.225887775421144,2025-06-16T00:45:07,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18adngbfy        36      1651  58364.250000  59809.250000      False   
1   ZTF22abbvtbc         2       811  59800.250000  59812.250000       True   
2   ZTF22abawpqu         3       301  59800.500000  59812.250000       True   
3   ZTF22abbxlen        13       854  59800.500000  59828.500000      False   
4   ZTF22abejyju        82      1892  59471.243623  60533.257269       True   
..           ...       ...       ...           ...           ...        ...   
57  ZTF22ababfbk         2      3712  59802.500000  59873.250000       True   
58  ZTF22abakgeg        33       912  59803.250000  59817.250000       True   
59  ZTF19adehksw        73      1642  58723.465903  60643.317870       True   
60  ZTF22abaxtfy         8       701  59803.500000  59824.500000      False   
61  ZTF19aavnssv        18      1511  58632.250000  59805.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False     9  0.344612           NaN  ...  309.567669  30.155285   
1     False     2 -0.178473      0.575828  ...  346.616009 -11.166852   
2     False     3  0.112837      0.090166  ...  349.059289 -24.865724   
3     False    13 -0.134314           NaN  ...   23.274808  -3.382633   
4     False    22  0.028900      0.161213  ...  330.295943  31.876105   
..      ...   ...       ...           ...  ...         ...        ...   
57    False     2       NaN           NaN  ...   35.300408  36.794580   
58    False    11  0.193835      0.570992  ...  266.008950  -5.403843   
59    False    21       NaN           NaN  ...   46.687782  46.153577   
60    False     8  0.141260           NaN  ...   10.120144  -9.625746   
61    False     9       NaN           NaN  ...  112.183415  45.327031   

     sigmara  sigmadec     deltajd      firstmjd       lastmjd  step_id_corr  \
0   0.000010  0.000017    8.974583  59800.364375  59809.338958           dev   
1   0.000092  0.000111   11.966181  59800.373692  59812.339873           dev   
2   0.000049  0.000142   11.973588  59800.375776  59812.349363           dev   
3   0.000063  0.000038   28.070776  59800.381065  59828.451840           dev   
4   0.054124  0.045962  732.865532  59800.391736  60533.257269      24.5.2a6   
..       ...       ...         ...           ...           ...           ...   
57  0.000008  0.000094   70.860428  59802.469097  59873.329526         1.1.6   
58  0.000052  0.000033   14.004317  59803.193194  59817.197512           dev   
59  0.041269  0.028588  839.893137  59803.424734  60643.317870      24.5.2a6   
60  0.000019  0.000015   20.937859  59803.456354  59824.394213           dev   
61  0.000028  0.000023    2.010648  59803.495544  59805.506192           dev   

    diffpos reference_change  
0      True            False  
1      True            False  
2      True            False  
3      True            False  
4      True            False  
..      ...              ...  
57    False            False  
58     True            False  
59     True            False  
60     True            False  
61     True            False  

[62 rows x 22 columns]]",,13.587560653686523,2025-06-24T13:16:00,0.0,0.0,0.8148148148148148,1.0,0.0,0.0
0.18.1,gpt-4o,v3,34,9,"
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,9.683680295944214,2025-06-16T00:45:17,[None],"'[' was never closed (<string>, line 1)",13.80324649810791,2025-06-24T13:16:15,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,34,10,"
subquery_probability = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.74471402168274,2025-06-16T00:45:28,[None],"'[' was never closed (<string>, line 1)",11.116802453994753,2025-06-24T13:16:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,1,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
..            ...       ...       ...           ...           ...        ...   
180  ZTF23aazhprx         2       578  60083.250000  60175.250000       True   
181  ZTF23aazhofz         2      1852  59788.250000  60175.250000       True   
182  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
183  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
184  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.176100  60173.176100   
3      False     1       NaN           NaN  ...  60173.178461  60173.178461   
4      False     6       NaN           NaN  ...  60173.180822  60532.194178   
..       ...   ...       ...           ...  ...           ...           ...   
180    False     1       NaN           NaN  ...  60175.179132  60175.179132   
181    False     1       NaN           NaN  ...  60175.181007  60175.181007   
182    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
183     True     2       NaN           NaN  ...  60175.192697  60182.239526   
184    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
180         1.2.0     True             False  stamp_classifier   
181         1.2.0     True             False  stamp_classifier   
182         1.2.0     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.526146       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.306560       1  
..                      ...         ...          ...     ...  
180  stamp_classifier_1.0.4          SN     0.574371       1  
181  stamp_classifier_1.0.4          SN     0.622088       1  
182  stamp_classifier_1.0.4          SN     0.698527       1  
183  stamp_classifier_1.0.4          SN     0.631699       1  
184  stamp_classifier_1.0.4          SN     0.569558       1  

[185 rows x 27 columns]]",,4.888890027999878,2025-06-24T13:16:32,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,1,1,"
# Step 1: Filter by Classification
classification_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Step 2: Filter by Time Coverage
time_coverage_subquery = """"""
SELECT oid
FROM object
WHERE deltajd >= 365
""""""

# Step 3: Filter by Detection Count
detection_count_subquery = """"""
SELECT oid
FROM magstat
WHERE ndet >= 20
""""""

# Step 4: Calculate Magnitude Variations
magnitude_variation_subquery = """"""
SELECT oid
FROM magstat
WHERE (fid = 1 AND (magmax_corr - magmin_corr) > 1)
OR (fid = 2 AND (magmax_corr - magmin_corr) > 0.5)
""""""

# Step 5: Retrieve Features
features_subquery = """"""
SELECT oid, value, name, version, fid
FROM feature
WHERE oid IN ({classification_subquery})
""""""

# Step 6: Combine Results
final_query = """"""
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM object o
INNER JOIN ({classification_subquery}) AS p ON o.oid = p.oid
INNER JOIN ({time_coverage_subquery}) AS tc ON o.oid = tc.oid
INNER JOIN ({detection_count_subquery}) AS dc ON o.oid = dc.oid
INNER JOIN ({magnitude_variation_subquery}) AS mv ON o.oid = mv.oid
INNER JOIN magstat m ON o.oid = m.oid
INNER JOIN ({features_subquery}) AS f ON o.oid = f.oid
WHERE m.fid IN (1, 2)
ORDER BY o.oid
""""""

# Final Query
full_query = final_query.format(
    classification_subquery=classification_subquery,
    time_coverage_subquery=time_coverage_subquery,
    detection_count_subquery=detection_count_subquery,
    magnitude_variation_subquery=magnitude_variation_subquery,
    features_subquery=features_subquery
)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,19.763691425323486,2025-06-16T01:05:27,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""{""
LINE 33: WHERE oid IN ({classification_subquery})
                       ^

[SQL: 
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) AS p ON o.oid = p.oid
INNER JOIN (
SELECT oid
FROM object
WHERE deltajd >= 365
) AS tc ON o.oid = tc.oid
INNER JOIN (
SELECT oid
FROM magstat
WHERE ndet >= 20
) AS dc ON o.oid = dc.oid
INNER JOIN (
SELECT oid
FROM magstat
WHERE (fid = 1 AND (magmax_corr - magmin_corr) > 1)
OR (fid = 2 AND (magmax_corr - magmin_corr) > 0.5)
) AS mv ON o.oid = mv.oid
INNER JOIN magstat m ON o.oid = m.oid
INNER JOIN (
SELECT oid, value, name, version, fid
FROM feature
WHERE oid IN ({classification_subquery})
) AS f ON o.oid = f.oid
WHERE m.fid IN (1, 2)
ORDER BY o.oid
]
(Background on this error at: https://sqlalche.me/e/20/f405)",19.475879669189453,2025-06-24T15:13:39,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,1,2,"
# Sub-query for Probability
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
""""""

# Sub-query for Object
object_subquery = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.deltajd >= 365
""""""

# Sub-query for Magstat
magstat_subquery = f""""""
SELECT m.oid, m.fid AS magstat_fid, m.magmax_corr, m.magmin_corr, 
       (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM magstat m
INNER JOIN ({object_subquery}) o ON m.oid = o.oid
WHERE m.ndet >= 20
  AND m.corrected = TRUE
  AND ((m.fid = 1 AND (m.magmax_corr - m.magmin_corr) > 1) OR
       (m.fid = 2 AND (m.magmax_corr - m.magmin_corr) > 0.5))
""""""

# Sub-query for Feature
feature_subquery = f""""""
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN ({probability_subquery}) p ON f.oid = p.oid
""""""

# Final Query
full_query = f""""""
SELECT m.oid, f.value, f.name, f.version, f.feature_fid, 
       o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, m.delta_mag
FROM ({magstat_subquery}) m
INNER JOIN ({feature_subquery}) f ON m.oid = f.oid
INNER JOIN ({object_subquery}) o ON m.oid = o.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,18.615444660186768,2025-06-16T01:05:46,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT m.oid, f.value, f.name, f.version, f.feature_fid, 
       o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, m.delta_mag
FROM (
SELECT m.oid, m.fid AS magstat_fid, m.magmax_corr, m.magmin_corr, 
       (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM magstat m
INNER JOIN (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
) o ON m.oid = o.oid
WHERE m.ndet >= 20
  AND m.corrected = TRUE
  AND ((m.fid = 1 AND (m.magmax_corr - m.magmin_corr) > 1) OR
       (m.fid = 2 AND (m.magmax_corr - m.magmin_corr) > 0.5))
) m
INNER JOIN (
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
) p ON f.oid = p.oid
) f ON m.oid = f.oid
INNER JOIN (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
) o ON m.oid = o.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",291.88293194770813,2025-06-24T15:18:43,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,1,3,"
# Sub-query for Probability
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
""""""

# Sub-query for Object Conditions
object_subquery = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.deltajd >= 365
""""""

# Sub-query for Magnitude Statistics
magstat_subquery = f""""""
SELECT m.oid, m.fid, m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM magstat m
INNER JOIN ({object_subquery}) o ON m.oid = o.oid
WHERE m.ndet >= 20
  AND ((m.fid = 1 AND (m.magmax_corr - m.magmin_corr) > 1) OR
       (m.fid = 2 AND (m.magmax_corr - m.magmin_corr) > 0.5))
""""""

# Sub-query for Features
feature_subquery = f""""""
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN ({probability_subquery}) p ON f.oid = p.oid
""""""

# Final Query Construction
final_query = f""""""
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, m.delta_mag
FROM ({object_subquery}) o
INNER JOIN ({magstat_subquery}) m ON o.oid = m.oid
INNER JOIN ({feature_subquery}) f ON o.oid = f.oid
""""""

# Full Query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.03337550163269,2025-06-16T01:06:10,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, m.delta_mag
FROM (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
) o
INNER JOIN (
SELECT m.oid, m.fid, m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM magstat m
INNER JOIN (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
) o ON m.oid = o.oid
WHERE m.ndet >= 20
  AND ((m.fid = 1 AND (m.magmax_corr - m.magmin_corr) > 1) OR
       (m.fid = 2 AND (m.magmax_corr - m.magmin_corr) > 0.5))
) m ON o.oid = m.oid
INNER JOIN (
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
) p ON f.oid = p.oid
) f ON o.oid = f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",260.32112216949463,2025-06-24T15:23:12,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,1,4,"
# Step 1: Filter objects classified as AGN with a probability greater than 0.6
agn_prob_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Step 2: Filter objects with light curves covering at least one year and at least 20 detections
object_filter_subquery = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN ({agn_prob_subquery}) p ON o.oid = p.oid
WHERE o.deltajd >= 365
AND o.ndet >= 20
""""""

# Step 3: Calculate magnitude variations in g and r bands
magstat_filter_subquery = """"""
SELECT oid, fid, magmax_corr, magmin_corr
FROM magstat
WHERE (fid = 1 AND magmax_corr - magmin_corr > 1)
OR (fid = 2 AND magmax_corr - magmin_corr > 0.5)
""""""

# Step 4: Retrieve features for the filtered objects
feature_subquery = f""""""
SELECT f.oid, f.value, f.name, f.version, f.fid
FROM feature f
INNER JOIN ({object_filter_subquery}) o ON f.oid = o.oid
""""""

# Step 5: Combine results and select required columns
final_query = f""""""
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, 
       o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, 
       (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM ({object_filter_subquery}) o
INNER JOIN ({magstat_filter_subquery}) m ON o.oid = m.oid
INNER JOIN ({feature_subquery}) f ON o.oid = f.oid
""""""

# Final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,17.458597660064697,2025-06-16T01:06:28,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, 
       o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, 
       (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
AND o.ndet >= 20
) o
INNER JOIN (
SELECT oid, fid, magmax_corr, magmin_corr
FROM magstat
WHERE (fid = 1 AND magmax_corr - magmin_corr > 1)
OR (fid = 2 AND magmax_corr - magmin_corr > 0.5)
) m ON o.oid = m.oid
INNER JOIN (
SELECT f.oid, f.value, f.name, f.version, f.fid
FROM feature f
INNER JOIN (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
AND o.ndet >= 20
) o ON f.oid = o.oid
) f ON o.oid = f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",256.7289271354676,2025-06-24T15:27:36,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,1,5,"
# Step 1: Filter AGN Objects with Probability > 0.6
agn_objects = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Step 2: Join with Object Table for Time and Detection Criteria
object_filter = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN ({agn_objects}) p ON o.oid = p.oid
WHERE o.deltajd >= 365
""""""

# Step 3: Join with Magstat Table for Magnitude Variation Criteria
magstat_filter = f""""""
SELECT m.oid, m.fid, m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM magstat m
INNER JOIN ({object_filter}) o ON m.oid = o.oid
WHERE (m.fid = 1 AND (m.magmax_corr - m.magmin_corr) > 1)
OR (m.fid = 2 AND (m.magmax_corr - m.magmin_corr) > 0.5)
AND m.ndet >= 20
""""""

# Step 4: Retrieve Features
features = f""""""
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN ({agn_objects}) p ON f.oid = p.oid
""""""

# Step 5: Final Query Combining All Steps
final_query = f""""""
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet, m.magmax_corr, m.magmin_corr, m.delta_mag
FROM ({object_filter}) o
INNER JOIN ({magstat_filter}) m ON o.oid = m.oid
INNER JOIN ({features}) f ON o.oid = f.oid
ORDER BY o.oid
""""""

# Final Query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,17.81825852394104,2025-06-16T01:06:45,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet, m.magmax_corr, m.magmin_corr, m.delta_mag
FROM (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
) o
INNER JOIN (
SELECT m.oid, m.fid, m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM magstat m
INNER JOIN (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
) o ON m.oid = o.oid
WHERE (m.fid = 1 AND (m.magmax_corr - m.magmin_corr) > 1)
OR (m.fid = 2 AND (m.magmax_corr - m.magmin_corr) > 0.5)
AND m.ndet >= 20
) m ON o.oid = m.oid
INNER JOIN (
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) p ON f.oid = p.oid
) f ON o.oid = f.oid
ORDER BY o.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",257.21065497398376,2025-06-24T15:32:01,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,1,6,"
# Sub-query for Probability
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND classifier_name = 'lc_classifier'
  AND ranking = 1
  AND probability > 0.6
""""""

# Sub-query for Object
object_subquery = """"""
SELECT oid, meanra, meandec, ndet
FROM object
WHERE deltajd >= 365
""""""

# Sub-query for Magstat
magstat_subquery = """"""
SELECT oid, fid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag
FROM magstat
WHERE ndet >= 20
  AND ((fid = 1 AND (magmax_corr - magmin_corr) > 1) OR (fid = 2 AND (magmax_corr - magmin_corr) > 0.5))
""""""

# Sub-query for Feature
feature_subquery = """"""
SELECT oid, name, value, version, fid
FROM feature
WHERE oid IN ({probability_subquery})
""""""

# Final Query
final_query = f""""""
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, m.delta_mag
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN ({magstat_subquery}) m ON o.oid = m.oid
INNER JOIN ({feature_subquery}) f ON o.oid = f.oid
WHERE m.fid IN (1, 2)
""""""

# Combine all sub-queries into the final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,17.081537008285522,2025-06-16T01:07:03,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""{""
LINE 26: WHERE oid IN ({probability_subquery})
                       ^

[SQL: 
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, m.delta_mag
FROM (
SELECT oid, meanra, meandec, ndet
FROM object
WHERE deltajd >= 365
) o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND classifier_name = 'lc_classifier'
  AND ranking = 1
  AND probability > 0.6
) p ON o.oid = p.oid
INNER JOIN (
SELECT oid, fid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag
FROM magstat
WHERE ndet >= 20
  AND ((fid = 1 AND (magmax_corr - magmin_corr) > 1) OR (fid = 2 AND (magmax_corr - magmin_corr) > 0.5))
) m ON o.oid = m.oid
INNER JOIN (
SELECT oid, name, value, version, fid
FROM feature
WHERE oid IN ({probability_subquery})
) f ON o.oid = f.oid
WHERE m.fid IN (1, 2)
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.6486337184906,2025-06-24T15:32:20,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,1,7,"
# Step 1: Filter AGN Classifications
agn_prob_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Step 2: Filter Objects Based on Time Coverage and Detections
object_filter_subquery = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN ({agn_prob_subquery}) p ON o.oid = p.oid
WHERE o.deltajd >= 365
AND o.ndet >= 20
""""""

# Step 3: Calculate Magnitude Variations
magstat_g_subquery = """"""
SELECT oid, (magmax_corr - magmin_corr) AS delta_mag_g
FROM magstat
WHERE fid = 1
AND (magmax_corr - magmin_corr) > 1
""""""

magstat_r_subquery = """"""
SELECT oid, (magmax_corr - magmin_corr) AS delta_mag_r
FROM magstat
WHERE fid = 2
AND (magmax_corr - magmin_corr) > 0.5
""""""

# Step 4: Retrieve Feature Details
feature_subquery = f""""""
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN ({object_filter_subquery}) o ON f.oid = o.oid
""""""

# Step 5: Combine Results
final_query = f""""""
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet, 
       mg.delta_mag_g, mr.delta_mag_r
FROM ({object_filter_subquery}) o
INNER JOIN ({magstat_g_subquery}) mg ON o.oid = mg.oid
INNER JOIN ({magstat_r_subquery}) mr ON o.oid = mr.oid
INNER JOIN ({feature_subquery}) f ON o.oid = f.oid
""""""

# Final Query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,17.653383493423462,2025-06-16T01:07:20,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet, 
       mg.delta_mag_g, mr.delta_mag_r
FROM (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
AND o.ndet >= 20
) o
INNER JOIN (
SELECT oid, (magmax_corr - magmin_corr) AS delta_mag_g
FROM magstat
WHERE fid = 1
AND (magmax_corr - magmin_corr) > 1
) mg ON o.oid = mg.oid
INNER JOIN (
SELECT oid, (magmax_corr - magmin_corr) AS delta_mag_r
FROM magstat
WHERE fid = 2
AND (magmax_corr - magmin_corr) > 0.5
) mr ON o.oid = mr.oid
INNER JOIN (
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
AND o.ndet >= 20
) o ON f.oid = o.oid
) f ON o.oid = f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",258.8633542060852,2025-06-24T15:36:47,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,1,8,"
# Step 1: Filter by Classification
classification_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Step 2: Filter by Time Coverage
time_coverage_subquery = """"""
SELECT oid
FROM object
WHERE deltajd >= 365
""""""

# Step 3: Filter by Detection Count
detection_count_subquery = """"""
SELECT oid
FROM magstat
WHERE ndet >= 20
""""""

# Step 4: Calculate Magnitude Variations
magnitude_variation_subquery = """"""
SELECT oid
FROM magstat
WHERE (fid = 1 AND magmax_corr - magmin_corr > 1)
OR (fid = 2 AND magmax_corr - magmin_corr > 0.5)
""""""

# Step 5: Combine Conditions
combined_conditions_subquery = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, f.value, f.name, f.version, f.fid AS feature_fid,
       m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM object o
INNER JOIN ({classification_subquery}) AS p ON o.oid = p.oid
INNER JOIN ({time_coverage_subquery}) AS t ON o.oid = t.oid
INNER JOIN ({detection_count_subquery}) AS d ON o.oid = d.oid
INNER JOIN ({magnitude_variation_subquery}) AS mv ON o.oid = mv.oid
INNER JOIN feature f ON o.oid = f.oid
INNER JOIN magstat m ON o.oid = m.oid
WHERE m.fid IN (1, 2)
""""""

# Final Query
full_query = f""""""
{combined_conditions_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,19.59578418731689,2025-06-16T01:07:40,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 

SELECT o.oid, o.meanra, o.meandec, o.ndet, f.value, f.name, f.version, f.fid AS feature_fid,
       m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) AS p ON o.oid = p.oid
INNER JOIN (
SELECT oid
FROM object
WHERE deltajd >= 365
) AS t ON o.oid = t.oid
INNER JOIN (
SELECT oid
FROM magstat
WHERE ndet >= 20
) AS d ON o.oid = d.oid
INNER JOIN (
SELECT oid
FROM magstat
WHERE (fid = 1 AND magmax_corr - magmin_corr > 1)
OR (fid = 2 AND magmax_corr - magmin_corr > 0.5)
) AS mv ON o.oid = mv.oid
INNER JOIN feature f ON o.oid = f.oid
INNER JOIN magstat m ON o.oid = m.oid
WHERE m.fid IN (1, 2)

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",257.1711173057556,2025-06-24T15:41:12,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,1,9,"
# Step 1: Filter by Classification
classification_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Step 2: Filter by Time Coverage
time_coverage_subquery = """"""
SELECT oid
FROM object
WHERE deltajd >= 365
""""""

# Step 3: Filter by Detection Count
detection_count_subquery = """"""
SELECT oid
FROM magstat
WHERE ndet >= 20
""""""

# Step 4: Calculate Magnitude Variations
magnitude_variation_subquery = """"""
SELECT oid
FROM magstat
WHERE (fid = 1 AND (magmax_corr - magmin_corr) > 1)
OR (fid = 2 AND (magmax_corr - magmin_corr) > 0.5)
""""""

# Step 5: Combine Conditions
combined_conditions_subquery = f""""""
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, o.meanra, o.meandec, o.ndet,
       ms_g.magmax_corr AS g_magmax_corr, ms_g.magmin_corr AS g_magmin_corr,
       ms_r.magmax_corr AS r_magmax_corr, ms_r.magmin_corr AS r_magmin_corr,
       (ms_g.magmax_corr - ms_g.magmin_corr) AS g_delta_mag,
       (ms_r.magmax_corr - ms_r.magmin_corr) AS r_delta_mag
FROM object o
INNER JOIN ({classification_subquery}) AS p ON o.oid = p.oid
INNER JOIN ({time_coverage_subquery}) AS tc ON o.oid = tc.oid
INNER JOIN ({detection_count_subquery}) AS dc ON o.oid = dc.oid
INNER JOIN ({magnitude_variation_subquery}) AS mv ON o.oid = mv.oid
INNER JOIN feature f ON o.oid = f.oid
INNER JOIN magstat ms_g ON o.oid = ms_g.oid AND ms_g.fid = 1
INNER JOIN magstat ms_r ON o.oid = ms_r.oid AND ms_r.fid = 2
""""""

# Final Query
full_query = f""""""
{combined_conditions_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,18.288084030151367,2025-06-16T01:07:58,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 

SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, o.meanra, o.meandec, o.ndet,
       ms_g.magmax_corr AS g_magmax_corr, ms_g.magmin_corr AS g_magmin_corr,
       ms_r.magmax_corr AS r_magmax_corr, ms_r.magmin_corr AS r_magmin_corr,
       (ms_g.magmax_corr - ms_g.magmin_corr) AS g_delta_mag,
       (ms_r.magmax_corr - ms_r.magmin_corr) AS r_delta_mag
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
) AS p ON o.oid = p.oid
INNER JOIN (
SELECT oid
FROM object
WHERE deltajd >= 365
) AS tc ON o.oid = tc.oid
INNER JOIN (
SELECT oid
FROM magstat
WHERE ndet >= 20
) AS dc ON o.oid = dc.oid
INNER JOIN (
SELECT oid
FROM magstat
WHERE (fid = 1 AND (magmax_corr - magmin_corr) > 1)
OR (fid = 2 AND (magmax_corr - magmin_corr) > 0.5)
) AS mv ON o.oid = mv.oid
INNER JOIN feature f ON o.oid = f.oid
INNER JOIN magstat ms_g ON o.oid = ms_g.oid AND ms_g.fid = 1
INNER JOIN magstat ms_r ON o.oid = ms_r.oid AND ms_r.fid = 2

]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",257.06657099723816,2025-06-24T15:45:37,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,1,10,"
# Sub-query for Probability
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
""""""

# Sub-query for Object Conditions
object_subquery = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.deltajd >= 365
""""""

# Sub-query for Detection Count and Magnitude Variations
magstat_subquery = f""""""
SELECT m.oid, m.fid, m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM magstat m
INNER JOIN ({object_subquery}) o ON m.oid = o.oid
WHERE m.ndet >= 20
  AND ((m.fid = 1 AND (m.magmax_corr - m.magmin_corr) > 1) OR
       (m.fid = 2 AND (m.magmax_corr - m.magmin_corr) > 0.5))
""""""

# Sub-query for Features
feature_subquery = f""""""
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN ({probability_subquery}) p ON f.oid = p.oid
""""""

# Final Query Assembly
final_query = f""""""
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, m.delta_mag
FROM ({object_subquery}) o
INNER JOIN ({magstat_subquery}) m ON o.oid = m.oid
INNER JOIN ({feature_subquery}) f ON o.oid = f.oid
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.38922667503357,2025-06-16T01:08:19,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet, 
       m.magmax_corr, m.magmin_corr, m.delta_mag
FROM (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
) o
INNER JOIN (
SELECT m.oid, m.fid, m.magmax_corr, m.magmin_corr, (m.magmax_corr - m.magmin_corr) AS delta_mag
FROM magstat m
INNER JOIN (
SELECT o.oid, o.meanra, o.meandec, o.ndet
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
WHERE o.deltajd >= 365
) o ON m.oid = o.oid
WHERE m.ndet >= 20
  AND ((m.fid = 1 AND (m.magmax_corr - m.magmin_corr) > 1) OR
       (m.fid = 2 AND (m.magmax_corr - m.magmin_corr) > 0.5))
) m ON o.oid = m.oid
INNER JOIN (
SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
FROM feature f
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'AGN'
  AND probability > 0.6
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
) p ON f.oid = p.oid
) f ON o.oid = f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",257.6503372192383,2025-06-24T15:50:02,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,16,0,"SELECT
    sq.oid, sq.probability, sq.diffmaglim, sq.fid, sq.mjd,
    magstat.fid as magstat_fid, magstat.dmdt_first
FROM
  (
SELECT
   non_detection.fid, non_detection.diffmaglim, non_detection.mjd, obj_oids.oid, obj_oids.probability
FROM
  (
SELECT
    object.oid, probability.probability
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='stamp_classifier'
    AND probability.class_name='SN'
    AND probability.ranking=1
    AND object.firstmjd > 60188.0
    AND object.firstmjd < 60189.0
) as obj_oids
    INNER JOIN
    non_detection ON non_detection.oid = obj_oids.oid
) AS sq
  INNER JOIN magstat
  ON sq.oid = magstat.oid
WHERE
  magstat.dmdt_first < -0.25
ORDER BY oid
LIMIT 100",,,,,"[             oid  probability  diffmaglim  fid           mjd  magstat_fid  \
0   ZTF18aaiaclp     0.520409     20.4159    1  60161.201343            2   
1   ZTF18aaiaclp     0.520409     20.5201    1  60161.206146            2   
2   ZTF18aaiaclp     0.520409     19.7568    1  60161.283750            2   
3   ZTF18aaiaclp     0.520409     19.5815    1  60163.299884            2   
4   ZTF18aaiaclp     0.520409     19.7775    1  60163.300359            2   
..           ...          ...         ...  ...           ...          ...   
95  ZTF18aaleydm     0.613368     16.7941    2  60158.233981            2   
96  ZTF18aaleydm     0.613368     19.9087    2  60161.343796            2   
97  ZTF18aaleydm     0.613368     20.2772    2  60163.288322            2   
98  ZTF18aaleydm     0.613368     20.6824    2  60165.215347            2   
99  ZTF18aaleydm     0.613368     20.2314    2  60169.290069            2   

    dmdt_first  
0    -0.445361  
1    -0.445361  
2    -0.445361  
3    -0.445361  
4    -0.445361  
..         ...  
95   -0.830610  
96   -0.830610  
97   -0.830610  
98   -0.830610  
99   -0.830610  

[100 rows x 7 columns]]",,11.991127014160156,2025-06-24T15:50:14,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,16,1,"
# Subquery for Probability
probability_subquery = """"""
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
""""""

# Subquery for Object
object_subquery = """"""
SELECT oid, firstmjd
FROM object
WHERE firstmjd >= 2459458.5 AND firstmjd < 2459460.5  -- First 2 days of September 2023
""""""

# Join Probability and Object
probability_object_join = f""""""
SELECT p.oid, p.probability, o.firstmjd
FROM ({probability_subquery}) p
INNER JOIN ({object_subquery}) o ON p.oid = o.oid
""""""

# Subquery for Fast Risers
fast_risers_subquery = """"""
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first > 0  -- Assuming positive dmdt_first indicates fast risers
""""""

# Join with Fast Risers
probability_object_fast_risers_join = f""""""
SELECT po.oid, po.probability, po.firstmjd, m.magstat_fid, m.dmdt_first
FROM ({probability_object_join}) po
INNER JOIN ({fast_risers_subquery}) m ON po.oid = m.oid
""""""

# Subquery for Light Curves
light_curves_subquery = """"""
SELECT oid, fid, mjd, diffmaglim
FROM detection
UNION
SELECT oid, fid, mjd, NULL AS diffmaglim
FROM non_detection
""""""

# Final Join
final_query = f""""""
SELECT pf.oid, pf.probability, lc.fid, lc.diffmaglim, pf.magstat_fid, pf.dmdt_first
FROM ({probability_object_fast_risers_join}) pf
INNER JOIN ({light_curves_subquery}) lc ON pf.oid = lc.oid
ORDER BY pf.oid
LIMIT 100
""""""

# Full Query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,16.25312328338623,2025-06-16T01:08:35,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT pf.oid, pf.probability, lc.fid, lc.diffmaglim, pf.magstat_fid, pf.dmdt_first
FROM (
SELECT po.oid, po.probability, po.firstmjd, m.magstat_fid, m.dmdt_first
FROM (
SELECT p.oid, p.probability, o.firstmjd
FROM (
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
) p
INNER JOIN (
SELECT oid, firstmjd
FROM object
WHERE firstmjd >= 2459458.5 AND firstmjd < 2459460.5  -- First 2 days of September 2023
) o ON p.oid = o.oid
) po
INNER JOIN (
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first > 0  -- Assuming positive dmdt_first indicates fast risers
) m ON po.oid = m.oid
) pf
INNER JOIN (
SELECT oid, fid, mjd, diffmaglim
FROM detection
UNION
SELECT oid, fid, mjd, NULL AS diffmaglim
FROM non_detection
) lc ON pf.oid = lc.oid
ORDER BY pf.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.12026000022888,2025-06-24T15:54:35,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,16,2,"
# Subquery to get objects with the highest probability in the stamp classifier for class 'SN'
subquery_prob = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
""""""

# Subquery to get objects with first detection in the first 2 days of September
subquery_first_detection = """"""
SELECT oid
FROM object
WHERE firstmjd BETWEEN 59800 AND 59802
""""""

# Subquery to get fast risers from magstat
subquery_fast_risers = """"""
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first IS NOT NULL
""""""

# Main query combining all conditions
final_query = """"""
SELECT o.oid, p.probability, d.fid, d.diffmaglim, m.magstat_fid, m.dmdt_first
FROM object o
INNER JOIN ({subquery_prob}) AS prob ON o.oid = prob.oid
INNER JOIN ({subquery_first_detection}) AS first_det ON o.oid = first_det.oid
INNER JOIN ({subquery_fast_risers}) AS m ON o.oid = m.oid
LEFT JOIN detection d ON o.oid = d.oid
LEFT JOIN non_detection nd ON o.oid = nd.oid
ORDER BY o.oid
LIMIT 100
"""""".format(subquery_prob=subquery_prob, subquery_first_detection=subquery_first_detection, subquery_fast_risers=subquery_fast_risers)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,16.524044513702393,2025-06-16T01:08:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT pf.oid, pf.probability, lc.fid, lc.diffmaglim, pf.magstat_fid, pf.dmdt_first
FROM (
SELECT po.oid, po.probability, po.firstmjd, m.magstat_fid, m.dmdt_first
FROM (
SELECT p.oid, p.probability, o.firstmjd
FROM (
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
) p
INNER JOIN (
SELECT oid, firstmjd
FROM object
WHERE firstmjd >= 2459458.5 AND firstmjd < 2459460.5  -- First 2 days of September 2023
) o ON p.oid = o.oid
) po
INNER JOIN (
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first > 0  -- Assuming positive dmdt_first indicates fast risers
) m ON po.oid = m.oid
) pf
INNER JOIN (
SELECT oid, fid, mjd, diffmaglim
FROM detection
UNION
SELECT oid, fid, mjd, NULL AS diffmaglim
FROM non_detection
) lc ON pf.oid = lc.oid
ORDER BY pf.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.3309714794159,2025-06-24T15:58:52,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,16,3,"
# Subquery to get the highest probability in the stamp classifier for class 'SN'
probability_subquery = """"""
SELECT oid, probability
FROM probability
WHERE ranking = 1
  AND classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
""""""

# Subquery to filter objects with first detection in the first 2 days of September
object_subquery = f""""""
SELECT o.oid, o.firstmjd
FROM object o
JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 2459458.5 AND 2459460.5  -- Julian dates for September 1st and 2nd, 2023
""""""

# Subquery to filter fast risers using magstat
fast_risers_subquery = f""""""
SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first
FROM magstat m
JOIN ({object_subquery}) o ON m.oid = o.oid
WHERE m.dmdt_first > 0.1  -- Example threshold for fast risers
""""""

# Final query to join with non_detection and detection tables
final_query = f""""""
SELECT o.oid, p.probability, d.fid, d.diffmaglim, m.magstat_fid, m.dmdt_first
FROM ({fast_risers_subquery}) m
JOIN non_detection nd ON m.oid = nd.oid
JOIN detection d ON m.oid = d.oid
JOIN ({probability_subquery}) p ON m.oid = p.oid
ORDER BY o.oid
LIMIT 100
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,17.895641326904297,2025-06-16T01:09:10,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT pf.oid, pf.probability, lc.fid, lc.diffmaglim, pf.magstat_fid, pf.dmdt_first
FROM (
SELECT po.oid, po.probability, po.firstmjd, m.magstat_fid, m.dmdt_first
FROM (
SELECT p.oid, p.probability, o.firstmjd
FROM (
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
) p
INNER JOIN (
SELECT oid, firstmjd
FROM object
WHERE firstmjd >= 2459458.5 AND firstmjd < 2459460.5  -- First 2 days of September 2023
) o ON p.oid = o.oid
) po
INNER JOIN (
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first > 0  -- Assuming positive dmdt_first indicates fast risers
) m ON po.oid = m.oid
) pf
INNER JOIN (
SELECT oid, fid, mjd, diffmaglim
FROM detection
UNION
SELECT oid, fid, mjd, NULL AS diffmaglim
FROM non_detection
) lc ON pf.oid = lc.oid
ORDER BY pf.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.3619668483734,2025-06-24T16:23:48,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,16,4,"
# Subquery 1: Highest Probability in Stamp Classifier for class 'SN'
subquery1 = """"""
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
""""""

# Subquery 2: First Detection in the First 2 Days of September
subquery2 = """"""
SELECT oid
FROM object
WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1st, 2023
""""""

# Subquery 3: Fast Risers
subquery3 = """"""
SELECT oid, fid AS magstat_fid, dmdt_first AS initial_rise_estimate
FROM magstat
WHERE dmdt_first IS NOT NULL  -- Assuming a non-null dmdt_first indicates a fast rise
""""""

# Final Query: Combine Subqueries and Retrieve Light Curves Including Non-Detections
final_query = f""""""
SELECT o.oid, p.probability, d.fid, d.diffmaglim, nd.fid AS non_detection_fid, m.magstat_fid, m.initial_rise_estimate
FROM ({subquery1}) AS p
INNER JOIN ({subquery2}) AS o ON p.oid = o.oid
INNER JOIN ({subquery3}) AS m ON o.oid = m.oid
LEFT JOIN detection d ON o.oid = d.oid
LEFT JOIN non_detection nd ON o.oid = nd.oid
ORDER BY o.oid
LIMIT 100
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,16.662551164627075,2025-06-16T01:09:27,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT pf.oid, pf.probability, lc.fid, lc.diffmaglim, pf.magstat_fid, pf.dmdt_first
FROM (
SELECT po.oid, po.probability, po.firstmjd, m.magstat_fid, m.dmdt_first
FROM (
SELECT p.oid, p.probability, o.firstmjd
FROM (
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
) p
INNER JOIN (
SELECT oid, firstmjd
FROM object
WHERE firstmjd >= 2459458.5 AND firstmjd < 2459460.5  -- First 2 days of September 2023
) o ON p.oid = o.oid
) po
INNER JOIN (
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first > 0  -- Assuming positive dmdt_first indicates fast risers
) m ON po.oid = m.oid
) pf
INNER JOIN (
SELECT oid, fid, mjd, diffmaglim
FROM detection
UNION
SELECT oid, fid, mjd, NULL AS diffmaglim
FROM non_detection
) lc ON pf.oid = lc.oid
ORDER BY pf.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",255.21453881263733,2025-06-24T16:28:09,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,16,5,"
# Subquery for Probability
probability_subquery = """"""
SELECT oid, probability
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
""""""

# Subquery for Object
object_subquery = """"""
SELECT oid, firstmjd
FROM object
WHERE firstmjd >= 2459458.5 AND firstmjd < 2459460.5  -- First 2 days of September 2023
""""""

# Join Probability and Object
probability_object_join = f""""""
SELECT p.oid, p.probability, o.firstmjd
FROM ({probability_subquery}) p
INNER JOIN ({object_subquery}) o ON p.oid = o.oid
""""""

# Subquery for Fast Risers
fast_risers_subquery = """"""
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
""""""

# Join with Fast Risers
probability_object_fast_risers_join = f""""""
SELECT po.oid, po.probability, po.firstmjd, m.magstat_fid, m.dmdt_first
FROM ({probability_object_join}) po
INNER JOIN ({fast_risers_subquery}) m ON po.oid = m.oid
""""""

# Retrieve Light Curves
light_curves_subquery = """"""
SELECT oid, fid, diffmaglim
FROM detection
UNION
SELECT oid, fid, mjd AS diffmaglim
FROM non_detection
""""""

# Final Join and Selection
final_query = f""""""
SELECT pf.oid, pf.probability, lc.fid, lc.diffmaglim, pf.magstat_fid, pf.dmdt_first
FROM ({probability_object_fast_risers_join}) pf
INNER JOIN ({light_curves_subquery}) lc ON pf.oid = lc.oid
ORDER BY pf.oid
LIMIT 100
""""""

# Full Query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,17.8200523853302,2025-06-16T01:09:44,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT pf.oid, pf.probability, lc.fid, lc.diffmaglim, pf.magstat_fid, pf.dmdt_first
FROM (
SELECT po.oid, po.probability, po.firstmjd, m.magstat_fid, m.dmdt_first
FROM (
SELECT p.oid, p.probability, o.firstmjd
FROM (
SELECT oid, probability
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
) p
INNER JOIN (
SELECT oid, firstmjd
FROM object
WHERE firstmjd >= 2459458.5 AND firstmjd < 2459460.5  -- First 2 days of September 2023
) o ON p.oid = o.oid
) po
INNER JOIN (
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
) m ON po.oid = m.oid
) pf
INNER JOIN (
SELECT oid, fid, diffmaglim
FROM detection
UNION
SELECT oid, fid, mjd AS diffmaglim
FROM non_detection
) lc ON pf.oid = lc.oid
ORDER BY pf.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.58539032936096,2025-06-24T16:32:25,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,16,6,"
# Subquery 1: Get objects with highest probability in the stamp classifier for class 'SN'
subquery1 = """"""
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
""""""

# Subquery 2: Get objects with first detection in the first 2 days of September
subquery2 = """"""
SELECT oid
FROM object
WHERE firstmjd >= 59800 AND firstmjd < 59802
""""""

# Subquery 3: Get objects that qualify as fast risers
subquery3 = """"""
SELECT oid, fid
FROM magstat
WHERE dmdt_first > 0  -- Assuming a positive dmdt_first indicates a fast rise
""""""

# Combine Subqueries: Get oids that meet all criteria
combined_subquery = f""""""
SELECT oid
FROM ({subquery1}) AS prob
INTERSECT
SELECT oid
FROM ({subquery2}) AS obj
INTERSECT
SELECT oid
FROM ({subquery3}) AS mag
""""""

# Final Query: Retrieve light curves and non-detections, including additional information
final_query = f""""""
SELECT d.oid, p.probability, d.fid, d.diffmaglim, nd.fid AS non_detection_fid, nd.diffmaglim AS non_detection_diffmaglim, 
       m.fid AS magstat_fid, m.dmdt_first
FROM ({combined_subquery}) AS combined
JOIN detection d ON combined.oid = d.oid
JOIN non_detection nd ON combined.oid = nd.oid
JOIN magstat m ON combined.oid = m.oid AND d.fid = m.fid
JOIN probability p ON combined.oid = p.oid
WHERE p.classifier_name = 'stamp_classifier'
  AND p.class_name = 'SN'
  AND p.ranking = 1
ORDER BY d.oid
LIMIT 100
""""""

# Final query string
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.0116605758667,2025-06-16T01:10:05,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT d.oid, p.probability, d.fid, d.diffmaglim, nd.fid AS non_detection_fid, nd.diffmaglim AS non_detection_diffmaglim, 
       m.fid AS magstat_fid, m.dmdt_first
FROM (
SELECT oid
FROM (
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
) AS prob
INTERSECT
SELECT oid
FROM (
SELECT oid
FROM object
WHERE firstmjd >= 59800 AND firstmjd < 59802
) AS obj
INTERSECT
SELECT oid
FROM (
SELECT oid, fid
FROM magstat
WHERE dmdt_first > 0  -- Assuming a positive dmdt_first indicates a fast rise
) AS mag
) AS combined
JOIN detection d ON combined.oid = d.oid
JOIN non_detection nd ON combined.oid = nd.oid
JOIN magstat m ON combined.oid = m.oid AND d.fid = m.fid
JOIN probability p ON combined.oid = p.oid
WHERE p.classifier_name = 'stamp_classifier'
  AND p.class_name = 'SN'
  AND p.ranking = 1
ORDER BY d.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.4743385314941,2025-06-24T16:36:44,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,16,7,"
# Subquery 1: Get oids with highest probability for class 'SN' in the stamp classifier
subquery_prob = """"""
SELECT oid, probability
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
""""""

# Subquery 2: Get oids with first detection in the first 2 days of September
subquery_first_detection = """"""
SELECT oid
FROM object
WHERE firstmjd BETWEEN 59800 AND 59802
""""""

# Subquery 3: Get oids that qualify as fast risers
subquery_fast_risers = """"""
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first > some_threshold_value  -- Replace 'some_threshold_value' with the actual threshold for fast risers
""""""

# Final Query: Combine all subqueries and retrieve the required information
final_query = """"""
SELECT o.oid, p.probability, d.fid, d.diffmaglim, nd.fid AS non_detection_fid, m.magstat_fid, m.dmdt_first
FROM ({subquery_prob}) p
INNER JOIN ({subquery_first_detection}) o ON p.oid = o.oid
INNER JOIN ({subquery_fast_risers}) m ON o.oid = m.oid
LEFT JOIN detection d ON o.oid = d.oid
LEFT JOIN non_detection nd ON o.oid = nd.oid
ORDER BY o.oid
LIMIT 100
"""""".format(subquery_prob=subquery_prob, subquery_first_detection=subquery_first_detection, subquery_fast_risers=subquery_fast_risers)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,17.583828449249268,2025-06-16T01:10:22,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT d.oid, p.probability, d.fid, d.diffmaglim, nd.fid AS non_detection_fid, nd.diffmaglim AS non_detection_diffmaglim, 
       m.fid AS magstat_fid, m.dmdt_first
FROM (
SELECT oid
FROM (
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
) AS prob
INTERSECT
SELECT oid
FROM (
SELECT oid
FROM object
WHERE firstmjd >= 59800 AND firstmjd < 59802
) AS obj
INTERSECT
SELECT oid
FROM (
SELECT oid, fid
FROM magstat
WHERE dmdt_first > 0  -- Assuming a positive dmdt_first indicates a fast rise
) AS mag
) AS combined
JOIN detection d ON combined.oid = d.oid
JOIN non_detection nd ON combined.oid = nd.oid
JOIN magstat m ON combined.oid = m.oid AND d.fid = m.fid
JOIN probability p ON combined.oid = p.oid
WHERE p.classifier_name = 'stamp_classifier'
  AND p.class_name = 'SN'
  AND p.ranking = 1
ORDER BY d.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.13771772384644,2025-06-24T16:41:10,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,16,8,"
# Step 1: Subquery for Highest Probability in Stamp Classifier
subquery_highest_probability = """"""
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
AND class_name = 'SN'
AND ranking = 1
""""""

# Step 2: Subquery for First Detection in the First 2 Days of September
subquery_first_detection_september = """"""
SELECT oid
FROM object
WHERE firstmjd >= 59800 AND firstmjd < 59802
""""""

# Step 3: Subquery for Fast Risers
subquery_fast_risers = """"""
SELECT oid, fid, dmdt_first
FROM magstat
WHERE dmdt_first > 0.1  -- Assuming a threshold for fast risers
""""""

# Step 4: Combine Subqueries
combined_subquery = f""""""
SELECT oid
FROM ({subquery_highest_probability}) AS hp
INTERSECT
SELECT oid
FROM ({subquery_first_detection_september}) AS fd
INTERSECT
SELECT oid
FROM ({subquery_fast_risers}) AS fr
""""""

# Step 5: Retrieve Light Curves and Non-Detections
subquery_light_curves = f""""""
SELECT d.oid, p.probability, d.fid, d.diffmaglim, d.mjd, nd.fid AS non_detection_fid, nd.diffmaglim AS non_detection_diffmaglim
FROM detection d
INNER JOIN ({combined_subquery}) AS combined ON d.oid = combined.oid
INNER JOIN probability p ON d.oid = p.oid
LEFT JOIN non_detection nd ON d.oid = nd.oid
WHERE p.classifier_name = 'stamp_classifier'
AND p.class_name = 'SN'
AND p.ranking = 1
""""""

# Step 6: Retrieve Additional Information from magstat
subquery_magstat_info = f""""""
SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first
FROM magstat m
INNER JOIN ({combined_subquery}) AS combined ON m.oid = combined.oid
""""""

# Step 7: Finalize Query
final_query = f""""""
SELECT lc.oid, lc.probability, lc.fid, lc.diffmaglim, lc.mjd, lc.non_detection_fid, lc.non_detection_diffmaglim, mi.magstat_fid, mi.dmdt_first
FROM ({subquery_light_curves}) AS lc
INNER JOIN ({subquery_magstat_info}) AS mi ON lc.oid = mi.oid
ORDER BY lc.oid
LIMIT 100
""""""

# Final Query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,21.086501121521,2025-06-16T01:10:43,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT lc.oid, lc.probability, lc.fid, lc.diffmaglim, lc.mjd, lc.non_detection_fid, lc.non_detection_diffmaglim, mi.magstat_fid, mi.dmdt_first
FROM (
SELECT d.oid, p.probability, d.fid, d.diffmaglim, d.mjd, nd.fid AS non_detection_fid, nd.diffmaglim AS non_detection_diffmaglim
FROM detection d
INNER JOIN (
SELECT oid
FROM (
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
AND class_name = 'SN'
AND ranking = 1
) AS hp
INTERSECT
SELECT oid
FROM (
SELECT oid
FROM object
WHERE firstmjd >= 59800 AND firstmjd < 59802
) AS fd
INTERSECT
SELECT oid
FROM (
SELECT oid, fid, dmdt_first
FROM magstat
WHERE dmdt_first > 0.1  -- Assuming a threshold for fast risers
) AS fr
) AS combined ON d.oid = combined.oid
INNER JOIN probability p ON d.oid = p.oid
LEFT JOIN non_detection nd ON d.oid = nd.oid
WHERE p.classifier_name = 'stamp_classifier'
AND p.class_name = 'SN'
AND p.ranking = 1
) AS lc
INNER JOIN (
SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first
FROM magstat m
INNER JOIN (
SELECT oid
FROM (
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
AND class_name = 'SN'
AND ranking = 1
) AS hp
INTERSECT
SELECT oid
FROM (
SELECT oid
FROM object
WHERE firstmjd >= 59800 AND firstmjd < 59802
) AS fd
INTERSECT
SELECT oid
FROM (
SELECT oid, fid, dmdt_first
FROM magstat
WHERE dmdt_first > 0.1  -- Assuming a threshold for fast risers
) AS fr
) AS combined ON m.oid = combined.oid
) AS mi ON lc.oid = mi.oid
ORDER BY lc.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.5669584274292,2025-06-24T16:45:37,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,16,9,"
# Subquery 1: Get objects with highest probability in the stamp classifier for class 'SN'
subquery1 = """"""
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
AND class_name = 'SN'
AND ranking = 1
""""""

# Subquery 2: Get objects with first detection in the first 2 days of September
subquery2 = """"""
SELECT oid
FROM object
WHERE firstmjd >= 59800 AND firstmjd < 59802
""""""

# Subquery 3: Get objects that qualify as fast risers
subquery3 = """"""
SELECT oid, fid AS magstat_fid, dmdt_first
FROM magstat
WHERE dmdt_first > 0.5  -- Assuming a threshold for fast risers
""""""

# Combine subqueries to filter objects meeting all criteria
combined_subquery = f""""""
SELECT o.oid, p.probability, d.fid, d.diffmaglim, m.magstat_fid, m.dmdt_first
FROM ({subquery1}) p
INNER JOIN ({subquery2}) o ON p.oid = o.oid
INNER JOIN ({subquery3}) m ON o.oid = m.oid
LEFT JOIN detection d ON o.oid = d.oid
LEFT JOIN non_detection nd ON o.oid = nd.oid
WHERE d.oid IS NOT NULL OR nd.oid IS NOT NULL
ORDER BY o.oid
LIMIT 100
""""""

# Final query
full_query = combined_subquery
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,19.17035984992981,2025-06-16T01:11:03,"[Empty DataFrame
Columns: [oid, probability, fid, diffmaglim, magstat_fid, dmdt_first]
Index: []]",,154.54682683944702,2025-06-24T16:48:15,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.18.1,gpt-4o,v3,16,10,"
# Subquery 1: Get objects with the highest probability in the stamp classifier for class 'SN'
subquery1 = """"""
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
""""""

# Subquery 2: Get objects with first detection in the first 2 days of September
subquery2 = """"""
SELECT oid
FROM object
WHERE firstmjd BETWEEN 59835 AND 59837  -- Assuming 59835 is the MJD for September 1, 2023
""""""

# Subquery 3: Get objects that qualify as fast risers
subquery3 = """"""
SELECT oid, fid AS magstat_fid, dmdt_first AS initial_rise_estimate
FROM magstat
WHERE dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
""""""

# Combine Subqueries: Get oids that meet all criteria
combined_subquery = f""""""
SELECT oid
FROM ({subquery1}) AS sq1
INTERSECT
SELECT oid
FROM ({subquery2}) AS sq2
INTERSECT
SELECT oid
FROM ({subquery3}) AS sq3
""""""

# Final Query: Retrieve light curves including non-detections
final_query = f""""""
SELECT o.oid, p.probability, d.fid, d.diffmaglim, m.fid AS magstat_fid, m.dmdt_first AS initial_rise_estimate
FROM ({combined_subquery}) AS c
INNER JOIN probability p ON c.oid = p.oid
INNER JOIN object o ON c.oid = o.oid
LEFT JOIN detection d ON c.oid = d.oid
LEFT JOIN non_detection nd ON c.oid = nd.oid
INNER JOIN magstat m ON c.oid = m.oid
WHERE p.classifier_name = 'stamp_classifier'
  AND p.class_name = 'SN'
  AND p.ranking = 1
ORDER BY o.oid
LIMIT 100
""""""

# Final query string
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,18.4174120426178,2025-06-16T01:11:21,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.probability, d.fid, d.diffmaglim, m.fid AS magstat_fid, m.dmdt_first AS initial_rise_estimate
FROM (
SELECT oid
FROM (
SELECT oid, probability
FROM probability
WHERE classifier_name = 'stamp_classifier'
  AND class_name = 'SN'
  AND ranking = 1
) AS sq1
INTERSECT
SELECT oid
FROM (
SELECT oid
FROM object
WHERE firstmjd BETWEEN 59835 AND 59837  -- Assuming 59835 is the MJD for September 1, 2023
) AS sq2
INTERSECT
SELECT oid
FROM (
SELECT oid, fid AS magstat_fid, dmdt_first AS initial_rise_estimate
FROM magstat
WHERE dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
) AS sq3
) AS c
INNER JOIN probability p ON c.oid = p.oid
INNER JOIN object o ON c.oid = o.oid
LEFT JOIN detection d ON c.oid = d.oid
LEFT JOIN non_detection nd ON c.oid = nd.oid
INNER JOIN magstat m ON c.oid = m.oid
WHERE p.classifier_name = 'stamp_classifier'
  AND p.class_name = 'SN'
  AND p.ranking = 1
ORDER BY o.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.8025300502777,2025-06-24T16:52:34,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,19,0,"SELECT
    object.oid, object.meanra, object.meandec, object.ndet, object.firstmjd,
    probability.class_name, probability.probability
FROM object
INNER JOIN probability
ON object.oid=probability.oid

WHERE
object.firstMJD > 59274.0
AND object.firstMJD < 59305.0
AND object.ndet=1
AND probability.classifier_name='stamp_classifier'
AND probability.ranking=1
AND probability.class_name='asteroid'
AND probability.probability>0.7",,,,,,"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: SELECT
    object.oid, object.meanra, object.meandec, object.ndet, object.firstmjd,
    probability.class_name, probability.probability
FROM object
INNER JOIN probability
ON object.oid=probability.oid

WHERE
object.firstMJD > 59274.0
AND object.firstMJD < 59305.0
AND object.ndet=1
AND probability.classifier_name='stamp_classifier'
AND probability.ranking=1
AND probability.class_name='asteroid'
AND probability.probability>0.7]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",248.5395040512085,2025-06-24T16:56:42,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,19,1,"
# Sub-query to filter objects based on the date range and number of detections
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59301  -- MJD for March 1st, 2021 to April 1st, 2021
AND ndet <= 1
""""""

# Sub-query to filter probabilities based on class name and probability
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND probability > 0.7
AND classifier_name = 'stamp_classifier'
AND ranking = 1
""""""

# Final query joining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,19.68489241600037,2025-06-16T01:11:41,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59301  -- MJD for March 1st, 2021 to April 1st, 2021
AND ndet <= 1
) o
INNER JOIN (
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND probability > 0.7
AND classifier_name = 'stamp_classifier'
AND ranking = 1
) p ON o.oid = p.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.72202825546265,2025-06-24T17:01:10,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,19,2,"
# Sub-query to filter objects based on the date range and number of detections
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59300  -- Corresponding MJD for March 1st to April 1st, 2021
AND ndet <= 1
""""""

# Sub-query to filter probabilities based on class name, classifier, and probability
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
""""""

# Final query joining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,14.458560943603516,2025-06-16T01:11:56,"[                oid      meanra    meandec  ndet      firstmjd class_name  \
0      ZTF21aamapxz   38.675823  14.388528     1  59265.135440   asteroid   
1      ZTF21aamapzi   35.768849   8.200034     1  59265.135440   asteroid   
2      ZTF21aamaqkz   37.665629  15.453575     1  59265.135440   asteroid   
3      ZTF21aamaqkq   38.646484  10.880825     1  59265.135440   asteroid   
4      ZTF21aamaqch   38.617771  19.074649     1  59265.135903   asteroid   
...             ...         ...        ...   ...           ...        ...   
72613  ZTF21aaqtcsz  200.896892 -20.664854     1  59298.418634   asteroid   
72614  ZTF21aaqtcwg  198.281307 -21.450622     1  59298.418634   asteroid   
72615  ZTF21aaqtcsa  201.189349 -25.093861     1  59298.418634   asteroid   
72616  ZTF21aaqtcxz  196.663480 -23.327139     1  59298.418634   asteroid   
72617  ZTF21aaqtesr  278.059364   2.383477     1  59298.436019   asteroid   

       probability  
0         0.704552  
1         0.784940  
2         0.756110  
3         0.725613  
4         0.720168  
...            ...  
72613     1.000000  
72614     1.000000  
72615     1.000000  
72616     1.000000  
72617     1.000000  

[72618 rows x 7 columns]]",,29.066431522369385,2025-06-24T17:02:04,0.5343163890502333,0.78539755983365,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,19,3,"
# Sub-query to filter objects based on the firstmjd and ndet conditions
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59296  -- March 1st, 2021 to April 1st, 2021 in MJD
AND ndet <= 1
""""""

# Sub-query to filter probabilities based on class_name, classifier_name, and probability
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
""""""

# Final query joining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.57520294189453,2025-06-16T01:12:12,"[                oid      meanra    meandec  ndet      firstmjd class_name  \
0      ZTF21aamapxz   38.675823  14.388528     1  59265.135440   asteroid   
1      ZTF21aamapzi   35.768849   8.200034     1  59265.135440   asteroid   
2      ZTF21aamaqkz   37.665629  15.453575     1  59265.135440   asteroid   
3      ZTF21aamaqkq   38.646484  10.880825     1  59265.135440   asteroid   
4      ZTF21aamaqch   38.617771  19.074649     1  59265.135903   asteroid   
...             ...         ...        ...   ...           ...        ...   
48615  ZTF21aaqknkn  165.069314  14.681553     1  59294.319282   asteroid   
48616  ZTF21aaqknon  161.699674  14.050993     1  59294.319282   asteroid   
48617  ZTF21aaqknwt  164.761261   9.472312     1  59294.319282   asteroid   
48618  ZTF21aaqknwh  164.238172   9.675806     1  59294.319282   asteroid   
48619  ZTF21aaqknwj  164.847444   8.925709     1  59294.319282   asteroid   

       probability  
0         0.704552  
1         0.784940  
2         0.756110  
3         0.725613  
4         0.720168  
...            ...  
48615     0.728323  
48616     0.712430  
48617     0.751556  
48618     0.724531  
48619     0.729019  

[48620 rows x 7 columns]]",,23.539427042007446,2025-06-24T17:02:38,0.3094939199190571,0.6794734677087618,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,19,4,"
# Sub-query to filter objects based on the date range and number of detections
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59301  -- Corresponds to March 1st, 2021 to April 1st, 2021
AND ndet <= 1
""""""

# Sub-query to filter probabilities for asteroids with the required conditions
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND probability > 0.7
AND classifier_name = 'stamp_classifier'
AND ranking = 1
""""""

# Final query joining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,15.188045263290403,2025-06-16T01:12:28,"[                oid      meanra    meandec  ndet      firstmjd class_name  \
0      ZTF21aamapxz   38.675823  14.388528     1  59265.135440   asteroid   
1      ZTF21aamapzi   35.768849   8.200034     1  59265.135440   asteroid   
2      ZTF21aamaqkz   37.665629  15.453575     1  59265.135440   asteroid   
3      ZTF21aamaqkq   38.646484  10.880825     1  59265.135440   asteroid   
4      ZTF21aamaqch   38.617771  19.074649     1  59265.135903   asteroid   
...             ...         ...        ...   ...           ...        ...   
77001  ZTF21aaquvch  235.215907 -21.094545     1  59300.481505   asteroid   
77002  ZTF21aaquuyz  237.092160 -22.983463     1  59300.481505   asteroid   
77003  ZTF21aaquvbd  233.767481 -26.774714     1  59300.481505   asteroid   
77004  ZTF21aaquvbt  233.733957 -21.591302     1  59300.481505   asteroid   
77005  ZTF21aaquvdm  235.708385 -21.421027     1  59300.481505   asteroid   

       probability  
0         0.704552  
1         0.784940  
2         0.756110  
3         0.725613  
4         0.720168  
...            ...  
77001     1.000000  
77002     1.000000  
77003     1.000000  
77004     1.000000  
77005     1.000000  

[77006 rows x 7 columns]]",,22.69199824333191,2025-06-24T17:03:17,0.575424856195312,0.7976261590005973,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,19,5,"
# Sub-query to filter objects based on the date range and detection count
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59300  -- MJD for March 1st, 2021 to April 1st, 2021
AND ndet <= 1
""""""

# Sub-query to filter probabilities for asteroids with the required conditions
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
""""""

# Final query joining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,14.60685896873474,2025-06-16T01:12:42,"[                oid      meanra    meandec  ndet      firstmjd class_name  \
0      ZTF21aamapxz   38.675823  14.388528     1  59265.135440   asteroid   
1      ZTF21aamapzi   35.768849   8.200034     1  59265.135440   asteroid   
2      ZTF21aamaqkz   37.665629  15.453575     1  59265.135440   asteroid   
3      ZTF21aamaqkq   38.646484  10.880825     1  59265.135440   asteroid   
4      ZTF21aamaqch   38.617771  19.074649     1  59265.135903   asteroid   
...             ...         ...        ...   ...           ...        ...   
72613  ZTF21aaqtcwg  198.281307 -21.450622     1  59298.418634   asteroid   
72614  ZTF21aaqtcsa  201.189349 -25.093861     1  59298.418634   asteroid   
72615  ZTF21aaqtcxz  196.663480 -23.327139     1  59298.418634   asteroid   
72616  ZTF21aaqtfag  286.543349  20.481121     1  59298.434606   asteroid   
72617  ZTF21aaqtesr  278.059364   2.383477     1  59298.436019   asteroid   

       probability  
0         0.704552  
1         0.784940  
2         0.756110  
3         0.725613  
4         0.720168  
...            ...  
72613     1.000000  
72614     1.000000  
72615     1.000000  
72616     1.000000  
72617     1.000000  

[72618 rows x 7 columns]]",,25.48356008529663,2025-06-24T17:03:54,0.5343163890502333,0.78539755983365,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,19,6,"
# Sub-query to filter objects based on the date range and number of detections
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59301  -- MJD for March 1st, 2021 to April 1st, 2021
AND ndet <= 1
""""""

# Sub-query to filter probabilities based on class name, classifier, and probability
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
""""""

# Final query joining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,11.418477773666382,2025-06-16T01:12:54,"[                oid      meanra    meandec  ndet      firstmjd class_name  \
0      ZTF21aamapxz   38.675823  14.388528     1  59265.135440   asteroid   
1      ZTF21aamapzi   35.768849   8.200034     1  59265.135440   asteroid   
2      ZTF21aamaqkz   37.665629  15.453575     1  59265.135440   asteroid   
3      ZTF21aamaqkq   38.646484  10.880825     1  59265.135440   asteroid   
4      ZTF21aamaqch   38.617771  19.074649     1  59265.135903   asteroid   
...             ...         ...        ...   ...           ...        ...   
77001  ZTF21aaquzbn  324.330163   8.511995     1  59300.526181   asteroid   
77002  ZTF21aaquzew  322.767514   1.990696     1  59300.528125   asteroid   
77003  ZTF21aaquzfm  322.151115   2.138137     1  59300.528125   asteroid   
77004  ZTF21aaquzqk  322.769759   1.991991     1  59300.532986   asteroid   
77005  ZTF21aaquzjq  319.714355   1.291627     1  59300.530556   asteroid   

       probability  
0         0.704552  
1         0.784940  
2         0.756110  
3         0.725613  
4         0.720168  
...            ...  
77001     1.000000  
77002     1.000000  
77003     1.000000  
77004     1.000000  
77005     1.000000  

[77006 rows x 7 columns]]",,23.47177672386169,2025-06-24T17:04:30,0.575424856195312,0.7976261590005973,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,19,7,"
# Sub-query to filter objects based on the date range and number of detections
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59301  -- Corresponds to March 1st, 2021 to April 1st, 2021
AND ndet <= 1
""""""

# Sub-query to filter probabilities for asteroids with the stamp classifier
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
""""""

# Final query joining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,12.767290115356444,2025-06-16T01:13:07,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59301  -- Corresponds to March 1st, 2021 to April 1st, 2021
AND ndet <= 1
) o
INNER JOIN (
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
) p ON o.oid = p.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",256.302925825119,2025-06-24T17:08:59,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,19,8,"
# Sub-query to filter objects based on firstmjd and ndet
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59301  -- Corresponding MJD for March 1st to April 1st, 2021
AND ndet <= 1
""""""

# Sub-query to filter probabilities for asteroids with the stamp classifier
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1  -- Default condition for most likely class
""""""

# Final query joining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.385650157928467,2025-06-16T01:13:23,"[                oid      meanra    meandec  ndet      firstmjd class_name  \
0      ZTF21aamapxz   38.675823  14.388528     1  59265.135440   asteroid   
1      ZTF21aamapzi   35.768849   8.200034     1  59265.135440   asteroid   
2      ZTF21aamaqkz   37.665629  15.453575     1  59265.135440   asteroid   
3      ZTF21aamaqkq   38.646484  10.880825     1  59265.135440   asteroid   
4      ZTF21aamaqch   38.617771  19.074649     1  59265.135903   asteroid   
...             ...         ...        ...   ...           ...        ...   
77001  ZTF21aaquzbu  322.766299   1.990112     1  59300.525706   asteroid   
77002  ZTF21aaquzbn  324.330163   8.511995     1  59300.526181   asteroid   
77003  ZTF21aaquzew  322.767514   1.990696     1  59300.528125   asteroid   
77004  ZTF21aaquzfm  322.151115   2.138137     1  59300.528125   asteroid   
77005  ZTF21aaquzqk  322.769759   1.991991     1  59300.532986   asteroid   

       probability  
0         0.704552  
1         0.784940  
2         0.756110  
3         0.725613  
4         0.720168  
...            ...  
77001     1.000000  
77002     1.000000  
77003     1.000000  
77004     1.000000  
77005     1.000000  

[77006 rows x 7 columns]]",,28.59102892875672,2025-06-24T17:09:42,0.575424856195312,0.7976261590005973,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,19,9,"
# Sub-query to filter objects based on the date range and number of detections
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59301  -- Corresponding MJD for March 1st, 2021 to April 1st, 2021
AND ndet <= 1
""""""

# Sub-query to filter probabilities for asteroids with the required conditions
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND probability > 0.7
AND ranking = 1
AND classifier_name = 'stamp_classifier'
""""""

# Final query combining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,12.488653182983398,2025-06-16T01:13:36,"[                oid      meanra    meandec  ndet      firstmjd class_name  \
0      ZTF21aamapxz   38.675823  14.388528     1  59265.135440   asteroid   
1      ZTF21aamapzi   35.768849   8.200034     1  59265.135440   asteroid   
2      ZTF21aamaqkz   37.665629  15.453575     1  59265.135440   asteroid   
3      ZTF21aamaqkq   38.646484  10.880825     1  59265.135440   asteroid   
4      ZTF21aamaqch   38.617771  19.074649     1  59265.135903   asteroid   
...             ...         ...        ...   ...           ...        ...   
77001  ZTF21aaquyzi  318.307789   4.204512     1  59300.523252   asteroid   
77002  ZTF21aaquyxg  315.176281   1.233923     1  59300.523252   asteroid   
77003  ZTF21aaquzfm  322.151115   2.138137     1  59300.528125   asteroid   
77004  ZTF21aaquzjq  319.714355   1.291627     1  59300.530556   asteroid   
77005  ZTF21aaquzqk  322.769759   1.991991     1  59300.532986   asteroid   

       probability  
0         0.704552  
1         0.784940  
2         0.756110  
3         0.725613  
4         0.720168  
...            ...  
77001     1.000000  
77002     1.000000  
77003     1.000000  
77004     1.000000  
77005     1.000000  

[77006 rows x 7 columns]]",,27.98401379585266,2025-06-24T17:10:23,0.575424856195312,0.7976261590005973,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,19,10,"
# Sub-query to filter objects based on the date range and number of detections
object_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd
FROM object
WHERE firstmjd BETWEEN 59265 AND 59301  -- Corresponds to March 1st, 2021 to April 1st, 2021
AND ndet <= 1
""""""

# Sub-query to filter probabilities for asteroids with the stamp classifier
probability_subquery = """"""
SELECT oid, class_name, probability
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
""""""

# Final query joining the object and probability sub-queries
full_query = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,12.753022909164429,2025-06-16T01:13:49,"[                oid      meanra    meandec  ndet      firstmjd class_name  \
0      ZTF21aamapxz   38.675823  14.388528     1  59265.135440   asteroid   
1      ZTF21aamapzi   35.768849   8.200034     1  59265.135440   asteroid   
2      ZTF21aamaqkz   37.665629  15.453575     1  59265.135440   asteroid   
3      ZTF21aamaqkq   38.646484  10.880825     1  59265.135440   asteroid   
4      ZTF21aamaqch   38.617771  19.074649     1  59265.135903   asteroid   
...             ...         ...        ...   ...           ...        ...   
77001  ZTF21aaquysq  314.692858   4.916127     1  59300.518310   asteroid   
77002  ZTF21aaquzqk  322.769759   1.991991     1  59300.532986   asteroid   
77003  ZTF21aaquzew  322.767514   1.990696     1  59300.528125   asteroid   
77004  ZTF21aaquzfm  322.151115   2.138137     1  59300.528125   asteroid   
77005  ZTF21aaquzjq  319.714355   1.291627     1  59300.530556   asteroid   

       probability  
0         0.704552  
1         0.784940  
2         0.756110  
3         0.725613  
4         0.720168  
...            ...  
77001     1.000000  
77002     1.000000  
77003     1.000000  
77004     1.000000  
77005     1.000000  

[77006 rows x 7 columns]]",,30.626840114593502,2025-06-24T17:11:09,0.575424856195312,0.7976261590005973,1.0,1.0,0.0,1.0
0.18.1,,,14,0,"
SELECT
    det.oid, det.candid,
    det.drb, det.fid,
    det.mjd, det.magpsf, det.sigmapsf,
    det.has_stamp,
    ps1.sgscore1, ps1.distpsnr1
FROM
    (SELECT *
    FROM detection
    WHERE oid in ('ZTF23aavzgjg','ZTF23aaynzyk','ZTF23aavqxos','ZTF23aaknyni','ZTF23aavsdtc','ZTF18aandkua','ZTF23aaxfewt','ZTF23aavshwi','ZTF22aawasao','ZTF23aaxgvnt')
    ) as det
    INNER JOIN
    (SELECT *
    FROM ps1_ztf
    WHERE oid in ('ZTF23aavzgjg','ZTF23aaynzyk','ZTF23aavqxos','ZTF23aaknyni','ZTF23aavsdtc','ZTF18aandkua','ZTF23aaxfewt','ZTF23aavshwi','ZTF22aawasao','ZTF23aaxgvnt')
    ) as ps1
    ON det.oid=ps1.oid
WHERE
     (ps1.sgscore1 < 0.5 OR ps1.distpsnr1 > 1)
    AND det.drb > 0.5
",,,,,"[              oid               candid       drb  fid           mjd  \
0    ZTF18aandkua  2434183903015015056  0.994159    1  60188.183901   
1    ZTF18aandkua  2756269351915010002  0.993011    2  60510.269352   
2    ZTF18aandkua  2772265531915010009  0.850113    2  60526.265532   
3    ZTF18aandkua  2979404491915010015  0.696538    1  60733.404491   
4    ZTF18aandkua  2434183903015015056  0.994159    1  60188.183901   
..            ...                  ...       ...  ...           ...   
168  ZTF23aavzgjg  2440173344115015014  0.999983    2  60194.173345   
169  ZTF23aavzgjg  2442207534115015008  0.998886    2  60196.207535   
170  ZTF23aaxfewt  2415290061315015127  0.999312    2  60169.290069   
171  ZTF23aaxgvnt  2415360251315015012  0.866198    1  60169.360255   
172  ZTF23aaynzyk  2419492286015015010  0.999918    2  60173.492280   

        magpsf  sigmapsf  has_stamp  sgscore1  distpsnr1  
0    17.907194  0.180156       True  0.075167   0.326697  
1    19.379133  0.161114       True  0.075167   0.326697  
2    19.641638  0.183068       True  0.075167   0.326697  
3    18.887863  0.175351       True  0.075167   0.326697  
4    17.907194  0.180156       True  0.075167   1.234589  
..         ...       ...        ...       ...        ...  
168  19.315939  0.112186       True  0.500000   8.032105  
169  19.268260  0.174212       True  0.500000   8.032105  
170  18.205078  0.063636       True  0.134304   0.635949  
171  19.366661  0.139281       True  0.987083   1.361963  
172  20.241919  0.203988       True  0.500000   1.575583  

[173 rows x 10 columns]]",,5.151440143585205,2025-06-24T17:11:14,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,14,1,"
# Subquery to filter detection table for specific oids and drb > 0.5
detection_subquery = """"""
SELECT oid, candid, fid, mjd, magpsf, sigmapsf, has_stamp, drb
FROM detection
WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
              'ZTF22aawasao', 'ZTF23aaxgvnt')
AND drb > 0.5
""""""

# Join with ps1_ztf table and apply additional filters
final_query = f""""""
SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1
FROM ({detection_subquery}) AS d
INNER JOIN ps1_ztf AS p ON d.oid = p.oid
WHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1
""""""

# Final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,12.855862617492676,2025-06-16T01:14:01,"[             oid               candid  fid           mjd     magpsf  sigmapsf  \
0   ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1   ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2   ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3   ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477  0.096587   
4   ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126  0.060204   
5   ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604  0.094521   
6   ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996  0.070969   
7   ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
8   ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047  0.061804   
9   ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606  0.067233   
10  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947  0.147604   
11  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866  0.079126   
12  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363  0.086399   
13  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382  0.193578   
14  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290  0.112882   
15  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288  0.176278   
16  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
17  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
18  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028  0.172092   
19  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201  0.131913   
20  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957  0.146235   
21  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
22  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
23  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
24  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
25  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
26  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
27  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
28  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
29  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983  0.215474   

    has_stamp       drb  sgscore1  distpsnr1  
0        True  0.949127  0.024583   0.183817  
1        True  0.879817  0.209000   0.343322  
2        True  1.000000  0.009583   2.024725  
3        True  1.000000  0.009583   2.024725  
4        True  1.000000  0.009583   2.024725  
5        True  1.000000  0.009583   2.024725  
6        True  1.000000  0.009583   2.024725  
7        True  0.999312  0.134304   0.635949  
8        True  1.000000  0.009583   2.024725  
9        True  1.000000  0.009583   2.024725  
10       True  0.999999  0.009583   2.024725  
11       True  1.000000  0.009583   2.024725  
12       True  1.000000  0.009583   2.024725  
13       True  0.999985  0.009583   2.024725  
14       True  0.999998  0.009583   2.024725  
15       True  0.999994  0.009583   2.024725  
16       True  0.994159  0.075167   0.326697  
17       True  0.994159  0.075167   1.234589  
18       True  0.999963  0.009583   2.024725  
19       True  0.999977  0.009583   2.024725  
20       True  0.999999  0.009583   2.024725  
21       True  0.755912  0.380149   0.673811  
22       True  0.755912  0.380149   0.904783  
23       True  0.993011  0.075167   0.326697  
24       True  0.993011  0.075167   1.234589  
25       True  0.850113  0.075167   0.326697  
26       True  0.850113  0.075167   1.234589  
27       True  0.696538  0.075167   0.326697  
28       True  0.696538  0.075167   1.234589  
29       True  0.921584  0.024583   0.183817  ]",,15.134332656860352,2025-06-24T17:11:34,0.1734104046242774,1.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,14,2,"
# Sub-query to filter detections with drb > 0.5 and specific oids
detection_subquery = """"""
SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb
FROM detection d
WHERE d.drb > 0.5
AND d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
              'ZTF22aawasao', 'ZTF23aaxgvnt')
""""""

# Sub-query to filter ps1_ztf with sgscore1 < 0.5 or distpsnr1 < 1 arcsec
ps1_ztf_subquery = """"""
SELECT p.oid, p.sgscore1, p.distpsnr1
FROM ps1_ztf p
WHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1
""""""

# Final query joining detection and ps1_ztf sub-queries
full_query = f""""""
SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1
FROM ({detection_subquery}) d
INNER JOIN ({ps1_ztf_subquery}) p ON d.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,14.217214107513428,2025-06-16T01:14:16,"[             oid               candid  fid           mjd     magpsf  sigmapsf  \
0   ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1   ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2   ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3   ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477  0.096587   
4   ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126  0.060204   
5   ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604  0.094521   
6   ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996  0.070969   
7   ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
8   ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047  0.061804   
9   ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606  0.067233   
10  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947  0.147604   
11  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866  0.079126   
12  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363  0.086399   
13  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382  0.193578   
14  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290  0.112882   
15  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288  0.176278   
16  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
17  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
18  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028  0.172092   
19  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201  0.131913   
20  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957  0.146235   
21  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
22  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
23  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
24  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
25  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
26  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
27  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
28  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
29  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983  0.215474   

    has_stamp       drb  sgscore1  distpsnr1  
0        True  0.949127  0.024583   0.183817  
1        True  0.879817  0.209000   0.343322  
2        True  1.000000  0.009583   2.024725  
3        True  1.000000  0.009583   2.024725  
4        True  1.000000  0.009583   2.024725  
5        True  1.000000  0.009583   2.024725  
6        True  1.000000  0.009583   2.024725  
7        True  0.999312  0.134304   0.635949  
8        True  1.000000  0.009583   2.024725  
9        True  1.000000  0.009583   2.024725  
10       True  0.999999  0.009583   2.024725  
11       True  1.000000  0.009583   2.024725  
12       True  1.000000  0.009583   2.024725  
13       True  0.999985  0.009583   2.024725  
14       True  0.999998  0.009583   2.024725  
15       True  0.999994  0.009583   2.024725  
16       True  0.994159  0.075167   0.326697  
17       True  0.994159  0.075167   1.234589  
18       True  0.999963  0.009583   2.024725  
19       True  0.999977  0.009583   2.024725  
20       True  0.999999  0.009583   2.024725  
21       True  0.755912  0.380149   0.673811  
22       True  0.755912  0.380149   0.904783  
23       True  0.993011  0.075167   0.326697  
24       True  0.993011  0.075167   1.234589  
25       True  0.850113  0.075167   0.326697  
26       True  0.850113  0.075167   1.234589  
27       True  0.696538  0.075167   0.326697  
28       True  0.696538  0.075167   1.234589  
29       True  0.921584  0.024583   0.183817  ]",,13.055691957473757,2025-06-24T17:11:51,0.1734104046242774,1.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,14,3,"
# Subquery for detection table
detection_subquery = """"""
SELECT candid, oid, mjd, fid, magpsf, sigmapsf, has_stamp, drb
FROM detection
WHERE drb > 0.5
AND oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
            'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
            'ZTF22aawasao', 'ZTF23aaxgvnt')
""""""

# Subquery for ps1_ztf table
ps1_ztf_subquery = """"""
SELECT oid, sgscore1, distpsnr1
FROM ps1_ztf
WHERE (sgscore1 < 0.5 OR distpsnr1 < 1)
AND oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
            'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
            'ZTF22aawasao', 'ZTF23aaxgvnt')
""""""

# Final query joining the subqueries
full_query = f""""""
SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1
FROM ({detection_subquery}) AS d
INNER JOIN ({ps1_ztf_subquery}) AS p ON d.oid = p.oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,14.164786100387571,2025-06-16T01:14:30,"[             oid               candid  fid           mjd     magpsf  sigmapsf  \
0   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
1   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
2   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
3   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
4   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
6   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
7   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
8   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
9   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
10  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
11  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983  0.215474   
12  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
13  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
14  ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477  0.096587   
15  ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126  0.060204   
16  ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604  0.094521   
17  ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996  0.070969   
18  ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047  0.061804   
19  ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606  0.067233   
20  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947  0.147604   
21  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866  0.079126   
22  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363  0.086399   
23  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382  0.193578   
24  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290  0.112882   
25  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288  0.176278   
26  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028  0.172092   
27  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201  0.131913   
28  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957  0.146235   
29  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   

    has_stamp       drb  sgscore1  distpsnr1  
0        True  0.994159  0.075167   0.326697  
1        True  0.993011  0.075167   0.326697  
2        True  0.850113  0.075167   0.326697  
3        True  0.696538  0.075167   0.326697  
4        True  0.994159  0.075167   1.234589  
5        True  0.993011  0.075167   1.234589  
6        True  0.850113  0.075167   1.234589  
7        True  0.696538  0.075167   1.234589  
8        True  0.755912  0.380149   0.673811  
9        True  0.755912  0.380149   0.904783  
10       True  0.949127  0.024583   0.183817  
11       True  0.921584  0.024583   0.183817  
12       True  0.879817  0.209000   0.343322  
13       True  1.000000  0.009583   2.024725  
14       True  1.000000  0.009583   2.024725  
15       True  1.000000  0.009583   2.024725  
16       True  1.000000  0.009583   2.024725  
17       True  1.000000  0.009583   2.024725  
18       True  1.000000  0.009583   2.024725  
19       True  1.000000  0.009583   2.024725  
20       True  0.999999  0.009583   2.024725  
21       True  1.000000  0.009583   2.024725  
22       True  1.000000  0.009583   2.024725  
23       True  0.999985  0.009583   2.024725  
24       True  0.999998  0.009583   2.024725  
25       True  0.999994  0.009583   2.024725  
26       True  0.999963  0.009583   2.024725  
27       True  0.999977  0.009583   2.024725  
28       True  0.999999  0.009583   2.024725  
29       True  0.999312  0.134304   0.635949  ]",,11.707543134689333,2025-06-24T17:12:07,0.1734104046242774,1.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,14,4,"
# Subquery to filter detection records by the specified oids list
subquery_oids = """"""
SELECT oid, candid, fid, mjd, magpsf, sigmapsf, has_stamp, drb
FROM detection
WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
              'ZTF22aawasao', 'ZTF23aaxgvnt')
""""""

# Main query to join tables and apply conditions
full_query = f""""""
SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1
FROM ({subquery_oids}) AS d
INNER JOIN ps1_ztf AS p ON d.oid = p.oid AND d.candid = p.candid
WHERE d.drb > 0.5
AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,14.1803936958313,2025-06-16T01:14:44,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,13.333197593688965,2025-06-24T17:12:25,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,14,5,"
# Subquery to filter detection records by specified oids and drb > 0.5
subquery_detection = """"""
SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb
FROM detection d
WHERE d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
                'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
                'ZTF22aawasao', 'ZTF23aaxgvnt')
AND d.drb > 0.5
""""""

# Join with ps1_ztf to apply conditions on sgscore1 and distpsnr1
subquery_ps1_ztf = f""""""
SELECT det.oid, det.candid, det.fid, det.mjd, det.magpsf, det.sigmapsf, det.has_stamp, det.drb, p.sgscore1, p.distpsnr1
FROM ({subquery_detection}) det
INNER JOIN ps1_ztf p ON det.oid = p.oid AND det.candid = p.candid
WHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1
""""""

# Join with object to retrieve additional object details
final_query = f""""""
SELECT o.oid, det.candid, det.fid, det.mjd, det.magpsf, det.sigmapsf, det.has_stamp, det.drb, det.sgscore1, det.distpsnr1
FROM ({subquery_ps1_ztf}) det
INNER JOIN object o ON det.oid = o.oid
""""""

# Final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,15.492870807647703,2025-06-16T01:15:00,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,11.365525245666504,2025-06-24T17:12:40,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,14,6,"
# Step 1: Filter by Object Identifiers and Join Tables
sub_query = """"""
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.magpsf, 
    d.sigmapsf, 
    d.has_stamp, 
    d.drb, 
    p.sgscore1, 
    p.distpsnr1
FROM 
    detection d
INNER JOIN 
    ps1_ztf p ON d.oid = p.oid
WHERE 
    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
              'ZTF22aawasao', 'ZTF23aaxgvnt')
""""""

# Step 2: Apply Selection Criteria
filtered_query = f""""""
SELECT * FROM ({sub_query}) AS filtered
WHERE 
    filtered.drb > 0.5 AND 
    (filtered.sgscore1 < 0.5 OR filtered.distpsnr1 < 1)
""""""

# Final Query
full_query = filtered_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,12.467962741851808,2025-06-16T01:15:12,"[             oid               candid  fid           mjd     magpsf  sigmapsf  \
0   ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1   ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2   ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3   ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477  0.096587   
4   ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126  0.060204   
5   ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604  0.094521   
6   ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996  0.070969   
7   ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
8   ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047  0.061804   
9   ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606  0.067233   
10  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947  0.147604   
11  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866  0.079126   
12  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363  0.086399   
13  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382  0.193578   
14  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290  0.112882   
15  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288  0.176278   
16  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
17  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
18  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028  0.172092   
19  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201  0.131913   
20  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957  0.146235   
21  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
22  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
23  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
24  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
25  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
26  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
27  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
28  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
29  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983  0.215474   

    has_stamp       drb  sgscore1  distpsnr1  
0        True  0.949127  0.024583   0.183817  
1        True  0.879817  0.209000   0.343322  
2        True  1.000000  0.009583   2.024725  
3        True  1.000000  0.009583   2.024725  
4        True  1.000000  0.009583   2.024725  
5        True  1.000000  0.009583   2.024725  
6        True  1.000000  0.009583   2.024725  
7        True  0.999312  0.134304   0.635949  
8        True  1.000000  0.009583   2.024725  
9        True  1.000000  0.009583   2.024725  
10       True  0.999999  0.009583   2.024725  
11       True  1.000000  0.009583   2.024725  
12       True  1.000000  0.009583   2.024725  
13       True  0.999985  0.009583   2.024725  
14       True  0.999998  0.009583   2.024725  
15       True  0.999994  0.009583   2.024725  
16       True  0.994159  0.075167   0.326697  
17       True  0.994159  0.075167   1.234589  
18       True  0.999963  0.009583   2.024725  
19       True  0.999977  0.009583   2.024725  
20       True  0.999999  0.009583   2.024725  
21       True  0.755912  0.380149   0.673811  
22       True  0.755912  0.380149   0.904783  
23       True  0.993011  0.075167   0.326697  
24       True  0.993011  0.075167   1.234589  
25       True  0.850113  0.075167   0.326697  
26       True  0.850113  0.075167   1.234589  
27       True  0.696538  0.075167   0.326697  
28       True  0.696538  0.075167   1.234589  
29       True  0.921584  0.024583   0.183817  ]",,10.428439855575562,2025-06-24T17:12:55,0.1734104046242774,1.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,14,7,"
# Subquery to filter detection table for specified oids and drb > 0.5
subquery_detection = """"""
SELECT oid, candid, fid, mjd, magpsf, sigmapsf, has_stamp, drb
FROM detection
WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
              'ZTF22aawasao', 'ZTF23aaxgvnt')
AND drb > 0.5
""""""

# Join with ps1_ztf table and apply additional conditions
subquery_ps1_ztf = f""""""
SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1
FROM ({subquery_detection}) d
INNER JOIN ps1_ztf p ON d.oid = p.oid AND d.candid = p.candid
WHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1
""""""

# Final query to select required columns
full_query = f""""""
SELECT oid, candid, fid, mjd, magpsf, sigmapsf, has_stamp, drb, sgscore1, distpsnr1
FROM ({subquery_ps1_ztf}) final
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,14.801411151885986,2025-06-16T01:15:27,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,12.715595483779907,2025-06-24T17:13:11,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,14,8,"
# Step 1: Filter by Object Identifiers and Join Tables
query_step1 = """"""
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.magpsf, 
    d.sigmapsf, 
    d.has_stamp, 
    d.drb, 
    pz.sgscore1, 
    pz.distpsnr1
FROM 
    detection d
INNER JOIN 
    ps1_ztf pz ON d.oid = pz.oid
WHERE 
    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
              'ZTF22aawasao', 'ZTF23aaxgvnt')
""""""

# Step 2: Apply Conditions for drb, sgscore1, and distpsnr1
query_step2 = """"""
SELECT 
    *
FROM 
    ({query_step1}) AS filtered_data
WHERE 
    drb > 0.5 AND 
    (sgscore1 < 0.5 OR distpsnr1 < 1)
""""""

# Final Query
full_query = query_step2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,12.168900966644289,2025-06-16T01:15:40,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""{""
LINE 5:     ({query_step1}) AS filtered_data
             ^

[SQL: 
SELECT 
    *
FROM 
    ({query_step1}) AS filtered_data
WHERE 
    drb > 0.5 AND 
    (sgscore1 < 0.5 OR distpsnr1 < 1)
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.728206872940063,2025-06-24T17:13:28,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,14,9,"
# Subquery to filter detection table for the specified oids
subquery_oids = """"""
SELECT oid
FROM detection
WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
              'ZTF22aawasao', 'ZTF23aaxgvnt')
""""""

# Main query to retrieve the required information
main_query = f""""""
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
    AND detection.oid IN ({subquery_oids})
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,13.921157598495483,2025-06-16T01:15:54,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
1  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
2  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
5  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
6  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.994159  0.075167   0.326697  
1       True  0.696538  0.075167   1.234589  
2       True  0.755912  0.380149   0.904783  
3       True  0.999312  0.134304   0.635949  
4       True  1.000000  0.009583   2.024725  
5       True  0.949127  0.024583   0.183817  
6       True  0.879817  0.209000   0.343322  ]",,11.888096809387209,2025-06-24T17:13:45,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,14,10,"
# Subquery to filter detections based on the given oids and conditions on drb, sgscore1, and distpsnr1
subquery_detections = """"""
SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1
FROM detection d
INNER JOIN ps1_ztf p ON d.oid = p.oid AND d.candid = p.candid
WHERE d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
                'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
                'ZTF22aawasao', 'ZTF23aaxgvnt')
AND d.drb > 0.5
AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)
""""""

# Final query to select the required columns from the filtered detections
full_query = f""""""
SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1
FROM ({subquery_detections}) AS filtered_detections
INNER JOIN detection d ON filtered_detections.oid = d.oid AND filtered_detections.candid = d.candid
INNER JOIN ps1_ztf p ON d.oid = p.oid AND d.candid = p.candid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,15.412352323532104,2025-06-16T01:16:09,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,12.737695932388306,2025-06-24T17:14:03,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.18.1,,,30,0,"
select oid, class_name, probability from probability where classifier_name = 'lc_classifier' and ranking = 1;
",,,,,"[                  oid      class_name  probability
0        ZTF20abvyxhi          Blazar     0.419760
1        ZTF21abrpqoj          Blazar     0.624616
2        ZTF18aaxyuql             LPV     0.905148
3        ZTF18abbdfvd  Periodic-Other     0.336168
4        ZTF20ablukiy         CV/Nova     0.189912
...               ...             ...          ...
4064173  ZTF18abkockd             LPV     0.481656
4064174  ZTF18aaoeqzv  Periodic-Other     0.597888
4064175  ZTF19abqyyje  Periodic-Other     0.613548
4064176  ZTF18abgzytl             YSO     0.604556
4064177  ZTF18acugehn  Periodic-Other     0.557664

[4064178 rows x 3 columns]]",,76.4478874206543,2025-06-24T17:15:20,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,30,1,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.754135847091675,2025-06-16T01:16:12,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",89.52518367767334,2025-06-24T17:18:58,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,30,2,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,5.205549001693726,2025-06-16T01:16:17,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",85.66871500015259,2025-06-24T17:22:10,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,30,3,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.644498825073242,2025-06-16T01:16:20,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",92.99363017082214,2025-06-24T17:25:38,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,30,4,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.103345394134521,2025-06-16T01:16:23,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",83.48182225227356,2025-06-24T17:28:47,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,30,5,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.7994325160980233,2025-06-16T01:16:27,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",78.98410487174988,2025-06-24T17:31:52,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,30,6,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.263079881668091,2025-06-16T01:16:31,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",99.25890111923218,2025-06-24T17:35:17,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,30,7,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,14.623989343643188,2025-06-16T01:16:45,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",83.42070007324219,2025-06-24T17:38:46,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,30,8,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.3096604347229004,2025-06-16T01:16:49,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",94.84515023231506,2025-06-24T17:41:57,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,30,9,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.411540031433105,2025-06-16T01:16:52,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",93.20576357841492,2025-06-24T17:45:29,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,30,10,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.994542598724365,2025-06-16T01:16:56,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""pWHERE""
LINE 1: ...class_name,     p.probabilityFROM     probability pWHERE    ...
                                                             ^

[SQL: SELECT     p.oid,     p.class_name,     p.probabilityFROM     probability pWHERE     p.ranking = 1     AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",100.58113741874696,2025-06-24T17:48:56,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,22,0,"
SELECT
    *
FROM
    object INNER JOIN (
    SELECT
        *
    FROM
        probability
    WHERE
        classifier_name='lc_classifier'
        AND ranking=1
    ) AS probability_oid
    ON object.oid=probability_oid.oid
WHERE
    probability_oid.classifier_name='lc_classifier'
    AND object.firstmjd BETWEEN 58239.0 AND 58270.0
",,,,,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aaoemxl       916      2077  58173.481481  60848.327951   
1       ZTF18aajruik      1554      5042  58205.499826  60848.341713   
2       ZTF18aaqalla       353      6172  58198.472766  60822.426146   
3       ZTF18aaiybzd      1214      4652  58198.398623  60597.158542   
4       ZTF18aaxltnr       919      2619  58217.507188  60817.397801   
...              ...       ...       ...           ...           ...   
103010  ZTF18aagrpym      3456      6362  58198.423819  60838.426829   
103011  ZTF18aauealg       446      2026  58231.484421  60847.325463   
103012  ZTF18aaztkle       305      2491  58261.485046  60832.456319   
103013  ZTF18aaudypw      1797      4256  58218.497106  60849.331366   
103014  ZTF18aauvvlj       934      2062  58219.320440  60848.280232   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   442      NaN           NaN  ...  58242.313310   
1            True    False   439      NaN           NaN  ...  58252.403310   
2            True    False   103      NaN           NaN  ...  58252.444583   
3            True    False   272      NaN           NaN  ...  58242.419363   
4            True    False   806      NaN           NaN  ...  58269.457836   
...           ...      ...   ...      ...           ...  ...           ...   
103010       True    False  1206      NaN           NaN  ...  58242.434444   
103011       True    False   353      NaN           NaN  ...  58252.440405   
103012       True    False   138      NaN           NaN  ...  58261.485046   
103013       True    False  1224      NaN           NaN  ...  58252.440405   
103014       True    False   449      NaN           NaN  ...  58255.260162   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60848.327951        27.5.6    False              True   
1       60848.341713        27.5.6     True             False   
2       60822.426146        27.5.6     True             False   
3       60597.158542      24.5.2a6    False              True   
4       60817.397801        27.5.6     True              True   
...              ...           ...      ...               ...   
103010  60838.426829        27.5.6    False             False   
103011  60847.325463        27.5.6     True              True   
103012  60832.456319        27.5.6    False             False   
103013  60849.331366        27.5.6    False              True   
103014  60848.280232        27.5.6    False             False   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13             RRL     0.414520   
1         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.303584   
2         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.423720   
3         lc_classifier  lc_classifier_1.1.13             RRL     0.300348   
4         lc_classifier  lc_classifier_1.1.13             LPV     0.684320   
...                 ...                   ...             ...          ...   
103010    lc_classifier  lc_classifier_1.1.13               E     0.375832   
103011    lc_classifier  lc_classifier_1.1.13             LPV     0.697424   
103012    lc_classifier  lc_classifier_1.1.13             YSO     0.475020   
103013    lc_classifier  lc_classifier_1.1.13             YSO     0.205128   
103014    lc_classifier  lc_classifier_1.1.13             RRL     0.563792   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
103010       1  
103011       1  
103012       1  
103013       1  
103014       1  

[103015 rows x 27 columns]]",,14.688800573349,2025-06-24T17:49:11,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,22,1,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.10867714881897,2025-06-16T01:17:01,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",20.899462699890137,2025-06-24T17:49:57,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,22,2,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.5505716800689697,2025-06-16T01:17:04,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",27.4510178565979,2025-06-24T17:50:54,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,22,3,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.453997611999512,2025-06-16T01:17:08,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",21.932530403137207,2025-06-24T17:51:41,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,22,4,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.5669853687286377,2025-06-16T01:17:12,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",23.782305479049683,2025-06-24T17:52:32,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,22,5,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.267582416534424,2025-06-16T01:17:15,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",26.46662449836731,2025-06-24T17:53:19,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,22,6,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.3587608337402344,2025-06-16T01:17:19,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",35.11629915237427,2025-06-24T17:54:22,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,22,7,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,5.213036298751831,2025-06-16T01:17:24,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",29.049702167510983,2025-06-24T17:55:18,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,22,8,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.8216922283172607,2025-06-16T01:17:28,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",34.37989592552185,2025-06-24T17:56:13,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,22,9,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.9114737510681152,2025-06-16T01:17:32,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",24.10778307914734,2025-06-24T17:57:04,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,22,10,"
SELECT o.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 58239.0 AND 58270.0
AND p.ranking = 1
AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.693753480911255,2025-06-16T01:17:36,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...t oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd...
                                                             ^

[SQL: SELECT o.*FROM object oINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0AND p.ranking = 1AND p.classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",22.793922901153564,2025-06-24T17:57:52,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,12,0,"
SELECT o.oid, o.meanra, o.meandec

FROM (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
    AND probability.ranking = 1
    AND object.firstmjd > 59988.0
    AND object.firstmjd < 60197.0
) as o
WHERE
    q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);
",,,,,"[             oid      meanra    meandec
0   ZTF23aazxfdh   11.327556  -2.327343
1   ZTF23aazneeg  357.339861 -17.674648
2   ZTF23aazxair   14.098124   0.520434
3   ZTF23abawaav  359.369924  -5.159571
4   ZTF23abbbrbi  358.010245  -4.224612
5   ZTF23abbbygf   16.168206  -1.053601
6   ZTF23aazwytj    0.881927 -10.744196
7   ZTF23abbkepd   13.835889   5.077601
8   ZTF23abapoiv    5.230048  -1.758021
9   ZTF23abbjstt   13.706127  -3.710276
10  ZTF23ababooa  347.699685 -15.441363
11  ZTF23aazkvym  357.860400 -11.907847
12  ZTF23abbbybs   12.780815  -5.443683
13  ZTF23abaychv   12.394942  -3.037759
14  ZTF23aaovxwf  351.140762 -19.056710
15  ZTF23aapnlvr  352.465073 -11.202974
16  ZTF23aaowayh  356.647299 -13.542643
17  ZTF23aapvrkk    0.175006 -12.236802
18  ZTF23aapvzyq  359.503657 -11.916706
19  ZTF23aaohpnv    8.491958   4.082251
20  ZTF23aapgxic    7.748520   5.157252
21  ZTF23aapqtxd    8.879058   2.147919
22  ZTF23abbygzm  343.960147 -17.448733
23  ZTF23abcvivc  358.337513  -5.886772
24  ZTF23aaqixha    8.509318  -9.703939
25  ZTF23aazxiuu    6.501685  -0.884798
26  ZTF23aaqixyp    6.388770  -7.758614
27  ZTF23abbefkk    9.982778   6.622644
28  ZTF23aazwshk   10.101225   4.791153
29  ZTF23abawaqe  352.826653 -18.783349
30  ZTF23aaqygof  345.346057 -18.765263
31  ZTF23aapwihe   17.827492   0.742945
32  ZTF23aaretvs   15.263196  -2.912866
33  ZTF23aarfbvs   11.196881  -2.378468
34  ZTF23aarffak  356.743944 -19.262242
35  ZTF23aarfpck    6.464097   2.183000
36  ZTF23aaqluoo  358.419121 -17.190397
37  ZTF23aascfrd  354.052083  -7.437187
38  ZTF23abbbomo  345.634527 -19.724748
39  ZTF23aapgjtm  351.100632 -14.425906
40  ZTF23aasyvbf    9.411387  -4.281495
41  ZTF23aatzjdo    1.226893 -13.502189
42  ZTF23aaovzyu  349.534040 -12.976046
43  ZTF23aaumlxn    6.423729  -1.050326
44  ZTF23aaaweph    1.307964 -11.502395
45  ZTF23aaaweph    1.307964 -11.502395
46  ZTF23aazsfpa  356.794110 -16.513073
47  ZTF23abbjtdn    6.232715   1.033046
48  ZTF23aavlyvc  359.897395  -6.376741
49  ZTF23aavmycb    7.102145   0.441236
50  ZTF23aawqydv   19.468501   0.780816
51  ZTF23aaxavca    9.017651   1.801565
52  ZTF23aaxavca    9.017651   1.801565
53  ZTF23aaxbfyp    4.112309 -10.371170
54  ZTF23aaxbfzl   16.973081   1.732003
55  ZTF23aaxtrgs    1.760985  -9.567699
56  ZTF23abbitkh   10.628642   8.028922
57  ZTF23aaxtdpc    9.048410  -2.151892
58  ZTF22abrrqkf  351.152588 -13.510948]",,44.51714324951172,2025-06-24T17:58:37,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,12,1,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.175091981887817,2025-06-16T01:17:40,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""SELECT""
LINE 1: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FRO...
                                                   ^

[SQL: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')) AS pINNER JOIN (    SELECT object.oid, object.meanra, object.meandec    FROM object    WHERE object.firstmjd BETWEEN 59988.0 AND 60197.0    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)) AS oON p.oid = o.oid]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.132475137710571,2025-06-24T17:58:56,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,12,2,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.824711322784424,2025-06-16T01:17:44,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""SELECT""
LINE 1: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FRO...
                                                   ^

[SQL: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')) AS pINNER JOIN (    SELECT object.oid, object.meanra, object.meandec    FROM object    WHERE object.firstmjd BETWEEN 59988.0 AND 60197.0    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)) AS oON p.oid = o.oid]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.99679160118103,2025-06-24T17:59:17,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,12,3,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.701000452041626,2025-06-16T01:17:48,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""SELECT""
LINE 1: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FRO...
                                                   ^

[SQL: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')) AS pINNER JOIN (    SELECT object.oid, object.meanra, object.meandec    FROM object    WHERE object.firstmjd BETWEEN 59988.0 AND 60197.0    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)) AS oON p.oid = o.oid]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.421422481536863,2025-06-24T17:59:39,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,12,4,"
SELECT object.oid, object.meanra, object.meandec
FROM object
JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.079430341720581,2025-06-16T01:17:52,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...id, object.meanra, object.meandecFROM objectWHERE object.fir...
                                                             ^

[SQL: SELECT object.oid, object.meanra, object.meandecFROM objectWHERE object.firstmjd BETWEEN 59988.0 AND 60197.0AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)AND object.oid IN (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN'))]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.191269874572754,2025-06-24T18:00:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,12,5,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,7.077455043792725,2025-06-16T01:17:59,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""SELECT""
LINE 1: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FRO...
                                                   ^

[SQL: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')) AS pINNER JOIN (    SELECT object.oid, object.meanra, object.meandec    FROM object    WHERE object.firstmjd BETWEEN 59988.0 AND 60197.0    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)) AS oON p.oid = o.oid]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.462416887283323,2025-06-24T18:00:21,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,12,6,"
SELECT object.oid, object.meanra, object.meandec
FROM object
JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.7745862007141113,2025-06-16T01:18:03,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...id, object.meanra, object.meandecFROM objectWHERE object.fir...
                                                             ^

[SQL: SELECT object.oid, object.meanra, object.meandecFROM objectWHERE object.firstmjd BETWEEN 59988.0 AND 60197.0AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)AND object.oid IN (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN'))]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.306755542755129,2025-06-24T18:00:44,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,12,7,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.696155071258545,2025-06-16T01:18:08,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""SELECT""
LINE 1: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FRO...
                                                   ^

[SQL: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')) AS pINNER JOIN (    SELECT object.oid, object.meanra, object.meandec    FROM object    WHERE object.firstmjd BETWEEN 59988.0 AND 60197.0    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)) AS oON p.oid = o.oid]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.049094438552856,2025-06-24T18:01:08,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,12,8,"
SELECT object.oid, object.meanra, object.meandec
FROM object
JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.031560182571411,2025-06-16T01:18:12,[None],"(psycopg2.ProgrammingError) can't execute an empty query
[SQL: -- Final query combining the stepsSELECT object.oid, object.meanra, object.meandecFROM objectWHERE object.oid IN (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN'))AND object.firstmjd BETWEEN 59988.0 AND 60197.0AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)]
(Background on this error at: https://sqlalche.me/e/20/f405)",16.439402103424072,2025-06-24T18:01:34,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,12,9,"
SELECT object.oid, object.meanra, object.meandec
FROM object
JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.235151529312134,2025-06-16T01:18:16,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...id, object.meanra, object.meandecFROM objectWHERE object.fir...
                                                             ^

[SQL: SELECT object.oid, object.meanra, object.meandecFROM objectWHERE object.firstmjd BETWEEN 59988.0 AND 60197.0AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)AND object.oid IN (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN'))]
(Background on this error at: https://sqlalche.me/e/20/f405)",19.992985725402832,2025-06-24T18:02:03,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,12,10,"
SELECT object.oid, object.meanra, object.meandec
FROM object
JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types
AND object.firstmjd BETWEEN 59988.0 AND 60197.0
AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.499204874038696,2025-06-16T01:18:21,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""SELECT""
LINE 1: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FRO...
                                                   ^

[SQL: SELECT o.oid, o.meanra, o.meandecFROM (    SELECT oid    FROM probability    WHERE ranking = 1    AND classifier_name = 'lc_classifier'    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')) AS pJOIN (    SELECT object.oid, object.meanra, object.meandec    FROM object    WHERE object.firstmjd BETWEEN 59988.0 AND 60197.0    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)) AS oON p.oid = o.oid]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.840442419052124,2025-06-24T18:02:27,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,57,0,"WITH catalog (id, obj_ra, obj_dec, r_deg) AS (
VALUES
('id_1', 354.67, 15.954, 0.00833333),
('id_2', 20.7993, 1.00331, 0.00555556)
)
SELECT
    c.id, c.obj_ra, c.obj_dec, r_deg, oid, ndet,
    meanra, meandec, firstmjd
FROM
    catalog AS c, object AS o
WHERE
    q3c_join(c.obj_ra, c.obj_dec, o.meanra, o.meandec, c.r_deg)
ORDER BY lastmjd DESC",,,,,"[     id    obj_ra   obj_dec     r_deg           oid  ndet      meanra  \
0  id_1  354.6700  15.95400  0.008333  ZTF18acfqezx     2  354.671235   
1  id_1  354.6700  15.95400  0.008333  ZTF22acabgbb     1  354.663704   
2  id_1  354.6700  15.95400  0.008333  ZTF20abyptpc    96  354.670313   
3  id_2   20.7993   1.00331  0.005556  ZTF20abywohm    89   20.799247   
4  id_2   20.7993   1.00331  0.005556  ZTF18abqyaix    46   20.799251   

     meandec      firstmjd  
0  15.954552  58431.216979  
1  15.955837  59935.163229  
2  15.954038  59098.360544  
3   1.003320  59073.419086  
4   1.003313  59073.419086  ]",,4.059361934661865,2025-06-24T18:02:32,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,57,1,"
# Subquery to calculate distance and filter objects within specified radii
distance_filter_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
""""""

# Subquery to join with detection table and aggregate data
detection_aggregation_subquery = f""""""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd, COUNT(d.candid) AS num_detections, MIN(d.mjd) AS first_detection_date
FROM ({distance_filter_subquery}) AS o
INNER JOIN detection d ON o.oid = d.oid
GROUP BY o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd
""""""

# Final query to select required columns and sort by last detection date
final_query = f""""""
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.num_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, o.first_detection_date
FROM ({detection_aggregation_subquery}) AS o
UNION
SELECT 
    'id_2' AS input_identifier, 20.7993 AS input_ra, 1.00331 AS input_dec, 20/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.num_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, o.first_detection_date
FROM ({detection_aggregation_subquery}) AS o
ORDER BY o.lastmjd DESC
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,29.197996616363525,2025-06-16T01:24:27,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""o""
LINE 37: ORDER BY o.lastmjd DESC
                  ^

[SQL: 
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.num_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, o.first_detection_date
FROM (
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd, COUNT(d.candid) AS num_detections, MIN(d.mjd) AS first_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
) AS o
INNER JOIN detection d ON o.oid = d.oid
GROUP BY o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd
) AS o
UNION
SELECT 
    'id_2' AS input_identifier, 20.7993 AS input_ra, 1.00331 AS input_dec, 20/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.num_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, o.first_detection_date
FROM (
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd, COUNT(d.candid) AS num_detections, MIN(d.mjd) AS first_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
) AS o
INNER JOIN detection d ON o.oid = d.oid
GROUP BY o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd
) AS o
ORDER BY o.lastmjd DESC
]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.599276065826416,2025-06-24T18:02:53,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,57,2,"
# Subquery to calculate the angular distance and filter objects within specified radii
distance_filter = """"""
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd
FROM object o
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(o.meandec)) * COS(RADIANS(o.meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(o.meandec)) * COS(RADIANS(o.meanra - 20.7993)))) * 3600 <= 20)
)
""""""

# Final query to join with detection table and retrieve required information
final_query = f""""""
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, o.firstmjd AS first_detection_date
FROM ({distance_filter}) o
JOIN (
    SELECT oid, MAX(mjd) AS last_detection_date
    FROM detection
    GROUP BY oid
) d ON o.oid = d.oid
ORDER BY d.last_detection_date DESC
""""""

# Join the steps in a final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.527384996414185,2025-06-16T01:24:49,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, o.firstmjd AS first_detection_date
FROM (
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd
FROM object o
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(o.meandec)) * COS(RADIANS(o.meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(o.meandec)) * COS(RADIANS(o.meanra - 20.7993)))) * 3600 <= 20)
)
) o
JOIN (
    SELECT oid, MAX(mjd) AS last_detection_date
    FROM detection
    GROUP BY oid
) d ON o.oid = d.oid
ORDER BY d.last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.85736179351807,2025-06-24T18:07:09,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,57,3,"
# Subquery to calculate distance and filter objects within specified radii
distance_filter = """"""
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
""""""

# Final query to join with detection table and select required columns
final_query = f""""""
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, o.firstmjd AS first_detection_date
FROM ({distance_filter}) AS o
INNER JOIN detection d ON o.oid = d.oid
ORDER BY o.lastmjd DESC
""""""

# Combine the subquery and final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,11.77865219116211,2025-06-16T01:25:00,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, o.firstmjd AS first_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
) AS o
INNER JOIN detection d ON o.oid = d.oid
ORDER BY o.lastmjd DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.47785258293152,2025-06-24T18:11:29,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,57,4,"
# Subquery to calculate the angular distance and filter objects within specified radii
distance_filter = """"""
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.lastmjd,
    CASE 
        WHEN (DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(o.meandec)) * COS(RADIANS(o.meanra - 354.67)))) * 3600) <= 30 THEN 'id_1'
        WHEN (DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(o.meandec)) * COS(RADIANS(o.meanra - 20.7993)))) * 3600) <= 20 THEN 'id_2'
    END AS input_object
FROM 
    object o
WHERE 
    (DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(o.meandec)) * COS(RADIANS(o.meanra - 354.67)))) * 3600) <= 30
    OR
    (DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(o.meandec)) * COS(RADIANS(o.meanra - 20.7993)))) * 3600) <= 20
""""""

# Final query to join with detection table and sort by last detection date
full_query = f""""""
SELECT 
    df.input_object,
    CASE 
        WHEN df.input_object = 'id_1' THEN 354.67
        ELSE 20.7993
    END AS input_ra,
    CASE 
        WHEN df.input_object = 'id_1' THEN 15.954
        ELSE 1.00331
    END AS input_dec,
    CASE 
        WHEN df.input_object = 'id_1' THEN 30.0 / 3600
        ELSE 20.0 / 3600
    END AS search_radius_deg,
    df.oid AS ztf_identifier,
    df.ndet AS number_of_detections,
    df.meanra AS mean_ra,
    df.meandec AS mean_dec,
    df.firstmjd AS first_detection_date
FROM 
    ({distance_filter}) df
ORDER BY 
    df.lastmjd DESC
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,22.66103458404541,2025-06-16T01:25:23,"[  input_object  input_ra  input_dec  search_radius_deg           oid  \
0         id_1  354.6700   15.95400           0.008333  ZTF18acfqezx   
1         id_1  354.6700   15.95400           0.008333  ZTF22acabgbb   
2         id_1  354.6700   15.95400           0.008333  ZTF20abyptpc   
3         id_2   20.7993    1.00331           0.005556  ZTF20abywohm   
4         id_2   20.7993    1.00331           0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,170.97469973564148,2025-06-24T18:14:25,1.0,1.0,0.0,0.0,1.0,0.0
0.18.1,gpt-4o,v3,57,5,"
# Subquery to calculate distance and filter objects within specified radii
distance_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
""""""

# Main query to select required columns and sort by last detection date
main_query = f""""""
SELECT 
    'id_1' AS input_identifier, 
    354.67 AS input_ra, 
    15.954 AS input_dec, 
    30/3600.0 AS search_radius_deg,
    oid AS ztf_identifier, 
    ndet AS number_of_detections, 
    meanra AS mean_ra, 
    meandec AS mean_dec, 
    firstmjd AS first_detection_date, 
    lastmjd AS last_detection_date
FROM ({distance_subquery}) AS filtered_objects
UNION
SELECT 
    'id_2' AS input_identifier, 
    20.7993 AS input_ra, 
    1.00331 AS input_dec, 
    20/3600.0 AS search_radius_deg,
    oid AS ztf_identifier, 
    ndet AS number_of_detections, 
    meanra AS mean_ra, 
    meandec AS mean_dec, 
    firstmjd AS first_detection_date, 
    lastmjd AS last_detection_date
FROM ({distance_subquery}) AS filtered_objects
ORDER BY last_detection_date DESC
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,14.604196786880491,2025-06-16T01:25:38,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT 
    'id_1' AS input_identifier, 
    354.67 AS input_ra, 
    15.954 AS input_dec, 
    30/3600.0 AS search_radius_deg,
    oid AS ztf_identifier, 
    ndet AS number_of_detections, 
    meanra AS mean_ra, 
    meandec AS mean_dec, 
    firstmjd AS first_detection_date, 
    lastmjd AS last_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
) AS filtered_objects
UNION
SELECT 
    'id_2' AS input_identifier, 
    20.7993 AS input_ra, 
    1.00331 AS input_dec, 
    20/3600.0 AS search_radius_deg,
    oid AS ztf_identifier, 
    ndet AS number_of_detections, 
    meanra AS mean_ra, 
    meandec AS mean_dec, 
    firstmjd AS first_detection_date, 
    lastmjd AS last_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
) AS filtered_objects
ORDER BY last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",258.4661333560944,2025-06-24T18:18:49,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,57,6,"
# Subquery to calculate the angular distance and filter objects within specified radii
distance_filter = """"""
SELECT 
    oid, 
    meanra, 
    meandec, 
    ndet, 
    firstmjd, 
    lastmjd
FROM 
    object
WHERE 
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
""""""

# Main query to join with detection table and select required columns
main_query = f""""""
SELECT 
    '{id_1}' AS input_id, 
    354.67 AS input_ra, 
    15.954 AS input_dec, 
    30/3600.0 AS search_radius_deg,
    o.oid AS ztf_id, 
    o.ndet AS number_of_detections, 
    o.meanra AS mean_ra, 
    o.meandec AS mean_dec, 
    o.firstmjd AS first_detection_date
FROM 
    ({distance_filter}) AS o
JOIN 
    detection d ON o.oid = d.oid
ORDER BY 
    o.lastmjd DESC
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,13.682972192764282,2025-06-16T01:25:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT 
    'id_1' AS input_identifier, 
    354.67 AS input_ra, 
    15.954 AS input_dec, 
    30/3600.0 AS search_radius_deg,
    oid AS ztf_identifier, 
    ndet AS number_of_detections, 
    meanra AS mean_ra, 
    meandec AS mean_dec, 
    firstmjd AS first_detection_date, 
    lastmjd AS last_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
) AS filtered_objects
UNION
SELECT 
    'id_2' AS input_identifier, 
    20.7993 AS input_ra, 
    1.00331 AS input_dec, 
    20/3600.0 AS search_radius_deg,
    oid AS ztf_identifier, 
    ndet AS number_of_detections, 
    meanra AS mean_ra, 
    meandec AS mean_dec, 
    firstmjd AS first_detection_date, 
    lastmjd AS last_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
) AS filtered_objects
ORDER BY last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",135.3151397705078,2025-06-24T18:21:10,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,57,7,"
# Subquery to calculate the angular distance for id_1 and id_2
distance_subquery = """"""
SELECT oid, meanra, meandec,
       (2 * asin(sqrt(sin(radians((meandec - 15.954) / 2))^2 + 
       cos(radians(15.954)) * cos(radians(meandec)) * 
       sin(radians((meanra - 354.67) / 2))^2))) * 180/pi() * 3600 AS distance_id_1,
       (2 * asin(sqrt(sin(radians((meandec - 1.00331) / 2))^2 + 
       cos(radians(1.00331)) * cos(radians(meandec)) * 
       sin(radians((meanra - 20.7993) / 2))^2))) * 180/pi() * 3600 AS distance_id_2
FROM object
""""""

# Main query to filter objects within the specified distances and join with detection table
main_query = f""""""
SELECT o.oid AS ztf_identifier, o.ndet AS number_of_detections, 
       o.meanra AS mean_ra, o.meandec AS mean_dec, 
       o.firstmjd AS first_detection_date, o.lastmjd AS last_detection_date,
       CASE 
           WHEN ds.distance_id_1 <= 30 THEN 'id_1'
           WHEN ds.distance_id_2 <= 20 THEN 'id_2'
       END AS input_object_identifier,
       CASE 
           WHEN ds.distance_id_1 <= 30 THEN 354.67
           WHEN ds.distance_id_2 <= 20 THEN 20.7993
       END AS input_object_ra,
       CASE 
           WHEN ds.distance_id_1 <= 30 THEN 15.954
           WHEN ds.distance_id_2 <= 20 THEN 1.00331
       END AS input_object_dec,
       CASE 
           WHEN ds.distance_id_1 <= 30 THEN 30/3600.0
           WHEN ds.distance_id_2 <= 20 THEN 20/3600.0
       END AS search_radius_deg
FROM ({distance_subquery}) AS ds
JOIN object o ON ds.oid = o.oid
WHERE ds.distance_id_1 <= 30 OR ds.distance_id_2 <= 20
ORDER BY o.lastmjd DESC
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,16.209934949874878,2025-06-16T01:26:08,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid AS ztf_identifier, o.ndet AS number_of_detections, 
       o.meanra AS mean_ra, o.meandec AS mean_dec, 
       o.firstmjd AS first_detection_date, o.lastmjd AS last_detection_date,
       CASE 
           WHEN ds.distance_id_1 <= 30 THEN 'id_1'
           WHEN ds.distance_id_2 <= 20 THEN 'id_2'
       END AS input_object_identifier,
       CASE 
           WHEN ds.distance_id_1 <= 30 THEN 354.67
           WHEN ds.distance_id_2 <= 20 THEN 20.7993
       END AS input_object_ra,
       CASE 
           WHEN ds.distance_id_1 <= 30 THEN 15.954
           WHEN ds.distance_id_2 <= 20 THEN 1.00331
       END AS input_object_dec,
       CASE 
           WHEN ds.distance_id_1 <= 30 THEN 30/3600.0
           WHEN ds.distance_id_2 <= 20 THEN 20/3600.0
       END AS search_radius_deg
FROM (
SELECT oid, meanra, meandec,
       (2 * asin(sqrt(sin(radians((meandec - 15.954) / 2))^2 + 
       cos(radians(15.954)) * cos(radians(meandec)) * 
       sin(radians((meanra - 354.67) / 2))^2))) * 180/pi() * 3600 AS distance_id_1,
       (2 * asin(sqrt(sin(radians((meandec - 1.00331) / 2))^2 + 
       cos(radians(1.00331)) * cos(radians(meandec)) * 
       sin(radians((meanra - 20.7993) / 2))^2))) * 180/pi() * 3600 AS distance_id_2
FROM object
) AS ds
JOIN object o ON ds.oid = o.oid
WHERE ds.distance_id_1 <= 30 OR ds.distance_id_2 <= 20
ORDER BY o.lastmjd DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",255.2358825206757,2025-06-24T18:25:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,57,8,"
# Subquery to calculate the angular distance and filter objects within specified radii
distance_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (acos(sin(radians(15.954)) * sin(radians(meandec)) + cos(radians(15.954)) * cos(radians(meandec)) * cos(radians(meanra - 354.67))) * 3600 <= 30)
    OR
    (acos(sin(radians(1.00331)) * sin(radians(meandec)) + cos(radians(1.00331)) * cos(radians(meandec)) * cos(radians(meanra - 20.7993))) * 3600 <= 20)
)
""""""

# Main query to join with detection table and retrieve required information
main_query = f""""""
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    'id_2' AS input_identifier, 20.7993 AS input_ra, 1.00331 AS input_dec, 20/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, 
    MIN(d.mjd) AS first_detection_date
FROM ({distance_subquery}) AS o
INNER JOIN detection d ON o.oid = d.oid
GROUP BY o.oid, o.meanra, o.meandec, o.ndet
ORDER BY o.lastmjd DESC
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,13.159373044967651,2025-06-16T01:26:21,[None],"(psycopg2.errors.GroupingError) column ""o.lastmjd"" must appear in the GROUP BY clause or be used in an aggregate function
LINE 18: ORDER BY o.lastmjd DESC
                  ^

[SQL: 
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    'id_2' AS input_identifier, 20.7993 AS input_ra, 1.00331 AS input_dec, 20/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, 
    MIN(d.mjd) AS first_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (acos(sin(radians(15.954)) * sin(radians(meandec)) + cos(radians(15.954)) * cos(radians(meandec)) * cos(radians(meanra - 354.67))) * 3600 <= 30)
    OR
    (acos(sin(radians(1.00331)) * sin(radians(meandec)) + cos(radians(1.00331)) * cos(radians(meandec)) * cos(radians(meanra - 20.7993))) * 3600 <= 20)
)
) AS o
INNER JOIN detection d ON o.oid = d.oid
GROUP BY o.oid, o.meanra, o.meandec, o.ndet
ORDER BY o.lastmjd DESC
]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.406307458877563,2025-06-24T18:25:50,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,57,9,"
# Subquery to calculate distance and filter objects within specified arcsec limits
distance_filter = """"""
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
""""""

# Main query to join with detection table and aggregate results
final_query = f""""""
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, 
    o.firstmjd AS first_detection_date
FROM ({distance_filter}) AS o
INNER JOIN detection d ON o.oid = d.oid
GROUP BY o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd
ORDER BY o.lastmjd DESC
""""""

# Join all the steps in a final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,12.914599418640137,2025-06-16T01:26:34,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, 
    o.firstmjd AS first_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
) AS o
INNER JOIN detection d ON o.oid = d.oid
GROUP BY o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd
ORDER BY o.lastmjd DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.61397624015808,2025-06-24T18:30:09,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,57,10,"
# Subquery to calculate the angular distance and filter objects within specified radii
distance_subquery = """"""
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd,
       SQRT(POW((meanra - 354.67) * COS(RADIANS(meandec)), 2) + POW((meandec - 15.954), 2)) * 3600 AS distance_id_1,
       SQRT(POW((meanra - 20.7993) * COS(RADIANS(meandec)), 2) + POW((meandec - 1.00331), 2)) * 3600 AS distance_id_2
FROM object
WHERE (SQRT(POW((meanra - 354.67) * COS(RADIANS(meandec)), 2) + POW((meandec - 15.954), 2)) * 3600 <= 30)
   OR (SQRT(POW((meanra - 20.7993) * COS(RADIANS(meandec)), 2) + POW((meandec - 1.00331), 2)) * 3600 <= 20)
""""""

# Final query to join with detection table and select required columns
final_query = f""""""
SELECT o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, 
       o.firstmjd AS first_detection_date, o.lastmjd AS last_detection_date,
       CASE 
           WHEN distance_id_1 <= 30 THEN 'id_1'
           WHEN distance_id_2 <= 20 THEN 'id_2'
       END AS input_object_identifier,
       CASE 
           WHEN distance_id_1 <= 30 THEN 354.67
           WHEN distance_id_2 <= 20 THEN 20.7993
       END AS input_object_ra,
       CASE 
           WHEN distance_id_1 <= 30 THEN 15.954
           WHEN distance_id_2 <= 20 THEN 1.00331
       END AS input_object_dec,
       CASE 
           WHEN distance_id_1 <= 30 THEN 30/3600.0
           WHEN distance_id_2 <= 20 THEN 20/3600.0
       END AS search_radius_deg
FROM ({distance_subquery}) AS o
ORDER BY o.lastmjd DESC
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,16.917675495147705,2025-06-16T01:26:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.meanra AS mean_ra, o.meandec AS mean_dec, 
    o.firstmjd AS first_detection_date
FROM (
SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
FROM object
WHERE (
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30)
    OR
    (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20)
)
) AS o
INNER JOIN detection d ON o.oid = d.oid
GROUP BY o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.lastmjd
ORDER BY o.lastmjd DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.37632489204407,2025-06-24T18:34:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,75,0,"SELECT
    *
FROM
    ss_ztf
WHERE
    ssnamenr != 'null'
LIMIT 100",,,,,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
2   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
3   ZTF23aayeymv  2418268262015015004       0.0     19.7   302661
4   ZTF23aayeyim  2418269212515015011       0.0     19.0   206792
..           ...                  ...       ...      ...      ...
95  ZTF23aayezti  2418271301315015002       0.0     18.3    54471
96  ZTF23aayezyo  2418269212915015020       0.0     19.2    78762
97  ZTF23aayfaal  2418271302515015031       0.0     17.1     5087
98  ZTF23aayezzs  2418270305615015029       0.0     19.0   100841
99  ZTF23aayezyg  2418269212915015055       0.0     17.4    45344

[100 rows x 5 columns]]",,4.509292125701904,2025-06-24T18:34:31,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,75,1,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.652698040008545,2025-06-16T01:26:54,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,17.153825283050537,2025-06-24T18:34:53,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,75,2,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.349809408187866,2025-06-16T01:26:57,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,9.129079341888428,2025-06-24T18:35:06,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,75,3,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.926194429397583,2025-06-16T01:27:00,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,21.786422967910767,2025-06-24T18:35:34,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,75,4,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,3.5122923851013184,2025-06-16T01:27:04,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,9.602182149887083,2025-06-24T18:35:48,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,75,5,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.6818323135375977,2025-06-16T01:27:06,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,8.207391738891602,2025-06-24T18:36:00,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,75,6,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.844146966934204,2025-06-16T01:27:09,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,10.118370056152344,2025-06-24T18:36:15,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,75,7,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,3.205473184585572,2025-06-16T01:27:13,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,9.907673835754396,2025-06-24T20:24:52,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,75,8,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.196985244750977,2025-06-16T01:27:15,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,10.522817134857178,2025-06-24T20:25:07,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,75,9,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.453774690628052,2025-06-16T01:27:18,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,10.989229440689089,2025-06-24T20:25:23,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,75,10,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,3.144099712371826,2025-06-16T01:27:21,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF23aayeyfv  2418271302815015006       0.0     19.3   161180
1   ZTF23aayeygv  2418263471615015000    -999.0   -999.0     null
2   ZTF23aayeydr  2418268733115015003       0.0     18.9   121848
3   ZTF23aayemla  2418235122715015010    -999.0   -999.0     null
4   ZTF23aayemkp  2418232741915015008       0.0     17.8    32172
..           ...                  ...       ...      ...      ...
95  ZTF23aayeyyz  2418268732615015019       0.0     19.8    88685
96  ZTF23aayezat  2418268732515015008       0.0     19.5   620282
97  ZTF23aayezez  2418269213815015020       0.0     19.4   148258
98  ZTF23aayezfe  2418269213815015013       0.0     19.6   336712
99  ZTF23aayeyzh  2418262991915015022    -999.0   -999.0     null

[100 rows x 5 columns]]",,9.459526300430298,2025-06-24T20:25:37,0.65,0.65,1.0,1.0,0.0,1.0
0.18.1,,,43,0,"SELECT
    oid, candid, xpos, ypos, scorr
FROM
    dataquality
WHERE
    oid IN ('ZTF20acwrybw','ZTF22abugigx')
    AND fid = 2",,,,,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,4.038943767547607,2025-06-24T20:25:41,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,43,1,"
# Define the sub-query to filter the dataquality table for the specified ZTF identifiers and r-band data
dataquality_subquery = """"""
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.063272476196287,2025-06-16T01:32:04,[None],No 'full_query' variable in Python code,10.157167673110962,2025-06-24T20:25:56,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,43,2,"
# Define the sub-query to filter the dataquality table for the specified conditions
dataquality_subquery = """"""
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.09823727607727,2025-06-16T01:32:13,[None],No 'full_query' variable in Python code,10.74492573738098,2025-06-24T20:26:12,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,43,3,"
# Sub-query to filter objects with specific ZTF identifiers
object_filter = """"""
SELECT oid 
FROM object 
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx')
""""""

# Main query to retrieve the required information from the dataquality table
dataquality_query = f""""""
SELECT dq.oid, dq.candid, dq.xpos, dq.ypos, dq.scorr
FROM dataquality dq
INNER JOIN ({object_filter}) obj ON dq.oid = obj.oid
WHERE dq.fid = 2
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.90279221534729,2025-06-16T01:32:23,[None],No 'full_query' variable in Python code,11.655052185058594,2025-06-24T20:26:29,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,43,4,"
# Define the sub-query to filter the dataquality table for the specified ZTF identifiers and r-band
dataquality_subquery = """"""
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,8.973914384841919,2025-06-16T01:32:33,[None],No 'full_query' variable in Python code,10.01166319847107,2025-06-24T20:26:44,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,43,5,"
# Define the sub-query to filter the dataquality table for the specified ZTF identifiers and r-band observations
dataquality_subquery = """"""
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,8.213456869125366,2025-06-16T01:32:41,[None],No 'full_query' variable in Python code,10.52329444885254,2025-06-24T20:27:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,43,6,"
# Define the sub-query to filter the dataquality table for the specified ZTF identifiers and r-band
dataquality_subquery = """"""
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,8.461350440979004,2025-06-16T01:32:49,[None],No 'full_query' variable in Python code,10.990261316299438,2025-06-24T20:27:16,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,43,7,"
# Define the sub-query to filter the dataquality table for the specific ZTF identifiers and r-band filter
dataquality_subquery = """"""
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.520592212677002,2025-06-16T01:33:00,[None],No 'full_query' variable in Python code,11.3011474609375,2025-06-24T20:27:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,43,8,"
# Sub-query to filter objects with specific ZTF identifiers
object_filter = """"""
SELECT oid 
FROM object 
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx')
""""""

# Main query to retrieve r-band epochs from the dataquality table
dataquality_query = f""""""
SELECT dq.oid, dq.candid, dq.xpos, dq.ypos, dq.scorr
FROM dataquality dq
INNER JOIN ({object_filter}) obj ON dq.oid = obj.oid
WHERE dq.fid = 2
""""""

# Final query
full_query = dataquality_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,8.902559995651245,2025-06-16T01:33:09,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,11.681537628173828,2025-06-24T20:27:48,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,43,9,"
# Define the sub-query to filter the dataquality table for the required conditions
dataquality_subquery = """"""
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,8.213907480239868,2025-06-16T01:33:17,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,11.142308235168455,2025-06-24T20:28:04,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,43,10,"
dataquality_subquery = """"""
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,8.782671451568604,2025-06-16T01:33:26,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,11.260865688323976,2025-06-24T20:28:21,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,,,89,0,"SELECT
    *
FROM
    dataquality
WHERE
    oid in
(
SELECT
    oid
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'SN'
    AND probability > 0.7
LIMIT 50
)",,,,,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF21aamxduf  1514482231715015006    1  1956.1433  2499.0212  1.107722   
1    ZTF21aamxduf  1516439301715015004    1  1955.2365  2540.7583  1.616236   
2    ZTF21aamxduf  1516500191715015008    2  1965.2140  2538.4087  1.410225   
3    ZTF21aamxduf  1518400971715015008    1  1946.3340  2497.2036  0.918117   
4    ZTF21aamxduf  1518454621715015005    2  1948.5463  2506.5984  1.161461   
..            ...                  ...  ...        ...        ...       ...   
236  ZTF21aamwurl  1526451140815015019    2  2361.6987  2084.5193  1.693306   
237  ZTF21aamuqhz  1514352985815015000    2   445.8874   186.0515  0.815668   
238  ZTF21aamximg  1514499544415015011    1  1767.8157  2937.8528  1.032121   
239  ZTF21aamwrni  1514437912215015017    1  1682.3422  1952.2223  2.286379   
240  ZTF21aamuows  1514352064315015014    2  1425.9983  2852.8186  1.327417   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    0.463527  1.980000     0.953    581.4787  ...     0.000009     0.035028   
1    0.387381  1.376471     0.871    539.7416  ...     0.000018     0.037795   
2   -0.365459  1.432676     0.872    542.0914  ...     0.000011     0.047839   
3   -0.006869  1.570000     0.923    583.2965  ...     0.000035     0.042601   
4   -0.426307  1.431574     0.843    573.9015  ...     0.000013     0.049340   
..        ...       ...       ...         ...  ...          ...          ...   
236 -0.253035  2.600000     0.995    710.8012  ...     0.000002     0.022639   
237  0.007465  2.480000     0.977    186.0515  ...     0.000016     0.047972   
238  0.219138  2.850000     0.993    142.6471  ...     0.000010     0.034368   
239 -0.493747  2.310000     0.982   1128.2777  ...     0.000013     0.040179   
240 -0.916880  2.490000     0.957    227.6815  ...     0.000013     0.050647   

     nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0         513 -0.069226  0.000015 -0.000011  26.2780   0.653  0.312036   
1         439 -0.037184  0.000035 -0.000023  26.2480   0.579  0.292183   
2         515  0.119671  0.000018 -0.000013  26.3630   0.677  0.312842   
3         302 -0.038208  0.000077 -0.000047  26.2425   0.532  0.270376   
4         514  0.117034  0.000022 -0.000016  26.3600   0.661  0.312328   
..        ...       ...       ...       ...      ...     ...       ...   
236      2030  0.078862  0.000007 -0.000004  26.1080   0.493  0.161669   
237       287  0.116622  0.000025 -0.000018  26.4430   0.640  0.333727   
238       340 -0.070488  0.000016 -0.000012  26.3820   0.655  0.337355   
239       504 -0.068593  0.000024 -0.000016  26.3420   0.574  0.310192   
240       347  0.126435  0.000019 -0.000014  26.5040   0.679  0.335966   

     exptime  
0       30.0  
1       30.0  
2       30.0  
3       30.0  
4       30.0  
..       ...  
236     30.0  
237     30.0  
238     30.0  
239     30.0  
240     30.0  

[241 rows x 32 columns]]",,5.307459592819214,2025-06-24T20:28:26,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,89,1,"
# Sub-query to filter ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
sub_query = """"""
SELECT oid 
FROM probability 
WHERE class_name = 'SN' 
AND classifier_name = 'stamp_classifier' 
AND probability > 0.7 
AND ranking = 1 
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.940357446670532,2025-06-16T01:33:37,[None],"'[' was never closed (<string>, line 1)",11.986850261688232,2025-06-24T20:28:45,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,89,2,"
probability_subquery = """"""
SELECT oid 
FROM probability 
WHERE class_name = 'SN' 
AND classifier_name = 'stamp_classifier' 
AND probability > 0.7 
AND ranking = 1
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.458405017852783,2025-06-16T01:33:47,[None],"'[' was never closed (<string>, line 1)",11.63380241394043,2025-06-24T20:29:01,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,89,3,"
# Sub-query to filter the probability table for supernovae with probability > 0.7 using the stamp_classifier
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.021333456039429,2025-06-16T01:33:57,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,11.75271463394165,2025-06-24T20:29:19,0.0,0.0,0.15625,1.0,0.0,0.0
0.18.1,gpt-4o,v3,89,4,"
# Sub-query to filter the probability table for objects classified as 'SN' with a probability greater than 0.7
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND ranking = 1
AND probability > 0.7
LIMIT 50
""""""

# Final query to join the dataquality table with the filtered probability subquery
full_query = f""""""
SELECT dq.*
FROM dataquality dq
INNER JOIN ({probability_subquery}) p ON dq.oid = p.oid
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.188769578933716,2025-06-16T01:34:07,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF21aaobfzx  1522449270515015003    1  1240.9950   921.7663  1.244743   
1    ZTF21aaoblhd  1522494684515015010    2  1413.2155  1659.8007  1.342615   
2    ZTF21aaoblhd  1522512974515015009    1  1418.1460  1667.1722  0.711121   
3    ZTF21aaoblhd  1526525173215015007    2  1544.5503  1523.3872  2.471555   
4    ZTF21aaoblhd  1537467463215015013    2  1539.4087  1543.0776  1.083040   
..            ...                  ...  ...        ...        ...       ...   
842  ZTF21aaofmuy  1524401783115015012    2  1691.0104  2797.7410  4.650958   
843  ZTF21aaofmst  1524402245915015011    2  2722.7764  1244.1180  2.321221   
844  ZTF21aaofmyd  1524401784815015000    2  2949.7456   177.2621  1.371334   
845  ZTF21aaofncc  1524401785315015016    2  1259.5621  2503.3062  3.706682   
846  ZTF21aaofnhq  1524401783215015004    2  2233.1455  1263.5319  7.147294   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   -0.699563  1.483569     0.743    921.7663  ...     0.000011     0.042628   
1    0.719532  2.410000     0.998   1413.2155  ...     0.000002     0.017363   
2    0.453546  3.100000     0.974   1413.3278  ...     0.000002     0.017000   
3    1.401231  2.170000     1.000   1523.3872  ...     0.000002     0.020054   
4   -0.051605  1.342794     0.693   1533.0913  ...     0.000003     0.021749   
..        ...       ...       ...         ...  ...          ...          ...   
842  0.141046  2.660000     0.983    282.7591  ...     0.000025     0.055612   
843 -0.079911  3.100000     0.981    349.7236  ...     0.000020     0.047318   
844  0.177233  3.510000     0.972    122.7545  ...     0.000016     0.045439   
845 -0.510355  2.710000     0.983    577.1939  ...     0.000015     0.041384   
846  0.335468  2.730000     0.996    839.3544  ...     0.000015     0.048148   

     nmatches  clrcoeff  clrcounc  zpclrcov   zpmed  clrmed    clrrms  exptime  
0         831 -0.105310  0.000021 -0.000014  26.259   0.595  0.251419     30.0  
1        1960  0.085081  0.000005 -0.000003  26.290   0.503  0.130376     30.0  
2        1950 -0.034295  0.000008 -0.000004  26.227   0.503  0.131334     30.0  
3        1991  0.089174  0.000008 -0.000004  25.973   0.501  0.130925     30.0  
4        1988  0.088483  0.000010 -0.000005  26.016   0.502  0.131302     30.0  
..        ...       ...       ...       ...     ...     ...       ...      ...  
842       246  0.139872  0.000035 -0.000027  26.378   0.717  0.331016     30.0  
843       330  0.109509  0.000028 -0.000021  26.375   0.750  0.325692     30.0  
844       318  0.105925  0.000024 -0.000018  26.188   0.671  0.331147     30.0  
845       313  0.096136  0.000021 -0.000016  26.333   0.725  0.328724     30.0  
846       329  0.117888  0.000023 -0.000017  26.351   0.634  0.327757     30.0  

[847 rows x 32 columns]]",,12.867296695709229,2025-06-24T20:29:39,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,89,5,"
# Sub-query to filter ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
LIMIT 50
""""""

# Final query to retrieve all columns from the dataquality table for the filtered objects
full_query = f""""""
SELECT dq.*
FROM dataquality dq
INNER JOIN ({probability_subquery}) p ON dq.oid = p.oid
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.563594102859495,2025-06-16T01:34:20,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF21aaopumu  1526421432015015004    2  2545.7440  1644.3364  1.840489   
1    ZTF21aaopumy  1526422833515015008    2  1805.9801  1762.4655  1.061261   
2    ZTF21aaopwvo  1526440693615015010    2  2348.0454  1710.4819  1.414108   
3    ZTF21aaopxed  1526440215915015016    2  1240.8365  2130.6448  1.104436   
4    ZTF21aaopxwl  1526441154715015008    2   516.7294  1263.1783  1.278236   
..            ...                  ...  ...        ...        ...       ...   
198  ZTF21aaotwik  1527267512515015169    2  2615.9856  2618.2030  0.880392   
199  ZTF21aaotwib  1527267512515015137    2  2984.0176  2137.1904  1.374747   
200  ZTF21aaotycd  1527267514415015020    2  1852.0208    75.3228  0.972135   
201  ZTF21aaotzci  1527286883515015001    2  1492.3817   164.5396  1.203511   
202  ZTF18aailizd  1527267514515015056    2   821.2339   249.4603  0.956509   

          sky  fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    0.380581  3.64     0.977    526.7562  ...     0.000012     0.049187   
1    0.046706  2.85     0.968   1266.5199  ...     0.000016     0.047279   
2    0.886132  3.00     0.977    724.4547  ...     0.000003     0.029935   
3   -0.384241  2.82     0.967    949.8553  ...     0.000003     0.036718   
4   -0.570094  3.35     0.981    516.7294  ...     0.000002     0.034392   
..        ...   ...       ...         ...  ...          ...          ...   
198 -1.574336  3.70     0.684    456.5143  ...     0.000507     0.199866   
199 -1.491089  3.54     0.846     88.4825  ...     0.000507     0.199866   
200 -2.543995  2.92     0.623     75.3228  ...     0.000520     0.189366   
201  0.037286  4.19     0.559    164.5396  ...     0.000016     0.053969   
202 -0.078759  5.38     0.946    249.4603  ...     0.000215     0.125330   

     nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0         333  0.118513  0.000022 -0.000015  26.2750   0.551  0.337028   
1         354  0.114166  0.000025 -0.000018  26.3025   0.624  0.319515   
2        1888  0.088753  0.000008 -0.000004  26.2180   0.527  0.201599   
3        1347  0.102206  0.000005 -0.000003  26.2890   0.535  0.279508   
4        1629  0.104182  0.000005 -0.000003  26.3370   0.564  0.254760   
..        ...       ...       ...       ...      ...     ...       ...   
198       461  0.113529  0.000816 -0.000588  25.3790   0.647  0.320427   
199       461  0.113529  0.000816 -0.000588  25.3790   0.647  0.320427   
200       421  0.099295  0.000795 -0.000590  25.6960   0.666  0.322687   
201       480  0.120755  0.000026 -0.000018  26.0415   0.620  0.328031   
202       438  0.105202  0.000298 -0.000233  25.6390   0.763  0.332944   

     exptime  
0       30.0  
1       30.0  
2       30.0  
3       30.0  
4       30.0  
..       ...  
198     30.0  
199     30.0  
200     30.0  
201     30.0  
202     30.0  

[203 rows x 32 columns]]",,12.66536021232605,2025-06-24T20:29:57,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,89,6,"
# Sub-query to filter the probability table for supernovae with probability > 0.7 using the stamp classifier
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
LIMIT 50
""""""

# Final query to join the filtered probability results with the dataquality table
full_query = f""""""
SELECT dq.*
FROM dataquality dq
INNER JOIN ({probability_subquery}) p ON dq.oid = p.oid
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.416324377059937,2025-06-16T01:34:31,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF21aapejbx  1536259011715015009    2   927.6974  2862.9927  3.933230   
1    ZTF21aapejbx  1536312841715015005    1   916.1597  2863.8247  3.315043   
2    ZTF21aapejbx  1538311791715015006    1   934.1278  2849.2686  5.207340   
3    ZTF21aapejbx  1538340231715015004    2   941.7224  2850.0444  6.269694   
4    ZTF21aapejbx  1541276161715015002    1   945.9999  2857.4348  1.082142   
..            ...                  ...  ...        ...        ...       ...   
469  ZTF21aapjlyx  1559262742115015002    1  2913.2300   173.7678  2.172698   
470  ZTF21aapjlyx  1563328952115015009    2  2900.3710   180.0843  2.981322   
471  ZTF21aapjlyx  1567279982115015004    2  2915.8850   191.6992  2.403249   
472  ZTF21aapjlyx  1569343092115015001    2  2917.6704   185.3988  1.206672   
473  ZTF21aapjlyx  1586321642115015005    2  2910.2083   164.0181  1.720764   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    0.327765  1.770000     0.984    217.5073  ...     0.000018     0.047103   
1    0.069500  2.220000     0.983    216.6752  ...     0.000021     0.038887   
2    0.109514  1.930000     0.983    231.2315  ...     0.000023     0.039535   
3    0.448631  1.670000     0.983    230.4555  ...     0.000013     0.043547   
4    0.069241  4.510000     0.978    223.0651  ...     0.000050     0.045989   
..        ...       ...       ...         ...  ...          ...          ...   
469 -0.278382  6.300000     0.942    159.2700  ...     0.000057     0.075741   
470  0.301434  5.630000     0.979    172.1289  ...     0.000037     0.054369   
471  0.114753  3.540000     0.975    156.6151  ...     0.000021     0.046864   
472  0.692936  3.410000     0.910    154.8297  ...     0.000019     0.048083   
473  0.309030  1.242641     0.550    162.2917  ...     0.000026     0.050199   

     nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0         232  0.116627  0.000029 -0.000021  26.4250   0.625  0.330497   
1         232 -0.078476  0.000034 -0.000024  26.2615   0.632  0.329311   
2         234 -0.075658  0.000037 -0.000026  26.2275   0.620  0.330557   
3         231  0.112515  0.000021 -0.000015  26.3640   0.626  0.329970   
4         193 -0.064852  0.000095 -0.000063  26.2160   0.550  0.306152   
..        ...       ...       ...       ...      ...     ...       ...   
469       343 -0.159562  0.000083 -0.000063  26.0920   0.745  0.326629   
470       344  0.100319  0.000052 -0.000040  26.4160   0.754  0.324231   
471       346  0.101921  0.000030 -0.000023  26.3825   0.749  0.323893   
472       347  0.111931  0.000027 -0.000021  26.3830   0.753  0.325342   
473       345  0.104441  0.000038 -0.000029  26.3650   0.753  0.324010   

     exptime  
0       30.0  
1       30.0  
2       30.0  
3       30.0  
4       30.0  
..       ...  
469     30.0  
470     30.0  
471     30.0  
472     30.0  
473     30.0  

[474 rows x 32 columns]]",,12.255860567092896,2025-06-24T20:30:15,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,89,7,"
# Sub-query to filter ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
LIMIT 50
""""""

# Final query to retrieve all columns from the dataquality table for the filtered objects
full_query = f""""""
SELECT dq.*
FROM dataquality dq
INNER JOIN ({probability_subquery}) p ON dq.oid = p.oid
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.017248153686523,2025-06-16T01:34:41,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF21aaptgfj  1537373401015015008    2  1020.2407  1016.1950  0.798273   
1    ZTF21aaptgkc  1537373404015015007    2  2842.4043  1053.2270  1.648665   
2    ZTF21aapkdxh  1537373863315015006    2  2118.2915  1221.1844  1.871242   
3    ZTF21aapkdxh  1541389003315015000    2  2119.1848  1221.9708  1.562379   
4    ZTF21aapkdxh  1555397343315015008    2  2142.8790  1198.2410  0.864643   
..            ...                  ...  ...        ...        ...       ...   
791  ZTF21aaazkfd  1570487112515015001    1  1860.5027   336.4388  2.847142   
792  ZTF21aaazkfd  1583473132515015003    2  1856.6754   344.6265  1.328146   
793  ZTF21aaazkfd  1587454842515015001    2  1854.1729   303.3850  1.126662   
794  ZTF21aaazkfd  1590464542515015003    1  1856.3940   340.1184  1.553010   
795  ZTF21aaazkfd  1619449132515015001    1  1863.7935   361.9542  0.804041   

          sky  fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    0.168630  1.99     0.983   1016.1950  ...     0.000009     0.042575   
1    0.049011  2.39     0.907    230.0956  ...     0.000015     0.051092   
2   -0.327831  1.99     0.993    954.2085  ...     0.000009     0.045816   
3   -0.181093  3.36     0.783    953.3151  ...     0.000008     0.042927   
4   -0.470079  2.58     0.698    929.6210  ...     0.000009     0.047283   
..        ...   ...       ...         ...  ...          ...          ...   
791  0.659924  2.36     0.977    336.4388  ...     0.000002     0.020471   
792  0.453292  2.72     0.958    344.6265  ...     0.000001     0.019369   
793 -2.050052  2.60     0.781    303.3850  ...     0.000004     0.024458   
794  0.186886  2.34     0.937    340.1184  ...     0.000002     0.021499   
795  0.034426  3.61     0.650    361.9542  ...     0.000002     0.022076   

     nmatches  clrcoeff  clrcounc  zpclrcov   zpmed  clrmed    clrrms  exptime  
0         349  0.102627  0.000015 -0.000011  26.293   0.614  0.339020     30.0  
1         340  0.127909  0.000025 -0.000017  26.570   0.623  0.325066     30.0  
2         457  0.120068  0.000017 -0.000011  26.374   0.583  0.309115     30.0  
3         455  0.114087  0.000014 -0.000009  26.332   0.589  0.309293     30.0  
4         459  0.126251  0.000016 -0.000011  26.362   0.583  0.310065     30.0  
..        ...       ...       ...       ...     ...     ...       ...      ...  
791      2025 -0.080193  0.000004 -0.000003  26.259   0.716  0.173737     30.0  
792      2026  0.087719  0.000002 -0.000002  26.398   0.715  0.171907     30.0  
793      2005  0.092045  0.000006 -0.000004  26.430   0.716  0.172060     30.0  
794      2022 -0.087243  0.000004 -0.000003  26.234   0.715  0.171575     30.0  
795      2032 -0.094653  0.000004 -0.000003  26.338   0.714  0.172275     30.0  

[796 rows x 32 columns]]",,13.06331181526184,2025-06-24T20:30:33,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,89,8,"
# Sub-query to filter ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
sub_query = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.721588373184204,2025-06-16T01:34:50,[None],"'[' was never closed (<string>, line 1)",11.734172821044922,2025-06-24T20:30:51,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,89,9,"
# Sub-query to filter the probability table for objects with a high probability of being supernovae
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'SN'
AND classifier_name = 'stamp_classifier'
AND probability > 0.7
AND ranking = 1
LIMIT 50
""""""

# Final query to join the dataquality table with the filtered probability subquery
full_query = f""""""
SELECT dq.*
FROM dataquality dq
INNER JOIN ({probability_subquery}) p ON dq.oid = p.oid
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.249925136566162,2025-06-16T01:35:00,"[               oid               candid  fid       xpos       ypos    chipsf  \
0     ZTF21aaqonuc  1542358712815015011    2  2399.1787  1299.2643  1.190882   
1     ZTF21aaqoobu  1542358716115015009    2   983.3620  2279.1106  2.715687   
2     ZTF21aaqonwo  1542358716315015011    2  2998.5696  1136.6425  9.988935   
3     ZTF21aaqooyk  1542359174715015023    2  2288.0825  1952.7773  1.225069   
4     ZTF21aaqoowh  1542359173615015008    2  1663.7104   820.1957  1.395023   
...            ...                  ...  ...        ...        ...       ...   
3060  ZTF21aajtszm  1543273513715015002    2   589.9947   294.5806  1.316426   
3061  ZTF21aajtszm  1555275913715015002    2   606.8391   262.9851  0.915084   
3062  ZTF21aajtszm  1557312743715015003    2   613.2372   262.4537  2.263318   
3063  ZTF21aajtszm  1563331303715015003    2   605.0386   255.8965  1.027358   
3064  ZTF21aajtszm  1567297983715015001    2   613.9624   268.8247  1.200311   

           sky  fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    -1.254947  3.58     0.981    673.3212  ...     0.000016     0.050485   
1    -0.160747  3.07     0.984    801.3893  ...     0.000015     0.045723   
2    -0.022359  2.77     0.983     73.9305  ...     0.000015     0.049333   
3     0.017034  3.85     0.973    784.4176  ...     0.000025     0.052157   
4    -0.112181  3.53     0.979    820.1957  ...     0.000014     0.046709   
...        ...   ...       ...         ...  ...          ...          ...   
3060 -0.058825  3.43     0.981    294.5806  ...     0.000015     0.052728   
3061  0.350799  2.01     0.982    262.9851  ...     0.000007     0.045069   
3062  0.200061  2.14     0.998    262.4537  ...     0.000007     0.042824   
3063  0.044257  2.95     0.947    255.8965  ...     0.000007     0.045860   
3064  0.541570  1.67     0.945    268.8247  ...     0.000007     0.045244   

      nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0        289.0  0.125372  0.000024 -0.000018  26.3490   0.644  0.336420   
1        350.0  0.103310  0.000022 -0.000017  26.0765   0.690  0.337019   
2        356.0  0.121097  0.000022 -0.000017  26.2240   0.696  0.329574   
3        218.0  0.131702  0.000036 -0.000027  26.3740   0.685  0.328557   
4        329.0  0.116279  0.000022 -0.000016  26.3330   0.626  0.323234   
...        ...       ...       ...       ...      ...     ...       ...   
3060     468.0  0.118474  0.000026 -0.000018  26.2660   0.615  0.326538   
3061     471.0  0.116380  0.000012 -0.000008  26.3370   0.611  0.327005   
3062     467.0  0.109604  0.000011 -0.000008  26.3260   0.611  0.325246   
3063     468.0  0.117636  0.000013 -0.000009  26.3150   0.613  0.326807   
3064     471.0  0.117509  0.000012 -0.000008  26.3070   0.611  0.326252   

      exptime  
0        30.0  
1        30.0  
2        30.0  
3        30.0  
4        30.0  
...       ...  
3060     30.0  
3061     30.0  
3062     30.0  
3063     30.0  
3064     30.0  

[3065 rows x 32 columns]]",,14.494693994522097,2025-06-24T20:31:11,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,89,10,"
# Sub-query to select ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
sub_query = """"""
SELECT oid 
FROM probability 
WHERE class_name = 'SN' 
AND classifier_name = 'stamp_classifier' 
AND ranking = 1 
AND probability > 0.7
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.52689814567566,2025-06-16T01:35:09,[None],"'[' was never closed (<string>, line 1)",12.970271110534668,2025-06-24T20:31:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,72,0,"SELECT
    *
FROM
    reference
WHERE
    oid = 'ZTF20actnuls'
    AND rfid = '712120223'",,,,,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,4.161559104919434,2025-06-24T20:31:36,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,72,1,"
SELECT *
FROM reference
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.745108366012573,2025-06-16T01:35:13,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""=""
LINE 1: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = ...
                                        ^

[SQL: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.280144453048706,2025-06-24T20:31:50,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,72,2,"
SELECT *
FROM reference
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.357124328613281,2025-06-16T01:35:16,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""=""
LINE 1: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = ...
                                        ^

[SQL: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.609887599945068,2025-06-24T20:32:05,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,72,3,"
SELECT *
FROM reference
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.5457260608673096,2025-06-16T01:35:18,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""=""
LINE 1: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = ...
                                        ^

[SQL: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.95183277130127,2025-06-24T20:32:19,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,72,4,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.427954912185669,2025-06-16T01:35:22,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.231534719467165,2025-06-24T20:32:33,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,72,5,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.7924623489379883,2025-06-16T01:35:25,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.39887809753418,2025-06-24T20:32:47,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,72,6,"
SELECT *
FROM reference
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.457161903381348,2025-06-16T01:35:29,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""=""
LINE 1: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = ...
                                        ^

[SQL: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.868698120117188,2025-06-24T20:33:01,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,72,7,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.329793691635132,2025-06-16T01:35:31,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.624337196350098,2025-06-24T20:33:15,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,72,8,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.169898271560669,2025-06-16T01:35:33,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.885185956954956,2025-06-24T20:33:30,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,72,9,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.165499210357666,2025-06-16T01:35:36,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,8.978474855422974,2025-06-24T20:33:44,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,72,10,"
SELECT *
FROM reference
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.46902084350586,2025-06-16T01:35:38,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""=""
LINE 1: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = ...
                                        ^

[SQL: SELECT *FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.960837364196776,2025-06-24T20:33:59,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,103,0,"SELECT
    *
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ps1_ztf
    ON object.oid = ps1_ztf.oid
WHERE
    classifier_name = 'lc_classifier'
    AND class_name NOT IN ('SNIa','SNII','SNIbc','SLSN')
    AND probability > 0.7
    AND distpsnr1 > 5
ORDER BY distpsnr1
LIMIT 200
",,,,,,"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: SELECT
    *
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ps1_ztf
    ON object.oid = ps1_ztf.oid
WHERE
    classifier_name = 'lc_classifier'
    AND class_name NOT IN ('SNIa','SNII','SNIbc','SLSN')
    AND probability > 0.7
    AND distpsnr1 > 5
ORDER BY distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.80130171775815,2025-06-24T21:59:16,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,103,1,"
# Subquery to filter probability table for objects with the specified conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Final query to join tables and apply all conditions
full_query = f""""""
SELECT *
FROM object
INNER JOIN ({probability_subquery}) AS prob_filtered ON object.oid = prob_filtered.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,17.87034296989441,2025-06-16T01:43:47,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT *
FROM object
INNER JOIN (
SELECT oid
FROM probability
WHERE probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND ranking = 1
AND classifier_name = 'lc_classifier'
) AS prob_filtered ON object.oid = prob_filtered.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.06460690498352,2025-06-24T22:05:20,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,103,2,"
# Subquery to filter probability table for objects with specified conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Final query to retrieve the required information
full_query = f""""""
SELECT *
FROM object
INNER JOIN ({probability_subquery}) AS prob_filtered ON object.oid = prob_filtered.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,11.520177364349363,2025-06-16T01:43:59,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,230.4344537258148,2025-06-24T22:10:06,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.18.1,gpt-4o,v3,103,3,"
# Subquery to filter the probability table for non-supernova classes with probability > 0.7
probability_subquery = """"""
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
""""""

# Final query to join object, probability, and ps1_ztf tables
full_query = f""""""
SELECT o.*, p.*, ps.*
FROM object o
INNER JOIN ({probability_subquery}) AS filtered_prob ON o.oid = filtered_prob.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,11.9746675491333,2025-06-16T01:44:11,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""p""
LINE 2: SELECT o.*, p.*, ps.*
                    ^

[SQL: 
SELECT o.*, p.*, ps.*
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
) AS filtered_prob ON o.oid = filtered_prob.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.156110525131226,2025-06-24T22:10:46,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,103,4,"
# Subquery to filter probability table for objects with ranking = 1, classifier_name = 'lc_classifier', and probability > 0.7 for classes other than supernova
probability_subquery = """"""
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
""""""

# Main query to retrieve all columns from object, probability, and ps1_ztf tables for objects that meet the conditions
full_query = """"""
SELECT o.*, p.*, ps.*
FROM object o
INNER JOIN ({probability_subquery}) p_sub ON o.oid = p_sub.oid
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
"""""".format(probability_subquery=probability_subquery)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,14.306121110916138,2025-06-16T01:44:26,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
..            ...       ...       ...           ...           ...        ...   
195  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
196  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
197  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
198  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
199  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   

     stellar  ndet g_r_max g_r_max_corr  ... sgmag3 srmag3  simag3  szmag3  \
0      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
1      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
2      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
3      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
4      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
..       ...   ...     ...          ...  ...    ...    ...     ...     ...   
195    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
196    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
197    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
198    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
199    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   

     sgscore3  distpsnr3  nmtchps  unique1  unique2 unique3  
0         0.5  20.389175       13    False    False   False  
1         0.5  20.389175       13    False    False   False  
2         0.5  20.389175       13    False    False   False  
3         0.5  20.389175       13    False    False   False  
4         0.5  20.389175       13    False    False   False  
..        ...        ...      ...      ...      ...     ...  
195       0.5  20.389175       13    False    False   False  
196       0.5  20.389175       13    False    False   False  
197       0.5  20.389175       13    False    False   False  
198       0.5  20.389175       13    False    False   False  
199       0.5  20.389175       13    False    False   False  

[200 rows x 53 columns]]",,132.21403408050537,2025-06-24T22:13:32,11.11111111111111,0.08,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,103,5,"
# Subquery to filter the probability table based on the given conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
""""""

# Final query to retrieve the desired information from the object, probability, and ps1_ztf tables
full_query = f""""""
SELECT *
FROM object
INNER JOIN ({probability_subquery}) AS prob_filtered ON object.oid = prob_filtered.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,11.16515612602234,2025-06-16T01:44:37,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,63.02705359458923,2025-06-24T22:15:00,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.18.1,gpt-4o,v3,103,6,"
# Subquery to filter the probability table for objects with ranking = 1, classifier_name = 'lc_classifier', and probability > 0.7, excluding supernova classes
probability_subquery = """"""
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
""""""

# Final query to join the object, probability, and ps1_ztf tables, applying the necessary conditions and ordering
full_query = f""""""
SELECT o.*, p.*, ps.*
FROM object o
INNER JOIN ({probability_subquery}) AS filtered_prob ON o.oid = filtered_prob.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,10.546203136444092,2025-06-16T01:44:48,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""p""
LINE 2: SELECT o.*, p.*, ps.*
                    ^

[SQL: 
SELECT o.*, p.*, ps.*
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
) AS filtered_prob ON o.oid = filtered_prob.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.643158674240112,2025-06-24T22:15:30,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,103,7,"
# Subquery to filter the probability table for the desired conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
""""""

# Final query to join the tables and apply all conditions
full_query = f""""""
SELECT o.*, p.*, ps.*
FROM object o
INNER JOIN ({probability_subquery}) p_sub ON o.oid = p_sub.oid
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,11.66687798500061,2025-06-16T01:44:59,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4    ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
..            ...       ...       ...           ...           ...        ...   
195  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
196  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
197  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
198  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
199  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   

     stellar  ndet g_r_max g_r_max_corr  ... sgmag3 srmag3  simag3  szmag3  \
0      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
1      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
2      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
3      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
4      False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
..       ...   ...     ...          ...  ...    ...    ...     ...     ...   
195    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
196    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
197    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
198    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   
199    False    81    None         None  ... -999.0 -999.0  -999.0  18.594   

     sgscore3  distpsnr3  nmtchps  unique1  unique2 unique3  
0         0.5  20.389175       13    False    False   False  
1         0.5  20.389175       13    False    False   False  
2         0.5  20.389175       13    False    False   False  
3         0.5  20.389175       13    False    False   False  
4         0.5  20.389175       13    False    False   False  
..        ...        ...      ...      ...      ...     ...  
195       0.5  20.389175       13    False    False   False  
196       0.5  20.389175       13    False    False   False  
197       0.5  20.389175       13    False    False   False  
198       0.5  20.389175       13    False    False   False  
199       0.5  20.389175       13    False    False   False  

[200 rows x 53 columns]]",,51.14548063278198,2025-06-24T22:16:39,11.11111111111111,0.08,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,103,8,"
# Subquery to filter the probability table for objects with ranking = 1, classifier_name = 'lc_classifier', and class_name not being a supernova class
probability_subquery = """"""
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
""""""

# Final query to join the object, probability, and ps1_ztf tables, applying the necessary conditions
full_query = f""""""
SELECT *
FROM object
INNER JOIN ({probability_subquery}) AS prob ON object.oid = prob.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1 ASC
LIMIT 200
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,11.381699562072754,2025-06-16T01:45:11,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT *
FROM object
INNER JOIN (
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
) AS prob ON object.oid = prob.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1 ASC
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",831.1944706439972,2025-06-24T22:31:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,103,9,"
# Subquery to filter oids based on probability conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
""""""

# Main query to join tables and apply distance condition
final_query = f""""""
SELECT o.*, p.*, ps.*
FROM object o
INNER JOIN ({probability_subquery}) prob ON o.oid = prob.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,14.87094497680664,2025-06-16T01:45:26,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,93.59166765213013,2025-06-24T22:35:09,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.18.1,gpt-4o,v3,103,10,"
# Subquery to filter probability table for objects with ranking = 1, classifier_name = 'lc_classifier', and probability > 0.7, excluding supernova classes
probability_subquery = """"""
SELECT oid
FROM probability
WHERE ranking = 1
AND classifier_name = 'lc_classifier'
AND probability > 0.7
AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
""""""

# Main query to join object, probability, and ps1_ztf tables, applying the necessary conditions
full_query = f""""""
SELECT *
FROM object
INNER JOIN ({probability_subquery}) AS prob_filtered ON object.oid = prob_filtered.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1 ASC
LIMIT 200
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,13.335817098617554,2025-06-16T01:45:39,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,50.22225785255432,2025-06-24T22:36:21,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.18.1,,,54,0,"SELECT
    *
FROM
    non_detection
WHERE
    oid IN ('ZTF23abtcveg','ZTF23abudlls')
    AND diffmaglim > 19.5",,,,,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,4.038325309753418,2025-06-24T22:36:25,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,54,1,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.2787652015686035,2025-06-16T01:45:42,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.52526569366455,2025-06-24T22:36:40,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,54,2,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.741811752319336,2025-06-16T01:45:44,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.880624532699583,2025-06-24T22:36:55,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,54,3,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,3.4512739181518555,2025-06-16T01:45:48,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.96458649635315,2025-06-24T22:37:13,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,54,4,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.9249203205108643,2025-06-16T01:45:51,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.8121178150177,2025-06-24T22:37:28,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,54,5,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.2670438289642334,2025-06-16T01:45:54,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.535046815872192,2025-06-24T22:37:43,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,54,6,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.2240030765533447,2025-06-16T01:45:56,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.637728691101074,2025-06-24T22:37:57,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,54,7,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.3149025440216064,2025-06-16T01:45:58,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.765024185180664,2025-06-24T22:38:11,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,54,8,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.5014541149139404,2025-06-16T01:46:01,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.489537000656128,2025-06-24T22:38:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,54,9,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,3.2009530067443848,2025-06-16T01:46:04,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.326913356781006,2025-06-24T22:38:39,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,54,10,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,4.336628437042236,2025-06-16T01:46:09,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF...
                                            ^

[SQL: SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.387616395950317,2025-06-24T22:38:52,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,99,0,"SELECT
    *
FROM
    forced_photometry
WHERE
    oid in
(
SELECT
    object.oid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    firstmjd > 60310
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability = 1
ORDER BY firstmjd
LIMIT 10
)
",,,,,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,4.939949989318848,2025-06-24T22:38:57,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,99,1,"
# Sub-query to filter objects with first detection date later than MJD 60310
object_subquery = """"""
SELECT oid 
FROM object 
WHERE firstmjd > 60310
""""""

# Sub-query to filter probabilities for asteroids with probability 1 from the stamp classifier
probability_subquery = """"""
SELECT oid 
FROM probability 
WHERE class_name = 'asteroid' 
AND probability = 1 
AND classifier_name = 'stamp_classifier'
""""""

# Final query to join the above sub-queries and retrieve all columns from forced_photometry
full_query = f""""""
SELECT fp.* 
FROM forced_photometry fp
INNER JOIN ({object_subquery}) o ON fp.oid = o.oid
INNER JOIN ({probability_subquery}) p ON fp.oid = p.oid
ORDER BY o.firstmjd
LIMIT 10
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,13.612058877944946,2025-06-16T01:49:39,[None],"(psycopg2.errors.UndefinedColumn) column o.firstmjd does not exist
LINE 16: ORDER BY o.firstmjd
                  ^

[SQL: 
SELECT fp.* 
FROM forced_photometry fp
INNER JOIN (
SELECT oid 
FROM object 
WHERE firstmjd > 60310
) o ON fp.oid = o.oid
INNER JOIN (
SELECT oid 
FROM probability 
WHERE class_name = 'asteroid' 
AND probability = 1 
AND classifier_name = 'stamp_classifier'
) p ON fp.oid = p.oid
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.183676958084106,2025-06-24T22:39:14,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,99,2,"
object_subquery = """"""
SELECT oid 
FROM object 
WHERE firstmjd > 60310
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,12.313122987747192,2025-06-16T01:49:51,[None],"'[' was never closed (<string>, line 1)",12.07051682472229,2025-06-24T22:39:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,99,3,"
# Sub-query to filter objects with first detection date later than MJD 60310
object_subquery = """"""
SELECT oid 
FROM object 
WHERE firstmjd > 60310
""""""

# Sub-query to filter objects with a probability of 1 of being an asteroid in the stamp classifier
probability_subquery = """"""
SELECT oid 
FROM probability 
WHERE class_name = 'asteroid' 
AND classifier_name = 'stamp_classifier' 
AND probability = 1
""""""

# Final query to join the above sub-queries and retrieve all columns from the forced_photometry table
full_query = f""""""
SELECT fp.* 
FROM forced_photometry fp
INNER JOIN ({object_subquery}) o ON fp.oid = o.oid
INNER JOIN ({probability_subquery}) p ON fp.oid = p.oid
ORDER BY o.firstmjd
LIMIT 10
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,12.578506708145142,2025-06-16T01:50:04,[None],"(psycopg2.errors.UndefinedColumn) column o.firstmjd does not exist
LINE 16: ORDER BY o.firstmjd
                  ^

[SQL: 
SELECT fp.* 
FROM forced_photometry fp
INNER JOIN (
SELECT oid 
FROM object 
WHERE firstmjd > 60310
) o ON fp.oid = o.oid
INNER JOIN (
SELECT oid 
FROM probability 
WHERE class_name = 'asteroid' 
AND classifier_name = 'stamp_classifier' 
AND probability = 1
) p ON fp.oid = p.oid
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.597546577453612,2025-06-24T22:39:47,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,99,4,"
# Sub-query to filter objects with first detection date later than MJD 60310
object_subquery = """"""
SELECT oid 
FROM object 
WHERE firstmjd > 60310
""""""

# Sub-query to filter probabilities for asteroids with probability 1 using the stamp classifier
probability_subquery = """"""
SELECT oid 
FROM probability 
WHERE class_name = 'asteroid' 
AND classifier_name = 'stamp_classifier' 
AND probability = 1
""""""

# Final query to join the sub-queries and retrieve all columns from forced_photometry
full_query = f""""""
SELECT fp.* 
FROM forced_photometry fp
INNER JOIN ({object_subquery}) o ON fp.oid = o.oid
INNER JOIN ({probability_subquery}) p ON fp.oid = p.oid
ORDER BY o.firstmjd
LIMIT 10
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,12.09075379371643,2025-06-16T01:50:16,[None],"(psycopg2.errors.UndefinedColumn) column o.firstmjd does not exist
LINE 16: ORDER BY o.firstmjd
                  ^

[SQL: 
SELECT fp.* 
FROM forced_photometry fp
INNER JOIN (
SELECT oid 
FROM object 
WHERE firstmjd > 60310
) o ON fp.oid = o.oid
INNER JOIN (
SELECT oid 
FROM probability 
WHERE class_name = 'asteroid' 
AND classifier_name = 'stamp_classifier' 
AND probability = 1
) p ON fp.oid = p.oid
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.37807846069336,2025-06-24T22:40:02,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,99,5,"
# Step 1: Filter the `object` table for objects with `firstmjd` greater than 60310
object_subquery = """"""
SELECT oid 
FROM object 
WHERE firstmjd > 60310
""""""

# Step 2: Join with `probability` table to filter objects with a probability of 1 of being an asteroid
probability_subquery = f""""""
SELECT p.oid 
FROM probability p
INNER JOIN ({object_subquery}) o ON p.oid = o.oid
WHERE p.class_name = 'asteroid' 
AND p.classifier_name = 'stamp_classifier' 
AND p.probability = 1 
AND p.ranking = 1
""""""

# Step 3: Join with `forced_photometry` table to retrieve all columns for the filtered objects
forced_photometry_subquery = f""""""
SELECT fp.* 
FROM forced_photometry fp
INNER JOIN ({probability_subquery}) po ON fp.oid = po.oid
ORDER BY fp.mjd
LIMIT 10
""""""

# Final query
full_query = forced_photometry_subquery
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,12.416192054748535,2025-06-16T01:50:29,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT fp.* 
FROM forced_photometry fp
INNER JOIN (
SELECT p.oid 
FROM probability p
INNER JOIN (
SELECT oid 
FROM object 
WHERE firstmjd > 60310
) o ON p.oid = o.oid
WHERE p.class_name = 'asteroid' 
AND p.classifier_name = 'stamp_classifier' 
AND p.probability = 1 
AND p.ranking = 1
) po ON fp.oid = po.oid
ORDER BY fp.mjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.74888968467712,2025-06-24T22:44:19,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,99,6,"
# Sub-query to filter objects based on first detection date and join with probability table
object_probability_subquery = """"""
SELECT object.oid
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd > 60310
AND probability.class_name = 'asteroid'
AND probability.classifier_name = 'stamp_classifier'
AND probability.probability = 1
ORDER BY object.firstmjd
LIMIT 10
""""""

# Final query to retrieve all columns from forced_photometry for the filtered objects
full_query = f""""""
SELECT forced_photometry.*
FROM forced_photometry
WHERE forced_photometry.oid IN ({object_probability_subquery})
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,10.85791540145874,2025-06-16T01:50:40,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,10.7995867729187,2025-06-24T22:44:35,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,99,7,"
subquery_object_probability = """"""
SELECT object.oid
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd > 60310
AND probability.class_name = 'asteroid'
AND probability.classifier_name = 'stamp_classifier'
AND probability.probability = 1
ORDER BY object.firstmjd
LIMIT 10
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,11.661874055862429,2025-06-16T01:50:52,[None],"invalid syntax (<string>, line 1)",9.91845154762268,2025-06-24T22:44:50,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,99,8,"
subquery_object_probability = """"""
SELECT object.oid
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd > 60310
AND probability.class_name = 'asteroid'
AND probability.probability = 1
AND probability.classifier_name = 'stamp_classifier'
ORDER BY object.firstmjd
LIMIT 10
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,12.633280515670776,2025-06-16T01:51:05,[None],"invalid syntax (<string>, line 1)",10.502697467803957,2025-06-24T22:45:05,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,99,9,"
subquery_object = """"""
SELECT oid 
FROM object 
WHERE firstmjd > 60310
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,16.378451108932495,2025-06-16T01:51:21,[None],"'[' was never closed (<string>, line 1)",11.513641595840454,2025-06-24T22:45:22,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,99,10,"
subquery_probability = """"""
SELECT oid 
FROM probability 
WHERE class_name = 'asteroid' 
AND classifier_name = 'stamp_classifier' 
AND probability = 1
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,21.582271099090576,2025-06-16T01:51:43,[None],"'[' was never closed (<string>, line 1)",12.520246267318726,2025-06-24T22:45:40,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,40,0,"SELECT
    oid_catalog, ra, dec, w1mpro, w2mpro,
    w1sigmpro, w2sigmpro, j_m_2mass, j_msig_2mass
FROM
    allwise
WHERE
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 0.000277778)",,,,,"[           oid_catalog         ra        dec  w1mpro  w2mpro  w1sigmpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842  13.735       0.03   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,24.02184200286865,2025-06-24T22:46:05,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,40,1,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,5.428032398223877,2025-06-16T01:51:49,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.40778136253357,2025-06-24T22:46:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,40,2,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.749850034713745,2025-06-16T01:51:53,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.342170000076294,2025-06-24T22:46:48,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,40,3,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.278043508529663,2025-06-16T01:51:57,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.551743745803831,2025-06-24T22:47:10,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,40,4,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.398689031600952,2025-06-16T01:52:01,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.666090965270996,2025-06-24T22:47:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,40,5,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.68088960647583,2025-06-16T01:52:05,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.30262303352356,2025-06-24T22:47:52,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,40,6,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.398367166519165,2025-06-16T01:52:10,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.929909944534302,2025-06-24T22:48:14,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,40,7,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.8190009593963614,2025-06-16T01:52:14,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.75754976272583,2025-06-24T22:48:35,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,40,8,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.7892236709594727,2025-06-16T01:52:18,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.030279159545898,2025-06-24T22:48:57,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,40,9,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.049093723297119,2025-06-16T01:52:22,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.913698673248293,2025-06-24T22:49:18,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,40,10,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- 1 arcsec converted to degrees
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.668725252151489,2025-06-16T01:52:26,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""q3c_radial_query""
LINE 1: ..._2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial...
                                                             ^

[SQL: SELECT     oid_catalog,     ra,     dec,     w1mpro,     w1sigmpro,     w2mpro,     w2sigmpro,     j_m_2mass,     j_msig_2massFROM     allwiseWHERE     q3c_radial_query(ra, dec, 23.6488, 30.7314, 1/3600.0) -- Ensure the function call ends with a semicolon]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.315968990325928,2025-06-24T22:49:40,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,80,0,"SELECT
    *
FROM
    xmatch
WHERE
    oid IN ('ZTF22abcmmkz','ZTF18abbufof')
    AND dist < 0.5",,,,,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,4.415410041809082,2025-06-24T22:49:45,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,80,1,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.0867233276367188,2025-06-16T01:52:29,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbuf...
                                     ^

[SQL: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')AND dist < 0.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.566672801971436,2025-06-24T22:50:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,80,2,"
query_xmatch = """"""
SELECT * 
FROM xmatch 
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof') 
AND dist < 0.5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",medium,8.83876919746399,2025-06-16T01:55:00,[None],"'[' was never closed (<string>, line 1)",11.24799132347107,2025-06-24T22:50:16,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,80,3,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.805427074432373,2025-06-16T01:55:03,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbuf...
                                     ^

[SQL: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')AND dist < 0.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.238332271575928,2025-06-24T22:50:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,80,4,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.334864377975464,2025-06-16T01:56:03,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbuf...
                                     ^

[SQL: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')  AND dist < 0.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.009474277496338,2025-06-24T22:50:46,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,80,5,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.366044759750366,2025-06-16T01:56:06,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbuf...
                                     ^

[SQL: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')  AND dist < 0.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.702088832855225,2025-06-24T22:51:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,80,6,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.8938565254211426,2025-06-16T01:56:09,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbuf...
                                     ^

[SQL: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')  AND dist < 0.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.441647052764893,2025-06-24T22:51:14,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,80,7,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.5057473182678223,2025-06-16T01:56:13,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbuf...
                                     ^

[SQL: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')  AND dist < 0.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.19852876663208,2025-06-24T22:51:28,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,80,8,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.571439981460572,2025-06-16T01:56:17,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbuf...
                                     ^

[SQL: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')  AND dist < 0.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.91771125793457,2025-06-24T22:51:43,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,80,9,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.5929110050201416,2025-06-16T01:58:48,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbuf...
                                     ^

[SQL: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')  AND dist < 0.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.337300539016724,2025-06-24T22:51:58,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,80,10,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,4.758074998855591,2025-06-16T02:12:03,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""IN""
LINE 1: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbuf...
                                     ^

[SQL: SELECT *FROM xmatchWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')  AND dist < 0.5]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.76266384124756,2025-06-24T22:52:12,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,45,0,"SELECT
    COUNT(chipsf)
FROM
    dataquality
WHERE
    oid IN ('ZTF23abjikaf','ZTF20achlced')
    AND chipsf >= 5",,,,,"[   count
0     81]",,4.717605352401733,2025-06-24T22:52:17,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,45,1,"
# Sub-query to filter dataquality table for specific object identifiers and minimum reduced chi-square value
dataquality_subquery = """"""
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
AND chipsf >= 5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,14.643436431884766,2025-06-16T02:13:58,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,10.343889474868774,2025-06-24T22:52:33,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,45,2,"
# Sub-query to filter the 'dataquality' table for the specific ZTF identifiers and reduced chi-square condition
dataquality_subquery = """"""
SELECT COUNT(*) 
FROM dataquality 
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') 
AND chipsf >= 5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,19.54676008224488,2025-06-16T02:14:18,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,10.501466035842896,2025-06-24T22:52:49,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,45,3,"
# Sub-query to filter dataquality table for specific oids and minimum reduced chi-square value
dataquality_subquery = """"""
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
AND chipsf >= 5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.012447118759155,2025-06-16T02:14:27,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,10.409173011779783,2025-06-24T22:53:04,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,45,4,"
# Sub-query to filter dataquality table for specific oids and chipsf condition
dataquality_subquery = """"""
SELECT COUNT(*)
FROM dataquality
WHERE chipsf >= 5
AND oid IN ('ZTF23abjikaf', 'ZTF20achlced')
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.742252588272097,2025-06-16T02:14:36,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,10.047531366348268,2025-06-24T22:53:18,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,45,5,"
# Step 1: Select from the 'dataquality' table and filter by 'oid' and 'chipsf'
query_step_1 = """"""
SELECT COUNT(*) 
FROM dataquality 
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') 
AND chipsf >= 5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.602808952331545,2025-06-16T02:14:46,[None],"'[' was never closed (<string>, line 1)",10.019176483154297,2025-06-24T22:53:34,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,45,6,"
# Sub-query to filter dataquality table for specific oids and chipsf condition
dataquality_subquery = """"""
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
AND chipsf >= 5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,8.454424381256104,2025-06-16T02:14:55,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,10.536624431610107,2025-06-24T22:53:49,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,45,7,"
# Sub-query to filter dataquality table based on the given conditions
dataquality_subquery = """"""
SELECT COUNT(*) 
FROM dataquality 
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') 
AND chipsf >= 5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,7.568387031555176,2025-06-16T02:15:02,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,11.460705041885376,2025-06-24T22:54:05,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,45,8,"
# Sub-query to filter dataquality table for specific oids and minimum reduced chi-square value
dataquality_subquery = """"""
SELECT COUNT(*) 
FROM dataquality 
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') 
AND chipsf >= 5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.009870767593384,2025-06-16T02:15:11,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,11.52276372909546,2025-06-24T22:54:21,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,45,9,"
# Sub-query to filter the dataquality table for the specific object identifiers and minimum reduced chi-square value
dataquality_subquery = """"""
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
AND chipsf >= 5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.978036403656006,2025-06-16T02:15:21,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,10.40729570388794,2025-06-24T22:54:37,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,45,10,"
# Step 1: Define the sub-query to filter the dataquality table based on the given conditions
dataquality_subquery = """"""
SELECT COUNT(*) 
FROM dataquality 
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') 
AND chipsf >= 5
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,8.583479642868042,2025-06-16T02:15:30,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,10.014446020126345,2025-06-24T22:54:51,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,63,0,"SELECT
    *
FROM
    probability
WHERE
    oid IN ('ZTF21aaobkmg','ZTF21aaomuka')
    AND classifier_name = 'lc_classifier'
    AND ranking <= 2
ORDER BY ranking",,,,,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,4.289581775665283,2025-06-24T22:54:56,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,1,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.247454166412353,2025-06-16T02:15:33,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.8526611328125,2025-06-24T22:55:11,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,2,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.55438232421875,2025-06-16T02:15:36,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.394390344619753,2025-06-24T22:55:25,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,3,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.382174491882324,2025-06-16T02:15:38,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,10.367411375045776,2025-06-24T22:55:40,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,4,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.511916399002075,2025-06-16T02:15:41,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.553081512451172,2025-06-24T22:55:55,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,5,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.979205369949341,2025-06-16T02:15:44,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,10.697057962417604,2025-06-24T22:56:10,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,6,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.8224873542785645,2025-06-16T02:15:47,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.519044876098633,2025-06-24T22:56:25,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,7,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.8075380325317383,2025-06-16T02:15:50,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,10.226897478103638,2025-06-24T22:56:40,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,8,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.51014256477356,2025-06-16T02:15:53,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.71830701828003,2025-06-24T22:56:55,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,9,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.413750410079956,2025-06-16T02:15:56,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.908406019210815,2025-06-24T22:57:10,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,63,10,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.937816858291626,2025-06-16T02:15:59,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,10.3464252948761,2025-06-24T22:57:25,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,,,73,0,"SELECT
    oid, ssnamenr, ssmagnr
FROM
    ss_ztf
WHERE
    oid = 'ZTF21acitntz'
",,,,,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,4.413572549819946,2025-06-24T22:57:30,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,73,1,"
SELECT 
    ss_ztf.oid AS ztf_object_identifier, 
    ss_ztf.ssnamenr AS mpc_name, 
    ss_ztf.ssmagnr AS mpc_magnitude
FROM 
    ss_ztf
WHERE 
    ss_ztf.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,3.9404804706573486,2025-06-16T02:16:03,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""ss_ztfWHERE""
LINE 1: ...name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHER...
                                                             ^

[SQL: SELECT     ss_ztf.oid AS ztf_object_identifier,     ss_ztf.ssnamenr AS mpc_name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHERE     ss_ztf.oid = 'ZTF21acitntz']
(Background on this error at: https://sqlalche.me/e/20/f405)",9.639146566390991,2025-06-24T23:35:07,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,73,2,"
SELECT 
    ss_ztf.oid, 
    ss_ztf.ssnamenr, 
    ss_ztf.ssmagnr
FROM 
    ss_ztf
WHERE 
    ss_ztf.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.9595282077789307,2025-06-16T02:16:06,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""ss_ztf""
LINE 1: ...namenr,     ss_ztf.ssmagnrFROM     objectJOIN     ss_ztf ON ...
                                                             ^

[SQL: SELECT     object.oid,     ss_ztf.ssnamenr,     ss_ztf.ssmagnrFROM     objectJOIN     ss_ztf ON object.oid = ss_ztf.oidWHERE     object.oid = 'ZTF21acitntz']
(Background on this error at: https://sqlalche.me/e/20/f405)",9.845804691314697,2025-06-24T23:35:20,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,73,3,"
SELECT 
    ss_ztf.oid AS ztf_object_identifier, 
    ss_ztf.ssnamenr AS mpc_name, 
    ss_ztf.ssmagnr AS mpc_magnitude
FROM 
    ss_ztf
WHERE 
    ss_ztf.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,5.4203040599823,2025-06-16T02:16:11,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""ss_ztfWHERE""
LINE 1: ...name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHER...
                                                             ^

[SQL: SELECT     ss_ztf.oid AS ztf_object_identifier,     ss_ztf.ssnamenr AS mpc_name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHERE     ss_ztf.oid = 'ZTF21acitntz']
(Background on this error at: https://sqlalche.me/e/20/f405)",11.0301992893219,2025-06-24T23:35:35,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,73,4,"
query_step_1 = """"""
SELECT object.oid, ss_ztf.ssnamenr, ss_ztf.ssmagnr
FROM object
INNER JOIN ss_ztf ON object.oid = ss_ztf.oid
WHERE object.oid = 'ZTF21acitntz'
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,20.887810468673703,2025-06-16T08:56:01,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,11.051594018936157,2025-06-24T23:35:51,0.0,0.0,0.3333333333333333,0.023809523809523808,0.0,0.0
0.18.1,gpt-4o,v3,73,5,"
# Sub-query to select the relevant columns from the object and ss_ztf tables
sub_query = """"""
SELECT 
    object.oid, 
    ss_ztf.ssnamenr, 
    ss_ztf.ssmagnr
FROM 
    object
INNER JOIN 
    ss_ztf ON object.oid = ss_ztf.oid
WHERE 
    object.oid = 'ZTF21acitntz'
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,16.839234352111816,2025-06-16T08:56:18,[None],"invalid syntax (<string>, line 1)",9.932436466217041,2025-06-24T23:36:04,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,73,6,"
# Sub-query to select the relevant columns from the object and ss_ztf tables
sub_query = """"""
SELECT 
    object.oid, 
    ss_ztf.ssnamenr, 
    ss_ztf.ssmagnr
FROM 
    object
INNER JOIN 
    ss_ztf ON object.oid = ss_ztf.oid
WHERE 
    object.oid = 'ZTF21acitntz'
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,12.899128913879396,2025-06-16T08:56:31,[None],"invalid syntax (<string>, line 1)",9.782031059265137,2025-06-24T23:36:17,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,73,7,"
query_step_1 = """"""
SELECT object.oid, ss_ztf.ssnamenr, ss_ztf.ssmagnr
FROM object
INNER JOIN ss_ztf ON object.oid = ss_ztf.oid
WHERE object.oid = 'ZTF21acitntz'
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,10.453405857086182,2025-06-16T08:56:42,[None],"invalid syntax (<string>, line 1)",10.143820762634277,2025-06-24T23:36:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,73,8,"
# Sub-query to select the relevant columns from the object and ss_ztf tables
sub_query = """"""
SELECT 
    object.oid, 
    ss_ztf.ssnamenr, 
    ss_ztf.ssmagnr
FROM 
    object
INNER JOIN 
    ss_ztf ON object.oid = ss_ztf.oid
WHERE 
    object.oid = 'ZTF21acitntz'
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,12.70344614982605,2025-06-16T08:56:55,[None],"invalid syntax (<string>, line 1)",10.083683013916016,2025-06-24T23:36:46,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,73,9,"
# Sub-query to select the relevant columns from the object and ss_ztf tables
sub_query = """"""
SELECT 
    object.oid, 
    ss_ztf.ssnamenr, 
    ss_ztf.ssmagnr
FROM 
    object
INNER JOIN 
    ss_ztf ON object.oid = ss_ztf.oid
WHERE 
    object.oid = 'ZTF21acitntz'
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,13.861647129058838,2025-06-16T08:57:09,[None],"invalid syntax (<string>, line 1)",7.879499673843384,2025-06-24T23:36:59,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,73,10,"
query_step_1 = """"""
SELECT object.oid, ss_ztf.ssnamenr, ss_ztf.ssmagnr
FROM object
INNER JOIN ss_ztf ON object.oid = ss_ztf.oid
WHERE object.oid = 'ZTF21acitntz'
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,17.11802864074707,2025-06-16T08:57:26,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,11.581167936325073,2025-06-24T23:37:15,0.0,0.0,0.3333333333333333,0.023809523809523808,0.0,0.0
0.18.1,,,92,0,"SELECT
    oid, classifier_version, class_name, probability
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking = 1
    AND oid in
(
SELECT
    oid
FROM
    magstat
WHERE
    fid = 1
    AND ndet >= 10
    AND ndubious = 0
ORDER BY oid
LIMIT 500
)
",,,,,"[              oid     classifier_version      class_name  probability
0    ZTF17aaaaaxb  hierarchical_rf_1.1.0  Periodic-Other     0.402136
1    ZTF17aaaaaxb   lc_classifier_1.1.13  Periodic-Other     0.378624
2    ZTF17aaaadiz  hierarchical_rf_1.1.0               E     0.282672
3    ZTF17aaaadiz   lc_classifier_1.1.13  Periodic-Other     0.258560
4    ZTF17aaaadyg  hierarchical_rf_1.1.0  Periodic-Other     0.553136
..            ...                    ...             ...          ...
932  ZTF17aaaaaas   lc_classifier_1.1.13  Periodic-Other     0.260952
933  ZTF17aaaaegw  hierarchical_rf_1.1.0             YSO     0.717024
934  ZTF17aaaaegw   lc_classifier_1.1.13             YSO     0.611064
935  ZTF17aaaabel  hierarchical_rf_1.1.0               E     0.371840
936  ZTF17aaaabel   lc_classifier_1.1.13  Periodic-Other     0.439200

[937 rows x 4 columns]]",,4.179383754730225,2025-06-24T23:37:19,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,92,1,"
# Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
object_subquery = """"""
SELECT o.oid
FROM object o
JOIN detection d ON o.oid = d.oid
WHERE d.fid = 1 AND d.dubious = FALSE
GROUP BY o.oid
HAVING COUNT(d.candid) >= 10
""""""

# Sub-query to get probabilities with ranking 1 for the light curve classifier
probability_subquery = """"""
SELECT p.oid, p.classifier_version, p.class_name, p.probability
FROM probability p
WHERE p.ranking = 1 AND p.classifier_name = 'lc_classifier'
""""""

# Final query to join the sub-queries and get the desired result
full_query = f""""""
SELECT p.oid, p.classifier_version, p.class_name, p.probability
FROM ({probability_subquery}) p
JOIN ({object_subquery}) o ON p.oid = o.oid
ORDER BY p.oid
LIMIT 500
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,18.20377898216248,2025-06-16T08:57:45,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT p.oid, p.classifier_version, p.class_name, p.probability
FROM (
SELECT p.oid, p.classifier_version, p.class_name, p.probability
FROM probability p
WHERE p.ranking = 1 AND p.classifier_name = 'lc_classifier'
) p
JOIN (
SELECT o.oid
FROM object o
JOIN detection d ON o.oid = d.oid
WHERE d.fid = 1 AND d.dubious = FALSE
GROUP BY o.oid
HAVING COUNT(d.candid) >= 10
) o ON p.oid = o.oid
ORDER BY p.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.93266654014587,2025-06-24T23:41:36,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,92,2,"
# Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
object_subquery = """"""
SELECT o.oid
FROM object o
JOIN detection d ON o.oid = d.oid
WHERE d.fid = 1 AND d.dubious = FALSE
GROUP BY o.oid
HAVING COUNT(d.candid) >= 10
""""""

# Sub-query to get the required probability information
probability_subquery = """"""
SELECT p.oid, p.classifier_version, p.class_name, p.probability
FROM probability p
WHERE p.ranking = 1 AND p.classifier_name = 'lc_classifier'
""""""

# Final query combining the sub-queries
full_query = f""""""
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM ({object_subquery}) AS o
JOIN ({probability_subquery}) AS p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,15.76963996887207,2025-06-16T08:58:01,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM (
SELECT o.oid
FROM object o
JOIN detection d ON o.oid = d.oid
WHERE d.fid = 1 AND d.dubious = FALSE
GROUP BY o.oid
HAVING COUNT(d.candid) >= 10
) AS o
JOIN (
SELECT p.oid, p.classifier_version, p.class_name, p.probability
FROM probability p
WHERE p.ranking = 1 AND p.classifier_name = 'lc_classifier'
) AS p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.97579050064087,2025-06-24T23:45:53,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,92,3,"
# Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
detection_subquery = """"""
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
""""""

# Sub-query to get the required probability information
probability_subquery = """"""
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
""""""

# Final query combining the object, detection, and probability tables
full_query = f""""""
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN ({detection_subquery}) d ON o.oid = d.oid
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.1958487033844,2025-06-16T08:58:18,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN (
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
) d ON o.oid = d.oid
INNER JOIN (
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.35764479637146,2025-06-24T23:50:11,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,92,4,"
# Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
detection_subquery = """"""
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
""""""

# Sub-query to get the most likely classification probabilities
probability_subquery = """"""
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
""""""

# Final query combining the sub-queries with the object table
full_query = f""""""
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN ({detection_subquery}) d ON o.oid = d.oid
ORDER BY o.oid
LIMIT 500
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,18.38047957420349,2025-06-16T08:58:37,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN (
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
INNER JOIN (
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
) d ON o.oid = d.oid
ORDER BY o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.43554949760437,2025-06-24T23:54:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,92,5,"
# Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
detection_subquery = """"""
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
""""""

# Sub-query to filter probabilities with ranking 1 for the light curve classifier
probability_subquery = """"""
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
""""""

# Final query to join the sub-queries and select the required columns
full_query = f""""""
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN ({detection_subquery}) d ON o.oid = d.oid
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,17.6523277759552,2025-06-16T08:58:55,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN (
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
) d ON o.oid = d.oid
INNER JOIN (
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.09667491912842,2025-06-24T23:58:48,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,92,6,"
# Sub-query to filter detections with at least 10 detections in the g band and no dubious corrections
detection_subquery = """"""
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
""""""

# Sub-query to get the most likely class probabilities for the light curve classifier
probability_subquery = """"""
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
""""""

# Final query to join the object table with the filtered detections and probabilities
full_query = f""""""
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
JOIN ({detection_subquery}) d ON o.oid = d.oid
JOIN ({probability_subquery}) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.532859086990356,2025-06-16T08:59:12,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
JOIN (
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
) d ON o.oid = d.oid
JOIN (
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.65809535980225,2025-06-25T00:03:05,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,92,7,"
# Subquery to count detections per object in the g band where dubious = FALSE
detection_count_subquery = """"""
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
""""""

# Main query to join with probability and filter based on conditions
main_query = f""""""
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
JOIN ({detection_count_subquery}) AS d ON o.oid = d.oid
JOIN probability p ON o.oid = p.oid
WHERE p.ranking = 1 AND p.classifier_name = 'lc_classifier'
ORDER BY o.oid
LIMIT 500
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.56864094734192,2025-06-16T08:59:30,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
JOIN (
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
) AS d ON o.oid = d.oid
JOIN probability p ON o.oid = p.oid
WHERE p.ranking = 1 AND p.classifier_name = 'lc_classifier'
ORDER BY o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.31775641441345,2025-06-25T00:07:23,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,92,8,"
# Subquery to filter detections in the g band with no dubious corrections and at least 10 detections
detection_subquery = """"""
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
""""""

# Main query to select the required columns from object and probability tables
main_query = f""""""
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
JOIN ({detection_subquery}) d ON o.oid = d.oid
JOIN probability p ON o.oid = p.oid
WHERE p.ranking = 1 AND p.classifier_name = 'lc_classifier'
ORDER BY o.oid
LIMIT 500
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,17.502107620239258,2025-06-16T08:59:48,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
JOIN (
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
) d ON o.oid = d.oid
JOIN probability p ON o.oid = p.oid
WHERE p.ranking = 1 AND p.classifier_name = 'lc_classifier'
ORDER BY o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.82035040855408,2025-06-25T00:11:37,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,92,9,"
# Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
detection_subquery = """"""
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
""""""

# Sub-query to filter probabilities with ranking 1 for the light curve classifier
probability_subquery = """"""
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
""""""

# Final query combining the sub-queries with the object table
full_query = f""""""
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN ({detection_subquery}) d ON o.oid = d.oid
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,16.051479816436768,2025-06-16T09:00:04,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN (
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
) d ON o.oid = d.oid
INNER JOIN (
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.23047876358032,2025-06-25T00:15:51,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,92,10,"
# Subquery 1: Filter the detection table for oids with fid = 1 and dubious = FALSE, ensuring at least 10 detections
subquery_detection = """"""
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
""""""

# Subquery 2: Filter the probability table for ranking = 1 and classifier_name = 'lc_classifier'
subquery_probability = """"""
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
""""""

# Main Query: Join the object table with the filtered detection and probability subqueries
full_query = """"""
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN ({subquery_detection}) d ON o.oid = d.oid
INNER JOIN ({subquery_probability}) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
"""""".format(subquery_detection=subquery_detection, subquery_probability=subquery_probability)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,19.97362971305847,2025-06-16T09:00:24,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT o.oid, p.classifier_version, p.class_name, p.probability
FROM object o
INNER JOIN (
SELECT oid
FROM detection
WHERE fid = 1 AND dubious = FALSE
GROUP BY oid
HAVING COUNT(*) >= 10
) d ON o.oid = d.oid
INNER JOIN (
SELECT oid, classifier_version, class_name, probability
FROM probability
WHERE ranking = 1 AND classifier_name = 'lc_classifier'
) p ON o.oid = p.oid
ORDER BY o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.88374090194702,2025-06-25T00:20:06,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,102,0,"SELECT
    *
FROM
    magstat
WHERE
    oid IN
(
SELECT
    probability.oid
FROM
    probability INNER JOIN
    xmatch
    ON probability.oid = xmatch.oid
    INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    w1mpro > 12
    AND w1mpro < 13
    AND classifier_name = 'lc_classifier'
    AND class_name = 'AGN'
    AND probability > 0.6
LIMIT 50
)",,,,,"[              oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0    ZTF19acbuwdb    1    False       True    34         2         NaN   
1    ZTF19acbuwdb    2    False       True    55         2         NaN   
2    ZTF19aaslszp    1    False       True    14         0         NaN   
3    ZTF19aaslszp    2    False       True    38         0         NaN   
4    ZTF19accprws    1    False       True   100         0         NaN   
..            ...  ...      ...        ...   ...       ...         ...   
99   ZTF18aaqrcws    2    False       True     3         0         NaN   
100  ZTF18aamdqhv    1    False       True   325         0         NaN   
101  ZTF18aamdqhv    2    False       True   242         0         NaN   
102  ZTF20aclfuhb    1    False       True    25         0         NaN   
103  ZTF20aclfuhb    2    False       True    11         0         NaN   

     dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0         NaN            NaN       NaN  ...       17.277626    17.629467   
1         NaN            NaN       NaN  ...       16.736994    16.936043   
2         NaN            NaN       NaN  ...       18.339777    18.424961   
3         NaN            NaN       NaN  ...       17.458006    17.704653   
4         NaN            NaN       NaN  ...       17.323280    17.430521   
..        ...            ...       ...  ...             ...          ...   
99        NaN            NaN       NaN  ...       16.875360    16.877518   
100       NaN            NaN       NaN  ...       17.246084    17.883020   
101       NaN            NaN       NaN  ...       17.183624    17.408785   
102       NaN            NaN       NaN  ...       16.664500    16.768790   
103       NaN            NaN       NaN  ...       16.003584    16.018919   

     magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0      17.136470       0.114029     17.136470      17.192860  58850.426   
1      16.610060       0.084905     16.610060      16.637360  58833.380   
2      18.263086       0.045689     18.313805      18.424961  60120.430   
3      17.340534       0.096294     17.387550      17.511440  58627.406   
4      16.601112       0.097823     17.425760      17.407330  58760.336   
..           ...            ...           ...            ...        ...   
99     16.854380       0.010436     16.877518      16.875360  59996.457   
100    16.928608       0.169198     17.427952      17.590567  58255.344   
101    16.573300       0.112167     17.347872      17.365288  58319.220   
102    16.646162       0.036799     16.665040            NaN  59141.460   
103    15.996751       0.009269     15.996751            NaN  59871.504   

       lastmjd  step_id_corr  saturation_rate  
0    60699.363        27.4.0              0.0  
1    60710.290        27.4.0              0.0  
2    60651.098        26.0.0              0.0  
3    60651.120        26.0.0              0.0  
4    60674.094        26.2.0              0.0  
..         ...           ...              ...  
99   60408.406        27.3.0              0.0  
100  60695.438        27.0.0              0.0  
101  60053.320        27.0.0              0.0  
102  60374.190    ALeRCE ZTF              0.0  
103  60326.230    ALeRCE ZTF              0.0  

[104 rows x 28 columns]]",,6.81818699836731,2025-06-25T00:20:13,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,102,1,"
# Sub-query to filter objects with a high probability of being an AGN
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND classifier_name = 'lc_classifier'
AND ranking = 1
AND probability > 0.6
""""""

# Sub-query to filter objects based on WISE W1 magnitude
allwise_subquery = """"""
SELECT oid_catalog AS oid
FROM allwise
WHERE w1mpro BETWEEN 12 AND 13
""""""

# Final query to join the results and retrieve all columns from the magstat table
full_query = f""""""
SELECT magstat.*
FROM magstat
INNER JOIN ({probability_subquery}) AS prob ON magstat.oid = prob.oid
INNER JOIN ({allwise_subquery}) AS wise ON magstat.oid = wise.oid
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,21.873571634292603,2025-06-16T09:00:46,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,17.35442852973938,2025-06-25T00:20:34,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,102,2,"
# Subquery to filter the probability table for AGN classification with the specified conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND classifier_name = 'lc_classifier'
AND ranking = 1
AND probability > 0.6
""""""

# Subquery to filter the allwise table for W1 magnitude between 12 and 13
allwise_subquery = """"""
SELECT oid_catalog
FROM allwise
WHERE w1mpro BETWEEN 12 AND 13
""""""

# Final query to join the results and retrieve all columns from the magstat table
full_query = f""""""
SELECT magstat.*
FROM magstat
INNER JOIN ({probability_subquery}) AS prob ON magstat.oid = prob.oid
INNER JOIN ({allwise_subquery}) AS wise ON magstat.oid = wise.oid_catalog
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,18.88718748092652,2025-06-16T09:01:06,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.622902393341064,2025-06-25T00:20:47,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,102,3,"
subquery_probability = """"""
SELECT oid 
FROM probability 
WHERE class_name = 'AGN' 
AND classifier_name = 'lc_classifier' 
AND probability > 0.6 
AND ranking = 1
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,17.5289626121521,2025-06-16T09:01:23,[None],"'[' was never closed (<string>, line 1)",10.236867904663086,2025-06-25T00:21:01,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,102,4,"
# Sub-query to filter objects with a probability larger than 0.6 of being an AGN according to the light curve classifier
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND classifier_name = 'lc_classifier'
AND probability > 0.6
AND ranking = 1
""""""

# Sub-query to filter objects with a WISE W1 magnitude between 12 and 13
allwise_subquery = """"""
SELECT oid_catalog AS oid
FROM allwise
WHERE w1mpro BETWEEN 12 AND 13
""""""

# Final query to join the sub-queries and retrieve all columns from the magstat table
full_query = f""""""
SELECT magstat.*
FROM magstat
INNER JOIN ({probability_subquery}) AS prob ON magstat.oid = prob.oid
INNER JOIN ({allwise_subquery}) AS wise ON magstat.oid = wise.oid
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,22.86651992797852,2025-06-16T09:01:46,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,10.45721960067749,2025-06-25T00:21:15,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,102,5,"
# Sub-query to filter objects with a high probability of being an AGN
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND classifier_name = 'lc_classifier'
AND probability > 0.6
AND ranking = 1
""""""

# Sub-query to filter objects based on WISE W1 magnitude
allwise_subquery = """"""
SELECT oid_catalog AS oid
FROM allwise
WHERE w1mpro BETWEEN 12 AND 13
""""""

# Final query to join the sub-queries and retrieve all columns from the magstat table
full_query = f""""""
SELECT magstat.*
FROM magstat
INNER JOIN ({probability_subquery}) AS prob ON magstat.oid = prob.oid
INNER JOIN ({allwise_subquery}) AS wise ON magstat.oid = wise.oid
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,22.31272006034851,2025-06-16T09:02:09,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.298077821731567,2025-06-25T00:21:28,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,102,6,"
# Sub-query to filter objects based on probability conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Sub-query to filter objects based on WISE W1 magnitude conditions
allwise_subquery = """"""
SELECT oid_catalog AS oid
FROM allwise
WHERE w1mpro BETWEEN 12 AND 13
""""""

# Final query to join the sub-queries and retrieve all columns from the magstat table
full_query = f""""""
SELECT magstat.*
FROM magstat
INNER JOIN ({probability_subquery}) AS prob ON magstat.oid = prob.oid
INNER JOIN ({allwise_subquery}) AS wise ON magstat.oid = wise.oid
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,19.2489025592804,2025-06-16T09:02:28,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.557831287384033,2025-06-25T00:21:42,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,102,7,"
# Sub-query to filter objects with a probability larger than 0.6 of being an AGN in the light curve classifier
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND classifier_name = 'lc_classifier'
AND probability > 0.6
AND ranking = 1
""""""

# Sub-query to filter objects with a WISE W1 magnitude between 12 and 13
allwise_subquery = """"""
SELECT oid_catalog AS oid
FROM allwise
WHERE w1mpro BETWEEN 12 AND 13
""""""

# Final query to join the results and retrieve all columns from the magstat table
full_query = f""""""
SELECT magstat.*
FROM magstat
INNER JOIN ({probability_subquery}) AS prob ON magstat.oid = prob.oid
INNER JOIN ({allwise_subquery}) AS wise ON magstat.oid = wise.oid
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,17.3172025680542,2025-06-16T09:02:46,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,11.240749835968018,2025-06-25T00:21:56,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,102,8,"
# Sub-query to filter objects with a probability greater than 0.6 of being an AGN in the light curve classifier
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND probability > 0.6
AND ranking = 1
AND classifier_name = 'lc_classifier'
""""""

# Sub-query to filter objects with WISE W1 magnitude between 12 and 13
allwise_subquery = """"""
SELECT oid_catalog AS oid
FROM allwise
WHERE w1mpro BETWEEN 12 AND 13
""""""

# Final query to join the results from the sub-queries and retrieve all columns from the magstat table
full_query = f""""""
SELECT magstat.*
FROM magstat
INNER JOIN ({probability_subquery}) AS prob ON magstat.oid = prob.oid
INNER JOIN ({allwise_subquery}) AS wise ON magstat.oid = wise.oid
LIMIT 50
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,19.305295944213867,2025-06-16T09:03:05,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,10.795329093933105,2025-06-25T00:22:11,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,102,9,"
subquery_probability = """"""
SELECT oid 
FROM probability 
WHERE class_name = 'AGN' 
AND classifier_name = 'lc_classifier' 
AND probability > 0.6 
AND ranking = 1
""""""
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,18.84740972518921,2025-06-16T09:03:24,[None],"invalid syntax (<string>, line 1)",8.68924355506897,2025-06-25T00:22:23,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,102,10,"
# Sub-query to filter objects with a probability greater than 0.6 of being an AGN according to the light curve classifier
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'AGN'
AND classifier_name = 'lc_classifier'
AND ranking = 1
AND probability > 0.6
""""""

# Sub-query to filter objects with a WISE W1 magnitude between 12 and 13
allwise_subquery = """"""
SELECT oid_catalog AS oid
FROM allwise
WHERE w1mpro BETWEEN 12 AND 13
""""""

# Final query to join the results from the sub-queries and retrieve all columns from the magstat table
full_query = """"""
SELECT magstat.*
FROM magstat
INNER JOIN ({probability_subquery}) AS prob ON magstat.oid = prob.oid
INNER JOIN ({allwise_subquery}) AS wise ON magstat.oid = wise.oid
LIMIT 50
"""""".format(probability_subquery=probability_subquery, allwise_subquery=allwise_subquery)
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,19.07527184486389,2025-06-16T09:03:44,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.579240322113037,2025-06-25T00:22:36,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,,,81,0,"SELECT
    oid, dist
FROM
    xmatch
WHERE
    oid_catalog = 'J163603.54-065228.7'",,,,,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,3.2306172847747803,2025-06-25T00:22:40,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,81,1,"
# Sub-query to select the relevant columns from the xmatch table for the specific ALLWISE object
xmatch_subquery = """"""
SELECT xmatch.oid, xmatch.dist
FROM xmatch
JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE allwise.oid_catalog = 'J163603.54-065228.7'
AND xmatch.catid = 'ALLWISE'
""""""
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,14.357345581054688,2025-06-16T09:03:58,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.171744585037231,2025-06-25T00:22:52,0.0,0.0,0.5,0.03571428571428571,0.0,0.0
0.18.1,gpt-4o,v3,81,2,"
# Sub-query to select the required columns from the xmatch table
xmatch_subquery = """"""
SELECT xmatch.oid, xmatch.dist
FROM xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE allwise.oid_catalog = 'J163603.54-065228.7'
""""""

# Final query combining all steps
full_query = xmatch_subquery
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,13.062530279159546,2025-06-16T09:04:12,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,10.392616987228394,2025-06-25T00:23:06,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,81,3,"
# Define the sub-query to select the required information from the xmatch table
sub_query_xmatch = """"""
SELECT oid, dist
FROM xmatch
WHERE oid_catalog = 'J163603.54-065228.7'
AND catid = 'ALLWISE'
""""""
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,19.981703281402588,2025-06-16T09:04:32,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,8.244099855422974,2025-06-25T00:23:18,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,81,4,"
# Sub-query to select the ZTF object identifier and distance from the xmatch table
xmatch_query = """"""
SELECT oid, dist
FROM xmatch
WHERE oid_catalog = 'J163603.54-065228.7'
AND catid = 'ALLWISE'
""""""
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.36785364151001,2025-06-16T09:04:49,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,8.402958631515503,2025-06-25T00:23:29,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,81,5,"
# Sub-query to select the relevant columns from the xmatch table
xmatch_subquery = """"""
SELECT xmatch.oid, xmatch.dist
FROM xmatch
JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE allwise.oid_catalog = 'J163603.54-065228.7' AND xmatch.catid = 'ALLWISE'
""""""

# Final query combining the sub-query
full_query = xmatch_subquery
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,14.279533624649048,2025-06-16T09:05:04,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,11.016079425811768,2025-06-25T00:23:44,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,81,6,"
# Sub-query to select relevant columns from the xmatch table and join with the allwise table
xmatch_allwise_query = """"""
SELECT xmatch.oid, xmatch.dist
FROM xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE allwise.oid_catalog = 'J163603.54-065228.7'
""""""
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,13.135518550872805,2025-06-16T09:05:17,[None],"'[' was never closed (<string>, line 1)",8.566038846969604,2025-06-25T00:23:56,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,81,7,"
# Sub-query to select the relevant columns from the xmatch table
xmatch_subquery = """"""
SELECT xmatch.oid, xmatch.dist
FROM xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE xmatch.oid_catalog = 'J163603.54-065228.7'
AND xmatch.catid = 'ALLWISE'
""""""
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,13.7387216091156,2025-06-16T09:05:31,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,7.965633392333984,2025-06-25T00:24:07,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,81,8,"
# Sub-query to select the relevant columns from the xmatch table and join with the allwise table
xmatch_allwise_query = """"""
SELECT xmatch.oid, xmatch.dist
FROM xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE allwise.oid_catalog = 'J163603.54-065228.7'
""""""
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.545315027236938,2025-06-16T09:05:44,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,8.096587657928467,2025-06-25T00:24:19,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,81,9,"
# Sub-query to select relevant columns from the xmatch table
xmatch_subquery = """"""
SELECT oid, dist
FROM xmatch
""""""

# Sub-query to filter the allwise table for the specific object identifier
allwise_filter_subquery = """"""
SELECT oid_catalog
FROM allwise
WHERE oid_catalog = 'J163603.54-065228.7'
""""""

# Final query combining the sub-queries with an INNER JOIN
full_query = f""""""
SELECT x.oid, x.dist
FROM ({xmatch_subquery}) AS x
INNER JOIN ({allwise_filter_subquery}) AS a
ON x.oid_catalog = a.oid_catalog
WHERE x.catid = 'ALLWISE'
""""""
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,16.230679512023926,2025-06-16T09:06:01,[None],"(psycopg2.errors.UndefinedColumn) column x.oid_catalog does not exist
LINE 12: ON x.oid_catalog = a.oid_catalog
            ^
HINT:  Perhaps you meant to reference the column ""a.oid_catalog"".

[SQL: 
SELECT x.oid, x.dist
FROM (
SELECT oid, dist
FROM xmatch
) AS x
INNER JOIN (
SELECT oid_catalog
FROM allwise
WHERE oid_catalog = 'J163603.54-065228.7'
) AS a
ON x.oid_catalog = a.oid_catalog
WHERE x.catid = 'ALLWISE'
]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.759751319885254,2025-06-25T00:24:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,81,10,"
# Sub-query to select the necessary columns from the xmatch table
xmatch_subquery = """"""
SELECT oid, dist
FROM xmatch
""""""

# Sub-query to filter the results based on the ALLWISE catalog identifier
allwise_filter_subquery = """"""
SELECT oid_catalog
FROM allwise
WHERE oid_catalog = 'J163603.54-065228.7'
""""""

# Final query combining the sub-queries with an INNER JOIN
full_query = f""""""
SELECT x.oid, x.dist
FROM ({xmatch_subquery}) AS x
INNER JOIN ({allwise_filter_subquery}) AS a
ON x.oid_catalog = a.oid_catalog
""""""
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,11.516954898834229,2025-06-16T09:06:12,[None],"(psycopg2.errors.UndefinedColumn) column x.oid_catalog does not exist
LINE 12: ON x.oid_catalog = a.oid_catalog
            ^
HINT:  Perhaps you meant to reference the column ""a.oid_catalog"".

[SQL: 
SELECT x.oid, x.dist
FROM (
SELECT oid, dist
FROM xmatch
) AS x
INNER JOIN (
SELECT oid_catalog
FROM allwise
WHERE oid_catalog = 'J163603.54-065228.7'
) AS a
ON x.oid_catalog = a.oid_catalog
]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.982962846755981,2025-06-25T00:24:43,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,69,0,"SELECT
    *
FROM
    ps1_ztf
WHERE
    oid IN ('ZTF21abstkhj','ZTF22aacqjeb','ZTF21aamwpdf')
    AND sgscore1 < 0.2",,,,,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,3.268503189086914,2025-06-25T00:24:47,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,1,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.7271342277526855,2025-06-16T09:06:16,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.54318904876709,2025-06-25T00:24:59,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,2,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.657652616500856,2025-06-16T09:06:20,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.634648084640503,2025-06-25T00:25:10,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,3,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.946145534515381,2025-06-16T09:06:24,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.043708086013794,2025-06-25T00:25:21,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,4,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.518930435180664,2025-06-16T09:06:28,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.733302116394043,2025-06-25T00:25:32,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,5,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,4.876144409179688,2025-06-16T09:06:34,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.716364622116089,2025-06-25T00:25:43,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,6,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.7572083473205566,2025-06-16T09:06:38,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.624694108963013,2025-06-25T00:25:54,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,7,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.02983832359314,2025-06-16T09:06:41,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.04515290260315,2025-06-25T00:26:06,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,8,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.8550500869750977,2025-06-16T09:06:44,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.291970491409302,2025-06-25T00:26:18,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,9,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.2988617420196533,2025-06-16T09:06:47,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.724233150482178,2025-06-25T00:26:29,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,69,10,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.913714408874512,2025-06-16T09:06:51,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.799785137176514,2025-06-25T00:26:40,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,,,61,0,"SELECT
    *
FROM
    magstat
WHERE
    ndet >= 10
    AND magmedian > 19
    AND maglast < 17
ORDER BY oid
LIMIT 30
",,,,,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   532         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaawgmp    1    False       True   475         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11    -0.36383   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabukrm    1    False       True   339         0         NaN   
19  ZTF17aabvdrf    2    False       True   275         0         NaN   
20  ZTF17aabxonw    2    False       True    24         0         NaN   
21  ZTF17aabyrpg    1    False       True   137         0         NaN   
22  ZTF17aaccevp    1    False       True    11         0         NaN   
23  ZTF17aacgwrb    1    False       True    38         2         NaN   
24  ZTF17aacldol    2    False       True   340         0         NaN   
25  ZTF17aacomhx    2    False       True    24         1         NaN   
26  ZTF17aadfmzp    1    False       True    11         0         NaN   
27  ZTF18aaaaofg    1    False       True   126         1         NaN   
28  ZTF18aaadqso    2    False       True   106         0         NaN   
29  ZTF18aaajdrc    1    False       True    41         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.435640   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       18.516771   100.000000   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855      -20.47397   2.96382  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       20.355993   100.000000   
19       NaN            NaN       NaN  ...       16.644870    19.223333   
20       NaN            NaN       NaN  ...       17.251135    17.346697   
21       NaN            NaN       NaN  ...       18.814323    19.148642   
22       NaN            NaN       NaN  ...       17.028027    17.059195   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       18.782711    20.460472   
25       NaN            NaN       NaN  ...             NaN          NaN   
26       NaN            NaN       NaN  ...       16.035013    16.058973   
27       NaN            NaN       NaN  ...       16.540580   100.000000   
28       NaN            NaN       NaN  ...       19.958225   100.000000   
29       NaN            NaN       NaN  ...       16.955814    17.002485   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.540014     15.853738      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    15.798027       4.227115     16.511460      20.535583  58273.460   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    15.798060       4.823264     16.889334      20.535583  58273.460   
19    16.574917       0.790544     18.732056      16.592250  58278.450   
20    16.228182       0.214038     16.228182      16.976244  58676.200   
21    13.964068       1.636876     15.538330      16.012342  58480.490   
22    15.907078       0.337792     15.907078      17.018574  59149.477   
23          NaN            NaN           NaN            NaN  58430.420   
24    15.087682       0.691946     16.486593      18.723999  58245.188   
25          NaN            NaN           NaN            NaN  58455.293   
26    15.296916       0.213511     15.296916      16.035013  59843.470   
27    16.453445       7.449521     21.514559      16.530027  58382.477   
28    14.369963       8.126190     15.869367      14.531776  58434.200   
29    15.961990       0.163007     15.961990      16.664300  58440.473   

      lastmjd  step_id_corr  saturation_rate  
0   60848.402        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.0.0              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60849.324        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60843.300        27.5.6              0.0  
19  60843.434        27.5.6              0.0  
20  60819.285        27.5.6              0.0  
21  60787.230        27.5.6              0.0  
22  60635.324        27.4.0              0.0  
23  60619.414        24.5.1              0.0  
24  60821.220        27.5.6              0.0  
25  60530.450        24.5.1              0.0  
26  60760.242        27.5.2              0.0  
27  60732.176        27.5.0              0.0  
28  60685.170        26.2.0              0.0  
29  60689.402        26.2.0              0.0  

[30 rows x 28 columns]]",,130.93675923347473,2025-06-25T00:28:51,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,61,1,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.2225165367126465,2025-06-16T09:06:54,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   532         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaawgmp    1    False       True   475         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11    -0.36383   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabukrm    1    False       True   339         0         NaN   
19  ZTF17aabvdrf    2    False       True   275         0         NaN   
20  ZTF17aabxonw    2    False       True    24         0         NaN   
21  ZTF17aabyrpg    1    False       True   137         0         NaN   
22  ZTF17aaccevp    1    False       True    11         0         NaN   
23  ZTF17aacgwrb    1    False       True    38         2         NaN   
24  ZTF17aacldol    2    False       True   340         0         NaN   
25  ZTF17aacomhx    2    False       True    24         1         NaN   
26  ZTF17aadfmzp    1    False       True    11         0         NaN   
27  ZTF18aaaaofg    1    False       True   126         1         NaN   
28  ZTF18aaadqso    2    False       True   106         0         NaN   
29  ZTF18aaajdrc    1    False       True    41         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.435640   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       18.516771   100.000000   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855      -20.47397   2.96382  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       20.355993   100.000000   
19       NaN            NaN       NaN  ...       16.644870    19.223333   
20       NaN            NaN       NaN  ...       17.251135    17.346697   
21       NaN            NaN       NaN  ...       18.814323    19.148642   
22       NaN            NaN       NaN  ...       17.028027    17.059195   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       18.782711    20.460472   
25       NaN            NaN       NaN  ...             NaN          NaN   
26       NaN            NaN       NaN  ...       16.035013    16.058973   
27       NaN            NaN       NaN  ...       16.540580   100.000000   
28       NaN            NaN       NaN  ...       19.958225   100.000000   
29       NaN            NaN       NaN  ...       16.955814    17.002485   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.540014     15.853738      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    15.798027       4.227115     16.511460      20.535583  58273.460   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    15.798060       4.823264     16.889334      20.535583  58273.460   
19    16.574917       0.790544     18.732056      16.592250  58278.450   
20    16.228182       0.214038     16.228182      16.976244  58676.200   
21    13.964068       1.636876     15.538330      16.012342  58480.490   
22    15.907078       0.337792     15.907078      17.018574  59149.477   
23          NaN            NaN           NaN            NaN  58430.420   
24    15.087682       0.691946     16.486593      18.723999  58245.188   
25          NaN            NaN           NaN            NaN  58455.293   
26    15.296916       0.213511     15.296916      16.035013  59843.470   
27    16.453445       7.449521     21.514559      16.530027  58382.477   
28    14.369963       8.126190     15.869367      14.531776  58434.200   
29    15.961990       0.163007     15.961990      16.664300  58440.473   

      lastmjd  step_id_corr  saturation_rate  
0   60848.402        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.0.0              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60849.324        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60843.300        27.5.6              0.0  
19  60843.434        27.5.6              0.0  
20  60819.285        27.5.6              0.0  
21  60787.230        27.5.6              0.0  
22  60635.324        27.4.0              0.0  
23  60619.414        24.5.1              0.0  
24  60821.220        27.5.6              0.0  
25  60530.450        24.5.1              0.0  
26  60760.242        27.5.2              0.0  
27  60732.176        27.5.0              0.0  
28  60685.170        26.2.0              0.0  
29  60689.402        26.2.0              0.0  

[30 rows x 28 columns]]",,9.359328508377075,2025-06-25T00:29:05,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,61,2,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.9353277683258057,2025-06-16T09:06:57,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT *FROM magstatWHERE ndet >= 10  AND magmedian > 19  AN...
                                       ^

[SQL: SELECT *FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.281468629837036,2025-06-25T00:29:18,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,61,3,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.204830408096313,2025-06-16T09:07:01,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   532         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaawgmp    1    False       True   475         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11    -0.36383   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabukrm    1    False       True   339         0         NaN   
19  ZTF17aabvdrf    2    False       True   275         0         NaN   
20  ZTF17aabxonw    2    False       True    24         0         NaN   
21  ZTF17aabyrpg    1    False       True   137         0         NaN   
22  ZTF17aaccevp    1    False       True    11         0         NaN   
23  ZTF17aacgwrb    1    False       True    38         2         NaN   
24  ZTF17aacldol    2    False       True   340         0         NaN   
25  ZTF17aacomhx    2    False       True    24         1         NaN   
26  ZTF17aadfmzp    1    False       True    11         0         NaN   
27  ZTF18aaaaofg    1    False       True   126         1         NaN   
28  ZTF18aaadqso    2    False       True   106         0         NaN   
29  ZTF18aaajdrc    1    False       True    41         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.435640   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       18.516771   100.000000   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855      -20.47397   2.96382  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       20.355993   100.000000   
19       NaN            NaN       NaN  ...       16.644870    19.223333   
20       NaN            NaN       NaN  ...       17.251135    17.346697   
21       NaN            NaN       NaN  ...       18.814323    19.148642   
22       NaN            NaN       NaN  ...       17.028027    17.059195   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       18.782711    20.460472   
25       NaN            NaN       NaN  ...             NaN          NaN   
26       NaN            NaN       NaN  ...       16.035013    16.058973   
27       NaN            NaN       NaN  ...       16.540580   100.000000   
28       NaN            NaN       NaN  ...       19.958225   100.000000   
29       NaN            NaN       NaN  ...       16.955814    17.002485   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.540014     15.853738      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    15.798027       4.227115     16.511460      20.535583  58273.460   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    15.798060       4.823264     16.889334      20.535583  58273.460   
19    16.574917       0.790544     18.732056      16.592250  58278.450   
20    16.228182       0.214038     16.228182      16.976244  58676.200   
21    13.964068       1.636876     15.538330      16.012342  58480.490   
22    15.907078       0.337792     15.907078      17.018574  59149.477   
23          NaN            NaN           NaN            NaN  58430.420   
24    15.087682       0.691946     16.486593      18.723999  58245.188   
25          NaN            NaN           NaN            NaN  58455.293   
26    15.296916       0.213511     15.296916      16.035013  59843.470   
27    16.453445       7.449521     21.514559      16.530027  58382.477   
28    14.369963       8.126190     15.869367      14.531776  58434.200   
29    15.961990       0.163007     15.961990      16.664300  58440.473   

      lastmjd  step_id_corr  saturation_rate  
0   60848.402        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.0.0              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60849.324        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60843.300        27.5.6              0.0  
19  60843.434        27.5.6              0.0  
20  60819.285        27.5.6              0.0  
21  60787.230        27.5.6              0.0  
22  60635.324        27.4.0              0.0  
23  60619.414        24.5.1              0.0  
24  60821.220        27.5.6              0.0  
25  60530.450        24.5.1              0.0  
26  60760.242        27.5.2              0.0  
27  60732.176        27.5.0              0.0  
28  60685.170        26.2.0              0.0  
29  60689.402        26.2.0              0.0  

[30 rows x 28 columns]]",,9.312362909317017,2025-06-25T00:29:32,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,61,4,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.710182905197144,2025-06-16T09:07:05,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   532         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaawgmp    1    False       True   475         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11    -0.36383   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabukrm    1    False       True   339         0         NaN   
19  ZTF17aabvdrf    2    False       True   275         0         NaN   
20  ZTF17aabxonw    2    False       True    24         0         NaN   
21  ZTF17aabyrpg    1    False       True   137         0         NaN   
22  ZTF17aaccevp    1    False       True    11         0         NaN   
23  ZTF17aacgwrb    1    False       True    38         2         NaN   
24  ZTF17aacldol    2    False       True   340         0         NaN   
25  ZTF17aacomhx    2    False       True    24         1         NaN   
26  ZTF17aadfmzp    1    False       True    11         0         NaN   
27  ZTF18aaaaofg    1    False       True   126         1         NaN   
28  ZTF18aaadqso    2    False       True   106         0         NaN   
29  ZTF18aaajdrc    1    False       True    41         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.435640   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       18.516771   100.000000   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855      -20.47397   2.96382  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       20.355993   100.000000   
19       NaN            NaN       NaN  ...       16.644870    19.223333   
20       NaN            NaN       NaN  ...       17.251135    17.346697   
21       NaN            NaN       NaN  ...       18.814323    19.148642   
22       NaN            NaN       NaN  ...       17.028027    17.059195   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       18.782711    20.460472   
25       NaN            NaN       NaN  ...             NaN          NaN   
26       NaN            NaN       NaN  ...       16.035013    16.058973   
27       NaN            NaN       NaN  ...       16.540580   100.000000   
28       NaN            NaN       NaN  ...       19.958225   100.000000   
29       NaN            NaN       NaN  ...       16.955814    17.002485   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.540014     15.853738      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    15.798027       4.227115     16.511460      20.535583  58273.460   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    15.798060       4.823264     16.889334      20.535583  58273.460   
19    16.574917       0.790544     18.732056      16.592250  58278.450   
20    16.228182       0.214038     16.228182      16.976244  58676.200   
21    13.964068       1.636876     15.538330      16.012342  58480.490   
22    15.907078       0.337792     15.907078      17.018574  59149.477   
23          NaN            NaN           NaN            NaN  58430.420   
24    15.087682       0.691946     16.486593      18.723999  58245.188   
25          NaN            NaN           NaN            NaN  58455.293   
26    15.296916       0.213511     15.296916      16.035013  59843.470   
27    16.453445       7.449521     21.514559      16.530027  58382.477   
28    14.369963       8.126190     15.869367      14.531776  58434.200   
29    15.961990       0.163007     15.961990      16.664300  58440.473   

      lastmjd  step_id_corr  saturation_rate  
0   60848.402        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.0.0              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60849.324        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60843.300        27.5.6              0.0  
19  60843.434        27.5.6              0.0  
20  60819.285        27.5.6              0.0  
21  60787.230        27.5.6              0.0  
22  60635.324        27.4.0              0.0  
23  60619.414        24.5.1              0.0  
24  60821.220        27.5.6              0.0  
25  60530.450        24.5.1              0.0  
26  60760.242        27.5.2              0.0  
27  60732.176        27.5.0              0.0  
28  60685.170        26.2.0              0.0  
29  60689.402        26.2.0              0.0  

[30 rows x 28 columns]]",,9.357787370681763,2025-06-25T00:29:45,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,61,5,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.7651689052581774,2025-06-16T09:07:09,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   532         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaawgmp    1    False       True   475         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11    -0.36383   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabukrm    1    False       True   339         0         NaN   
19  ZTF17aabvdrf    2    False       True   275         0         NaN   
20  ZTF17aabxonw    2    False       True    24         0         NaN   
21  ZTF17aabyrpg    1    False       True   137         0         NaN   
22  ZTF17aaccevp    1    False       True    11         0         NaN   
23  ZTF17aacgwrb    1    False       True    38         2         NaN   
24  ZTF17aacldol    2    False       True   340         0         NaN   
25  ZTF17aacomhx    2    False       True    24         1         NaN   
26  ZTF17aadfmzp    1    False       True    11         0         NaN   
27  ZTF18aaaaofg    1    False       True   126         1         NaN   
28  ZTF18aaadqso    2    False       True   106         0         NaN   
29  ZTF18aaajdrc    1    False       True    41         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.435640   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       18.516771   100.000000   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855      -20.47397   2.96382  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       20.355993   100.000000   
19       NaN            NaN       NaN  ...       16.644870    19.223333   
20       NaN            NaN       NaN  ...       17.251135    17.346697   
21       NaN            NaN       NaN  ...       18.814323    19.148642   
22       NaN            NaN       NaN  ...       17.028027    17.059195   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       18.782711    20.460472   
25       NaN            NaN       NaN  ...             NaN          NaN   
26       NaN            NaN       NaN  ...       16.035013    16.058973   
27       NaN            NaN       NaN  ...       16.540580   100.000000   
28       NaN            NaN       NaN  ...       19.958225   100.000000   
29       NaN            NaN       NaN  ...       16.955814    17.002485   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.540014     15.853738      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    15.798027       4.227115     16.511460      20.535583  58273.460   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    15.798060       4.823264     16.889334      20.535583  58273.460   
19    16.574917       0.790544     18.732056      16.592250  58278.450   
20    16.228182       0.214038     16.228182      16.976244  58676.200   
21    13.964068       1.636876     15.538330      16.012342  58480.490   
22    15.907078       0.337792     15.907078      17.018574  59149.477   
23          NaN            NaN           NaN            NaN  58430.420   
24    15.087682       0.691946     16.486593      18.723999  58245.188   
25          NaN            NaN           NaN            NaN  58455.293   
26    15.296916       0.213511     15.296916      16.035013  59843.470   
27    16.453445       7.449521     21.514559      16.530027  58382.477   
28    14.369963       8.126190     15.869367      14.531776  58434.200   
29    15.961990       0.163007     15.961990      16.664300  58440.473   

      lastmjd  step_id_corr  saturation_rate  
0   60848.402        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.0.0              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60849.324        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60843.300        27.5.6              0.0  
19  60843.434        27.5.6              0.0  
20  60819.285        27.5.6              0.0  
21  60787.230        27.5.6              0.0  
22  60635.324        27.4.0              0.0  
23  60619.414        24.5.1              0.0  
24  60821.220        27.5.6              0.0  
25  60530.450        24.5.1              0.0  
26  60760.242        27.5.2              0.0  
27  60732.176        27.5.0              0.0  
28  60685.170        26.2.0              0.0  
29  60689.402        26.2.0              0.0  

[30 rows x 28 columns]]",,9.44733214378357,2025-06-25T00:29:59,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,61,6,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.207560539245605,2025-06-16T09:07:12,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   532         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaawgmp    1    False       True   475         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11    -0.36383   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabukrm    1    False       True   339         0         NaN   
19  ZTF17aabvdrf    2    False       True   275         0         NaN   
20  ZTF17aabxonw    2    False       True    24         0         NaN   
21  ZTF17aabyrpg    1    False       True   137         0         NaN   
22  ZTF17aaccevp    1    False       True    11         0         NaN   
23  ZTF17aacgwrb    1    False       True    38         2         NaN   
24  ZTF17aacldol    2    False       True   340         0         NaN   
25  ZTF17aacomhx    2    False       True    24         1         NaN   
26  ZTF17aadfmzp    1    False       True    11         0         NaN   
27  ZTF18aaaaofg    1    False       True   126         1         NaN   
28  ZTF18aaadqso    2    False       True   106         0         NaN   
29  ZTF18aaajdrc    1    False       True    41         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.435640   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       18.516771   100.000000   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855      -20.47397   2.96382  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       20.355993   100.000000   
19       NaN            NaN       NaN  ...       16.644870    19.223333   
20       NaN            NaN       NaN  ...       17.251135    17.346697   
21       NaN            NaN       NaN  ...       18.814323    19.148642   
22       NaN            NaN       NaN  ...       17.028027    17.059195   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       18.782711    20.460472   
25       NaN            NaN       NaN  ...             NaN          NaN   
26       NaN            NaN       NaN  ...       16.035013    16.058973   
27       NaN            NaN       NaN  ...       16.540580   100.000000   
28       NaN            NaN       NaN  ...       19.958225   100.000000   
29       NaN            NaN       NaN  ...       16.955814    17.002485   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.540014     15.853738      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    15.798027       4.227115     16.511460      20.535583  58273.460   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    15.798060       4.823264     16.889334      20.535583  58273.460   
19    16.574917       0.790544     18.732056      16.592250  58278.450   
20    16.228182       0.214038     16.228182      16.976244  58676.200   
21    13.964068       1.636876     15.538330      16.012342  58480.490   
22    15.907078       0.337792     15.907078      17.018574  59149.477   
23          NaN            NaN           NaN            NaN  58430.420   
24    15.087682       0.691946     16.486593      18.723999  58245.188   
25          NaN            NaN           NaN            NaN  58455.293   
26    15.296916       0.213511     15.296916      16.035013  59843.470   
27    16.453445       7.449521     21.514559      16.530027  58382.477   
28    14.369963       8.126190     15.869367      14.531776  58434.200   
29    15.961990       0.163007     15.961990      16.664300  58440.473   

      lastmjd  step_id_corr  saturation_rate  
0   60848.402        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.0.0              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60849.324        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60843.300        27.5.6              0.0  
19  60843.434        27.5.6              0.0  
20  60819.285        27.5.6              0.0  
21  60787.230        27.5.6              0.0  
22  60635.324        27.4.0              0.0  
23  60619.414        24.5.1              0.0  
24  60821.220        27.5.6              0.0  
25  60530.450        24.5.1              0.0  
26  60760.242        27.5.2              0.0  
27  60732.176        27.5.0              0.0  
28  60685.170        26.2.0              0.0  
29  60689.402        26.2.0              0.0  

[30 rows x 28 columns]]",,9.434480905532837,2025-06-25T00:30:13,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,61,7,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.0531721115112305,2025-06-16T09:07:16,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT *FROM magstatWHERE ndet >= 10  AND magmedian > 19  AN...
                                       ^

[SQL: SELECT *FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.38840651512146,2025-06-25T00:30:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,61,8,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.081967830657959,2025-06-16T09:07:19,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   532         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaawgmp    1    False       True   475         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11    -0.36383   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabukrm    1    False       True   339         0         NaN   
19  ZTF17aabvdrf    2    False       True   275         0         NaN   
20  ZTF17aabxonw    2    False       True    24         0         NaN   
21  ZTF17aabyrpg    1    False       True   137         0         NaN   
22  ZTF17aaccevp    1    False       True    11         0         NaN   
23  ZTF17aacgwrb    1    False       True    38         2         NaN   
24  ZTF17aacldol    2    False       True   340         0         NaN   
25  ZTF17aacomhx    2    False       True    24         1         NaN   
26  ZTF17aadfmzp    1    False       True    11         0         NaN   
27  ZTF18aaaaofg    1    False       True   126         1         NaN   
28  ZTF18aaadqso    2    False       True   106         0         NaN   
29  ZTF18aaajdrc    1    False       True    41         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.435640   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       18.516771   100.000000   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855      -20.47397   2.96382  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       20.355993   100.000000   
19       NaN            NaN       NaN  ...       16.644870    19.223333   
20       NaN            NaN       NaN  ...       17.251135    17.346697   
21       NaN            NaN       NaN  ...       18.814323    19.148642   
22       NaN            NaN       NaN  ...       17.028027    17.059195   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       18.782711    20.460472   
25       NaN            NaN       NaN  ...             NaN          NaN   
26       NaN            NaN       NaN  ...       16.035013    16.058973   
27       NaN            NaN       NaN  ...       16.540580   100.000000   
28       NaN            NaN       NaN  ...       19.958225   100.000000   
29       NaN            NaN       NaN  ...       16.955814    17.002485   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.540014     15.853738      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    15.798027       4.227115     16.511460      20.535583  58273.460   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    15.798060       4.823264     16.889334      20.535583  58273.460   
19    16.574917       0.790544     18.732056      16.592250  58278.450   
20    16.228182       0.214038     16.228182      16.976244  58676.200   
21    13.964068       1.636876     15.538330      16.012342  58480.490   
22    15.907078       0.337792     15.907078      17.018574  59149.477   
23          NaN            NaN           NaN            NaN  58430.420   
24    15.087682       0.691946     16.486593      18.723999  58245.188   
25          NaN            NaN           NaN            NaN  58455.293   
26    15.296916       0.213511     15.296916      16.035013  59843.470   
27    16.453445       7.449521     21.514559      16.530027  58382.477   
28    14.369963       8.126190     15.869367      14.531776  58434.200   
29    15.961990       0.163007     15.961990      16.664300  58440.473   

      lastmjd  step_id_corr  saturation_rate  
0   60848.402        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.0.0              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60849.324        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60843.300        27.5.6              0.0  
19  60843.434        27.5.6              0.0  
20  60819.285        27.5.6              0.0  
21  60787.230        27.5.6              0.0  
22  60635.324        27.4.0              0.0  
23  60619.414        24.5.1              0.0  
24  60821.220        27.5.6              0.0  
25  60530.450        24.5.1              0.0  
26  60760.242        27.5.2              0.0  
27  60732.176        27.5.0              0.0  
28  60685.170        26.2.0              0.0  
29  60689.402        26.2.0              0.0  

[30 rows x 28 columns]]",,9.2318274974823,2025-06-25T00:30:40,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,61,9,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.9917244911193848,2025-06-16T09:07:23,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   532         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaawgmp    1    False       True   475         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11    -0.36383   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabukrm    1    False       True   339         0         NaN   
19  ZTF17aabvdrf    2    False       True   275         0         NaN   
20  ZTF17aabxonw    2    False       True    24         0         NaN   
21  ZTF17aabyrpg    1    False       True   137         0         NaN   
22  ZTF17aaccevp    1    False       True    11         0         NaN   
23  ZTF17aacgwrb    1    False       True    38         2         NaN   
24  ZTF17aacldol    2    False       True   340         0         NaN   
25  ZTF17aacomhx    2    False       True    24         1         NaN   
26  ZTF17aadfmzp    1    False       True    11         0         NaN   
27  ZTF18aaaaofg    1    False       True   126         1         NaN   
28  ZTF18aaadqso    2    False       True   106         0         NaN   
29  ZTF18aaajdrc    1    False       True    41         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.435640   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       18.516771   100.000000   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855      -20.47397   2.96382  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       20.355993   100.000000   
19       NaN            NaN       NaN  ...       16.644870    19.223333   
20       NaN            NaN       NaN  ...       17.251135    17.346697   
21       NaN            NaN       NaN  ...       18.814323    19.148642   
22       NaN            NaN       NaN  ...       17.028027    17.059195   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       18.782711    20.460472   
25       NaN            NaN       NaN  ...             NaN          NaN   
26       NaN            NaN       NaN  ...       16.035013    16.058973   
27       NaN            NaN       NaN  ...       16.540580   100.000000   
28       NaN            NaN       NaN  ...       19.958225   100.000000   
29       NaN            NaN       NaN  ...       16.955814    17.002485   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.540014     15.853738      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    15.798027       4.227115     16.511460      20.535583  58273.460   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    15.798060       4.823264     16.889334      20.535583  58273.460   
19    16.574917       0.790544     18.732056      16.592250  58278.450   
20    16.228182       0.214038     16.228182      16.976244  58676.200   
21    13.964068       1.636876     15.538330      16.012342  58480.490   
22    15.907078       0.337792     15.907078      17.018574  59149.477   
23          NaN            NaN           NaN            NaN  58430.420   
24    15.087682       0.691946     16.486593      18.723999  58245.188   
25          NaN            NaN           NaN            NaN  58455.293   
26    15.296916       0.213511     15.296916      16.035013  59843.470   
27    16.453445       7.449521     21.514559      16.530027  58382.477   
28    14.369963       8.126190     15.869367      14.531776  58434.200   
29    15.961990       0.163007     15.961990      16.664300  58440.473   

      lastmjd  step_id_corr  saturation_rate  
0   60848.402        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.0.0              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60849.324        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60843.300        27.5.6              0.0  
19  60843.434        27.5.6              0.0  
20  60819.285        27.5.6              0.0  
21  60787.230        27.5.6              0.0  
22  60635.324        27.4.0              0.0  
23  60619.414        24.5.1              0.0  
24  60821.220        27.5.6              0.0  
25  60530.450        24.5.1              0.0  
26  60760.242        27.5.2              0.0  
27  60732.176        27.5.0              0.0  
28  60685.170        26.2.0              0.0  
29  60689.402        26.2.0              0.0  

[30 rows x 28 columns]]",,9.35874342918396,2025-06-25T00:30:53,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,61,10,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,4.016896724700928,2025-06-16T09:07:27,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   532         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaawgmp    1    False       True   475         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11    -0.36383   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabukrm    1    False       True   339         0         NaN   
19  ZTF17aabvdrf    2    False       True   275         0         NaN   
20  ZTF17aabxonw    2    False       True    24         0         NaN   
21  ZTF17aabyrpg    1    False       True   137         0         NaN   
22  ZTF17aaccevp    1    False       True    11         0         NaN   
23  ZTF17aacgwrb    1    False       True    38         2         NaN   
24  ZTF17aacldol    2    False       True   340         0         NaN   
25  ZTF17aacomhx    2    False       True    24         1         NaN   
26  ZTF17aadfmzp    1    False       True    11         0         NaN   
27  ZTF18aaaaofg    1    False       True   126         1         NaN   
28  ZTF18aaadqso    2    False       True   106         0         NaN   
29  ZTF18aaajdrc    1    False       True    41         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.435640   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       18.516771   100.000000   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855      -20.47397   2.96382  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       20.355993   100.000000   
19       NaN            NaN       NaN  ...       16.644870    19.223333   
20       NaN            NaN       NaN  ...       17.251135    17.346697   
21       NaN            NaN       NaN  ...       18.814323    19.148642   
22       NaN            NaN       NaN  ...       17.028027    17.059195   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       18.782711    20.460472   
25       NaN            NaN       NaN  ...             NaN          NaN   
26       NaN            NaN       NaN  ...       16.035013    16.058973   
27       NaN            NaN       NaN  ...       16.540580   100.000000   
28       NaN            NaN       NaN  ...       19.958225   100.000000   
29       NaN            NaN       NaN  ...       16.955814    17.002485   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.540014     15.853738      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    15.798027       4.227115     16.511460      20.535583  58273.460   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    15.798060       4.823264     16.889334      20.535583  58273.460   
19    16.574917       0.790544     18.732056      16.592250  58278.450   
20    16.228182       0.214038     16.228182      16.976244  58676.200   
21    13.964068       1.636876     15.538330      16.012342  58480.490   
22    15.907078       0.337792     15.907078      17.018574  59149.477   
23          NaN            NaN           NaN            NaN  58430.420   
24    15.087682       0.691946     16.486593      18.723999  58245.188   
25          NaN            NaN           NaN            NaN  58455.293   
26    15.296916       0.213511     15.296916      16.035013  59843.470   
27    16.453445       7.449521     21.514559      16.530027  58382.477   
28    14.369963       8.126190     15.869367      14.531776  58434.200   
29    15.961990       0.163007     15.961990      16.664300  58440.473   

      lastmjd  step_id_corr  saturation_rate  
0   60848.402        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.0.0              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60849.324        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60843.300        27.5.6              0.0  
19  60843.434        27.5.6              0.0  
20  60819.285        27.5.6              0.0  
21  60787.230        27.5.6              0.0  
22  60635.324        27.4.0              0.0  
23  60619.414        24.5.1              0.0  
24  60821.220        27.5.6              0.0  
25  60530.450        24.5.1              0.0  
26  60760.242        27.5.2              0.0  
27  60732.176        27.5.0              0.0  
28  60685.170        26.2.0              0.0  
29  60689.402        26.2.0              0.0  

[30 rows x 28 columns]]",,9.580052614212036,2025-06-25T00:31:07,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,,,104,0,"SELECT
    sq1.oid,
    ss_ztf.candid, ss_ztf.ssdistnr, ss_ztf.ssmagnr,
    ss_ztf.ssnamenr, dataquality.fid,
    dataquality.fwhm, dataquality.nmatches,
    dataquality.exptime
FROM
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.9
    AND classifier_version = 'stamp_classifier_1.0.4'
LIMIT 30
) as sq1
INNER JOIN
ss_ztf
ON sq1.oid = ss_ztf.oid
INNER JOIN
dataquality
ON ss_ztf.oid = dataquality.oid
AND ss_ztf.candid = dataquality.candid",,,,,"[             oid               candid  ssdistnr  ssmagnr ssnamenr  fid  \
0   ZTF21abiqtce  1642187814715015011       0.0     19.2    46590    2   
1   ZTF21abiqtch  1642187814715015001       0.0     20.2    43053    2   
2   ZTF21abiqter  1642187333015015003       0.0     19.2    31627    2   
3   ZTF21abiqtfd  1642187815715015004       0.0     19.8    99956    2   
4   ZTF21abiqtfq  1642187810815015010       0.0     19.6    95240    2   
5   ZTF21abiqtdq  1642187813415015016       0.0     19.7    90203    2   
6   ZTF21abiqteb  1642187330415015005       0.0     19.7    49011    2   
7   ZTF21abiqthd  1642187332615015001       0.0     19.7    50206    2   
8   ZTF21abiqtgw  1642187334715015015       0.0     20.0    84185    2   
9   ZTF21abiqthy  1642187810415015009       0.0     19.9    15413    2   
10  ZTF21abiqtjj  1642187812915015015       0.0     20.0   104588    2   
11  ZTF21abiqtpp  1642188425415015000       0.0     19.5    45799    2   
12  ZTF21abiqtco  1642187332815015005       0.0     19.2    16429    2   
13  ZTF21abiqthe  1642187332615015000       0.0     19.8    49544    2   
14  ZTF21abiqtkx  1642187332915015013       0.0     19.6    26316    2   
15  ZTF21abiqtnb  1642187334415015010       0.0     20.4   427804    2   
16  ZTF21abiqtnz  1642187812115015015       0.0     20.5    89670    2   
17  ZTF21abiqtps  1642187334115015000       0.0     19.5    53383    2   
18  ZTF21abiqtbe  1642187334615015007       0.0     19.8    79515    2   
19  ZTF21abiqteh  1642187331215015007       0.0     16.2     1056    2   
20  ZTF21abiqtgg  1642187335515015006       0.0     20.6   231452    2   
21  ZTF21abiqtiv  1642187334315015015       0.0     19.9    94465    2   
22  ZTF21abiqtkn  1642187335715015002       0.0     19.6   108203    2   
23  ZTF21abiqtkw  1642187332915015011       0.0     18.8    14295    2   
24  ZTF21abiqtob  1642187816115015009       0.0     19.8   138479    2   
25  ZTF21abiqtrf  1642188422115015014       0.0     18.2    11192    2   
26  ZTF21abiqtqj  1642187330615015003       0.0     20.5    64508    2   
27  ZTF21abiqtan  1642187330515015010       0.0     19.6    76897    2   
28  ZTF21abiqtbs  1642187813015015002       0.0     20.1    38199    2   
29  ZTF21abiqtaw  1642187336315015001       0.0     19.6    75778    2   

        fwhm  nmatches  exptime  
0   1.930000       363     30.0  
1   2.010000       363     30.0  
2   2.020000       428     30.0  
3   2.200000       312     30.0  
4   1.980000       367     30.0  
5   1.720000       330     30.0  
6   1.670000       431     30.0  
7   1.730000       438     30.0  
8   2.750000       475     30.0  
9   1.660000       386     30.0  
10  2.530000       376     30.0  
11  1.660000      1449     30.0  
12  2.630000       479     30.0  
13  2.280000       438     30.0  
14  2.740000       398     30.0  
15  1.650000       412     30.0  
16  1.114006       361     30.0  
17  2.270000       418     30.0  
18  2.550000       417     30.0  
19  2.150000       430     30.0  
20  2.250000       383     30.0  
21  2.120000       467     30.0  
22  1.930000       446     30.0  
23  2.560000       398     30.0  
24  2.080000       300     30.0  
25  2.040000      1712     30.0  
26  1.089646       433     30.0  
27  1.670000       444     30.0  
28  1.750000       352     30.0  
29  2.360000       448     30.0  ]",,3.4353156089782715,2025-06-25T00:31:11,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,104,1,"
# Subquery to filter probability table for objects classified as 'asteroid' with probability > 0.9
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
""""""

# Final query to join with object, ss_ztf, and detection tables
full_query = f""""""
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_identifier,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    ({probability_subquery}) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.70476126670837,2025-06-16T09:39:14,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_identifier,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.58040165901184,2025-06-25T00:31:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,104,2,"
# Subquery to filter probability table for objects with class_name 'asteroid', classifier_name 'stamp_classifier', classifier_version 'stamp_classifier_1.0.4', and probability > 0.9
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
""""""

# Final query to join the necessary tables and retrieve the required columns
full_query = """"""
SELECT 
    o.oid AS ztf_object_id,
    d.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    pz.nmtchps AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    object o
INNER JOIN 
    ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ps1_ztf pz ON o.oid = pz.oid AND d.candid = pz.candid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,21.40079355239868,2025-06-16T09:39:35,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""{""
LINE 15:     ({probability_subquery}) p ON o.oid = p.oid
              ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    d.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    pz.nmtchps AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    object o
INNER JOIN 
    ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ps1_ztf pz ON o.oid = pz.oid AND d.candid = pz.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.102024555206299,2025-06-25T00:31:40,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,104,3,"
# Subquery to filter objects in the probability table with the specified conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
""""""

# Final query to join all necessary tables and retrieve the required columns
full_query = f""""""
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    ({probability_subquery}) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,39.32926654815674,2025-06-16T09:40:15,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.795527935028076,2025-06-25T00:31:58,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,104,4,"
# Subquery to filter objects with a probability greater than 0.9 of being an asteroid using the 'stamp_classifier_1.0.4'
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
""""""

# Final query to join the necessary tables and retrieve the required columns
full_query = """"""
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_sso,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_sso_name,
    d.fid AS filter_id,
    d.magpsf AS fwhm_sextractor,  -- Assuming magpsf is used as a proxy for FWHM
    pz.nmtchps AS num_ps1_calibrators,  -- Assuming nmtchps is the number of PS1 calibrators
    d.exptime AS exposure_time  -- Assuming exptime is the exposure time
FROM 
    object o
INNER JOIN 
    ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ps1_ztf pz ON o.oid = pz.oid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,28.938411712646484,2025-06-16T09:40:44,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""{""
LINE 15:     ({probability_subquery}) p ON o.oid = p.oid
              ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_sso,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_sso_name,
    d.fid AS filter_id,
    d.magpsf AS fwhm_sextractor,  -- Assuming magpsf is used as a proxy for FWHM
    pz.nmtchps AS num_ps1_calibrators,  -- Assuming nmtchps is the number of PS1 calibrators
    d.exptime AS exposure_time  -- Assuming exptime is the exposure time
FROM 
    object o
INNER JOIN 
    ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ps1_ztf pz ON o.oid = pz.oid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.49829912185669,2025-06-25T00:32:14,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,104,5,"
# Subquery to filter objects with a high probability of being an asteroid
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
""""""

# Main query to retrieve the required information
main_query = f""""""
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_to_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.nid AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
INNER JOIN detection d ON o.oid = d.oid
LIMIT 30
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,26.664358377456665,2025-06-16T09:41:11,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_to_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.nid AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
INNER JOIN detection d ON o.oid = d.oid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.402220249176025,2025-06-25T00:32:30,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,104,6,"
# Subquery to filter oids from the probability table
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.9
  AND ranking = 1
""""""

# Final query to join all necessary tables and retrieve the required columns
full_query = f""""""
SELECT o.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr, d.fid, d.fwhm, d.ncalib, d.exptime
FROM ({probability_subquery}) AS p
INNER JOIN object o ON p.oid = o.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
INNER JOIN detection d ON s.candid = d.candid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,33.31720352172852,2025-06-16T09:41:44,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 2: ...candid, s.ssdistnr, s.ssmagnr, s.ssnamenr, d.fid, d.fwhm, d....
                                                             ^

[SQL: 
SELECT o.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr, d.fid, d.fwhm, d.ncalib, d.exptime
FROM (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.9
  AND ranking = 1
) AS p
INNER JOIN object o ON p.oid = o.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
INNER JOIN detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.061640739440918,2025-06-25T00:32:42,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,104,7,"
# Subquery to filter objects with a high probability of being an asteroid
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
""""""

# Main query to retrieve the required information
main_query = f""""""
SELECT 
    o.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.fwhm, 
    d.ncalib, 
    d.exptime
FROM 
    object o
INNER JOIN 
    ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
LIMIT 30
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,33.77779054641724,2025-06-16T09:42:18,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm, 
            ^

[SQL: 
SELECT 
    o.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.fwhm, 
    d.ncalib, 
    d.exptime
FROM 
    object o
INNER JOIN 
    (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.904898881912231,2025-06-25T00:32:56,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,104,8,"
# Subquery to filter objects with the specified probability conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.9
  AND ranking = 1
""""""

# Final query to join all necessary tables and retrieve the required columns
full_query = f""""""
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    ({probability_subquery}) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.760040760040283,2025-06-16T09:42:43,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.9
  AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.151479244232178,2025-06-25T00:33:11,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,104,9,"
# Subquery to filter objects with a probability greater than 0.9 for being an asteroid
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
""""""

# Main query to retrieve the required information
full_query = f""""""
SELECT 
    object.oid AS ztf_identifier,
    ss_ztf.candid AS candidate_identifier,
    ss_ztf.ssdistnr AS distance_to_nearest_solar_system_object,
    ss_ztf.ssmagnr AS mpc_archive_magnitude,
    ss_ztf.ssnamenr AS mpc_archive_name,
    detection.fid AS filter_identifier,
    detection.fwhm AS fwhm_from_sextractor,
    detection.ncalib AS number_of_ps1_calibrators_used,
    detection.exptime AS exposure_time
FROM object
INNER JOIN ({probability_subquery}) AS prob_filtered ON object.oid = prob_filtered.oid
INNER JOIN ss_ztf ON object.oid = ss_ztf.oid
INNER JOIN detection ON object.oid = detection.oid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.469566345214844,2025-06-16T09:43:07,[None],"(psycopg2.errors.UndefinedColumn) column detection.fwhm does not exist
LINE 9:     detection.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    object.oid AS ztf_identifier,
    ss_ztf.candid AS candidate_identifier,
    ss_ztf.ssdistnr AS distance_to_nearest_solar_system_object,
    ss_ztf.ssmagnr AS mpc_archive_magnitude,
    ss_ztf.ssnamenr AS mpc_archive_name,
    detection.fid AS filter_identifier,
    detection.fwhm AS fwhm_from_sextractor,
    detection.ncalib AS number_of_ps1_calibrators_used,
    detection.exptime AS exposure_time
FROM object
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.9
AND ranking = 1
) AS prob_filtered ON object.oid = prob_filtered.oid
INNER JOIN ss_ztf ON object.oid = ss_ztf.oid
INNER JOIN detection ON object.oid = detection.oid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.05893588066101,2025-06-25T00:33:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,104,10,"
# Subquery to filter objects with a probability greater than 0.9 of being an asteroid
probability_subquery = """"""
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
""""""

# Final query to retrieve the required information
full_query = f""""""
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators,
    d.exptime AS exposure_time
FROM 
    ({probability_subquery}) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.59845781326294,2025-06-16T09:43:29,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.935823202133179,2025-06-25T00:33:40,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,71,0,"SELECT
    rfid, oid, candid, magnr, sigmagnr
FROM
    reference
WHERE
    oid IN ('ZTF20aczxeud','ZTF21aappfdu','ZTF22aacqjeb')
    AND fid = 1
ORDER BY oid",,,,,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,3.228459119796753,2025-06-25T00:33:43,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,71,1,"
# Sub-query to select the required columns from the 'reference' table for specific ZTF identifiers and 'g' band
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,17.51957678794861,2025-06-16T09:43:47,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.68610692024231,2025-06-25T00:33:56,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,71,2,"
# Define the sub-query to filter the reference table for specific ZTF identifiers and g band
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,33.328709840774536,2025-06-16T09:44:20,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.675104141235352,2025-06-25T00:34:09,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,71,3,"
# Define the sub-query to filter the reference table based on the given conditions
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,23.79592800140381,2025-06-16T09:44:44,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.402839422225952,2025-06-25T00:34:22,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,71,4,"
# Sub-query to filter the reference table for the specified ZTF identifiers and g band
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,30.14469861984253,2025-06-16T09:45:14,[None],"'[' was never closed (<string>, line 1)",7.899224758148193,2025-06-25T00:34:33,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,71,5,"
# Define the sub-query to filter the reference table for specific ZTF identifiers and g band
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,14.899633407592772,2025-06-16T09:45:30,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.320655345916748,2025-06-25T00:34:47,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,71,6,"
# Define the sub-query to filter the reference table for specific ZTF identifiers and g band
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,20.8101179599762,2025-06-16T09:45:51,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.623620748519897,2025-06-25T00:35:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,71,7,"
# Sub-query to filter the reference table for the specified ZTF identifiers and g band
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,19.144887924194336,2025-06-16T09:46:10,[None],"'[' was never closed (<string>, line 1)",7.931141138076782,2025-06-25T00:35:12,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,71,8,"
# Define the sub-query to filter the reference table by ZTF identifiers and g band
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,22.586200952529907,2025-06-16T09:46:33,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 9:     d.fwhm AS fwhm_from_sextractor,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators,
    d.exptime AS exposure_time
FROM 
    (
SELECT oid
FROM probability
WHERE probability > 0.9
AND class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND ranking = 1
) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.113895416259766,2025-06-25T00:35:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,71,9,"
# Define the sub-query to filter the reference table for specific ZTF identifiers and g band
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,13.364122152328491,2025-06-16T09:46:46,[None],"'[' was never closed (<string>, line 1)",8.492042779922485,2025-06-25T00:35:38,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,71,10,"
# Sub-query to filter the reference table for specific ZTF identifiers and g band
reference_subquery = """"""
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
AND fid = 1
ORDER BY oid
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,21.825485229492188,2025-06-16T09:47:09,[None],"'[' was never closed (<string>, line 1)",8.353785037994385,2025-06-25T00:35:50,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,42,0,"SELECT
    oid, candid, fid, chipsf, fwhm, classtar,
    nbad, magzpsci, magzpsciunc, exptime
FROM
    dataquality
WHERE
    oid = 'ZTF21aapnixl'
ORDER BY chipsf
",,,,,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,3.273743152618408,2025-06-25T00:35:54,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,42,1,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,10.751531839370728,2025-06-16T09:47:19,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...gzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF...
                                                             ^

[SQL: SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF21aapnixl'ORDER BY chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.570741891860962,2025-06-25T00:36:05,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,42,2,"
SELECT 
    oid, 
    candid, 
    fid, 
    chipsf, 
    fwhm, 
    classtar, 
    nbad, 
    magzpsci, 
    magzpsciunc, 
    exptime
FROM 
    dataquality
WHERE 
    oid = 'ZTF21aapnixl'
ORDER BY 
    chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.730674743652344,2025-06-16T09:47:23,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...psciunc,     exptimeFROM     dataqualityWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     candid,     fid,     chipsf,     fwhm,     classtar,     nbad,     magzpsci,     magzpsciunc,     exptimeFROM     dataqualityWHERE     oid = 'ZTF21aapnixl'ORDER BY     chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.915961980819702,2025-06-25T00:36:16,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,42,3,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,4.0540406703948975,2025-06-16T09:47:28,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...gzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF...
                                                             ^

[SQL: SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF21aapnixl'ORDER BY chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.511823415756226,2025-06-25T00:36:27,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,42,4,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.5854570865631104,2025-06-16T09:47:31,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...gzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF...
                                                             ^

[SQL: SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF21aapnixl'ORDER BY chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.854352712631226,2025-06-25T00:36:39,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,42,5,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,7.555653810501099,2025-06-16T09:47:39,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...gzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF...
                                                             ^

[SQL: SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF21aapnixl'ORDER BY chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.770652532577515,2025-06-25T00:36:50,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,42,6,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.9918007850646973,2025-06-16T09:47:42,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...gzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF...
                                                             ^

[SQL: SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF21aapnixl'ORDER BY chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.314965009689331,2025-06-25T00:37:02,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,42,7,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,4.269702672958374,2025-06-16T09:47:47,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...gzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF...
                                                             ^

[SQL: SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF21aapnixl'ORDER BY chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.040303468704224,2025-06-25T00:37:13,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,42,8,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.4568960666656494,2025-06-16T09:47:50,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...gzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF...
                                                             ^

[SQL: SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF21aapnixl'ORDER BY chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.797170877456665,2025-06-25T00:37:25,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,42,9,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,6.642957210540772,2025-06-16T09:47:57,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...gzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF...
                                                             ^

[SQL: SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF21aapnixl'ORDER BY chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.674230098724365,2025-06-25T00:37:36,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,42,10,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.82563829421997,2025-06-16T09:48:02,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...gzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF...
                                                             ^

[SQL: SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptimeFROM dataqualityWHERE oid = 'ZTF21aapnixl'ORDER BY chipsf]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.719608783721924,2025-06-25T00:37:47,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,107,0,"SELECT
    object.oid, ndet, firstmjd, lastmjd,
    probability, ss_ztf.candid, ssdistnr,
    ssnamenr, mjd, fid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ss_ztf
    ON object.oid = ss_ztf.oid
    INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ndet > 500
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.5
    AND classifier_version = 'stamp_classifier_1.0.4'
    AND ssdistnr < 2
ORDER BY firstmjd
LIMIT 10
",,,,,"[            oid  ndet      firstmjd       lastmjd  probability  \
0  ZTF18aakqcul   788  58279.169583  60848.290162          1.0   
1  ZTF18abbxrwg   998  58287.335428  60847.400509          1.0   
2  ZTF18abctcjx   989  58301.355914  60850.376227          1.0   
3  ZTF18abegdjb   763  58304.357766  60849.400486          1.0   
4  ZTF18abjxzue   733  58332.271759  60848.335081          1.0   
5  ZTF18abnjuiy   502  58347.196447  60850.389653          1.0   
6  ZTF18abnowwc   625  58348.212234  60849.399074          1.0   
7  ZTF18abnugpf   581  58348.353021  60849.312477          1.0   
8  ZTF17aacmuxo   580  58356.512998  60773.163762          1.0   
9  ZTF17aaapcln  1253  58357.495787  60775.153993          1.0   

                candid  ssdistnr ssnamenr           mjd  fid  
0  1497422265615015015    -999.0     null  59251.422269    1  
1  1499564341415015015    -999.0     null  59253.564340    2  
2  1508557300615015050    -999.0     null  59262.557303    2  
3  1508557301515015029    -999.0     null  59262.557303    2  
4  1494508860715015005    -999.0     null  59248.508866    1  
5  1499540791315015006    -999.0     null  59253.540799    1  
6  1508557771615015008    -999.0     null  59262.557778    2  
7  1515558154415015007    -999.0     null  59269.558160    2  
8  1521247305515015000    -999.0     null  59275.247303    2  
9  1494169106015015027    -999.0     null  59248.169109    2  ]",,83.00639271736145,2025-06-25T00:39:10,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,107,1,"
# Subquery to filter the probability table for objects classified as asteroids with a probability greater than 0.5
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
""""""

# Main query to join tables and apply filters
main_query = f""""""
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,25.16800189018249,2025-06-16T09:50:26,[None],"(psycopg2.errors.UndefinedColumn) column p.probability does not exist
LINE 7:     p.probability,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.721442222595215,2025-06-25T00:39:27,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,107,2,"
# Subquery for Probability
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.5
  AND ranking = 1
""""""

# Main Query
full_query = f""""""
SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability, d.candid, s.ssdistnr, s.ssnamenr, d.mjd, d.fid
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
  AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,20.76758098602295,2025-06-16T09:50:47,[None],"(psycopg2.errors.UndefinedColumn) column p.probability does not exist
LINE 2: SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability, ...
                                                     ^

[SQL: 
SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability, d.candid, s.ssdistnr, s.ssnamenr, d.mjd, d.fid
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.5
  AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
  AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.979499578475952,2025-06-25T00:39:41,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,107,3,"
# Subquery to filter objects with more than 500 detections
object_subquery = """"""
SELECT oid, ndet, firstmjd, lastmjd
FROM object
WHERE ndet > 500
""""""

# Subquery to filter probabilities for asteroids with the specified conditions
probability_subquery = """"""
SELECT oid, probability
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
""""""

# Subquery to filter solar system objects with distance below 2 arcsec
ss_ztf_subquery = """"""
SELECT oid, ssdistnr, ssnamenr
FROM ss_ztf
WHERE ssdistnr < 2
""""""

# Final query combining all conditions and retrieving the required columns
final_query = """"""
SELECT o.oid AS ztf_identifier, o.ndet AS number_of_detections, o.firstmjd AS first_detection_date, 
       o.lastmjd AS last_detection_date, p.probability, d.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, s.ssnamenr AS mpc_name, d.mjd AS detection_date, 
       d.fid AS filter_identifier
FROM ({object_subquery}) o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN ({ss_ztf_subquery}) s ON o.oid = s.oid
INNER JOIN detection d ON o.oid = d.oid
ORDER BY o.firstmjd
LIMIT 10
""""""

# Combine all subqueries into the final query
full_query = final_query.format(
    object_subquery=object_subquery,
    probability_subquery=probability_subquery,
    ss_ztf_subquery=ss_ztf_subquery
)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,24.476194143295288,2025-06-16T09:51:12,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   788          58279.169583   
1  ZTF18aakqcul                   788          58279.169583   
2  ZTF18aakqcul                   788          58279.169583   
3  ZTF18aakqcul                   788          58279.169583   
4  ZTF18aakqcul                   788          58279.169583   
5  ZTF18aakqcul                   788          58279.169583   
6  ZTF18aakqcul                   788          58279.169583   
7  ZTF18aakqcul                   788          58279.169583   
8  ZTF18aakqcul                   788          58279.169583   
9  ZTF18aakqcul                   788          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60848.290162          1.0   2240496781515010017   
1         60848.290162          1.0   2267443691515010008   
2         60848.290162          1.0   2267443215615010000   
3         60848.290162          1.0   2278298941515010013   
4         60848.290162          1.0   2278368001515010003   
5         60848.290162          1.0   2292295131515010015   
6         60848.290162          1.0   2290276151515010004   
7         60848.290162          1.0   2296331551515010005   
8         60848.290162          1.0   2296332025615010001   
9         60848.290162          1.0   2292274235615010002   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    59994.496782                  1  
1                  -999.0     null    60021.443692                  2  
2                  -999.0     null    60021.443218                  2  
3                  -999.0     null    60032.298947                  1  
4                  -999.0     null    60032.368009                  2  
5                  -999.0     null    60046.295139                  1  
6                  -999.0     null    60044.276157                  2  
7                  -999.0     null    60050.331551                  2  
8                  -999.0     null    60050.332026                  2  
9                  -999.0     null    60046.274236                  1  ]",,76.23315143585205,2025-06-25T00:41:02,1.0,0.1,0.1,0.1,0.0,0.0
0.18.1,gpt-4o,v3,107,4,"
# Subquery to filter probability table for objects with a probability greater than 0.5 of being an asteroid
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
""""""

# Main query to join tables and apply conditions
main_query = f""""""
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,25.826544523239136,2025-06-16T09:51:38,[None],"(psycopg2.errors.UndefinedColumn) column p.probability does not exist
LINE 7:     p.probability,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.386516332626343,2025-06-25T00:41:18,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,107,5,"
# Subquery to filter probability table for objects classified as 'asteroid' with a probability greater than 0.5
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
""""""

# Final query to join tables and apply conditions
full_query = f""""""
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,25.10620379447937,2025-06-16T09:52:03,[None],"(psycopg2.errors.UndefinedColumn) column p.probability does not exist
LINE 7:     p.probability,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.301680326461792,2025-06-25T00:41:34,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,107,6,"
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.5
  AND ranking = 1
""""""

final_query = """"""
SELECT o.oid AS ztf_identifier, 
       o.ndet AS number_of_detections, 
       o.firstmjd AS first_detection_date, 
       o.lastmjd AS last_detection_date, 
       p.probability, 
       d.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       d.mjd AS detection_date, 
       d.fid AS filter_identifier
FROM object o
JOIN ({probability_subquery}) p ON o.oid = p.oid
JOIN detection d ON o.oid = d.oid
JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
  AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,20.73655891418457,2025-06-16T09:52:24,[None],"(psycopg2.errors.UndefinedColumn) column p.probability does not exist
LINE 7:     p.probability,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.906232833862305,2025-06-25T00:41:49,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,107,7,"
# Subquery to filter probability table for objects with a probability greater than 0.5 of being an asteroid
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
""""""

# Main query to join tables and apply conditions
main_query = f""""""
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,28.958325386047363,2025-06-16T09:52:53,[None],"(psycopg2.errors.UndefinedColumn) column p.probability does not exist
LINE 7:     p.probability,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.892641305923462,2025-06-25T00:42:05,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,107,8,"
# Subquery to filter probability table for objects with a probability greater than 0.5 of being an asteroid
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
""""""

# Main query to join tables and apply filters
main_query = f""""""
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
""""""

# Final query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,24.210309267044067,2025-06-16T09:53:18,[None],"(psycopg2.errors.UndefinedColumn) column p.probability does not exist
LINE 7:     p.probability,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.316603422164917,2025-06-25T00:42:20,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,107,9,"
# Subquery to filter probability table for objects classified as 'asteroid' with probability > 0.5 and version 'stamp_classifier_1.0.4'
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.5
  AND ranking = 1
""""""

# Final query to join tables and apply all conditions
final_query = """"""
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
  AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
"""""".format(probability_subquery=probability_subquery)

# Final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,27.59562635421753,2025-06-16T09:53:46,[None],"(psycopg2.errors.UndefinedColumn) column p.probability does not exist
LINE 7:     p.probability,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.5
  AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
  AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.652334451675415,2025-06-25T00:42:36,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,107,10,"
# Subquery to filter probability table for objects classified as 'asteroid' with probability > 0.5 and version 'stamp_classifier_1.0.4'
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
""""""

# Main query to join tables and apply conditions
final_query = """"""
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
"""""".format(probability_subquery=probability_subquery)

# Final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,25.25736379623413,2025-06-16T09:54:11,[None],"(psycopg2.errors.UndefinedColumn) column p.probability does not exist
LINE 7:     p.probability,
            ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM object o
INNER JOIN (
SELECT oid
FROM probability
WHERE class_name = 'asteroid'
AND classifier_name = 'stamp_classifier'
AND classifier_version = 'stamp_classifier_1.0.4'
AND probability > 0.5
AND ranking = 1
) p ON o.oid = p.oid
INNER JOIN detection d ON o.oid = d.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
WHERE o.ndet > 500
AND s.ssdistnr < 2
ORDER BY o.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.69836688041687,2025-06-25T00:42:51,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,83,0,"SELECT
    *
FROM
    allwise
WHERE
    oid_catalog in
(
SELECT
    oid_catalog
FROM
    xmatch
WHERE
    oid = 'ZTF21aazqwxv'
)",,,,,"[           oid_catalog          ra       dec  w1mpro  w2mpro  w3mpro  w4mpro  \
0  J131116.64+045854.7  197.819368  4.981863  13.319  13.129   9.839   7.761   

   w1sigmpro  w2sigmpro  w3sigmpro  w4sigmpro  j_m_2mass  h_m_2mass  \
0      0.033      0.037      0.056      0.247     15.331     14.491   

   k_m_2mass  j_msig_2mass  h_msig_2mass  k_msig_2mass  
0     14.027         0.109           0.1           0.1  ]",,3.351693868637085,2025-06-25T00:42:55,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,83,1,"
SELECT allwise.*
FROM allwise
JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
JOIN object ON xmatch.oid = object.oid
WHERE object.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.7788007259368896,2025-06-16T09:54:14,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""ON""
LINE 1: SELECT allwise.*FROM allwiseJOIN object ON allwise.oid_catal...
                                                ^

[SQL: SELECT allwise.*FROM allwiseJOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.628077983856201,2025-06-25T00:43:07,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,83,2,"
SELECT allwise.*
FROM allwise
INNER JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
WHERE xmatch.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.818822860717773,2025-06-16T09:54:17,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...N object ON allwise.oid_catalog = object.oidWHERE object.oid...
                                                             ^

[SQL: SELECT allwise.*FROM allwiseINNER JOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.666749954223633,2025-06-25T00:43:19,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,83,3,"
SELECT allwise.*
FROM allwise
INNER JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
WHERE xmatch.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.6642582416534415,2025-06-16T09:54:21,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...N object ON allwise.oid_catalog = object.oidWHERE object.oid...
                                                             ^

[SQL: SELECT allwise.*FROM allwiseINNER JOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",8.098744630813599,2025-06-25T00:43:30,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,83,4,"
SELECT allwise.*
FROM allwise
JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
WHERE xmatch.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.5948407649993896,2025-06-16T09:54:25,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""ON""
LINE 1: SELECT allwise.*FROM allwiseJOIN object ON allwise.oid_catal...
                                                ^

[SQL: SELECT allwise.*FROM allwiseJOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",14.601807832717896,2025-06-25T00:43:49,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,83,5,"
SELECT allwise.*
FROM allwise
INNER JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
WHERE xmatch.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.98545241355896,2025-06-16T09:54:30,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...N object ON allwise.oid_catalog = object.oidWHERE object.oid...
                                                             ^

[SQL: SELECT allwise.*FROM allwiseINNER JOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.701087474822998,2025-06-25T00:44:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,83,6,"
SELECT allwise.*
FROM allwise
INNER JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
WHERE xmatch.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.870442390441896,2025-06-16T09:54:34,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...N object ON allwise.oid_catalog = object.oidWHERE object.oid...
                                                             ^

[SQL: SELECT allwise.*FROM allwiseINNER JOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.535634517669678,2025-06-25T00:44:11,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,83,7,"
SELECT allwise.*
FROM allwise
INNER JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
WHERE xmatch.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.45447301864624,2025-06-16T09:54:37,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...N object ON allwise.oid_catalog = object.oidWHERE object.oid...
                                                             ^

[SQL: SELECT allwise.*FROM allwiseINNER JOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",8.039549350738525,2025-06-25T00:44:23,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,83,8,"
SELECT allwise.*
FROM allwise
INNER JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
WHERE xmatch.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.2501864433288574,2025-06-16T09:54:40,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...N object ON allwise.oid_catalog = object.oidWHERE object.oid...
                                                             ^

[SQL: SELECT allwise.*FROM allwiseINNER JOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.627914667129517,2025-06-25T00:44:34,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,83,9,"
SELECT allwise.*
FROM allwise
JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
JOIN object ON xmatch.oid = object.oid
WHERE object.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.4519917964935303,2025-06-16T09:54:43,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""ON""
LINE 1: SELECT allwise.*FROM allwiseJOIN object ON allwise.oid_catal...
                                                ^

[SQL: SELECT allwise.*FROM allwiseJOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.490403413772583,2025-06-25T00:44:45,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,83,10,"
SELECT allwise.*
FROM allwise
INNER JOIN xmatch ON allwise.oid_catalog = xmatch.oid_catalog
WHERE xmatch.oid = 'ZTF21aazqwxv'
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.86440110206604,2025-06-16T09:55:04,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""object""
LINE 1: ...N object ON allwise.oid_catalog = object.oidWHERE object.oid...
                                                             ^

[SQL: SELECT allwise.*FROM allwiseINNER JOIN object ON allwise.oid_catalog = object.oidWHERE object.oid = 'ZTF21aazqwxv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.849631309509277,2025-06-25T00:44:56,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,84,0,"SELECT
    oid, xmatch.oid_catalog, dist,
    w1mpro, w2mpro, w3mpro, w4mpro
FROM
    xmatch INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    xmatch.oid = 'ZTF19aascdol'",,,,,"[            oid          oid_catalog      dist  w1mpro  w2mpro  w3mpro  w4mpro
0  ZTF19aascdol  J154334.93+152539.5  0.000043  15.286  14.354  11.747   8.611]",,3.2733154296875,2025-06-25T00:45:00,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,84,1,"
# Step 1: Filter the `object` table to find the specific ZTF object 'ZTF19aascdol'
object_subquery = """"""
SELECT oid
FROM object
WHERE oid = 'ZTF19aascdol'
""""""

# Step 2: Join the `xmatch` table with the `object` table to find the catalog matches
xmatch_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist
FROM xmatch
INNER JOIN ({object_subquery}) AS obj
ON xmatch.oid = obj.oid
WHERE xmatch.catid = 'ALLWISE'
""""""

# Step 3: Join the `allwise` table with the `xmatch` table to retrieve the WISE magnitudes
allwise_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist, allwise.w1mpro, allwise.w2mpro, allwise.w3mpro, allwise.w4mpro
FROM ({xmatch_subquery}) AS xmatch
INNER JOIN allwise
ON allwise.oid_catalog = xmatch.oid_catalog
""""""

# Final query combining all steps
full_query = f""""""
{allwise_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,26.087002515792847,2025-06-16T10:08:47,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,10.215927839279175,2025-06-25T00:45:14,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,84,2,"
# Sub-query to filter the object table for the specific ZTF object
object_subquery = """"""
SELECT oid 
FROM object 
WHERE oid = 'ZTF19aascdol'
""""""

# Sub-query to join the xmatch table with the filtered object table
xmatch_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist 
FROM xmatch 
INNER JOIN ({object_subquery}) AS filtered_object 
ON xmatch.oid = filtered_object.oid
WHERE xmatch.catid = 'ALLWISE'
""""""

# Sub-query to join the allwise table with the filtered xmatch table
allwise_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist, 
       allwise.w1mpro, allwise.w2mpro, allwise.w3mpro, allwise.w4mpro 
FROM ({xmatch_subquery}) AS xmatch 
INNER JOIN allwise 
ON xmatch.oid_catalog = allwise.oid_catalog
""""""

# Final query combining all sub-queries
full_query = f""""""
{allwise_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,33.82020854949951,2025-06-16T10:09:22,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,10.706611156463623,2025-06-25T00:45:28,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,84,3,"
# Sub-query to select the ZTF object 'ZTF19aascdol' from the object table
object_subquery = """"""
SELECT oid 
FROM object 
WHERE oid = 'ZTF19aascdol'
""""""

# Sub-query to join the object and xmatch tables to get the ALLWISE matches
xmatch_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist 
FROM ({object_subquery}) AS obj
INNER JOIN xmatch ON obj.oid = xmatch.oid
WHERE xmatch.catid = 'ALLWISE'
""""""

# Sub-query to join the xmatch results with the allwise table to get the magnitudes
allwise_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist, 
       allwise.w1mpro, allwise.w2mpro, allwise.w3mpro, allwise.w4mpro
FROM ({xmatch_subquery}) AS xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
""""""

# Final query combining all sub-queries
full_query = f""""""
{allwise_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,20.598461627960205,2025-06-16T10:09:42,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,9.458659887313843,2025-06-25T00:45:41,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,84,4,"
# Step 1: Filter the specific ZTF object using the `object` table
object_subquery = """"""
SELECT oid
FROM object
WHERE oid = 'ZTF19aascdol'
""""""

# Step 2: Join `object` with `xmatch` to find catalog matches
xmatch_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist
FROM ({object_subquery}) AS obj
INNER JOIN xmatch ON obj.oid = xmatch.oid
WHERE xmatch.catid = 'ALLWISE'
""""""

# Step 3: Join `xmatch` with `allwise` to retrieve WISE magnitudes
allwise_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist, allwise.w1mpro, allwise.w2mpro, allwise.w3mpro, allwise.w4mpro
FROM ({xmatch_subquery}) AS xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
""""""

# Final query combining all steps
full_query = f""""""
{allwise_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,16.817240953445435,2025-06-16T10:10:00,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,13.230285167694092,2025-06-25T00:45:58,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,84,5,"
# Step 1: Filter the `object` table to find the row where `oid` is 'ZTF19aascdol'.
object_subquery = """"""
SELECT oid
FROM object
WHERE oid = 'ZTF19aascdol'
""""""

# Step 2: Use an `INNER JOIN` between the `object` table and the `xmatch` table on the `oid` column to find the corresponding catalog matches.
xmatch_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist
FROM ({object_subquery}) AS obj
INNER JOIN xmatch ON obj.oid = xmatch.oid
WHERE xmatch.catid = 'ALLWISE'
""""""

# Step 3: Use another `INNER JOIN` between the `xmatch` table and the `allwise` table on the `oid_catalog` column to retrieve the magnitude information.
allwise_subquery = f""""""
SELECT xmatch.oid, allwise.oid_catalog, xmatch.dist, allwise.w1mpro, allwise.w2mpro, allwise.w3mpro, allwise.w4mpro
FROM ({xmatch_subquery}) AS xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
""""""

# Final query combining all steps
full_query = f""""""
{allwise_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,18.17668628692627,2025-06-16T10:10:18,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,10.864053726196289,2025-06-25T00:46:14,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,84,6,"
# Step 1: Filter the `object` table to select the row where `oid` is 'ZTF19aascdol'.
object_subquery = """"""
SELECT oid
FROM object
WHERE oid = 'ZTF19aascdol'
""""""

# Step 2: Perform an `INNER JOIN` between the `object` table and the `xmatch` table on the `oid` column to find catalog matches.
xmatch_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist
FROM ({object_subquery}) AS obj
INNER JOIN xmatch ON obj.oid = xmatch.oid
WHERE xmatch.catid = 'ALLWISE'
""""""

# Step 3: Perform an `INNER JOIN` between the `xmatch` table and the `allwise` table on the `oid_catalog` column to retrieve the WISE magnitudes.
allwise_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist, allwise.w1mpro, allwise.w2mpro, allwise.w3mpro, allwise.w4mpro
FROM ({xmatch_subquery}) AS xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
""""""

# Final query combining all steps
full_query = f""""""
{allwise_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,16.11121940612793,2025-06-16T10:10:34,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,10.597530841827393,2025-06-25T00:46:29,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,84,7,"
# Sub-query to filter the object table for the specific ZTF object
object_subquery = """"""
SELECT oid 
FROM object 
WHERE oid = 'ZTF19aascdol'
""""""

# Sub-query to join object with xmatch to get the ALLWISE catalog identifier and distance
xmatch_subquery = f""""""
SELECT x.oid_catalog, x.dist 
FROM ({object_subquery}) o
INNER JOIN xmatch x ON o.oid = x.oid
WHERE x.catid = 'ALLWISE'
""""""

# Sub-query to join xmatch with allwise to get the WISE magnitudes
allwise_subquery = f""""""
SELECT x.oid_catalog, x.dist, a.w1mpro, a.w2mpro, a.w3mpro, a.w4mpro 
FROM ({xmatch_subquery}) x
INNER JOIN allwise a ON x.oid_catalog = a.oid_catalog
""""""

# Final query to get all the required information
full_query = f""""""
SELECT o.oid, a.oid_catalog, a.dist, a.w1mpro, a.w2mpro, a.w3mpro, a.w4mpro
FROM ({object_subquery}) o
INNER JOIN ({allwise_subquery}) a ON o.oid = a.oid_catalog
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.453426361083984,2025-06-16T10:10:52,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,12.632901191711426,2025-06-25T00:46:45,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,84,8,"
# Step 1: Start with the `object` table to filter for the ZTF object 'ZTF19aascdol'.
object_subquery = """"""
SELECT oid
FROM object
WHERE oid = 'ZTF19aascdol'
""""""

# Step 2: Join the `xmatch` table to find the ALLWISE matches.
xmatch_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist
FROM xmatch
INNER JOIN ({object_subquery}) AS obj ON obj.oid = xmatch.oid
WHERE xmatch.catid = 'ALLWISE'
""""""

# Step 3: Join the `allwise` table to retrieve the magnitudes.
allwise_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist, allwise.w1mpro, allwise.w2mpro, allwise.w3mpro, allwise.w4mpro
FROM ({xmatch_subquery}) AS xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
""""""

# Final query combining all steps
full_query = f""""""
{allwise_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.27702832221985,2025-06-16T10:11:09,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,9.959228277206421,2025-06-25T00:46:59,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,84,9,"
# Sub-query to select the ZTF object 'ZTF19aascdol' from the object table
object_subquery = """"""
SELECT oid 
FROM object 
WHERE oid = 'ZTF19aascdol'
""""""

# Sub-query to join object and xmatch tables to get the ALLWISE matches
xmatch_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist 
FROM ({object_subquery}) AS obj
INNER JOIN xmatch ON obj.oid = xmatch.oid
WHERE xmatch.catid = 'ALLWISE'
""""""

# Sub-query to join xmatch and allwise tables to get the WISE magnitudes
allwise_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist, allwise.w1mpro, allwise.w2mpro, allwise.w3mpro, allwise.w4mpro
FROM ({xmatch_subquery}) AS xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
""""""

# Final query to get all the required information
full_query = f""""""
SELECT * 
FROM ({allwise_subquery}) AS final_result
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,14.917670249938965,2025-06-16T10:11:25,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,9.895370244979858,2025-06-25T00:47:12,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,84,10,"
# Step 1: Filter the specific ZTF object using the `object` table
object_subquery = """"""
SELECT oid
FROM object
WHERE oid = 'ZTF19aascdol'
""""""

# Step 2: Join `object` with `xmatch` to find catalog matches
xmatch_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist
FROM ({object_subquery}) AS obj
INNER JOIN xmatch ON obj.oid = xmatch.oid
WHERE xmatch.catid = 'ALLWISE'
""""""

# Step 3: Join `xmatch` with `allwise` to retrieve magnitude information
allwise_subquery = f""""""
SELECT xmatch.oid, xmatch.oid_catalog, xmatch.dist, 
       allwise.w1mpro, allwise.w2mpro, allwise.w3mpro, allwise.w4mpro
FROM ({xmatch_subquery}) AS xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
""""""

# Final query combining all steps
full_query = f""""""
{allwise_subquery}
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.690086126327516,2025-06-16T10:11:41,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,10.192813396453857,2025-06-25T00:47:26,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,,,96,0,"SELECT
    ss_ztf.*, detection.mjd, detection.fid,
    detection.isdiffpos, detection.ra, detection.dec,
    detection.magpsf, detection.sigmapsf
FROM
    ss_ztf INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ssnamenr IN ('2003FP134','2009UK56')
    AND ssdistnr < 2
ORDER BY ssnamenr, mjd",,,,,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,27.472015619277954,2025-06-25T00:47:54,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,96,1,"
# Subquery to filter ss_ztf for relevant solar system objects within 2 arcseconds
ss_ztf_subquery = """"""
SELECT *
FROM ss_ztf
WHERE ssnamenr IN ('2003FP134', '2009UK56')
AND ssdistnr <= 2
""""""

# Final query joining ss_ztf and detection tables
full_query = f""""""
SELECT ss_ztf.*, detection.mjd, detection.fid, detection.isdiffpos, detection.ra, detection.dec, detection.magpsf, detection.sigmapsf
FROM ({ss_ztf_subquery}) AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid
ORDER BY ss_ztf.ssnamenr, detection.mjd
""""""
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,17.61396551132202,2025-06-16T10:11:58,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,15.069247961044312,2025-06-25T00:48:16,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,96,2,"
# Subquery to filter ss_ztf for specific solar system identifiers and distance
ss_ztf_subquery = """"""
SELECT *
FROM ss_ztf
WHERE ssnamenr IN ('2003FP134', '2009UK56')
AND ssdistnr <= 2
""""""

# Final query joining ss_ztf and detection tables
full_query = f""""""
SELECT ss_ztf.*, 
       detection.mjd AS detection_date, 
       detection.fid AS filter_identifier, 
       detection.isdiffpos, 
       detection.ra, 
       detection.dec, 
       detection.magpsf AS difference_magnitude, 
       detection.sigmapsf AS magnitude_uncertainty
FROM ({ss_ztf_subquery}) AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid
ORDER BY ss_ztf.ssnamenr, detection.mjd
""""""
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,17.697418689727783,2025-06-16T10:12:16,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

    difference_magnitude  magnitude_uncertainty  
0              20.192154               0.178280  
1              18.976067               0.170550  
2              19.098774               0.178708  
3              19.052930               0.091880  
4              18.866552               0.111349  
5              19.000805               0.124175  
6              18.983727               0.160271  
7              19.122366               0.093317  
8              19.243404               0.105018  
9              19.301159               0.215448  
10             19.525230               0.168116  
11             19.692917               0.152464  
12             20.403624               0.171651  
13             20.593506               0.179858  
14             20.169308               0.190793  
15             20.084251               0.143195  
16             20.582052               0.217129  
17             20.017073               0.141530  
18             20.329580               0.195694  
19             20.295746               0.186697  
20             19.843100               0.108691  
21             19.573830               0.144548  
22             19.879513               0.182747  
23             20.331053               0.161874  
24             20.051088               0.208385  
25             19.858680               0.133551  
26             20.297800               0.209505  ]",,14.971394300460815,2025-06-25T00:48:37,1.0,1.0,0.6666666666666666,0.6666666666666666,1.0,0.0
0.18.1,gpt-4o,v3,96,3,"
# Step 1: Filter ss_ztf Table
ss_ztf_subquery = """"""
SELECT *
FROM ss_ztf
WHERE ssnamenr IN ('2003FP134', '2009UK56')
AND ssdistnr <= 2
""""""

# Step 2: Join with detection Table
detection_subquery = f""""""
SELECT ss_ztf.*, detection.mjd AS detection_date, detection.fid AS filter_identifier, 
       detection.isdiffpos, detection.ra, detection.dec, detection.magpsf, detection.sigmapsf
FROM ({ss_ztf_subquery}) AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid
""""""

# Step 3: Final Query with Sorting
final_query = f""""""
SELECT *
FROM ({detection_subquery}) AS result
ORDER BY ssnamenr, detection_date
""""""

# Combine all steps into the final query
full_query = final_query
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.67723917961121,2025-06-16T10:12:42,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

       magpsf  sigmapsf  
0   20.192154  0.178280  
1   18.976067  0.170550  
2   19.098774  0.178708  
3   19.052930  0.091880  
4   18.866552  0.111349  
5   19.000805  0.124175  
6   18.983727  0.160271  
7   19.122366  0.093317  
8   19.243404  0.105018  
9   19.301159  0.215448  
10  19.525230  0.168116  
11  19.692917  0.152464  
12  20.403624  0.171651  
13  20.593506  0.179858  
14  20.169308  0.190793  
15  20.084251  0.143195  
16  20.582052  0.217129  
17  20.017073  0.141530  
18  20.329580  0.195694  
19  20.295746  0.186697  
20  19.843100  0.108691  
21  19.573830  0.144548  
22  19.879513  0.182747  
23  20.331053  0.161874  
24  20.051088  0.208385  
25  19.858680  0.133551  
26  20.297800  0.209505  ]",,19.326419353485107,2025-06-25T00:49:03,1.0,1.0,0.8333333333333334,0.8333333333333334,1.0,0.0
0.18.1,gpt-4o,v3,96,4,"
# Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
ss_ztf_subquery = """"""
SELECT candid, oid, ssdistnr, ssmagnr, ssnamenr
FROM ss_ztf
WHERE ssnamenr IN ('2003FP134', '2009UK56')
AND ssdistnr <= 2
""""""

# Final query joining ss_ztf and detection tables
full_query = f""""""
SELECT ss_ztf.*, detection.mjd, detection.fid, detection.isdiffpos, detection.ra, detection.dec, detection.magpsf, detection.sigmapsf
FROM ({ss_ztf_subquery}) AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid
ORDER BY ss_ztf.ssnamenr, detection.mjd
""""""
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,15.643696784973145,2025-06-16T10:12:58,"[                 candid           oid  ssdistnr  ssmagnr   ssnamenr  \
0   1595376262715015044  ZTF21abbsmyp       0.0     19.5  2003FP134   
1   1608313551615015025  ZTF21abcqekm       0.0     19.0  2003FP134   
2   1609376562915015021  ZTF21abculin       0.0     19.0  2003FP134   
3   1612381041715015014  ZTF21abdihfx       0.0     18.9  2003FP134   
4   1614399211715015002  ZTF21abdulcm       0.0     18.8  2003FP134   
5   1619365033915015076  ZTF21abeywpa       0.0     19.1  2003FP134   
6   1621376883815015021  ZTF21abfkygj       0.0     19.2  2003FP134   
7   1624308764315015004  ZTF21abgavxk       0.0     19.3  2003FP134   
8   1628315454015015046  ZTF21abgxhjg       0.0     19.5  2003FP134   
9   1630314794115015013  ZTF21abhfyvv       0.0     19.5  2003FP134   
10  1640314606315015016  ZTF21abiljll       0.0     19.8  2003FP134   
11  1646209986215015001  ZTF21abjphvf       0.0     20.0  2003FP134   
12  1356469912115015034  ZTF20acawpht       0.0     20.7   2009UK56   
13  1362353242215015020  ZTF20acdqnho       0.0     20.5   2009UK56   
14  1380426825615015010  ZTF20acilssf       0.0     20.1   2009UK56   
15  1382319845615015022  ZTF20acjbakd       0.0     20.1   2009UK56   
16  1382380335615015023  ZTF20acjdjlc       0.0     20.1   2009UK56   
17  1384347685815015007  ZTF20acjxpmq       0.0     20.0   2009UK56   
18  1386400255815015038  ZTF20ackrekd       0.0     20.0   2009UK56   
19  1390391754415015016  ZTF20acmpwqx       0.0     19.9   2009UK56   
20  1390410544415015011  ZTF20acmriqf       0.0     19.9   2009UK56   
21  1403235991815015005  ZTF20acoyuab       0.0     19.7   2009UK56   
22  1410308410715015003  ZTF20acpljmx       0.0     19.8   2009UK56   
23  1410344090715015002  ZTF20acpmmxt       0.0     19.8   2009UK56   
24  1412291460615015021  ZTF20acqazko       0.0     19.8   2009UK56   
25  1416266955415015001  ZTF20acrfjpp       0.0     19.9   2009UK56   
26  1418239475415015010  ZTF20acruhoq       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,19.69178009033203,2025-06-25T00:49:29,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,96,5,"
# Step 1: Filter ss_ztf Table
ss_ztf_subquery = """"""
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IN ('2003FP134', '2009UK56') 
AND ssdistnr <= 2
""""""

# Step 2: Join with detection Table
detection_join_query = f""""""
SELECT ss_ztf.*, 
       detection.mjd, 
       detection.fid, 
       detection.isdiffpos, 
       detection.ra, 
       detection.dec, 
       detection.magpsf, 
       detection.sigmapsf
FROM ({ss_ztf_subquery}) AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid
""""""

# Step 3: Order the Results
final_query = f""""""
{detection_join_query}
ORDER BY ss_ztf.ssnamenr, detection.mjd
""""""

# Final Query
full_query = final_query
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,20.513309001922607,2025-06-16T10:13:19,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,16.87393808364868,2025-06-25T00:49:53,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,96,6,"
# Subquery to filter relevant solar system objects from ss_ztf
solar_system_subquery = """"""
SELECT candid
FROM ss_ztf
WHERE ssnamenr IN ('2003FP134', '2009UK56')
AND ssdistnr <= 2
""""""

# Main query to join ss_ztf and detection tables and retrieve the required information
full_query = f""""""
SELECT 
    ss_ztf.*, 
    detection.mjd AS detection_date, 
    detection.fid AS filter_identifier, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS magnitude_uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid
WHERE 
    ss_ztf.candid IN ({solar_system_subquery})
ORDER BY 
    ss_ztf.ssnamenr, detection.mjd
""""""
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.349035501480103,2025-06-16T10:13:38,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

    difference_magnitude  magnitude_uncertainty  
0              20.192154               0.178280  
1              18.976067               0.170550  
2              19.098774               0.178708  
3              19.052930               0.091880  
4              18.866552               0.111349  
5              19.000805               0.124175  
6              18.983727               0.160271  
7              19.122366               0.093317  
8              19.243404               0.105018  
9              19.301159               0.215448  
10             19.525230               0.168116  
11             19.692917               0.152464  
12             20.403624               0.171651  
13             20.593506               0.179858  
14             20.169308               0.190793  
15             20.084251               0.143195  
16             20.582052               0.217129  
17             20.017073               0.141530  
18             20.329580               0.195694  
19             20.295746               0.186697  
20             19.843100               0.108691  
21             19.573830               0.144548  
22             19.879513               0.182747  
23             20.331053               0.161874  
24             20.051088               0.208385  
25             19.858680               0.133551  
26             20.297800               0.209505  ]",,27.61309814453125,2025-06-25T00:50:27,1.0,1.0,0.6666666666666666,0.6666666666666666,1.0,0.0
0.18.1,gpt-4o,v3,96,7,"
# Subquery to filter ss_ztf for specific solar system identifiers and distance
ss_ztf_subquery = """"""
SELECT *
FROM ss_ztf
WHERE ssnamenr IN ('2003FP134', '2009UK56')
AND ssdistnr <= 2
""""""

# Final query joining ss_ztf and detection tables
full_query = f""""""
SELECT ss_ztf.*, detection.mjd, detection.fid, detection.isdiffpos, detection.ra, detection.dec, detection.magpsf, detection.sigmapsf
FROM ({ss_ztf_subquery}) AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid
ORDER BY ss_ztf.ssnamenr, detection.mjd
""""""
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.58406400680542,2025-06-16T10:13:56,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,14.605273008346558,2025-06-25T00:50:48,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,96,8,"
# Step 1: Filter ss_ztf Table
ss_ztf_subquery = """"""
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IN ('2003FP134', '2009UK56') 
AND ssdistnr <= 2
""""""

# Step 2: Join with detection Table
detection_join_query = f""""""
SELECT ss_ztf.*, 
       detection.mjd AS detection_date, 
       detection.fid AS filter_identifier, 
       detection.isdiffpos, 
       detection.ra, 
       detection.dec, 
       detection.magpsf, 
       detection.sigmapsf
FROM ({ss_ztf_subquery}) AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid
""""""

# Step 3: Apply Sorting
final_query = f""""""
{detection_join_query}
ORDER BY ss_ztf.ssnamenr, detection.mjd
""""""

# Final Query
full_query = final_query
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,53.54521656036377,2025-06-16T10:14:50,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

       magpsf  sigmapsf  
0   20.192154  0.178280  
1   18.976067  0.170550  
2   19.098774  0.178708  
3   19.052930  0.091880  
4   18.866552  0.111349  
5   19.000805  0.124175  
6   18.983727  0.160271  
7   19.122366  0.093317  
8   19.243404  0.105018  
9   19.301159  0.215448  
10  19.525230  0.168116  
11  19.692917  0.152464  
12  20.403624  0.171651  
13  20.593506  0.179858  
14  20.169308  0.190793  
15  20.084251  0.143195  
16  20.582052  0.217129  
17  20.017073  0.141530  
18  20.329580  0.195694  
19  20.295746  0.186697  
20  19.843100  0.108691  
21  19.573830  0.144548  
22  19.879513  0.182747  
23  20.331053  0.161874  
24  20.051088  0.208385  
25  19.858680  0.133551  
26  20.297800  0.209505  ]",,16.079859972000122,2025-06-25T00:51:10,1.0,1.0,0.8333333333333334,0.8333333333333334,1.0,0.0
0.18.1,gpt-4o,v3,96,9,"
# Step 1: Filter ss_ztf Table
ss_ztf_subquery = """"""
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IN ('2003FP134', '2009UK56') 
AND ssdistnr <= 2
""""""

# Step 2: Join with detection Table
detection_join_query = f""""""
SELECT ss_ztf.*, 
       detection.mjd AS detection_date, 
       detection.fid AS filter_identifier, 
       detection.isdiffpos, 
       detection.ra, 
       detection.dec, 
       detection.magpsf, 
       detection.sigmapsf
FROM ({ss_ztf_subquery}) AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid
ORDER BY ss_ztf.ssnamenr, detection.mjd
""""""

# Final Query
full_query = detection_join_query
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.79346776008606,2025-06-16T10:15:10,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

       magpsf  sigmapsf  
0   20.192154  0.178280  
1   18.976067  0.170550  
2   19.098774  0.178708  
3   19.052930  0.091880  
4   18.866552  0.111349  
5   19.000805  0.124175  
6   18.983727  0.160271  
7   19.122366  0.093317  
8   19.243404  0.105018  
9   19.301159  0.215448  
10  19.525230  0.168116  
11  19.692917  0.152464  
12  20.403624  0.171651  
13  20.593506  0.179858  
14  20.169308  0.190793  
15  20.084251  0.143195  
16  20.582052  0.217129  
17  20.017073  0.141530  
18  20.329580  0.195694  
19  20.295746  0.186697  
20  19.843100  0.108691  
21  19.573830  0.144548  
22  19.879513  0.182747  
23  20.331053  0.161874  
24  20.051088  0.208385  
25  19.858680  0.133551  
26  20.297800  0.209505  ]",,15.126900672912598,2025-06-25T00:51:32,1.0,1.0,0.8333333333333334,0.8333333333333334,1.0,0.0
0.18.1,gpt-4o,v3,96,10,"
# Step 1: Filter ss_ztf Table
ss_ztf_subquery = """"""
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IN ('2003FP134', '2009UK56') 
AND ssdistnr <= 2
""""""

# Step 2: Join with detection Table
detection_join_query = f""""""
SELECT ss_ztf.*, 
       detection.mjd, 
       detection.fid, 
       detection.isdiffpos, 
       detection.ra, 
       detection.dec, 
       detection.magpsf, 
       detection.sigmapsf
FROM ({ss_ztf_subquery}) AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid
""""""

# Step 3: Apply Sorting
final_query = f""""""
{detection_join_query}
ORDER BY ss_ztf.ssnamenr, detection.mjd
""""""

# Final Query
full_query = final_query
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.24636936187744,2025-06-16T10:15:29,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,16.47093939781189,2025-06-25T00:51:55,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,,,67,0,"SELECT
    *
FROM
    gaia_ztf
WHERE
    oid IN ('ZTF18acxlskz','ZTF22aanppbi','ZTF22abunrft')
    AND neargaia < 1.5",,,,,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,3.5211029052734375,2025-06-25T00:51:59,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,1,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.3088345527648926,2025-06-16T10:15:32,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.64664101600647,2025-06-25T00:52:10,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,2,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,2.652263879776001,2025-06-16T10:15:35,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.870128870010376,2025-06-25T00:52:22,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,3,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,2.346453666687012,2025-06-16T10:15:38,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,9.111067295074463,2025-06-25T00:52:35,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,4,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.133471727371216,2025-06-16T10:15:41,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,25.31921124458313,2025-06-25T00:53:05,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,5,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.29685115814209,2025-06-16T10:15:45,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.091092109680176,2025-06-25T00:53:17,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,6,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,5.249295234680176,2025-06-16T10:15:50,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.70769190788269,2025-06-25T00:53:28,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,7,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,2.473111629486084,2025-06-16T10:15:53,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.009214639663696,2025-06-25T00:53:40,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,8,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,4.121143341064453,2025-06-16T10:15:58,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.348605155944824,2025-06-25T00:53:52,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,9,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,2.7992608547210693,2025-06-16T10:16:01,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.125164985656738,2025-06-25T00:54:06,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,67,10,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,2.757686853408813,2025-06-16T10:16:04,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.9062254428863525,2025-06-25T00:54:19,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,,,55,0,"SELECT
    *
FROM
    object
WHERE
    oid = 'ZTF20aatxryt'",,,,,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,3.3691601753234863,2025-06-25T00:54:24,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,1,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.834590435028076,2025-06-16T10:16:08,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.989126205444336,2025-06-25T00:54:40,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,2,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,1.8073091506958008,2025-06-16T10:16:10,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.187965393066406,2025-06-25T00:54:53,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,3,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.1664609909057617,2025-06-16T10:16:12,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.263973236083984,2025-06-25T00:55:05,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,4,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.312453508377075,2025-06-16T10:16:15,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.226243495941162,2025-06-25T00:55:16,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,5,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.276548385620117,2025-06-16T10:16:17,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.794227361679077,2025-06-25T00:55:28,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,6,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,1.9683823585510247,2025-06-16T10:16:19,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.697523832321167,2025-06-25T00:55:39,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,7,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.268640518188477,2025-06-16T10:16:22,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.212749719619751,2025-06-25T00:55:50,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,8,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,1.9474036693573,2025-06-16T10:16:24,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.353280782699585,2025-06-25T00:56:01,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,9,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.199370145797729,2025-06-16T10:16:27,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.263171434402466,2025-06-25T00:56:12,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,55,10,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,1.902355432510376,2025-06-16T10:16:29,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.575880765914917,2025-06-25T00:56:24,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,,,47,0,"SELECT
    oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM
    detection
WHERE
    oid IN ('ZTF23aaawbsc','ZTF21abxlmuw')
    AND rb > 0.7
ORDER BY oid, mjd",,,,,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,3.4250638484954834,2025-06-25T00:56:28,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,47,1,"
# Sub-query to filter detections with the specified ZTF identifiers and real/bogus score greater than 0.7
detection_subquery = """"""
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
""""""

# Final query to join the sub-query results and sort by ZTF identifier and detection date
full_query = f""""""
SELECT 
    o.oid AS ztf_identifier, 
    d.candid AS candidate_identifier, 
    d.fid AS filter_identifier, 
    d.mjd AS detection_date, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb AS real_bogus_score
FROM 
    ({detection_subquery}) d
INNER JOIN 
    object o ON d.oid = o.oid
ORDER BY 
    o.oid, d.mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,19.348379850387573,2025-06-16T10:22:23,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,12.870822668075562,2025-06-25T00:56:45,1.0,1.0,0.5,0.5,1.0,0.0
0.18.1,gpt-4o,v3,47,2,"
# Sub-query to filter detections based on ZTF identifiers and real/bogus score
detection_subquery = """"""
SELECT oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM detection
WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') AND rb > 0.7
ORDER BY oid, mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.229100704193115,2025-06-16T10:22:45,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,8.536839962005615,2025-06-25T00:56:58,1.0,1.0,0.5,0.5,1.0,0.0
0.18.1,gpt-4o,v3,47,3,"
# Define the sub-query to filter detections based on the specified ZTF identifiers and real/bogus score
detection_subquery = """"""
SELECT oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM detection
WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') AND rb > 0.7
ORDER BY oid, mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,11.537571668624878,2025-06-16T10:22:57,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,9.177433013916016,2025-06-25T00:57:11,1.0,1.0,0.5,0.5,1.0,0.0
0.18.1,gpt-4o,v3,47,4,"
# Sub-query to filter detections with the specified ZTF identifiers and real/bogus score greater than 0.7
detection_subquery = """"""
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
""""""

# Final query to join the sub-query results and sort by ZTF identifier and detection date
full_query = f""""""
SELECT 
    o.oid AS ztf_identifier, 
    d.candid AS candidate_identifier, 
    d.fid AS filter_identifier, 
    d.mjd AS detection_date, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb AS real_bogus_score
FROM 
    ({detection_subquery}) d
INNER JOIN 
    object o ON d.oid = o.oid
ORDER BY 
    o.oid, d.mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,26.219308376312256,2025-06-16T10:23:23,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,11.550193071365356,2025-06-25T00:57:26,1.0,1.0,0.5,0.5,1.0,0.0
0.18.1,gpt-4o,v3,47,5,"
# Define the sub-query to filter detections based on the specified ZTF identifiers and real/bogus score
detection_subquery = """"""
SELECT oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM detection
WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') AND rb > 0.7
ORDER BY oid, mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.503247261047363,2025-06-16T10:23:36,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,8.563755750656128,2025-06-25T00:57:39,1.0,1.0,0.5,0.5,1.0,0.0
0.18.1,gpt-4o,v3,47,6,"
# Define the sub-query to filter detections based on the specified ZTF identifiers and real/bogus score
detection_subquery = """"""
SELECT 
    oid, 
    candid, 
    fid, 
    mjd, 
    isdiffpos, 
    ra, 
    dec, 
    magpsf, 
    sigmapsf, 
    rb
FROM 
    detection
WHERE 
    oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND rb > 0.7
ORDER BY 
    oid, 
    mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,14.013703107833862,2025-06-16T10:23:50,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,9.426019430160522,2025-06-25T00:57:52,1.0,1.0,0.5,0.5,1.0,0.0
0.18.1,gpt-4o,v3,47,7,"
# Define the sub-query to filter detections based on the specified ZTF identifiers and real/bogus score
detection_subquery = """"""
SELECT oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM detection
WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') AND rb > 0.7
ORDER BY oid, mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.816784858703612,2025-06-16T10:24:03,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,8.39392352104187,2025-06-25T00:58:05,1.0,1.0,0.5,0.5,1.0,0.0
0.18.1,gpt-4o,v3,47,8,"
# Define the sub-query to filter detections based on the specified ZTF identifiers and real/bogus score
detection_subquery = """"""
SELECT oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM detection
WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') AND rb > 0.7
ORDER BY oid, mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.362667560577393,2025-06-16T10:24:17,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,8.657528400421143,2025-06-25T00:58:18,1.0,1.0,0.5,0.5,1.0,0.0
0.18.1,gpt-4o,v3,47,9,"
# Sub-query to filter detections with the specified ZTF identifiers and a real/bogus score greater than 0.7
detection_subquery = """"""
SELECT 
    detection.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.rb
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
WHERE 
    object.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND detection.rb > 0.7
ORDER BY 
    detection.oid, 
    detection.mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,14.833095073699951,2025-06-16T10:24:32,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,9.307877779006958,2025-06-25T00:58:31,1.0,1.0,0.5,0.5,1.0,0.0
0.18.1,gpt-4o,v3,47,10,"
# Sub-query to filter detections based on ZTF identifiers and real/bogus score
detection_subquery = """"""
SELECT oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM detection
WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') AND rb > 0.7
""""""

# Final query to sort the results by ZTF identifier and detection date
full_query = f""""""
SELECT *
FROM ({detection_subquery}) AS filtered_detections
ORDER BY oid, mjd
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.950206756591797,2025-06-16T10:24:45,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.533835649490356,2025-06-25T00:58:44,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,,,79,0,"SELECT
    catid, oid_catalog, dist
FROM
    xmatch
WHERE
    oid = 'ZTF20achscch'",,,,,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,3.3479363918304443,2025-06-25T00:58:48,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,79,1,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.2274601459503174,2025-06-16T10:24:48,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.80450701713562,2025-06-25T00:59:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,79,2,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.3192598819732666,2025-06-16T10:24:50,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.511545181274414,2025-06-25T00:59:11,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,79,3,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.1159210205078125,2025-06-16T10:31:37,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.666327238082886,2025-06-25T00:59:22,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,79,4,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.7402164936065674,2025-06-16T10:31:40,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.5364439487457275,2025-06-25T00:59:34,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,79,5,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.1543428897857666,2025-06-16T10:31:42,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.5097126960754395,2025-06-25T00:59:45,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,79,6,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.039494276046753,2025-06-16T10:31:45,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.2555272579193115,2025-06-25T00:59:56,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,79,7,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.325446844100952,2025-06-16T10:31:47,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",14.68021559715271,2025-06-25T01:00:14,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,79,8,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,4.505962133407593,2025-06-16T10:31:52,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",8.199455261230469,2025-06-25T01:00:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,79,9,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.4317946434021,2025-06-16T10:31:55,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.73465371131897,2025-06-25T01:00:38,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,79,10,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.729098558425904,2025-06-16T10:31:58,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20...
                                                        ^

[SQL: SELECT catid, oid_catalog, distFROM xmatchWHERE oid = 'ZTF20achscch']
(Background on this error at: https://sqlalche.me/e/20/f405)",8.127801656723022,2025-06-25T01:00:50,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,94,0,"SELECT
    *
FROM
    object INNER JOIN
    reference
    ON object.oid = reference.oid
WHERE
    reference_change
LIMIT 50",,,,,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abgscsl       135      4634  58296.371771  60756.525833       True   
1   ZTF18abgscsl       135      4634  58296.371771  60756.525833       True   
2   ZTF18acgrhwx       198      1472  58349.449456  60759.182326       True   
3   ZTF18acgrhwx       198      1472  58349.449456  60759.182326       True   
4   ZTF18achpgro       114      1545  58349.403669  60734.163287       True   
5   ZTF18achpgro       114      1545  58349.403669  60734.163287       True   
6   ZTF17aaarveq       485      1872  58101.116991  60761.217454       True   
7   ZTF17aaarveq       485      1872  58101.116991  60761.217454       True   
8   ZTF18acnkvby      1124      2001  58095.115127  60785.492026       True   
9   ZTF18acnkvby      1124      2001  58095.115127  60785.492026       True   
10  ZTF18acnkvby      1124      2001  58095.115127  60785.492026       True   
11  ZTF18abncdok       403      2155  58095.115127  60848.452986       True   
12  ZTF18abncdok       403      2155  58095.115127  60848.452986       True   
13  ZTF18acnkswd        41      2527  58438.364537  60679.112419       True   
14  ZTF18acnkswd        41      2527  58438.364537  60679.112419       True   
15  ZTF18abjpkam       912      2617  58278.409028  60841.301944       True   
16  ZTF18abjpkam       912      2617  58278.409028  60841.301944       True   
17  ZTF18abjpkam       912      2617  58278.409028  60841.301944       True   
18  ZTF18abjpkam       912      2617  58278.409028  60841.301944       True   
19  ZTF18abmrmsd       394      2399  58095.139363  60846.432419       True   
20  ZTF18abmrmsd       394      2399  58095.139363  60846.432419       True   
21  ZTF18abccqut        95      2143  58283.476238  60764.513229       True   
22  ZTF18abccqut        95      2143  58283.476238  60764.513229       True   
23  ZTF18abccqut        95      2143  58283.476238  60764.513229       True   
24  ZTF18abccqut        95      2143  58283.476238  60764.513229       True   
25  ZTF18abnxdph       143      1556  58278.409028  60807.446991       True   
26  ZTF18abnxdph       143      1556  58278.409028  60807.446991       True   
27  ZTF18abnxdph       143      1556  58278.409028  60807.446991       True   
28  ZTF18abiceqj        29      3512  58317.400891  60621.145336       True   
29  ZTF18abiceqj        29      3512  58317.400891  60621.145336       True   
30  ZTF18abiceqj        29      3512  58317.400891  60621.145336       True   
31  ZTF18abuiung        62      3381  58369.471516  60634.321100      False   
32  ZTF18abuiung        62      3381  58369.471516  60634.321100      False   
33  ZTF17aabuxeo      2768      4065  58095.095151  60849.354178       True   
34  ZTF17aabuxeo      2768      4065  58095.095151  60849.354178       True   
35  ZTF17aabuxeo      2768      4065  58095.095151  60849.354178       True   
36  ZTF17aabuxeo      2768      4065  58095.095151  60849.354178       True   
37  ZTF17aabuxeo      2768      4065  58095.095151  60849.354178       True   
38  ZTF18abehjoo        36      2139  58261.482188  60621.145799       True   
39  ZTF18abehjoo        36      2139  58261.482188  60621.145799       True   
40  ZTF18aayxqew      1654      2928  58078.106562  60848.449456       True   
41  ZTF18aayxqew      1654      2928  58078.106562  60848.449456       True   
42  ZTF18abncdhe       564      2157  58095.115127  60842.389213       True   
43  ZTF18abncdhe       564      2157  58095.115127  60842.389213       True   
44  ZTF18abncdhe       564      2157  58095.115127  60842.389213       True   
45  ZTF18ablweul       186      3710  58337.391065  60621.152373       True   
46  ZTF18ablweul       186      3710  58337.391065  60621.152373       True   
47  ZTF18ablweul       186      3710  58337.391065  60621.152373       True   
48  ZTF18ablweul       186      3710  58337.391065  60621.152373       True   
49  ZTF18abaeigf       975      4013  58281.470509  60848.459502       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False    62    None         None  ...   691  14.158000     0.016  0.561   
1     False    62    None         None  ...   691  13.179000     0.017  0.578   
2     False    61    None         None  ...   810  14.605000     0.020  0.764   
3     False    61    None         None  ...   810  15.191999     0.019  0.796   
4     False    68    None         None  ...   836  13.412999     0.017  0.909   
5     False    68    None         None  ...   836  14.005000     0.014  0.495   
6     False   272    None         None  ...   742  12.924999     0.017  0.986   
7     False   272    None         None  ...   742  13.974000     0.018  0.833   
8     False   142    None         None  ...   734  16.215000     0.016  0.450   
9     False   142    None         None  ...   734  15.693000     0.017  0.730   
10    False   142    None         None  ...  1772  15.688000     0.028  0.700   
11    False   210    None         None  ...   734  16.938000     0.023  0.908   
12    False   210    None         None  ...   734  16.809000     0.014  0.674   
13    False    28    None         None  ...   867  12.582000     0.021  1.334   
14    False    28    None         None  ...   868  12.521999     0.011  0.187   
15    False   602    None         None  ...   877  12.547999     0.014  0.404   
16    False   602    None         None  ...   867  12.488999     0.013  0.849   
17    False   602    None         None  ...   877  14.303000     0.017  1.105   
18    False   602    None         None  ...   867  14.038000     0.025  1.804   
19    False   200    None         None  ...   734  17.974000     0.024  1.161   
20    False   200    None         None  ...   734  17.096000     0.015  0.663   
21    False    40    None         None  ...   691  13.035000     0.010  0.190   
22    False    40    None         None  ...   691  12.908999     0.016  0.538   
23    False    40    None         None  ...  1731  12.861999     0.018  0.485   
24    False    40    None         None  ...  1688  12.861999     0.024  0.435   
25    False   121    None         None  ...   867  15.017000     0.016  0.630   
26    False   121    None         None  ...  1878  14.976000     0.018  0.430   
27    False   121    None         None  ...   867  14.026000     0.014  0.712   
28    False    14    None         None  ...   489  13.165999     0.027  0.631   
29    False    14    None         None  ...   488  13.179000     0.014  0.347   
30    False    14    None         None  ...   488  13.755000     0.017  0.732   
31    False    30    None         None  ...   699  14.016000     0.014  0.378   
32    False    30    None         None  ...   699  14.743999     0.015  0.517   
33    False  1796    None         None  ...   689  16.181000     0.020  0.854   
34    False  1796    None         None  ...   689  15.419000     0.018  0.815   
35    False  1796    None         None  ...  1730  16.140000     0.019  0.683   
36    False  1796    None         None  ...   690  16.248001     0.021  1.061   
37    False  1796    None         None  ...   690  15.434999     0.021  1.014   
38    False    25    None         None  ...   436  14.330999     0.021  0.428   
39    False    25    None         None  ...   436  14.946000     0.014  0.347   
40    False   860    None         None  ...   769  17.366001     0.016  0.549   
41    False   860    None         None  ...   769  16.476000     0.015  0.397   
42    False   348    None         None  ...   734  17.417000     0.023  1.142   
43    False   348    None         None  ...   734  18.231000     0.018  0.722   
44    False   348    None         None  ...  1772  17.386000     0.021  0.617   
45    False    62    None         None  ...   733  17.892000     0.021  0.754   
46    False    62    None         None  ...   732  17.913000     0.024  0.968   
47    False    62    None         None  ...   732  17.425000     0.022  0.787   
48    False    62    None         None  ...   733  17.464000     0.021  0.675   
49    False   814    None         None  ...   804  14.231000     0.011  0.302   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.046  333.300936  30.424674  58252.462303  58287.426308         15  
1     0.037  333.300928  30.424682  58242.467396  58289.481794         15  
2    -0.041   65.606292  60.973630  58216.147049  58447.406100         33  
3    -0.018   65.606320  60.973642  58315.450012  58426.363160         15  
4     0.017   62.850805  68.132179  58216.146586  58424.321586         15  
5    -0.006   62.850823  68.132177  58312.482014  58441.447674         15  
6     0.031   64.583791  46.305813  58160.238461  58422.341563         15  
7    -0.046   64.583814  46.305810  58168.125139  58340.493391         15  
8     0.011  345.649517  43.187908  58262.474352  58342.410116         15  
9    -0.003  345.649520  43.187898  58244.484109  58380.322616         15  
10   -0.040  345.649536  43.187885  58326.250000  58751.250000         40  
11   -0.035  344.350543  41.076282  58262.474352  58344.363044         15  
12   -0.028  344.350546  41.076269  58244.484109  58437.263183         15  
13    0.113  334.100123  75.078159  58206.472500  58441.261875         37  
14    0.014  334.100117  75.078134  58242.448403  58423.248843         15  
15    0.004  322.569481  79.612409  58637.346424  58757.306377         15  
16    0.016  322.569557  79.612444  58198.515706  58305.406991         15  
17    0.017  322.569588  79.612414  58634.453102  58694.324537         15  
18   -0.103  322.569534  79.612456  58262.446505  58367.286331         15  
19   -0.082  344.963601  42.894192  58262.474352  58343.414213         16  
20    0.043  344.963589  42.894192  58244.484109  58428.123345         16  
21    0.006  333.586087  33.213892  58252.462303  58283.456331         16  
22    0.037  333.586097  33.213892  58242.467396  58289.469063         15  
23    0.047  333.586121  33.213863  58327.500000  58763.250000         40  
24   -0.024  333.586121  33.213879  58300.500000  58763.250000         40  
25   -0.037  318.400033  75.984212  58206.472500  58441.261875         37  
26   -0.053  318.400055  75.984222  58363.250000  59119.250000         16  
27   -0.012  318.400005  75.984218  58198.515706  58312.430498         15  
28   -0.046  291.754097   3.844082  58255.460532  58340.293171         40  
29    0.027  291.754122   3.844098  58198.504259  58293.314687         17  
30   -0.002  291.754121   3.844104  58205.509873  58279.375150         15  
31   -0.005   50.679392  39.698337  58310.450475  58425.326736         15  
32   -0.031   50.679415  39.698356  58304.467789  58366.424525         15  
33   -0.041  325.600280  36.568913  58228.487616  58314.380278         15  
34   -0.016  325.600282  36.568916  58218.489560  58317.423056         15  
35   -0.038  325.600281  36.568928  58307.500000  58766.250000         37  
36   -0.077  325.600293  36.568917  58244.452905  58320.445174         15  
37   -0.048  325.600285  36.568919  58244.483137  58320.382639         15  
38   -0.038  283.974649  -3.734178  58274.353449  58347.323461         40  
39    0.015  283.974646  -3.734165  58246.461782  58290.398657         15  
40    0.025  323.220136  48.907886  58228.490035  58276.389387         15  
41    0.023  323.220122  48.907883  58218.490984  58291.475648         18  
42   -0.049  350.113788  40.903271  58244.484109  58373.304699         15  
43   -0.055  350.113797  40.903281  58247.485347  58343.414213         16  
44   -0.052  350.113800  40.903244  58326.250000  58751.250000         40  
45   -0.060  334.308459  42.107583  58254.445903  58334.322627         15  
46   -0.033  334.308454  42.107585  58262.472014  58360.362824         15  
47   -0.030  334.308452  42.107580  58242.467870  58360.288449         15  
48   -0.046  334.308457  42.107576  58242.468785  58373.288542         15  
49    0.003  341.065413  52.457008  58244.451910  58281.431609         15  

[50 rows x 36 columns]]",,3.4463396072387695,2025-06-25T01:00:53,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,94,1,"
# Sub-query to select all columns from the 'object' table where 'reference_change' is TRUE
object_subquery = """"""
SELECT * FROM object WHERE reference_change = TRUE
""""""

# Sub-query to select all columns from the 'reference' table
reference_subquery = """"""
SELECT * FROM reference
""""""

# Final query to join the results of the above sub-queries and limit the output to 50 rows
full_query = f""""""
SELECT * 
FROM ({object_subquery}) AS obj
INNER JOIN ({reference_subquery}) AS ref
ON obj.oid = ref.oid
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,13.613489151000977,2025-06-16T10:38:48,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18acrugts       304      2562  58322.471678  60681.241273      False   
1   ZTF18acrugts       304      2562  58322.471678  60681.241273      False   
2   ZTF18acrugts       304      2562  58322.471678  60681.241273      False   
3   ZTF18acrugts       304      2562  58322.471678  60681.241273      False   
4   ZTF18abkwmvg         6      2070  58308.376956  60621.145799       True   
5   ZTF18abkwmvg         6      2070  58308.376956  60621.145799       True   
6   ZTF18abuyqhg      1149      1513  58367.461181  60753.138090       True   
7   ZTF18abuyqhg      1149      1513  58367.461181  60753.138090       True   
8   ZTF18abikhce       883      3703  58267.440116  60805.422106       True   
9   ZTF18abikhce       883      3703  58267.440116  60805.422106       True   
10  ZTF18abikhce       883      3703  58267.440116  60805.422106       True   
11  ZTF18abikhce       883      3703  58267.440116  60805.422106       True   
12  ZTF18abxlkgb       367      2215  58305.443333  60848.447535       True   
13  ZTF18abxlkgb       367      2215  58305.443333  60848.447535       True   
14  ZTF18acdnsqb        41      3006  58427.270938  60543.446759       True   
15  ZTF18acdnsqb        41      3006  58427.270938  60543.446759       True   
16  ZTF18acdnsqb        41      3006  58427.270938  60543.446759       True   
17  ZTF18acdnsqb        41      3006  58427.270938  60543.446759       True   
18  ZTF18abttcxw        69      1830  58344.492928  60596.476748       True   
19  ZTF18abttcxw        69      1830  58344.492928  60596.476748       True   
20  ZTF18abomtsu       530      1986  58092.101343  60849.485324       True   
21  ZTF18abomtsu       530      1986  58092.101343  60849.485324       True   
22  ZTF18abomtsu       530      1986  58092.101343  60849.485324       True   
23  ZTF18abppkxp       265      3848  58354.478380  60761.217928       True   
24  ZTF18abppkxp       265      3848  58354.478380  60761.217928       True   
25  ZTF18abppkxp       265      3848  58354.478380  60761.217928       True   
26  ZTF18abppkxp       265      3848  58354.478380  60761.217928       True   
27  ZTF19abupfee        46      1059  58725.374236  60652.163449       True   
28  ZTF19abupfee        46      1059  58725.374236  60652.163449       True   
29  ZTF18aaadvly       472      1822  58129.267870  60729.164641       True   
30  ZTF18aaadvly       472      1822  58129.267870  60729.164641       True   
31  ZTF18aaadvly       472      1822  58129.267870  60729.164641       True   
32  ZTF18abqaolk       107      3445  58102.417014  60753.155984       True   
33  ZTF18abqaolk       107      3445  58102.417014  60753.155984       True   
34  ZTF18abqaolk       107      3445  58102.417014  60753.155984       True   
35  ZTF18abqaolk       107      3445  58102.417014  60753.155984       True   
36  ZTF18abwnpbz        21      2101  58377.258102  60621.151424       True   
37  ZTF18abwnpbz        21      2101  58377.258102  60621.151424       True   
38  ZTF18achoeww       594      3447  58434.278819  60743.200509       True   
39  ZTF18achoeww       594      3447  58434.278819  60743.200509       True   
40  ZTF18achoeww       594      3447  58434.278819  60743.200509       True   
41  ZTF18achoeww       594      3447  58434.278819  60743.200509       True   
42  ZTF18abnxsiw       559      1411  58258.454687  60621.157766       True   
43  ZTF18abnxsiw       559      1411  58258.454687  60621.157766       True   
44  ZTF18aaaecvo       925      4079  58094.101562  60773.195544       True   
45  ZTF18aaaecvo       925      4079  58094.101562  60773.195544       True   
46  ZTF18aaaecvo       925      4079  58094.101562  60773.195544       True   
47  ZTF18aaaecvo       925      4079  58094.101562  60773.195544       True   
48  ZTF19abydagi       244      1071  58643.454537  60671.246389       True   
49  ZTF19abydagi       244      1071  58643.454537  60671.246389       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False   194    None         None  ...   835  14.738999     0.027  1.685   
1     False   194    None         None  ...   836  12.721999     0.024  0.964   
2     False   194    None         None  ...   835  12.693000     0.016  0.688   
3     False   194    None         None  ...   836  14.731000     0.021  0.824   
4      True     6    None         None  ...   436  14.187000     0.017  0.598   
5      True     6    None         None  ...   436  12.884999     0.023  0.587   
6     False   555    None         None  ...   405  16.572000     0.019  0.768   
7     False   555    None         None  ...   405  17.051000     0.014  0.405   
8     False   334    None         None  ...   488  13.009999     0.025  0.677   
9     False   334    None         None  ...   488  14.932000     0.017  0.674   
10    False   334    None         None  ...   437  14.960999     0.016  0.727   
11    False   334    None         None  ...   437  13.006000     0.018  0.246   
12    False   162    None         None  ...   689  14.408999     0.018  0.248   
13    False   162    None         None  ...   689  14.967999     0.015  0.463   
14    False    24    None         None  ...   657  13.932000     0.015  0.455   
15    False    24    None         None  ...   656  13.948000     0.015  0.924   
16    False    24    None         None  ...   657  13.335999     0.011  0.359   
17    False    24    None         None  ...   656  13.396000     0.018  0.626   
18    False    27    None         None  ...   742  16.820000     0.020  0.739   
19    False    27    None         None  ...   742  15.936000     0.016  0.183   
20    False   444    None         None  ...   777  18.455000     0.025  0.886   
21    False   444    None         None  ...   777  14.879999     0.017  0.412   
22    False   444    None         None  ...  1813  14.827000     0.019  0.743   
23    False   164    None         None  ...   702  12.688999     0.019  1.071   
24    False   164    None         None  ...   702  13.271999     0.013  0.491   
25    False   164    None         None  ...   701  13.321000     0.010  0.326   
26    False   164    None         None  ...   701  12.740999     0.015  0.366   
27    False    33    None         None  ...   869  16.152000     0.013  0.291   
28    False    33    None         None  ...   869  15.648000     0.018  0.502   
29    False   176    None         None  ...   701  16.867000     0.025  1.092   
30    False   176    None         None  ...   701  17.853000     0.032  2.043   
31    False   176    None         None  ...  1741  16.852000     0.014  0.340   
32    False    87    None         None  ...   778  17.716000     0.012  0.385   
33    False    87    None         None  ...   778  19.000000     0.021  0.744   
34    False    87    None         None  ...   777  18.952000     0.021  0.589   
35    False    87    None         None  ...   777  17.706000     0.026  1.130   
36    False     8    None         None  ...   689  13.377000     0.021  0.539   
37    False     8    None         None  ...   689  13.780000     0.018  0.603   
38    False   190    None         None  ...   655  13.538000     0.021  0.968   
39    False   190    None         None  ...   656  12.733000     0.020  1.122   
40    False   190    None         None  ...   656  13.535000     0.023  1.127   
41    False   190    None         None  ...   655  12.714999     0.024  1.270   
42    False   120    None         None  ...   868  12.382999     0.018  1.020   
43    False   120    None         None  ...   868  14.537000     0.013  0.654   
44    False   459    None         None  ...   701  15.598000     0.021  0.886   
45    False   459    None         None  ...   701  16.518000     0.023  1.185   
46    False   459    None         None  ...   702  16.547000     0.019  0.528   
47    False   459    None         None  ...   702  15.617000     0.016  0.499   
48    False   172    None         None  ...   869  13.599999     0.017  0.416   
49    False   172    None         None  ...   869  14.267000     0.012  0.376   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.070   53.248562  71.766383  58319.427928  58397.366771         15  
1     0.007   53.248515  71.766349  58216.146586  58447.406551         24  
2    -0.010   53.248517  71.766362  58283.481354  58447.385243         30  
3    -0.057   53.248530  71.766345  58304.469664  58441.447674         30  
4    -0.025  286.436013   0.165408  58247.395521  58288.376470         15  
5    -0.001  286.436014   0.165419  58218.484329  58340.297824         15  
6    -0.044   62.444098  -4.000960  58342.499086  58379.502500         16  
7    -0.020   62.444095  -4.000956  58348.484306  58370.478391         15  
8     0.000  288.441468   1.036148  58334.342442  58340.295474         40  
9    -0.051  288.441462   1.036147  58205.509873  58281.379583         15  
10   -0.012  288.441464   1.036162  58228.479491  58332.231250         15  
11   -0.012  288.441461   1.036160  58218.486759  58347.326215         40  
12    0.010  320.011225  33.646839  58218.489560  58449.150162         40  
13   -0.024  320.011205  33.646856  58228.487616  58332.454526         15  
14    0.018   67.048046  30.351778  58168.121782  58443.219387         37  
15   -0.015   67.048072  30.351790  58323.446782  58430.302755         15  
16   -0.001   67.048042  30.351784  58160.250000  58434.250000         15  
17   -0.034   67.048093  30.351797  58335.461250  58425.321157         16  
18   -0.062   61.249861  48.842505  58168.125139  58344.492928         15  
19    0.007   61.249863  48.842496  58323.492674  58449.359282         40  
20   -0.078   50.807017  57.141228  58304.471076  58340.497593         15  
21   -0.010   50.806963  57.141226  58312.423796  58441.406273         40  
22   -0.055   50.806969  57.141216  58356.250000  58764.500000         37  
23    0.024   67.704713  38.329756  58160.224236  58348.446042         15  
24   -0.010   67.704703  38.329746  58167.105787  58365.446157         15  
25    0.014   67.704732  38.329748  58168.124016  58423.431910         15  
26   -0.009   67.704736  38.329750  58160.237940  58423.326412         15  
27   -0.017    6.693974  83.316838  58643.454537  58704.380509         15  
28   -0.035    6.693994  83.316845  58643.481481  58741.422963         15  
29   -0.070   65.151685  43.653218  58160.237940  58447.402361         33  
30   -0.125   65.151691  43.653228  58168.124016  58422.434826         15  
31   -0.006   65.151695  43.653214  58356.250000  58761.500000         33  
32   -0.015   54.984401  52.581628  58325.486377  58378.421794         15  
33   -0.052   54.984393  52.581603  58304.469178  58345.445324         15  
34   -0.019   54.984450  52.581632  58304.471076  58342.450590         15  
35   -0.030   54.984414  52.581621  58303.473206  58353.429109         15  
36   -0.018  320.865924  31.794655  58218.513438  58449.150162         40  
37   -0.058  320.865925  31.794672  58228.487616  58320.445648         15  
38    0.032   59.062290  34.924346  58168.122373  58379.475312         15  
39    0.036   59.062284  34.924313  58342.496806  58434.350914         15  
40    0.000   59.062281  34.924312  58168.121227  58437.428819         15  
41    0.076   59.062281  34.924326  58316.470046  58425.329063         16  
42    0.031  340.891678  73.815779  58216.514213  58346.392894         15  
43    0.014  340.891682  73.815774  58252.468947  58367.311389         15  
44   -0.060   67.675679  41.881957  58160.237940  58447.402361         38  
45   -0.038   67.675688  41.881964  58168.124016  58422.434826         16  
46   -0.058   67.675673  41.881950  58168.150498  58369.465197         15  
47   -0.026   67.675680  41.881949  58160.224236  58375.489711         15  
48   -0.024    6.062326  80.481103  58643.481481  58760.324977         15  
49   -0.009    6.062373  80.481101  58643.454537  58704.380509         15  

[50 rows x 36 columns]]",,9.163307905197144,2025-06-25T01:01:07,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,94,2,"
query = """"""
SELECT *
FROM object
INNER JOIN reference ON object.oid = reference.oid
WHERE object.reference_change = TRUE
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,19.0009343624115,2025-06-16T10:39:07,[None],"'[' was never closed (<string>, line 1)",8.434636116027832,2025-06-25T01:01:19,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,94,3,"
query = """"""
SELECT *
FROM object
INNER JOIN reference ON object.oid = reference.oid
WHERE object.reference_change = TRUE
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,17.279570817947388,2025-06-16T10:39:25,[None],"'[' was never closed (<string>, line 1)",11.92379903793335,2025-06-25T01:01:35,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,94,4,"
query = """"""
SELECT object.*, reference.*
FROM object
INNER JOIN reference ON object.oid = reference.oid
WHERE object.reference_change = TRUE
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,13.456892013549805,2025-06-16T10:39:38,[None],"'[' was never closed (<string>, line 1)",8.479625225067139,2025-06-25T01:01:47,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,94,5,"
query = """"""
SELECT *
FROM object
INNER JOIN reference ON object.oid = reference.oid
WHERE object.reference_change = TRUE
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,16.646132469177246,2025-06-16T10:39:55,[None],"'[' was never closed (<string>, line 1)",8.6300368309021,2025-06-25T01:02:00,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,94,6,"
# Sub-query to select all columns from the 'object' table where 'reference_change' is TRUE
object_subquery = """"""
SELECT * 
FROM object 
WHERE reference_change = TRUE
""""""

# Sub-query to select all columns from the 'reference' table
reference_subquery = """"""
SELECT * 
FROM reference
""""""

# Final query to join the results of the sub-queries and limit the output to 50 rows
full_query = f""""""
SELECT o.*, r.* 
FROM ({object_subquery}) AS o
INNER JOIN ({reference_subquery}) AS r ON o.oid = r.oid
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.859567642211914,2025-06-16T10:40:08,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abbdget        16      1913  58284.396296  60621.093924       True   
1   ZTF18abbdget        16      1913  58284.396296  60621.093924       True   
2   ZTF19aarggva       291       945  58593.417778  60849.314919       True   
3   ZTF19aarggva       291       945  58593.417778  60849.314919       True   
4   ZTF18aboeves       205      1135  58292.313218  60849.400961       True   
5   ZTF18aboeves       205      1135  58292.313218  60849.400961       True   
6   ZTF18abhrrpb        17      1790  58492.178484  60643.242130       True   
7   ZTF18abhrrpb        17      1790  58492.178484  60643.242130       True   
8   ZTF18ablqoje        57      1661  58303.261921  60544.192859       True   
9   ZTF18ablqoje        57      1661  58303.261921  60544.192859       True   
10  ZTF18ablqoje        57      1661  58303.261921  60544.192859       True   
11  ZTF18ablqoje        57      1661  58303.261921  60544.192859       True   
12  ZTF21aaqspec        44      1585  58697.327789  60544.205081       True   
13  ZTF21aaqspec        44      1585  58697.327789  60544.205081       True   
14  ZTF18abnorfk       446       962  58348.189456  60832.356447       True   
15  ZTF18abnorfk       446       962  58348.189456  60832.356447       True   
16  ZTF18abcpcte        40      3804  58290.450868  60621.158275       True   
17  ZTF18abcpcte        40      3804  58290.450868  60621.158275       True   
18  ZTF18abcpcte        40      3804  58290.450868  60621.158275       True   
19  ZTF18abcpcte        40      3804  58290.450868  60621.158275       True   
20  ZTF18abhcuqr       996      3192  58247.456551  60847.400972       True   
21  ZTF18abhcuqr       996      3192  58247.456551  60847.400972       True   
22  ZTF18abhcuqr       996      3192  58247.456551  60847.400972       True   
23  ZTF18abhcuqr       996      3192  58247.456551  60847.400972       True   
24  ZTF18abkcpnb        36      4355  58328.446111  60723.548808      False   
25  ZTF18abmotmv      1108      1722  58219.512893  60850.332882       True   
26  ZTF18abmotmv      1108      1722  58219.512893  60850.332882       True   
27  ZTF18abchhhx       771      4765  58288.430556  60727.184595       True   
28  ZTF18abchhhx       771      4765  58288.430556  60727.184595       True   
29  ZTF18abchhhx       771      4765  58288.430556  60727.184595       True   
30  ZTF18abchhhx       771      4765  58288.430556  60727.184595       True   
31  ZTF18abchhhx       771      4765  58288.430556  60727.184595       True   
32  ZTF17aabuxen       927      4068  58095.260949  60743.172986       True   
33  ZTF17aabuxen       927      4068  58095.260949  60743.172986       True   
34  ZTF17aabuxen       927      4068  58095.260949  60743.172986       True   
35  ZTF17aabuxen       927      4068  58095.260949  60743.172986       True   
36  ZTF18ablpror       901      1607  58246.438426  60849.400486       True   
37  ZTF18ablpror       901      1607  58246.438426  60849.400486       True   
38  ZTF18abgomlu        21      3537  58312.358299  60621.145336       True   
39  ZTF18abgomlu        21      3537  58312.358299  60621.145336       True   
40  ZTF18abgomlu        21      3537  58312.358299  60621.145336       True   
41  ZTF18abgomlu        21      3537  58312.358299  60621.145336       True   
42  ZTF18abcmoag       325      1120  58290.320266  60797.336771       True   
43  ZTF18abcmoag       325      1120  58290.320266  60797.336771       True   
44  ZTF18abmqxhz       111      1974  58344.342477  60725.517720       True   
45  ZTF18abmqxhz       111      1974  58344.342477  60725.517720       True   
46  ZTF18abmqxhz       111      1974  58344.342477  60725.517720       True   
47  ZTF18acaybrd       212      2786  58305.251134  60836.355208      False   
48  ZTF18acaybrd       212      2786  58305.251134  60836.355208      False   
49  ZTF18acaybrd       212      2786  58305.251134  60836.355208      False   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False     8    None         None  ...   487  15.309999     0.018  0.925   
1     False     8    None         None  ...   487  13.651999     0.017  0.719   
2     False   122    None         None  ...   280  14.283000     0.016  0.508   
3     False   122    None         None  ...   280  16.234001     0.009  0.278   
4     False   159    None         None  ...   283  13.412000     0.018  0.540   
5     False   159    None         None  ...   283  16.010000     0.013  0.502   
6      True     9    None         None  ...   805  15.743000     0.014  0.501   
7      True     9    None         None  ...   805  16.459000     0.011  0.300   
8     False    33    None         None  ...   280  14.158999     0.018  0.767   
9     False    33    None         None  ...   279  14.276999     0.028  0.986   
10    False    33    None         None  ...   280  15.736000     0.013  0.639   
11    False    33    None         None  ...   279  15.736000     0.015  1.176   
12    False     5    None         None  ...   875  13.986000     0.017  0.527   
13    False     5    None         None  ...   875  13.348000     0.019  0.284   
14    False   181    None         None  ...   280  14.631000     0.023  0.982   
15    False   181    None         None  ...   280  16.920000     0.015  0.926   
16    False    25    None         None  ...   832  16.805000     0.020  1.400   
17    False    25    None         None  ...   832  17.473000     0.014  0.760   
18    False    25    None         None  ...   806  16.803000     0.016  0.488   
19    False    25    None         None  ...   806  17.455000     0.014  0.432   
20    False   544    None         None  ...   334  15.058000     0.031  0.942   
21    False   544    None         None  ...   334  18.254000     0.026  1.006   
22    False   544    None         None  ...   333  18.448000     0.034  1.488   
23    False   544    None         None  ...   333  15.190000     0.025  0.815   
24    False     2    None         None  ...   592  14.013000     0.022  1.070   
25    False   543    None         None  ...   432  16.908000     0.015  0.514   
26    False   543    None         None  ...   432  16.506000     0.024  1.158   
27    False   504    None         None  ...   806  16.024000     0.012  0.740   
28    False   504    None         None  ...   806  15.217999     0.013  0.487   
29    False   504    None         None  ...   807  15.224000     0.017  0.717   
30    False   504    None         None  ...   807  15.986999     0.018  0.827   
31    False   504    None         None  ...  1810  15.240999     0.021  0.604   
32    False   736    None         None  ...   807  14.988999     0.011  0.574   
33    False   736    None         None  ...   807  15.736999     0.013  1.455   
34    False   736    None         None  ...   808  15.694000     0.028  1.814   
35    False   736    None         None  ...   808  14.981000     0.020  0.455   
36    False   409    None         None  ...   334  15.934999     0.018  0.793   
37    False   409    None         None  ...   334  18.065000     0.029  2.006   
38     True    12    None         None  ...   488  13.495999     0.026  1.183   
39     True    12    None         None  ...   489  13.960000     0.013  0.396   
40     True    12    None         None  ...   488  14.019000     0.021  0.970   
41     True    12    None         None  ...   489  13.422000     0.022  0.329   
42    False   124    None         None  ...   330  18.916000     0.037  2.050   
43    False   124    None         None  ...   330  18.417000     0.107  7.767   
44    False    70    None         None  ...   727  16.663000     0.015  0.405   
45    False    70    None         None  ...   727  16.165000     0.019  0.463   
46    False    70    None         None  ...  1765  16.160000     0.016  0.592   
47    False   145    None         None  ...   332  14.009999     0.033  0.949   
48    False   145    None         None  ...   331  14.268000     0.024  0.225   
49    False   145    None         None  ...   331  15.111000     0.024  1.617   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.048  280.731038   3.708902  58205.509410  58273.443530         15  
1    -0.006  280.731038   3.708915  58217.484491  58293.296690         16  
2     0.044  258.060612 -22.466719  58257.438449  58302.270729         40  
3     0.002  258.060605 -22.466735  58248.376412  58673.297662         15  
4    -0.039  280.178749 -20.917789  58263.396701  58310.314606         15  
5    -0.001  280.178754 -20.917779  58229.500359  58608.438484         15  
6    -0.002  354.869382  53.878658  58244.485023  58342.466053         15  
7    -0.006  354.869380  53.878651  58246.484803  58286.456007         15  
8    -0.036  254.067962 -27.815147  58257.438449  58302.243310         40  
9    -0.058  254.068041 -27.815169  58607.376250  58635.354792         40  
10   -0.023  254.067996 -27.815181  58248.376412  58670.278646         15  
11   -0.019  254.068028 -27.815174  58246.355602  58643.314630         15  
12    0.043  247.816182  83.772555  58634.243924  58695.307211         15  
13    0.005  247.816162  83.772560  58634.250000  59741.250000        100  
14   -0.101  258.566656 -23.957678  58257.438449  58302.280324         40  
15   -0.012  258.566640 -23.957707  58248.376412  58670.278646         15  
16   -0.034  359.027382  62.379115  58244.486042  58279.408715         15  
17   -0.033  359.027386  62.379115  58246.485810  58286.456470         15  
18   -0.022  359.027397  62.379116  58256.483495  58367.359525         15  
19   -0.017  359.027392  62.379113  58252.467512  58287.432083         15  
20   -0.047  279.931787 -18.680587  58256.412257  58320.344016         40  
21   -0.010  279.931727 -18.680641  58246.460394  58372.229803         15  
22   -0.014  279.931794 -18.680653  58262.401238  58347.190440         15  
23   -0.020  279.931815 -18.680598  58274.353935  58313.312755         30  
24   -0.019  305.198267  22.428551  58230.496956  58322.424942         15  
25   -0.014  258.721990  -1.036772  58203.500810  58337.185266         15  
26   -0.035  258.721999  -1.036778  58216.425671  58368.127732         22  
27   -0.014   13.554386  58.926659  58262.476227  58285.449630         15  
28   -0.035   13.554397  58.926656  58257.468924  58287.473738         15  
29   -0.053   13.554359  58.926643  58256.484444  58310.427581         15  
30   -0.054   13.554378  58.926642  58274.449306  58313.477083         15  
31   -0.040   13.554394  58.926640  58344.500000  58765.500000         40  
32    0.000   26.473572  65.554529  58274.475324  58303.475521         15  
33    0.003   26.473546  65.554523  58274.449306  58315.423854         15  
34   -0.037   26.473616  65.554512  58277.465220  58322.473576         15  
35    0.001   26.473616  65.554511  58281.466655  58337.492095         15  
36    0.091  281.209778 -13.869628  58262.375336  58319.343495         40  
37    0.005  281.209778 -13.869630  58246.460394  58372.229803         16  
38   -0.064  291.707136   7.501168  58198.504259  58322.355347         15  
39   -0.004  291.707136   7.501163  58206.527836  58306.334236         15  
40   -0.042  291.707134   7.501176  58205.509873  58278.379167         15  
41   -0.034  291.707134   7.501167  58322.354884  58340.295023         40  
42    0.079  253.115650 -18.305241  58205.471285  58574.416979         15  
43    0.432  253.115604 -18.305260  58217.469028  58289.322558         40  
44   -0.065  285.965470  41.220094  58204.513403  58302.432836         15  
45   -0.017  285.965471  41.220079  58186.530139  58423.093565         40  
46   -0.012  285.965477  41.220082  58267.374167  58443.115127         24  
47   -0.090  266.218776 -20.070980  58618.355058  58637.419398         40  
48   -0.023  266.218818 -20.070968  58304.236817  58304.334178         40  
49    0.132  266.219336 -20.070485  58205.526424  58329.199213         17  

[50 rows x 36 columns]]",,9.5664222240448,2025-06-25T01:02:13,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,94,7,"
query = """"""
SELECT *
FROM object
INNER JOIN reference ON object.oid = reference.oid
WHERE object.reference_change = TRUE
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,15.758151292800903,2025-06-16T10:40:24,[None],"'[' was never closed (<string>, line 1)",8.734785795211792,2025-06-25T01:02:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,94,8,"
# Sub-query to select all columns from the 'object' table where 'reference_change' is TRUE
object_subquery = """"""
SELECT * FROM object WHERE reference_change = TRUE
""""""

# Sub-query to select all columns from the 'reference' table
reference_subquery = """"""
SELECT * FROM reference
""""""

# Final query to join the results of the sub-queries and limit the output to 50 rows
full_query = f""""""
SELECT * 
FROM ({object_subquery}) AS obj
INNER JOIN ({reference_subquery}) AS ref
ON obj.oid = ref.oid
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.919393539428713,2025-06-16T10:40:37,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abajtbn       121      3722  58282.426111  60547.258692       True   
1   ZTF18abajtbn       121      3722  58282.426111  60547.258692       True   
2   ZTF18abajtbn       121      3722  58282.426111  60547.258692       True   
3   ZTF18abajtbn       121      3722  58282.426111  60547.258692       True   
4   ZTF17aabpiuz       484      1984  58105.143113  60840.368183       True   
5   ZTF17aabpiuz       484      1984  58105.143113  60840.368183       True   
6   ZTF18abncavq       923      3430  58258.453738  60847.346829       True   
7   ZTF18abncavq       923      3430  58258.453738  60847.346829       True   
8   ZTF18abncavq       923      3430  58258.453738  60847.346829       True   
9   ZTF18abncavq       923      3430  58258.453738  60847.346829       True   
10  ZTF18abvidws       436      2283  58095.095694  60849.300255       True   
11  ZTF18abvidws       436      2283  58095.095694  60849.300255       True   
12  ZTF18abbvfww        18      3950  58286.478495  60621.151898       True   
13  ZTF18abbvfww        18      3950  58286.478495  60621.151898       True   
14  ZTF18acjqjnk        35      1782  58435.228773  60826.474618       True   
15  ZTF18acjqjnk        35      1782  58435.228773  60826.474618       True   
16  ZTF19aczksea        14      3465  58574.483067  60733.539502       True   
17  ZTF19aczksea        14      3465  58574.483067  60733.539502       True   
18  ZTF19aczksea        14      3465  58574.483067  60733.539502       True   
19  ZTF18aarwwcd      2399      3850  58218.510556  60849.320590       True   
20  ZTF18aarwwcd      2399      3850  58218.510556  60849.320590       True   
21  ZTF18aarwwcd      2399      3850  58218.510556  60849.320590       True   
22  ZTF18aarwwcd      2399      3850  58218.510556  60849.320590       True   
23  ZTF18aarwwcd      2399      3850  58218.510556  60849.320590       True   
24  ZTF18aavqlqj       179      2094  58247.462917  60634.163692       True   
25  ZTF18aavqlqj       179      2094  58247.462917  60634.163692       True   
26  ZTF18abmnthu       250      2176  58252.486875  60823.368495       True   
27  ZTF18abmnthu       250      2176  58252.486875  60823.368495       True   
28  ZTF18abqdkkx       250      1515  58291.368947  60834.400150       True   
29  ZTF18abqdkkx       250      1515  58291.368947  60834.400150       True   
30  ZTF18aawbiju      1851      4503  58208.527025  60849.337581       True   
31  ZTF18aawbiju      1851      4503  58208.527025  60849.337581       True   
32  ZTF18aawbiju      1851      4503  58208.527025  60849.337581       True   
33  ZTF18aawbiju      1851      4503  58208.527025  60849.337581       True   
34  ZTF18acauhpg       355      2184  58095.113495  60821.365127       True   
35  ZTF18acauhpg       355      2184  58095.113495  60821.365127       True   
36  ZTF18aawvcxs       769      4431  58217.507188  60847.323090       True   
37  ZTF18aawvcxs       769      4431  58217.507188  60847.323090       True   
38  ZTF18aawvcxs       769      4431  58217.507188  60847.323090       True   
39  ZTF18aawvcxs       769      4431  58217.507188  60847.323090       True   
40  ZTF17aaawdak      1666      2207  58095.095151  60848.447535       True   
41  ZTF17aaawdak      1666      2207  58095.095151  60848.447535       True   
42  ZTF18abboggt        72      2013  58246.448056  60781.489444      False   
43  ZTF18abboggt        72      2013  58246.448056  60781.489444      False   
44  ZTF18abloojo       145      2002  58252.482616  60787.472373       True   
45  ZTF18abloojo       145      2002  58252.482616  60787.472373       True   
46  ZTF20aahhkqj        19      2105  58505.563565  60707.565278       True   
47  ZTF18accpjvz       697      2059  58245.457720  60839.385058       True   
48  ZTF18accpjvz       697      2059  58245.457720  60839.385058       True   
49  ZTF17aaaebjf      1282      1996  58101.119618  60848.448982       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False    56       NaN           NaN  ...    803  14.943000     0.015   
1     False    56       NaN           NaN  ...    804  14.335999     0.017   
2     False    56       NaN           NaN  ...    804  14.941999     0.012   
3     False    56       NaN           NaN  ...    803  14.325000     0.015   
4     False   412       NaN           NaN  ...    770  16.898000     0.035   
5     False   412       NaN           NaN  ...    770  16.392000     0.036   
6     False   675       NaN           NaN  ...    852  19.269000     0.018   
7     False   675       NaN           NaN  ...    852  17.866000     0.018   
8     False   675       NaN           NaN  ...    851  19.155000     0.023   
9     False   675       NaN           NaN  ...    851  17.866000     0.023   
10    False   296       NaN           NaN  ...    688  18.668000     0.024   
11    False   296       NaN           NaN  ...    688  17.754000     0.023   
12     True     5       NaN           NaN  ...    769  14.552000     0.026   
13     True     5       NaN           NaN  ...    731  15.174000     0.015   
14    False    25       NaN           NaN  ...    602  15.285000     0.017   
15    False    25       NaN           NaN  ...    602  14.750000     0.021   
16    False     6 -0.774157      0.517286  ...    541  13.236999     0.021   
17    False     6 -0.774157      0.517286  ...    541  14.247000     0.021   
18    False     6 -0.774157      0.517286  ...   1536  13.221000     0.022   
19    False  1512       NaN           NaN  ...    639  17.072000     0.013   
20    False  1512       NaN           NaN  ...   1683  14.372999     0.018   
21    False  1512       NaN           NaN  ...    639  14.724000     0.015   
22    False  1512       NaN           NaN  ...    638  14.492000     0.029   
23    False  1512       NaN           NaN  ...    638  16.650000     0.021   
24    False   106       NaN           NaN  ...    687  18.213000     0.014   
25    False   106       NaN           NaN  ...    687  17.046000     0.013   
26    False   132       NaN           NaN  ...    688  16.076000     0.017   
27    False   132       NaN           NaN  ...    688  16.373001     0.020   
28    False   137       NaN           NaN  ...    385  15.059000     0.014   
29    False   137       NaN           NaN  ...    385  17.615000     0.017   
30    False  1273       NaN           NaN  ...    687  16.977001     0.015   
31    False  1273       NaN           NaN  ...    640  17.026001     0.012   
32    False  1273       NaN           NaN  ...    687  15.665000     0.018   
33    False  1273       NaN           NaN  ...    640  15.778999     0.014   
34    False   237       NaN           NaN  ...    731  17.426000     0.018   
35    False   237       NaN           NaN  ...    731  18.469000     0.015   
36    False   447       NaN           NaN  ...    589  18.088000     0.019   
37    False   447       NaN           NaN  ...    539  18.109001     0.015   
38    False   447       NaN           NaN  ...    539  17.458000     0.018   
39    False   447       NaN           NaN  ...    589  17.458000     0.020   
40    False   915       NaN           NaN  ...    689  16.187000     0.023   
41    False   915       NaN           NaN  ...    689  16.505001     0.024   
42    False    28       NaN           NaN  ...    770  15.895000     0.014   
43    False    28       NaN           NaN  ...    770  18.364000     0.034   
44    False    83       NaN           NaN  ...    638  18.400000     0.016   
45    False    83       NaN           NaN  ...    638  17.421000     0.022   
46     True     5       NaN           NaN  ...    538  13.039000     0.023   
47    False   484       NaN           NaN  ...    688  15.236000     0.029   
48    False   484       NaN           NaN  ...    688  13.681999     0.017   
49    False   830       NaN           NaN  ...    770  13.365000     0.015   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.506   -0.022  340.038109  57.434271  58228.489526  58278.432604   
1   0.595   -0.043  340.038115  57.434267  58242.469699  58288.473935   
2   0.190    0.000  340.038111  57.434263  58228.488611  58276.408125   
3   0.548    0.000  340.038116  57.434264  58217.493982  58283.388912   
4   2.394    0.084  330.619057  48.453406  58244.452419  58282.427083   
5   2.390    0.048  330.619052  48.453401  58217.493530  58293.474780   
6   0.538    0.021  325.642214  66.569809  58228.476748  58323.435451   
7   0.691   -0.018  325.642160  66.569817  58216.513704  58345.336852   
8   0.827   -0.044  325.642266  66.569816  58230.490718  58337.367442   
9   1.380   -0.011  325.642240  66.569815  58217.495428  58343.343380   
10  0.980   -0.084  313.488659  34.091790  58229.503901  58346.320451   
11  0.592   -0.077  313.488662  34.091769  58271.435243  58449.146933   
12  0.933   -0.031  317.569771  44.231373  58218.490984  58277.400741   
13  0.363    0.016  317.569830  44.231382  58230.492130  58323.433079   
14  0.697   -0.035   15.033984  27.847595  58280.450174  58366.455914   
15  0.781   -0.039   15.033993  27.847565  58276.463437  58447.330046   
16  0.752   -0.025  302.610466  11.148051  58218.488148  58338.331296   
17  0.820   -0.031  302.610469  11.148033  58230.497870  58323.401134   
18  0.616   -0.027  302.610443  11.148014  58443.000000  59403.250000   
19  0.268   -0.029  289.533929  29.091524  58203.506921  58244.456343   
20  0.481   -0.012  289.533931  29.091518  58270.411111  58443.114213   
21  0.279   -0.019  289.533938  29.091526  58186.532512  58255.442963   
22  1.309   -0.091  289.533942  29.091532  58186.529502  58294.333299   
23  0.856   -0.088  289.533948  29.091523  58203.506458  58282.395394   
24  0.409   -0.007  308.957800  35.092811  58205.513113  58259.426007   
25  0.173   -0.017  308.957789  35.092808  58198.516343  58256.466053   
26  0.571   -0.038  311.950280  35.972021  58217.490683  58370.276377   
27  0.878   -0.075  311.950278  35.972026  58234.465509  58340.350417   
28  0.219   -0.007  284.791783  -7.136082  58291.405590  58293.409039   
29  0.612   -0.028  284.791781  -7.136081  58246.461319  58377.210544   
30  0.536    0.014  303.424194  29.726526  58205.513113  58258.475498   
31  0.423   -0.008  303.424213  29.726549  58203.507396  58258.477523   
32  0.511   -0.020  303.424184  29.726528  58198.516343  58276.426181   
33  0.370   -0.028  303.424209  29.726549  58216.511319  58257.455324   
34  0.451   -0.019  317.902870  41.623773  58218.490532  58441.236435   
35  0.375    0.004  317.902865  41.623788  58230.492130  58338.365278   
36  0.702    0.021  282.034518  15.310114  58203.505521  58316.357269   
37  0.329   -0.008  282.034527  15.310119  58204.507674  58254.418576   
38  0.514    0.044  282.034526  15.310117  58186.533692  58258.438947   
39  0.529   -0.035  282.034525  15.310104  58186.528900  58433.093056   
40  0.815   -0.049  318.897427  33.626945  58242.466007  58380.219410   
41  1.311   -0.006  318.897421  33.626969  58228.487616  58338.379815   
42  0.352   -0.006  332.282401  48.862853  58244.452419  58279.457650   
43  0.587   -0.059  332.280666  48.862464  58217.493530  58291.472905   
44  0.473   -0.009  288.180974  22.734949  58203.506458  58322.214016   
45  0.639   -0.013  288.180951  22.734942  58186.529502  58337.329143   
46  0.592    0.006  278.876041   9.013249  58198.525590  58333.282917   
47  1.842   -0.135  315.724910  31.664178  58234.465509  58343.390093   
48  0.327    0.010  315.724885  31.664173  58272.458681  58449.127581   
49  0.558    0.007  329.539371  48.363900  58217.493530  58293.474780   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          17  
6          15  
7          15  
8          15  
9          15  
10         15  
11         40  
12         15  
13         15  
14         15  
15         37  
16         15  
17         15  
18         16  
19         15  
20         19  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         40  
29         15  
30         15  
31         15  
32         15  
33         16  
34         40  
35         15  
36         15  
37         15  
38         15  
39         40  
40         15  
41         16  
42         15  
43         15  
44         15  
45         39  
46         40  
47         15  
48         40  
49         17  

[50 rows x 36 columns]]",,9.380390405654907,2025-06-25T01:02:39,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,94,9,"
# Sub-query to select all columns from the 'object' table where 'reference_change' is TRUE
object_subquery = """"""
SELECT * 
FROM object 
WHERE reference_change = TRUE
""""""

# Sub-query to select all columns from the 'reference' table
reference_subquery = """"""
SELECT * 
FROM reference
""""""

# Final query to join the 'object' and 'reference' tables and limit the result to 50 rows
full_query = f""""""
SELECT o.*, r.* 
FROM ({object_subquery}) AS o
INNER JOIN ({reference_subquery}) AS r ON o.oid = r.oid
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,15.22245168685913,2025-06-16T10:40:53,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazwmmz       299      2950  58095.135012  60544.297766       True   
1   ZTF18aazwmmz       299      2950  58095.135012  60544.297766       True   
2   ZTF18aazwmmz       299      2950  58095.135012  60544.297766       True   
3   ZTF17aaburqs       708      2039  58095.135012  60848.451968       True   
4   ZTF17aaburqs       708      2039  58095.135012  60848.451968       True   
5   ZTF18aayejmn      1218      2914  58218.469352  60849.288831       True   
6   ZTF18aayejmn      1218      2914  58218.469352  60849.288831       True   
7   ZTF18aayejmn      1218      2914  58218.469352  60849.288831       True   
8   ZTF18abhpplo        11      2512  58288.397755  60621.144861       True   
9   ZTF18abhpplo        11      2512  58288.397755  60621.144861       True   
10  ZTF18abmakwx       151      1930  58301.410984  60847.344907       True   
11  ZTF18abmakwx       151      1930  58301.410984  60847.344907       True   
12  ZTF18aayxdoh      1418      6509  58217.507188  60637.113993       True   
13  ZTF18aayxdoh      1418      6509  58217.507188  60637.113993       True   
14  ZTF18aayxdoh      1418      6509  58217.507188  60637.113993       True   
15  ZTF18abctbnd       830      1567  58259.417928  60849.334711       True   
16  ZTF18abctbnd       830      1567  58259.417928  60849.334711       True   
17  ZTF18abluudn       617      1461  58337.324549  60591.150069       True   
18  ZTF18abluudn       617      1461  58337.324549  60591.150069       True   
19  ZTF18aberawb       783      2870  58252.483102  60845.316968       True   
20  ZTF18aberawb       783      2870  58252.483102  60845.316968       True   
21  ZTF18acdxfae        25      2477  58428.178843  60667.177199       True   
22  ZTF18acdxfae        25      2477  58428.178843  60667.177199       True   
23  ZTF18aayefur        49      2661  58274.392639  60546.210764       True   
24  ZTF18aayefur        49      2661  58274.392639  60546.210764       True   
25  ZTF18abwerrl       622      1015  58314.438866  60850.435417       True   
26  ZTF18abwerrl       622      1015  58314.438866  60850.435417       True   
27  ZTF18abbsxwx        94      2736  58286.403380  60786.442083       True   
28  ZTF18abbsxwx        94      2736  58286.403380  60786.442083       True   
29  ZTF18aabexyn       658      2140  58131.083912  60845.469514       True   
30  ZTF18aabexyn       658      2140  58131.083912  60845.469514       True   
31  ZTF18aabexyn       658      2140  58131.083912  60845.469514       True   
32  ZTF18abegcph       696      1631  58259.417928  60847.397535       True   
33  ZTF18abegcph       696      1631  58259.417928  60847.397535       True   
34  ZTF18abymzfu       152      3244  58384.252072  60756.518044       True   
35  ZTF18abymzfu       152      3244  58384.252072  60756.518044       True   
36  ZTF18abymzfu       152      3244  58384.252072  60756.518044       True   
37  ZTF19acyexub         9      1830  58801.134525  60733.539028       True   
38  ZTF19acyexub         9      1830  58801.134525  60733.539028       True   
39  ZTF18abodvyu       488      4197  58284.471724  60724.133611       True   
40  ZTF18abodvyu       488      4197  58284.471724  60724.133611       True   
41  ZTF18abodvyu       488      4197  58284.471724  60724.133611       True   
42  ZTF18abodvyu       488      4197  58284.471724  60724.133611       True   
43  ZTF17aabqiay      1379      3765  58105.209155  60848.459502       True   
44  ZTF17aabqiay      1379      3765  58105.209155  60848.459502       True   
45  ZTF17aabqiay      1379      3765  58105.209155  60848.459502       True   
46  ZTF17aabqiay      1379      3765  58105.209155  60848.459502       True   
47  ZTF18abqcums       153      1560  58292.387500  60803.459120       True   
48  ZTF18abqcums       153      1560  58292.387500  60803.459120       True   
49  ZTF18aaxyzry       221      2188  58273.460058  60639.114560       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False   103    None         None  ...   803  17.021000     0.018  0.785   
1     False   103    None         None  ...   831  16.036000     0.025  1.116   
2     False   103    None         None  ...   831  16.964000     0.026  1.183   
3     False   543    None         None  ...   831  16.376000     0.015  0.508   
4     False   543    None         None  ...   831  17.455000     0.017  0.631   
5     False   879    None         None  ...   539  16.201000     0.017  0.700   
6     False   879    None         None  ...   539  15.358000     0.023  0.587   
7     False   879    None         None  ...  1534  15.610000     0.023  0.692   
8      True     8    None         None  ...   540  14.378000     0.021  0.674   
9      True     8    None         None  ...   540  13.789000     0.016  0.334   
10    False   123    None         None  ...   800  18.165000     0.018  0.606   
11    False   123    None         None  ...   800  17.474000     0.018  0.286   
12    False   766    None         None  ...   488  18.723999     0.029  1.061   
13    False   766    None         None  ...   487  18.650000     0.029  0.358   
14    False   766    None         None  ...   539  16.948000     0.020  0.923   
15    False   464    None         None  ...   385  15.188999     0.021  0.683   
16    False   464    None         None  ...   385  15.940000     0.014  0.499   
17    False   211    None         None  ...   385  14.710000     0.014  0.547   
18    False   211    None         None  ...   385  13.113999     0.020  0.654   
19    False   439    None         None  ...   539  15.631000     0.019  0.552   
20    False   439    None         None  ...   539  18.620000     0.019  0.737   
21    False    13    None         None  ...   771  19.455000     0.030  1.136   
22    False    13    None         None  ...   771  18.185000     0.017  0.638   
23    False    23    None         None  ...   539  18.140000     0.030  0.649   
24    False    23    None         None  ...   539  19.477000     0.029  0.631   
25    False   383    None         None  ...   342  14.937000     0.016  0.704   
26    False   383    None         None  ...   342  14.858000     0.016  0.361   
27    False    70    None         None  ...   539  18.321001     0.023  1.243   
28    False    70    None         None  ...   539  17.045000     0.018  0.344   
29    False   262    None         None  ...   554  16.510000     0.022  0.972   
30    False   262    None         None  ...   554  15.674000     0.017  0.588   
31    False   262    None         None  ...  1549  15.697000     0.024  1.061   
32    False   371    None         None  ...   385  16.579000     0.018  0.632   
33    False   371    None         None  ...   385  14.217999     0.030  1.266   
34    False    66    None         None  ...   643  15.846000     0.021  0.761   
35    False    66    None         None  ...   643  16.708000     0.017  0.842   
36    False    66    None         None  ...  1640  15.849999     0.018  0.482   
37    False     7    None         None  ...   489  13.264000     0.015  0.205   
38    False     7    None         None  ...  1483  13.335999     0.022  0.750   
39    False   357    None         None  ...   806  12.903000     0.021  0.718   
40    False   357    None         None  ...   832  12.974999     0.015  0.733   
41    False   357    None         None  ...   832  15.303000     0.019  1.029   
42    False   357    None         None  ...   806  15.250000     0.021  1.245   
43    False  1159    None         None  ...   804  15.835999     0.012  0.497   
44    False  1159    None         None  ...   832  15.877000     0.019  0.700   
45    False  1159    None         None  ...   804  17.181000     0.012  0.476   
46    False  1159    None         None  ...   832  17.194000     0.013  0.465   
47    False   103    None         None  ...   385  13.428000     0.018  0.332   
48    False   103    None         None  ...   385  15.198000     0.015  0.475   
49    False   155    None         None  ...   640  14.722000     0.012  0.317   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.037  333.918967  58.682775  58228.489526  58279.457199         15  
1    -0.050  333.918905  58.682769  58217.494444  58276.468669         15  
2    -0.066  333.918915  58.682760  58206.523553  58282.425648         15  
3    -0.016  338.144977  63.640173  58217.494444  58287.472303         15  
4    -0.026  338.144992  63.640176  58228.489074  58283.427384         15  
5     0.013  283.808879  11.470352  58204.528588  58273.443079         15  
6    -0.007  283.808903  11.470351  58292.330949  58333.305752         40  
7     0.042  283.808899  11.470347  58348.250000  59380.500000         16  
8    -0.007  295.057809  12.943563  58205.510799  58279.443357         15  
9     0.005  295.057810  12.943565  58197.504954  58305.356736         15  
10   -0.025  300.343644  53.596922  58228.476157  58323.431192         15  
11    0.007  300.343653  53.596911  58268.415208  58441.208067         40  
12   -0.052  284.755583   8.092214  58198.504259  58276.422488         15  
13   -0.001  284.755611   8.092203  58217.484491  58275.376586         15  
14    0.019  284.756507   8.092129  58186.533692  58289.327720         15  
15   -0.030  288.248749 -12.575299  58282.439722  58291.407419         40  
16   -0.021  288.248746 -12.575288  58246.461319  58363.188113         15  
17   -0.021  290.058822 -11.459708  58246.461319  58363.188113         15  
18   -0.032  290.058833 -11.459704  58276.439375  58291.382292         40  
19   -0.026  285.012517  10.750780  58186.533692  58314.416285         15  
20   -0.045  285.012518  10.750778  58205.510336  58274.397755         15  
21   -0.063  344.268800  46.158477  58252.465648  58337.390613         15  
22   -0.031  344.268790  46.158458  58242.469248  58449.233947         40  
23   -0.061  287.625174  12.812936  58186.533692  58332.291146         15  
24   -0.046  287.625178  12.812938  58204.528588  58263.441956         15  
25   -0.024  339.358619 -18.371661  58277.459097  58373.356609         15  
26   -0.028  339.358620 -18.371672  58280.480139  58430.169861         20  
27   -0.073  284.295620  10.201663  58204.507674  58273.443079         15  
28   -0.013  284.295622  10.201666  58186.533692  58293.315150         19  
29    0.024   31.214561  17.782580  58304.464120  58351.448530         16  
30   -0.008   31.214552  17.782576  58312.445880  58374.391343         15  
31    0.048   31.214560  17.782572  58336.500000  58437.250000         18  
32   -0.018  289.004294  -8.483540  58246.461319  58348.337419         15  
33    0.050  289.004304  -8.483538  58276.439375  58291.402847         40  
34   -0.039  324.019536  25.818079  58256.423276  58279.424664         15  
35   -0.057  324.019537  25.818078  58228.487153  58280.441331         15  
36   -0.019  324.019531  25.818071  58321.250000  58757.250000         30  
37   -0.005  294.747558   3.231130  58273.380984  58340.295937         40  
38   -0.020  294.747559   3.231136  59061.500000  59732.500000         16  
39   -0.058    0.483732  60.551904  58256.483495  58342.346377         15  
40   -0.015    0.483775  60.551913  58246.450845  58279.408715         15  
41    0.000    0.483806  60.551904  58246.485810  58287.432581         15  
42   -0.075    0.483799  60.551894  58252.467512  58289.425232         15  
43   -0.006  348.296818  58.510177  58242.469699  58282.470035         15  
44   -0.041  348.296756  58.510170  58244.486042  58301.452500         15  
45   -0.010  348.296818  58.510172  58244.451910  58279.456285         15  
46   -0.026  348.296789  58.510164  58246.485810  58301.471030         15  
47    0.005  284.738650 -12.520130  58291.356609  58293.379352         40  
48   -0.024  284.738634 -12.520125  58246.461319  58366.189525         15  
49   -0.006  298.251245  28.515497  58203.507396  58254.441018         15  

[50 rows x 36 columns]]",,10.460482597351074,2025-06-25T01:02:54,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,94,10,"
query = """"""
SELECT object.*, reference.*
FROM object
INNER JOIN reference ON object.oid = reference.oid
WHERE object.reference_change = TRUE
LIMIT 50
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,14.136014223098757,2025-06-16T10:41:07,[None],"'[' was never closed (<string>, line 1)",8.367968797683716,2025-06-25T01:03:06,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,90,0,"SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking <= 2
    AND oid in
(
SELECT
    oid
FROM
    feature
WHERE
    name = 'Multiband_period'
    AND version = 'lc_classifier_1.2.1-P'
    AND value < 5
LIMIT 100
)",,,,,"[              oid classifier_name     classifier_version class_name  \
0    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        CEP   
1    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0       DSCT   
2    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        RRL   
3    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0        RRL   
4    ZTF18abadjvy   lc_classifier  hierarchical_rf_1.1.0          E   
..            ...             ...                    ...        ...   
331  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0          E   
332  ZTF18abasovn   lc_classifier   lc_classifier_1.1.13          E   
333  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0        RRL   
334  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0     Blazar   
335  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0        QSO   

     probability  ranking  
0       0.161280        2  
1       0.283360        1  
2       0.190720        1  
3       0.227040        2  
4       0.093744        2  
..           ...      ...  
331     0.424664        1  
332     0.306484        1  
333     0.188956        2  
334     0.205800        2  
335     0.678160        1  

[336 rows x 6 columns]]",,3.470367908477783,2025-06-25T01:03:10,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,90,1,"
# Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Sub-query to filter the feature table for objects with a multiband period lower than 5 days
feature_subquery = """"""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
""""""

# Final query to get all columns from the probability table for the filtered objects
final_query = f""""""
SELECT p.*
FROM probability p
WHERE p.oid IN (
    {probability_subquery}
    INTERSECT
    {feature_subquery}
)
LIMIT 100
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,25.919995546340942,2025-06-16T10:41:34,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,26.41159439086914,2025-06-25T01:03:41,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,90,2,"
# Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Sub-query to filter the feature table for multiband period less than 5 days
feature_subquery = f""""""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
""""""

# Final query to retrieve all columns from the probability table for the filtered oids
final_query = f""""""
SELECT p.*
FROM probability p
INNER JOIN (
    {probability_subquery}
    INTERSECT
    {feature_subquery}
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
AND p.ranking IN (1, 2)
LIMIT 100
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,22.750810623168945,2025-06-16T10:41:57,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,23.926817417144775,2025-06-25T01:04:12,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,90,3,"
# Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Sub-query to filter the feature table for multiband period lower than 5 days in the specified feature version
feature_subquery = f""""""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
AND oid IN ({probability_subquery})
""""""

# Final query to retrieve all columns from the probability table for the filtered objects
final_query = f""""""
SELECT p.*
FROM probability p
INNER JOIN ({feature_subquery}) f ON p.oid = f.oid
WHERE p.classifier_name = 'lc_classifier'
AND p.ranking IN (1, 2)
LIMIT 100
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,22.396374940872192,2025-06-16T10:42:19,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.44997501373291,2025-06-25T01:04:25,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,90,4,"
# Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Sub-query to filter the feature table for objects with a multiband period lower than 5 days
feature_subquery = """"""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
""""""

# Final query to retrieve all columns from the probability table for the filtered objects
final_query = f""""""
SELECT p.*
FROM probability p
WHERE p.oid IN (
    {probability_subquery}
    INTERSECT
    {feature_subquery}
)
LIMIT 100
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,30.707452058792114,2025-06-16T10:42:50,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,23.664149045944214,2025-06-25T01:04:53,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,90,5,"
# Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Sub-query to filter the feature table for multiband period less than 5 days in the specified feature version
feature_subquery = f""""""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
""""""

# Final query to retrieve all columns from the probability table for the filtered oids
final_query = f""""""
SELECT p.*
FROM probability p
WHERE p.oid IN (
    {probability_subquery}
    INTERSECT
    {feature_subquery}
)
LIMIT 100
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,23.98274707794189,2025-06-16T10:43:14,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,25.709747314453125,2025-06-25T01:05:23,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,90,6,"
# Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Sub-query to filter the feature table for objects with a multiband period lower than 5 days
feature_subquery = f""""""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
AND oid IN ({probability_subquery})
""""""

# Final query to retrieve all columns from the probability table for the filtered objects
final_query = f""""""
SELECT p.*
FROM probability p
INNER JOIN ({feature_subquery}) f ON p.oid = f.oid
WHERE p.classifier_name = 'lc_classifier'
AND p.ranking IN (1, 2)
LIMIT 100
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,19.012012481689453,2025-06-16T10:43:34,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.496848583221436,2025-06-25T01:05:36,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,90,7,"
# Sub-query to filter the probability table for the desired conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Sub-query to filter the feature table for the desired conditions
feature_subquery = """"""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
""""""

# Final query combining the sub-queries and retrieving the desired results
final_query = """"""
SELECT p.*
FROM probability p
WHERE p.oid IN (
    SELECT oid
    FROM ({probability_subquery}) AS prob
    INTERSECT
    SELECT oid
    FROM ({feature_subquery}) AS feat
)
LIMIT 100
"""""".format(probability_subquery=probability_subquery, feature_subquery=feature_subquery)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,31.565905332565308,2025-06-16T10:44:05,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,8.923546314239502,2025-06-25T01:05:49,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,90,8,"
# Sub-query to filter objects from the probability table with the specified conditions
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Sub-query to filter objects from the feature table with the specified conditions
feature_subquery = """"""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
""""""

# Final query combining the sub-queries and selecting the required data
final_query = """"""
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM ({feature_subquery}) AS f
    INTERSECT
    SELECT oid
    FROM ({probability_subquery}) AS pr
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
AND p.ranking IN (1, 2)
LIMIT 100
"""""".format(feature_subquery=feature_subquery, probability_subquery=probability_subquery)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,19.235997438430783,2025-06-16T10:44:25,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.79552936553955,2025-06-25T01:06:03,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,90,9,"
# Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Sub-query to filter the feature table for objects with a multiband period lower than 5 days
feature_subquery = """"""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
""""""

# Final query to retrieve all columns from the probability table for the filtered objects
final_query = f""""""
SELECT p.*
FROM probability p
WHERE p.oid IN (
    SELECT oid
    FROM ({probability_subquery}) AS prob
    INTERSECT
    SELECT oid
    FROM ({feature_subquery}) AS feat
)
LIMIT 100
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,21.32762384414673,2025-06-16T10:44:46,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,24.801742792129517,2025-06-25T01:06:31,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,90,10,"
# Step 1: Sub-query for Probability Table
probability_subquery = """"""
SELECT oid
FROM probability
WHERE classifier_name = 'lc_classifier'
AND ranking IN (1, 2)
""""""

# Step 2: Sub-query for Feature Table
feature_subquery = f""""""
SELECT oid
FROM feature
WHERE name = 'multiband_period'
AND value < 5
AND version = 'lc_classifier_1.2.1-P'
AND oid IN ({probability_subquery})
""""""

# Step 3: Final Query Construction
final_query = f""""""
SELECT p.*
FROM probability p
INNER JOIN ({feature_subquery}) f ON p.oid = f.oid
WHERE p.classifier_name = 'lc_classifier'
AND p.ranking IN (1, 2)
LIMIT 100
""""""

# Combine all steps into the final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,19.26492738723755,2025-06-16T10:45:06,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.808425664901733,2025-06-25T01:06:45,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,,,51,0,"SELECT
    oid, mjd, fid, mag, e_mag, mag_corr, e_mag_corr_ext, isdiffpos
FROM
    forced_photometry
WHERE
    oid = 'ZTF24aaiutyh'
ORDER BY mjd",,,,,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr_ext  isdiffpos  
0         0.397760         -1  
1         0.385556          1  
2         0.198804          1  
3         0.396211          1  
4         0.359854          1  
..             ...        ...  
60        0.052439          1  
61        0.056607          1  
62        0.044895          1  
63        0.116776          1  
64        0.086913          1  

[65 rows x 8 columns]]",,3.2395401000976562,2025-06-25T01:06:49,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,51,1,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,4.900911808013916,2025-06-16T10:45:11,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.9012017250061035,2025-06-25T01:07:01,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,51,2,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,4.207991123199463,2025-06-16T10:45:16,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.070750951766968,2025-06-25T01:07:13,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,51,3,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,3.163038969039917,2025-06-16T10:45:19,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.50308609008789,2025-06-25T01:07:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,51,4,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,5.479589462280273,2025-06-16T10:45:25,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.301199913024902,2025-06-25T01:07:38,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,51,5,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.770949602127075,2025-06-16T10:45:28,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.895798444747925,2025-06-25T01:07:52,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,51,6,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,3.5962867736816406,2025-06-16T10:45:32,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.00125527381897,2025-06-25T01:08:04,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,51,7,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,3.112713098526001,2025-06-16T10:45:35,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.687194585800171,2025-06-25T01:08:15,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,51,8,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.254549026489258,2025-06-16T10:45:37,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.72099256515503,2025-06-25T01:08:28,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,51,9,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.731321096420288,2025-06-16T10:45:41,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.780861139297485,2025-06-25T01:08:40,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,51,10,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,3.16998553276062,2025-06-16T10:45:44,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF...
                                                             ^

[SQL: SELECT     oid,     mjd,     fid,     mag,     e_mag,     mag_corr,     e_mag_corr,     isdiffposFROM     forced_photometryWHERE     oid = 'ZTF24aaiutyh'ORDER BY     mjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.052809715270996,2025-06-25T01:08:52,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,59,0,"
SELECT
    oid, fid, ndet, magmean
FROM
    magstat
WHERE
    oid = 'ZTF18acsvogv'
",,,,,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,3.2723567485809326,2025-06-25T01:08:56,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,59,1,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,1.9203577041625977,2025-06-16T10:45:46,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18...
                                                        ^

[SQL: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.535328149795532,2025-06-25T01:09:08,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,59,2,"
SELECT 
    oid,  -- ZTF identifier
    fid,  -- filter identifier
    ndet,  -- number of detections
    magmean  -- mean difference magnitude
FROM 
    magstat
WHERE 
    oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.202239513397217,2025-06-16T10:45:50,[None],"(psycopg2.errors.SyntaxError) syntax error at end of input
LINE 1: ...ence magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv'
                                                                       ^

[SQL: SELECT     oid,  -- ZTF identifier    fid,  -- filter identifier    ndet,  -- number of detections    magmean  -- mean difference magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.900151968002319,2025-06-25T01:09:19,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,59,3,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,1.6402239799499512,2025-06-16T10:45:52,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18...
                                                        ^

[SQL: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.352553844451904,2025-06-25T01:09:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,59,4,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.2900469303131104,2025-06-16T10:45:55,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18...
                                                        ^

[SQL: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.529452562332153,2025-06-25T01:09:42,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,59,5,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,1.923781394958496,2025-06-16T10:45:57,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18...
                                                        ^

[SQL: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.507312774658203,2025-06-25T01:09:54,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,59,6,"
SELECT 
    oid,  -- ZTF identifier
    fid,  -- filter identifier
    ndet,  -- number of detections
    magmean  -- mean difference magnitude
FROM 
    magstat
WHERE 
    oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.242866516113281,2025-06-16T10:46:01,[None],"(psycopg2.errors.SyntaxError) syntax error at end of input
LINE 1: ...ence magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv'
                                                                       ^

[SQL: SELECT     oid,  -- ZTF identifier    fid,  -- filter identifier    ndet,  -- number of detections    magmean  -- mean difference magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",9.000104904174805,2025-06-25T01:10:07,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,59,7,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.970935106277466,2025-06-16T10:46:04,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18...
                                                        ^

[SQL: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",8.52569055557251,2025-06-25T01:10:19,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,59,8,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.335162878036499,2025-06-16T10:46:07,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18...
                                                        ^

[SQL: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.99690842628479,2025-06-25T01:10:32,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,59,9,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.357360363006592,2025-06-16T10:46:11,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18...
                                                        ^

[SQL: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.5749266147613525,2025-06-25T01:10:43,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,59,10,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,5.557467937469482,2025-06-16T10:46:17,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18...
                                                        ^

[SQL: SELECT oid, fid, ndet, magmeanFROM magstatWHERE oid = 'ZTF18acsvogv']
(Background on this error at: https://sqlalche.me/e/20/f405)",9.184710025787354,2025-06-25T01:10:57,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,100,0,"
SELECT
    oid, mjd, fid, isdiffpos,
    magpsf, sigmapsf, NULL as diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'detection' as table
FROM
    detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, NULL as isdiffpos,
    NULL as magpsf, NULL as sigmapsf, diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'non_detection' as table
FROM
    non_detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, isdiffpos,
    NULL as magpsf, NULL as sigmapsf,
    NULL as diffmaglim,
    mag, e_mag,
    'forced_photometry' as table
FROM
    forced_photometry
WHERE
    oid = 'ZTF24aamtvxb'
",,,,,"[              oid           mjd  fid  isdiffpos     magpsf  sigmapsf  \
0    ZTF24aamtvxb  60440.276505    1        1.0  18.307241  0.082498   
1    ZTF24aamtvxb  60442.171227    1        1.0  15.560810  0.033140   
2    ZTF24aamtvxb  60444.229016    1        1.0  14.585193  0.024982   
3    ZTF24aamtvxb  60449.220266    1        1.0  13.173624  0.018505   
4    ZTF24aamtvxb  60449.310336    2        1.0  13.359071  0.016791   
..            ...           ...  ...        ...        ...       ...   
244  ZTF24aamtvxb  60592.533183    2        1.0        NaN       NaN   
245  ZTF24aamtvxb  60600.525556    2        1.0        NaN       NaN   
246  ZTF24aamtvxb  60599.535475    2        1.0        NaN       NaN   
247  ZTF24aamtvxb  60595.530752    2        1.0        NaN       NaN   
248  ZTF24aamtvxb  60594.531447    2        1.0        NaN       NaN   

     diffmaglim        mag     e_mag              table  
0           NaN        NaN       NaN          detection  
1           NaN        NaN       NaN          detection  
2           NaN        NaN       NaN          detection  
3           NaN        NaN       NaN          detection  
4           NaN        NaN       NaN          detection  
..          ...        ...       ...                ...  
244         NaN  17.383959  0.047817  forced_photometry  
245         NaN  17.480049  0.060428  forced_photometry  
246         NaN  17.442333  0.028261  forced_photometry  
247         NaN  17.347569  0.024500  forced_photometry  
248         NaN  17.469713  0.041608  forced_photometry  

[249 rows x 10 columns]]",,3.463878870010376,2025-06-25T01:11:01,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,100,1,"
detection_subquery = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

non_detection_subquery = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

forced_photometry_subquery = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

full_query = f""""""
{detection_subquery}
UNION ALL
{non_detection_subquery}
UNION ALL
{forced_photometry_subquery}
ORDER BY epoch_date
""""""
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,27.870641469955444,2025-06-16T10:53:34,[None],"invalid syntax (<string>, line 1)",14.652291297912598,2025-06-25T01:11:20,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,100,2,"
detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

non_detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

forced_photometry_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

full_query = f""""""
{detections_query}
UNION
{non_detections_query}
UNION
{forced_photometry_query}
ORDER BY epoch_date
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,24.345059156417847,2025-06-16T10:53:59,[None],"invalid syntax (<string>, line 1)",13.50356388092041,2025-06-25T01:11:37,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,100,3,"
# Subquery for Detections
detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Subquery for Non-Detections
non_detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Subquery for Forced Photometry
forced_photometry_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Combine all subqueries using UNION
full_query = f""""""
{detections_query}
UNION
{non_detections_query}
UNION
{forced_photometry_query}
ORDER BY epoch_date
""""""
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,19.55949544906616,2025-06-16T10:54:18,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 47:     mag AS forced_diff_mag, 
             ^

[SQL: 

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

ORDER BY epoch_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.220412731170654,2025-06-25T01:11:54,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,100,4,"
detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

non_detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

forced_photometry_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

full_query = f""""""
{detections_query}
UNION
{non_detections_query}
UNION
{forced_photometry_query}
ORDER BY epoch_date
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,26.178884029388428,2025-06-16T10:54:44,[None],"invalid syntax (<string>, line 1)",13.51444149017334,2025-06-25T01:12:11,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,100,5,"
# Subquery for Detections
detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Subquery for Non-Detections
non_detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Subquery for Forced Photometry
forced_photometry_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Combine all subqueries
full_query = f""""""
{detections_query}
UNION ALL
{non_detections_query}
UNION ALL
{forced_photometry_query}
ORDER BY epoch_date
""""""
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,18.27235984802246,2025-06-16T10:55:03,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 47:     mag AS forced_diff_mag, 
             ^

[SQL: 

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

ORDER BY epoch_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.45714807510376,2025-06-25T01:12:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,100,6,"
detection_subquery = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

non_detection_subquery = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

forced_photometry_subquery = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

full_query = f""""""
{detection_subquery}
UNION ALL
{non_detection_subquery}
UNION ALL
{forced_photometry_subquery}
""""""
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,23.586771488189697,2025-06-16T10:55:26,[None],"invalid syntax (<string>, line 1)",12.48242449760437,2025-06-25T01:12:47,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,100,7,"
detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

non_detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

forced_photometry_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

full_query = f""""""
{detections_query}
UNION ALL
{non_detections_query}
UNION ALL
{forced_photometry_query}
ORDER BY epoch_date
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,26.20413613319397,2025-06-16T10:55:53,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 47:     mag AS forced_difference_magnitude, 
             ^

[SQL: 

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

ORDER BY epoch_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",19.29133701324463,2025-06-25T01:13:10,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,100,8,"
# Subquery for Detections
detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Subquery for Non-Detections
non_detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Subquery for Forced Photometry
forced_photometry_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Combine all subqueries
full_query = f""""""
{detections_query}
UNION ALL
{non_detections_query}
UNION ALL
{forced_photometry_query}
ORDER BY epoch_date
""""""
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,23.50993514060974,2025-06-16T10:56:16,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 47:     mag AS forced_diff_mag, 
             ^

[SQL: 

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

ORDER BY epoch_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.685872554779053,2025-06-25T01:13:28,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,100,9,"
# Subquery for Detections
detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Subquery for Non-Detections
non_detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Subquery for Forced Photometry
forced_photometry_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

# Combine all subqueries using UNION ALL
full_query = f""""""
{detections_query}
UNION ALL
{non_detections_query}
UNION ALL
{forced_photometry_query}
ORDER BY epoch_date
""""""
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,23.50310969352722,2025-06-16T10:56:40,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 47:     mag AS forced_difference_magnitude, 
             ^

[SQL: 

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

ORDER BY epoch_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.313533782958984,2025-06-25T01:13:46,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,100,10,"
detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

non_detections_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

forced_photometry_query = """"""
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
""""""

full_query = f""""""
{detections_query}
UNION ALL
{non_detections_query}
UNION ALL
{forced_photometry_query}
ORDER BY epoch_date
""""""
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,19.41485548019409,2025-06-16T10:57:00,[None],"invalid syntax (<string>, line 1)",13.644270420074463,2025-06-25T01:14:05,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,106,0,"
SELECT
    sq1.oid, sq1.ndet, sq1.firstmjd,
    sq1.probability as prob_stamp_bogus,
    sq2.probability as prob_lc_transient
FROM
(
SELECT
    object.oid, object.ndet, object.firstmjd,
    probability.class_name,
    probability.probability
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    ndet > 10
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'bogus'
    AND probability > 0.7
    AND classifier_version = 'stamp_classifier_1.0.4'
) AS sq1
INNER JOIN
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier_top'
    AND class_name = 'Transient'
    AND probability > 0.9
) AS sq2
ON sq1.oid = sq2.oid
ORDER BY sq1.oid
LIMIT 30
",,,,,"[             oid  ndet      firstmjd  prob_stamp_bogus  prob_lc_transient
0   ZTF17aaahhwn    16  60168.430151          0.771008              1.000
1   ZTF18aajkcdn    11  59904.431377          0.767230              0.954
2   ZTF18abjrfqx    56  58325.466678          0.745006              1.000
3   ZTF18ablowct    25  58334.328206          0.700790              1.000
4   ZTF18abmwnov    57  58346.359896          0.715889              1.000
5   ZTF18absdojk   378  58362.167813          0.705910              0.952
6   ZTF18abuicad    67  58371.378785          0.835837              0.956
7   ZTF18abzbkby    37  58385.452824          0.864839              0.994
8   ZTF18acbwxcc    23  58423.140255          0.777057              0.970
9   ZTF18acszayr    30  58456.220949          0.767309              0.938
10  ZTF19aaoyjoz    17  58580.254491          0.761249              0.982
11  ZTF19aauoiow   117  58636.423935          0.773761              1.000
12  ZTF19aavjzrz   113  58643.455984          0.794810              1.000
13  ZTF19aawsdlq    34  58636.421644          0.792299              1.000
14  ZTF19aazfvhh    63  58646.469097          0.722329              0.996
15  ZTF19abwsecm    26  58725.461806          0.808821              1.000
16  ZTF19abxjimu   143  58732.422708          0.721538              0.998
17  ZTF19abzqwpr    45  58746.390891          0.713936              0.998
18  ZTF19abzsnqm    31  58746.390394          0.788473              0.988
19  ZTF19acbkczc    25  58754.207940          0.911203              0.936
20  ZTF19aczmkbo    19  58836.133241          0.822191              1.000
21  ZTF20aafpojg    23  58863.214120          0.729397              0.964
22  ZTF20abjsyqn    21  59036.374190          0.710259              0.922
23  ZTF20abylbuf    90  59096.384016          0.724529              1.000
24  ZTF20acjbhhp    60  59136.325822          0.703471              1.000
25  ZTF20acoyvdg    23  59157.236493          0.705165              0.996
26  ZTF20acpmgdz    64  59165.336678          0.724588              1.000
27  ZTF20acqzjqz   107  59169.318993          0.752268              1.000
28  ZTF20acwgxhk    48  59193.197292          0.739050              0.976
29  ZTF20acxdawc    17  59193.198241          0.861717              0.968]",,41.20831561088562,2025-06-25T01:14:47,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,106,1,"
# Subquery for Stamp Classifier
stamp_classifier_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
""""""

# Subquery for Light Curve Classifier
lc_classifier_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
""""""

# Main Query
full_query = """"""
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN ({stamp_classifier_subquery}) sc ON o.oid = sc.oid
INNER JOIN ({lc_classifier_subquery}) lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
"""""".format(stamp_classifier_subquery=stamp_classifier_subquery, lc_classifier_subquery=lc_classifier_subquery)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.49346137046814,2025-06-16T10:57:21,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,9.857379674911499,2025-06-25T01:15:03,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,106,2,"
# Subquery for Bogus Probability
bogus_prob_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
  AND ranking = 1
""""""

# Subquery for Transient Probability
transient_prob_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
  AND ranking = 1
""""""

# Final Query
final_query = f""""""
SELECT o.oid, o.ndet, o.firstmjd, bp.prob_stamp_bogus, tp.prob_lc_transient
FROM object o
INNER JOIN ({bogus_prob_subquery}) bp ON o.oid = bp.oid
INNER JOIN ({transient_prob_subquery}) tp ON o.oid = tp.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
""""""

# Assign the final query to the full_query variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,22.87533068656921,2025-06-16T10:57:44,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,14.599767446517944,2025-06-25T01:15:22,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,106,3,"
# Subquery for Stamp Classifier
stamp_classifier_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
""""""

# Subquery for Light Curve Classifier Top Level
lc_classifier_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
""""""

# Final Query
full_query = f""""""
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN ({stamp_classifier_subquery}) sc ON o.oid = sc.oid
INNER JOIN ({lc_classifier_subquery}) lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,29.54082536697388,2025-06-16T10:58:14,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,9.855131149291992,2025-06-25T01:15:37,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,106,4,"
# Subquery for Bogus Probability
bogus_prob_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
""""""

# Subquery for Transient Probability
transient_prob_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
""""""

# Final Query
full_query = f""""""
SELECT o.oid, o.ndet, o.firstmjd, bp.prob_stamp_bogus, tp.prob_lc_transient
FROM object o
INNER JOIN ({bogus_prob_subquery}) bp ON o.oid = bp.oid
INNER JOIN ({transient_prob_subquery}) tp ON o.oid = tp.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.88082361221313,2025-06-16T10:58:34,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,9.897904634475708,2025-06-25T01:15:52,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,106,5,"
# Subquery for Stamp Classifier
stamp_classifier_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
  AND ranking = 1
""""""

# Subquery for Light Curve Classifier Top Level
lc_classifier_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
  AND ranking = 1
""""""

# Final Query
final_query = f""""""
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN ({stamp_classifier_subquery}) sc ON o.oid = sc.oid
INNER JOIN ({lc_classifier_subquery}) lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
""""""

# Assign the final query to the full_query variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.95684027671814,2025-06-16T10:58:54,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,12.813354969024658,2025-06-25T01:16:10,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,106,6,"
# Subquery for Bogus Probability
bogus_prob_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
""""""

# Subquery for Transient Probability
transient_prob_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
""""""

# Final Query combining the subqueries with the object table
final_query = f""""""
SELECT o.oid, o.ndet, o.firstmjd, bp.prob_stamp_bogus, tp.prob_lc_transient
FROM object o
INNER JOIN ({bogus_prob_subquery}) bp ON o.oid = bp.oid
INNER JOIN ({transient_prob_subquery}) tp ON o.oid = tp.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
""""""

# Assign the final query to the full_query variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.963688611984253,2025-06-16T10:59:20,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.122175216674805,2025-06-25T01:16:27,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,106,7,"
# Subquery for Stamp Classifier
stamp_classifier_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
""""""

# Subquery for Light Curve Classifier Top Level
lc_classifier_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
""""""

# Main Query
main_query = f""""""
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN ({stamp_classifier_subquery}) sc ON o.oid = sc.oid
INNER JOIN ({lc_classifier_subquery}) lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
""""""

# Final Query
full_query = main_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,20.423657655715942,2025-06-16T10:59:41,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.617199659347534,2025-06-25T01:16:44,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,106,8,"
# Subquery for Bogus Probability
bogus_prob_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
  AND ranking = 1
""""""

# Subquery for Transient Probability
transient_prob_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
  AND ranking = 1
""""""

# Final Query
final_query = f""""""
SELECT o.oid, o.ndet, o.firstmjd, bp.prob_stamp_bogus, tp.prob_lc_transient
FROM object o
INNER JOIN ({bogus_prob_subquery}) bp ON o.oid = bp.oid
INNER JOIN ({transient_prob_subquery}) tp ON o.oid = tp.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
""""""

# Assign the final query to the full_query variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.735939025878903,2025-06-16T11:00:01,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,14.178342342376709,2025-06-25T01:17:03,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,106,9,"
# Subquery for Stamp Classifier
stamp_classifier_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
""""""

# Subquery for Light Curve Classifier Top Level
lc_classifier_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
""""""

# Final Query combining the subqueries with the object table
final_query = """"""
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN ({stamp_classifier_subquery}) sc ON o.oid = sc.oid
INNER JOIN ({lc_classifier_subquery}) lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
"""""".format(stamp_classifier_subquery=stamp_classifier_subquery, lc_classifier_subquery=lc_classifier_subquery)

# Assign the final query to the full_query variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,26.405288457870483,2025-06-16T11:00:27,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,9.439543724060059,2025-06-25T01:17:18,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,gpt-4o,v3,106,10,"
# Subquery for Stamp Classifier
stamp_classifier_subquery = """"""
SELECT oid, probability AS prob_stamp_bogus
FROM probability
WHERE class_name = 'bogus'
  AND classifier_name = 'stamp_classifier'
  AND classifier_version = 'stamp_classifier_1.0.4'
  AND probability > 0.7
""""""

# Subquery for Light Curve Classifier Top Level
lc_classifier_subquery = """"""
SELECT oid, probability AS prob_lc_transient
FROM probability
WHERE class_name = 'transient'
  AND classifier_name = 'lc_classifier_top'
  AND probability > 0.9
""""""

# Final Query
full_query = f""""""
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN ({stamp_classifier_subquery}) sc ON o.oid = sc.oid
INNER JOIN ({lc_classifier_subquery}) lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,26.304603338241577,2025-06-16T11:00:54,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.475574016571045,2025-06-25T01:17:34,0.0,0.0,1.0,1.0,0.0,1.0
0.18.1,,,56,0,"SELECT
    oid, ndet, meanra, meandec,
    firstmjd, lastmjd,
    g_r_mean, g_r_mean_corr
FROM
    object
WHERE
    oid IN ('ZTF20abywydb','ZTF20abzpxxu','ZTF20acduffd')
    AND not corrected
ORDER BY firstmjd",,,,,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,3.34981632232666,2025-06-25T01:17:38,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,56,1,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND NOT corrected 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.444474697113037,2025-06-16T11:00:58,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,10.072012186050415,2025-06-25T01:17:53,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,56,2,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND NOT corrected 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.97304630279541,2025-06-16T11:01:03,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,8.831255197525024,2025-06-25T01:18:07,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,56,3,"
SELECT 
    o.oid AS ""ZTF identifier"", 
    o.ndet AS ""number of detections"", 
    o.meanra AS ""mean RA"", 
    o.meandec AS ""mean Dec"", 
    o.firstmjd AS ""date of first detection"", 
    o.lastmjd AS ""date of last detection"", 
    o.g_r_mean AS ""difference between mean g- and r-band difference magnitudes"", 
    o.g_r_mean_corr AS ""difference between mean g- and r-band corrected magnitudes""
FROM 
    object o
WHERE 
    o.oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')
    AND o.corrected = FALSE
ORDER BY 
    o.firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,5.211292743682861,2025-06-16T11:01:08,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""o""
LINE 1: ...d corrected magnitudes""FROM     object oWHERE     o.oid IN (...
                                                             ^

[SQL: SELECT     o.oid AS ""ZTF identifier"",     o.ndet AS ""number of detections"",     o.meanra AS ""mean RA"",     o.meandec AS ""mean Dec"",     o.firstmjd AS ""date of first detection"",     o.lastmjd AS ""date of last detection"",     o.g_r_mean AS ""difference between mean g- and r-band difference magnitudes"",     o.g_r_mean_corr AS ""difference between mean g- and r-band corrected magnitudes""FROM     object oWHERE     o.oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')    AND o.corrected = FALSEORDER BY     o.firstmjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.760983943939209,2025-06-25T01:18:21,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,56,4,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND NOT corrected 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.016999959945679,2025-06-16T11:01:12,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,8.541051387786865,2025-06-25T01:18:35,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,56,5,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND NOT corrected 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.982090711593628,2025-06-16T11:01:16,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,8.601830244064331,2025-06-25T01:18:48,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,56,6,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.162226438522339,2025-06-16T11:01:21,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,9.125040292739868,2025-06-25T01:19:01,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,56,7,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND NOT corrected 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.9968149662017822,2025-06-16T11:01:25,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,8.688844203948975,2025-06-25T01:19:15,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,56,8,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND NOT corrected 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.210201978683472,2025-06-16T11:01:29,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,9.117160320281982,2025-06-25T01:19:30,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,56,9,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr
FROM 
    object
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND NOT corrected
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.007767915725708,2025-06-16T11:01:33,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""oid""
LINE 1: ...r_mean,     g_r_mean_corrFROM     objectWHERE     oid IN ('Z...
                                                             ^

[SQL: SELECT     oid,     ndet,     meanra,     meandec,     firstmjd,     lastmjd,     g_r_mean,     g_r_mean_corrFROM     objectWHERE     oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')     AND corrected = FALSEORDER BY     firstmjd]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.389698028564453,2025-06-25T01:19:42,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,56,10,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.374988079071045,2025-06-16T11:01:38,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,8.22208023071289,2025-06-25T01:19:54,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,,,48,0,"SELECT
    oid, name, value, fid, version
FROM
    feature
WHERE
    oid = 'ZTF18abqyaix'
ORDER BY name, fid, version
",,,,,"[              oid             name     value  fid                version
0    ZTF18abqyaix        Amplitude  0.269018    1  lc_classifier_1.2.1-P
1    ZTF18abqyaix        Amplitude  0.599888    2  lc_classifier_1.2.1-P
2    ZTF18abqyaix  AndersonDarling  0.249661    1  lc_classifier_1.2.1-P
3    ZTF18abqyaix  AndersonDarling  0.994609    2  lc_classifier_1.2.1-P
4    ZTF18abqyaix   Autocor_length  5.000000    1  lc_classifier_1.2.1-P
..            ...              ...       ...  ...                    ...
173  ZTF18abqyaix              Std  0.360955    2  lc_classifier_1.2.1-P
174  ZTF18abqyaix         StetsonK  0.869824    1  lc_classifier_1.2.1-P
175  ZTF18abqyaix         StetsonK  0.941219    2  lc_classifier_1.2.1-P
176  ZTF18abqyaix            W1-W2       NaN    0  lc_classifier_1.2.1-P
177  ZTF18abqyaix            W2-W3       NaN    0  lc_classifier_1.2.1-P

[178 rows x 5 columns]]",,3.5515642166137695,2025-06-25T01:19:59,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,48,1,"
# Query to retrieve all features for the ZTF object 'ZTF18abqyaix'
query = """"""
SELECT 
    oid, 
    name, 
    value, 
    fid, 
    version
FROM 
    feature
WHERE 
    oid = 'ZTF18abqyaix'
ORDER BY 
    oid, 
    fid, 
    version
""""""
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,18.318978309631348,2025-06-16T11:33:28,[None],"'[' was never closed (<string>, line 1)",8.692579746246338,2025-06-25T01:20:12,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,48,2,"
# Sub-query to retrieve all features for the ZTF object 'ZTF18abqyaix'
features_query = """"""
SELECT 
    feature.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
""""""

# Final query
full_query = features_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,16.102814197540283,2025-06-16T11:33:45,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,10.060817003250122,2025-06-25T01:20:26,1.0,1.0,0.2,0.2,1.0,0.0
0.18.1,gpt-4o,v3,48,3,"
# Query to retrieve all features for the ZTF object 'ZTF18abqyaix'
query = """"""
SELECT 
    feature.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    feature.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,17.30983018875122,2025-06-16T11:34:03,[None],"'[' was never closed (<string>, line 1)",8.781481742858887,2025-06-25T01:20:39,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,48,4,"
# Sub-query to retrieve all features for the ZTF object 'ZTF18abqyaix'
features_subquery = """"""
SELECT 
    feature.oid AS ztf_identifier, 
    feature.name AS feature_name, 
    feature.value AS feature_value, 
    feature.fid AS filter_identifier, 
    feature.version AS feature_version
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
""""""

# Final query
full_query = features_subquery
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,15.10700249671936,2025-06-16T11:34:18,"[              oid    feature_name  feature_value  filter_identifier  \
0    ZTF18abqyaix            g-W3            NaN                  0   
1    ZTF18abqyaix            g-W2            NaN                  0   
2    ZTF18abqyaix           W2-W3            NaN                  0   
3    ZTF18abqyaix           W1-W2            NaN                  0   
4    ZTF18abqyaix        sgscore1       0.003750                  0   
..            ...             ...            ...                ...   
173  ZTF18abqyaix    Power_rate_2       0.145128                 12   
174  ZTF18abqyaix    Power_rate_3       0.146342                 12   
175  ZTF18abqyaix    Power_rate_4       0.090179                 12   
176  ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177  ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature_version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,11.246378421783447,2025-06-25T01:20:54,1.0,1.0,0.0,0.0,1.0,0.0
0.18.1,gpt-4o,v3,48,5,"
# Step 1: Main Query to retrieve all features for the ZTF object 'ZTF18abqyaix'
query = """"""
SELECT 
    oid, 
    name, 
    value, 
    fid, 
    version
FROM 
    feature
WHERE 
    oid = 'ZTF18abqyaix'
ORDER BY 
    oid, 
    fid, 
    version
""""""
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,14.767359733581545,2025-06-16T11:34:33,[None],"'[' was never closed (<string>, line 1)",9.769491195678711,2025-06-25T01:21:08,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,48,6,"
query = """"""
SELECT 
    feature.oid, 
    feature.name, 
    feature.value, 
    feature.fid, 
    feature.version
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, 
    feature.fid, 
    feature.version
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,15.665133953094482,2025-06-16T11:34:49,[None],"'[' was never closed (<string>, line 1)",9.843760013580322,2025-06-25T01:21:22,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,48,7,"
# Define the sub-query to retrieve all features for the ZTF object 'ZTF18abqyaix'
feature_query = """"""
SELECT oid, name, value, fid, version
FROM feature
WHERE oid = 'ZTF18abqyaix'
ORDER BY oid, fid, version
""""""

# Join the sub-query into the final query
full_query = feature_query
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,11.037874460220335,2025-06-16T11:35:01,"[              oid            name     value  fid                version
0    ZTF18abqyaix            g-W3       NaN    0  lc_classifier_1.2.1-P
1    ZTF18abqyaix            g-W2       NaN    0  lc_classifier_1.2.1-P
2    ZTF18abqyaix           W2-W3       NaN    0  lc_classifier_1.2.1-P
3    ZTF18abqyaix           W1-W2       NaN    0  lc_classifier_1.2.1-P
4    ZTF18abqyaix        sgscore1  0.003750    0  lc_classifier_1.2.1-P
..            ...             ...       ...  ...                    ...
173  ZTF18abqyaix    Power_rate_2  0.145128   12  lc_classifier_1.2.1-P
174  ZTF18abqyaix    Power_rate_3  0.146342   12  lc_classifier_1.2.1-P
175  ZTF18abqyaix    Power_rate_4  0.090179   12  lc_classifier_1.2.1-P
176  ZTF18abqyaix  Power_rate_1/4  0.114255   12  lc_classifier_1.2.1-P
177  ZTF18abqyaix  Power_rate_1/3  0.114255   12  lc_classifier_1.2.1-P

[178 rows x 5 columns]]",,10.75766634941101,2025-06-25T01:21:37,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,48,8,"
# Step 1: Main Query to retrieve features for the specific ZTF object
query_features = """"""
SELECT 
    feature.oid, 
    feature.name, 
    feature.value, 
    feature.fid, 
    feature.version
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    feature.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, 
    feature.fid, 
    feature.version
""""""

# Final Query
full_query = query_features
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,16.234848022460938,2025-06-16T11:35:17,"[              oid            name     value  fid                version
0    ZTF18abqyaix            g-W3       NaN    0  lc_classifier_1.2.1-P
1    ZTF18abqyaix            g-W2       NaN    0  lc_classifier_1.2.1-P
2    ZTF18abqyaix           W2-W3       NaN    0  lc_classifier_1.2.1-P
3    ZTF18abqyaix           W1-W2       NaN    0  lc_classifier_1.2.1-P
4    ZTF18abqyaix        sgscore1  0.003750    0  lc_classifier_1.2.1-P
..            ...             ...       ...  ...                    ...
173  ZTF18abqyaix    Power_rate_2  0.145128   12  lc_classifier_1.2.1-P
174  ZTF18abqyaix    Power_rate_3  0.146342   12  lc_classifier_1.2.1-P
175  ZTF18abqyaix    Power_rate_4  0.090179   12  lc_classifier_1.2.1-P
176  ZTF18abqyaix  Power_rate_1/4  0.114255   12  lc_classifier_1.2.1-P
177  ZTF18abqyaix  Power_rate_1/3  0.114255   12  lc_classifier_1.2.1-P

[178 rows x 5 columns]]",,8.49854302406311,2025-06-25T01:21:49,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,48,9,"
# Sub-query to retrieve all features for the ZTF object 'ZTF18abqyaix'
features_query = """"""
SELECT 
    feature.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
""""""

# Final query
full_query = features_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,17.10571265220642,2025-06-16T11:35:34,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.262881755828857,2025-06-25T01:22:02,1.0,1.0,0.2,0.2,1.0,0.0
0.18.1,gpt-4o,v3,48,10,"
# Step 1: Main Query to retrieve all features for the ZTF object 'ZTF18abqyaix'
query_features = """"""
SELECT 
    oid, 
    name, 
    value, 
    fid, 
    version
FROM 
    feature
WHERE 
    oid = 'ZTF18abqyaix'
ORDER BY 
    oid, 
    fid, 
    version
""""""
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,24.38269829750061,2025-06-16T11:35:59,[None],"'[' was never closed (<string>, line 1)",8.223434686660767,2025-06-25T01:22:14,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,58,0,"SELECT
    *
FROM
    object
WHERE
    ndet >= 30
    AND g_r_max_corr > 3.5
    AND deltajd > 10
LIMIT 20",,,,,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF18ablqwwb        99      1452  58246.438912  60505.283009       True   
19  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18    False    30  2.706536      3.555395  ...  274.210093 -11.143490   
19     True    30  3.235800      3.623149  ...  277.959517  -6.129832   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.061259  0.060104  2169.054109  58336.228901  60505.283009   
19  0.000109  0.000111    74.875255  59621.545683  59696.420937   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18          24.5.2a6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,11.100197076797485,2025-06-25T01:22:26,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,58,1,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.936786890029907,2025-06-16T11:36:04,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr -...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.966439247131348,2025-06-25T01:22:38,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,58,2,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.815251111984253,2025-06-16T11:36:08,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr -...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.070219278335571,2025-06-25T01:22:50,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,58,3,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,6.117708683013916,2025-06-16T11:36:15,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr -...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.075894594192505,2025-06-25T01:23:02,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,58,4,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.504852533340454,2025-06-16T11:36:20,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr -...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",7.951084852218628,2025-06-25T01:23:14,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,58,5,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.925798177719116,2025-06-16T11:36:24,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr -...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.015798330307007,2025-06-25T01:23:27,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,58,6,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,5.354051828384399,2025-06-16T11:36:30,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr -...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.737436294555664,2025-06-25T01:23:39,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,58,7,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.430248260498047,2025-06-16T11:36:33,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  -- Corrected colum...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  -- Corrected column name from 'ndet' to 'ndethist'  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.004002094268799,2025-06-25T01:23:52,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,58,8,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.634068012237549,2025-06-16T11:36:37,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  -- Corrected colum...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  -- Corrected column name from 'ndet' to 'ndethist'  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.285161018371582,2025-06-25T01:24:05,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,58,9,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.1529104709625244,2025-06-16T11:36:41,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr -...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.009684801101685,2025-06-25T01:24:17,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,58,10,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.576635837554932,2025-06-16T11:36:44,[None],"(psycopg2.errors.SyntaxError) syntax error at or near "">=""
LINE 1: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr -...
                                           ^

[SQL: SELECT * FROM objectWHERE ndethist >= 30  AND g_r_max_corr - g_r_mean_corr > 3.5  AND deltajd > 20LIMIT 20]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.029955625534058,2025-06-25T01:24:29,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,78,0,"SELECT
    *
FROM
    taxonomy
WHERE
    classifier_name = 'lc_classifier'",,,,,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,3.4013831615448,2025-06-25T01:24:33,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,78,1,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.067512035369873,2025-06-16T11:36:48,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.625881671905518,2025-06-25T01:24:45,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,78,2,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.601973056793213,2025-06-16T11:36:50,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.528411865234375,2025-06-25T01:24:57,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,78,3,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.733088970184326,2025-06-16T11:36:53,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.860394239425659,2025-06-25T01:25:09,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,78,4,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.349646806716919,2025-06-16T11:36:56,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.4459826946258545,2025-06-25T01:25:20,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,78,5,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.268355369567871,2025-06-16T11:36:58,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.6788153648376465,2025-06-25T01:25:32,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,78,6,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.612077474594116,2025-06-16T11:37:02,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.560454368591309,2025-06-25T01:25:44,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,78,7,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.6314022541046143,2025-06-16T11:37:05,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.40995454788208,2025-06-25T01:25:55,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,78,8,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.8114681243896484,2025-06-16T11:37:08,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",8.026705265045166,2025-06-25T01:26:07,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,78,9,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.9354488849639893,2025-06-16T11:37:11,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.558422565460205,2025-06-25T01:26:19,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,78,10,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.708778142929077,2025-06-16T11:37:14,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""classifier_name""
LINE 1: ...me, classifier_version, classesFROM taxonomyWHERE classifier...
                                                             ^

[SQL: SELECT classifier_name, classifier_version, classesFROM taxonomyWHERE classifier_name = 'lc_classifier']
(Background on this error at: https://sqlalche.me/e/20/f405)",7.911098003387451,2025-06-25T01:26:31,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,,,39,0,"SELECT
  sq.oid, sq.meanra, sq.meandec,
  detection.candid, detection.fid as f_id,detection.magpsf, detection.sigmapsf_corr, detection.sigmapsf_corr_ext
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier_stochastic'
    AND probability.class_name='CV/Nova'
    AND probability.ranking = 1
) AS sq
  INNER JOIN detection
  ON sq.oid = detection.oid
WHERE
  sq.ndet < 50
  AND detection.fid = 2
ORDER BY oid
LIMIT 1000
",,,,,"[              oid      meanra    meandec               candid  f_id  \
0    ZTF17aaaaanb  324.816860  45.593583   537475640115015008     2   
1    ZTF17aaaaanb  324.816860  45.593583   607270780115015027     2   
2    ZTF17aaaaanb  324.816860  45.593583   613325340115010003     2   
3    ZTF17aaaaanb  324.816860  45.593583   536383390115015014     2   
4    ZTF17aaaaanb  324.816860  45.593583   529390300115015005     2   
..            ...         ...        ...                  ...   ...   
995  ZTF17aaadgdr  116.399044  32.744831  1770447452515010006     2   
996  ZTF17aaadgdr  116.399044  32.744831  1749372252515010004     2   
997  ZTF17aaadgdr  116.399044  32.744831  1707500242515010003     2   
998  ZTF17aaadgdr  116.399044  32.744831  1449452172515015013     2   
999  ZTF17aaadgdr  116.399044  32.744831  1496215692515015015     2   

        magpsf  sigmapsf_corr  sigmapsf_corr_ext  
0    19.760700       0.021343           0.031418  
1    19.648392       0.026439           0.034795  
2    19.791729       0.025855           0.043814  
3    19.882864       0.022219           0.032339  
4    19.678644     100.000000           0.019559  
..         ...            ...                ...  
995  17.057882       0.013267           0.023265  
996  17.945915     100.000000           0.014774  
997  17.377996       0.005561           0.018345  
998  18.655804     100.000000           0.005591  
999  19.048782     100.000000           0.004847  

[1000 rows x 8 columns]]",,6.678541421890259,2025-06-25T01:26:38,1.0,1.0,1.0,1.0,1.0,1.0
0.18.1,gpt-4o,v3,39,1,"
# Subquery for Probability
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
AND classifier_name = 'lc_classifier_stochastic'
AND ranking = 1
""""""

# Subquery for Object
object_subquery = """"""
SELECT oid
FROM object
WHERE ndet <= 50
""""""

# Subquery for Detection
detection_subquery = """"""
SELECT oid, candid, ra, dec, magpsf_corr, magpsf
FROM detection
WHERE fid = 2
""""""

# Subquery for Magstat
magstat_subquery = """"""
SELECT oid, magmax_corr, magmin_corr
FROM magstat
WHERE fid = 2
""""""

# Final Query
full_query = f""""""
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, m.magmax_corr, m.magmin_corr
FROM ({probability_subquery}) p
INNER JOIN ({object_subquery}) o ON p.oid = o.oid
INNER JOIN ({detection_subquery}) d ON o.oid = d.oid
INNER JOIN ({magstat_subquery}) m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,25.76883029937744,2025-06-16T11:40:18,"[              oid               candid          ra        dec  magpsf_corr  \
0    ZTF17aaaaanb   537475640115015008  324.816838  45.593586    17.878054   
1    ZTF17aaaaanb   607270780115015027  324.816914  45.593575    17.857359   
2    ZTF17aaaaanb   613325340115010003  324.816873  45.593583    18.342743   
3    ZTF17aaaaanb   536383390115015014  324.816970  45.593631    17.898651   
4    ZTF17aaaaanb   529390300115015005  324.816837  45.593660    17.863106   
..            ...                  ...         ...        ...          ...   
995  ZTF17aaadasq  1462249394015010007   71.777284  -1.224114    15.950828   
996  ZTF17aaadasq   680356974015010001   71.777208  -1.224201    15.770741   
997  ZTF17aaaddnz  2601135243615015015   82.263412  42.077390    16.939540   
998  ZTF17aaaddnz  2259148213615015003   82.263267  42.077525    16.913158   
999  ZTF17aaaddnz  2155389053615015003   82.263332  42.077491    16.820160   

        magpsf  magmax_corr  magmin_corr  
0    19.760700    18.342743    17.818405  
1    19.648392    18.342743    17.818405  
2    19.791729    18.342743    17.818405  
3    19.882864    18.342743    17.818405  
4    19.678644    18.342743    17.818405  
..         ...          ...          ...  
995  17.562300    15.967023    15.658115  
996  19.287691    15.967023    15.658115  
997  19.438950    17.132713    16.820160  
998  19.200290    17.132713    16.820160  
999  18.601990    17.132713    16.820160  

[1000 rows x 8 columns]]",,13.10468053817749,2025-06-25T01:26:59,0.964,0.975,0.375,0.375,0.0,0.0
0.18.1,gpt-4o,v3,39,2,"
# Subquery to filter objects classified as 'CV/Nova' with the highest probability using 'lc_classifier_stochastic'
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
AND ranking = 1
AND classifier_name = 'lc_classifier_stochastic'
""""""

# Main query to join tables and apply conditions
final_query = f""""""
SELECT 
    o.oid, 
    d.candid, 
    d.fid AS f_id, 
    d.ra, 
    d.dec, 
    d.magpsf_corr, 
    d.magpsf, 
    (m.magmax_corr - m.magmin_corr) AS max_rise
FROM 
    object o
INNER JOIN 
    ({probability_subquery}) p ON o.oid = p.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    magstat m ON o.oid = m.oid AND d.fid = m.fid
WHERE 
    o.ndet <= 50
AND 
    d.fid = 2
AND 
    m.fid = 2
ORDER BY 
    o.oid
LIMIT 1000
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,42.06597638130188,2025-06-16T11:43:14,"[              oid               candid          ra        dec  magpsf_corr  \
0    ZTF17aaaaanb   537475640115015008  324.816838  45.593586    17.878054   
1    ZTF17aaaaanb   607270780115015027  324.816914  45.593575    17.857359   
2    ZTF17aaaaanb   613325340115010003  324.816873  45.593583    18.342743   
3    ZTF17aaaaanb   536383390115015014  324.816970  45.593631    17.898651   
4    ZTF17aaaaanb   529390300115015005  324.816837  45.593660    17.863106   
..            ...                  ...         ...        ...          ...   
995  ZTF17aaadasq  1462249394015010007   71.777284  -1.224114    15.950828   
996  ZTF17aaadasq   680356974015010001   71.777208  -1.224201    15.770741   
997  ZTF17aaaddnz  2601135243615015015   82.263412  42.077390    16.939540   
998  ZTF17aaaddnz  2259148213615015003   82.263267  42.077525    16.913158   
999  ZTF17aaaddnz  2155389053615015003   82.263332  42.077491    16.820160   

        magpsf  magmax_corr  magmin_corr  
0    19.760700    18.342743    17.818405  
1    19.648392    18.342743    17.818405  
2    19.791729    18.342743    17.818405  
3    19.882864    18.342743    17.818405  
4    19.678644    18.342743    17.818405  
..         ...          ...          ...  
995  17.562300    15.967023    15.658115  
996  19.287691    15.967023    15.658115  
997  19.438950    17.132713    16.820160  
998  19.200290    17.132713    16.820160  
999  18.601990    17.132713    16.820160  

[1000 rows x 8 columns]]",,10.658256530761719,2025-06-25T01:27:15,0.964,0.975,0.375,0.375,0.0,0.0
0.18.1,gpt-4o,v3,39,3,"
# Subquery to filter objects with the highest probability class as 'CV/Nova' using 'lc_classifier_stochastic'
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
AND classifier_name = 'lc_classifier_stochastic'
AND ranking = 1
""""""

# Subquery to filter objects with ndet <= 50
object_subquery = f""""""
SELECT o.oid
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.ndet <= 50
""""""

# Subquery to get detection details for r-band (fid = 2)
detection_subquery = f""""""
SELECT d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf_corr, d.magpsf
FROM detection d
INNER JOIN ({object_subquery}) o ON d.oid = o.oid
WHERE d.fid = 2
""""""

# Subquery to calculate maximum rise from minimum in each detection for r-band
magstat_subquery = f""""""
SELECT m.oid, (m.magmax_corr - m.magmin_corr) AS max_rise
FROM magstat m
WHERE m.fid = 2
""""""

# Final query combining all subqueries
final_query = f""""""
SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf_corr, d.magpsf, m.max_rise
FROM ({detection_subquery}) d
INNER JOIN ({magstat_subquery}) m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
""""""

# Assign the final query to a variable
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,21.35676336288452,2025-06-16T11:43:36,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaadasq  1462249394015010007     2   71.777284  -1.224114   
996  ZTF17aaadasq   680356974015010001     2   71.777208  -1.224201   
997  ZTF17aaaddnz  2601135243615015015     2   82.263412  42.077390   
998  ZTF17aaaddnz  2259148213615015003     2   82.263267  42.077525   
999  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   

     magpsf_corr     magpsf  max_rise  
0      17.878054  19.760700  0.524338  
1      17.857359  19.648392  0.524338  
2      18.342743  19.791729  0.524338  
3      17.898651  19.882864  0.524338  
4      17.863106  19.678644  0.524338  
..           ...        ...       ...  
995    15.950828  17.562300  0.308908  
996    15.770741  19.287691  0.308908  
997    16.939540  19.438950  0.312553  
998    16.913158  19.200290  0.312553  
999    16.820160  18.601990  0.312553  

[1000 rows x 8 columns]]",,14.988702535629272,2025-06-25T01:27:34,0.964,0.975,0.5,0.5,0.0,0.0
0.18.1,gpt-4o,v3,39,4,"
# Subquery to filter objects with the highest probability class as CV/Nova
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
AND classifier_name = 'lc_classifier'
AND ranking = 1
""""""

# Subquery to filter objects with ndet <= 50
object_subquery = f""""""
SELECT o.oid
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.ndet <= 50
""""""

# Subquery to get detection details in the r-band
detection_subquery = f""""""
SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr
FROM detection d
INNER JOIN ({object_subquery}) o ON d.oid = o.oid
WHERE d.fid = 2
""""""

# Subquery to calculate maximum rise from minimum in the r-band
magstat_subquery = f""""""
SELECT m.oid, (m.magmax_corr - m.magmin_corr) AS max_rise
FROM magstat m
INNER JOIN ({object_subquery}) o ON m.oid = o.oid
WHERE m.fid = 2
""""""

# Final query to combine all subqueries and limit the result
final_query = f""""""
SELECT d.oid, d.candid, d.f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr, m.max_rise
FROM ({detection_subquery}) d
INNER JOIN ({magstat_subquery}) m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
""""""

# Combine all steps into the final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.238609075546265,2025-06-16T11:44:00,"[              oid               candid  f_id         ra        dec     magpsf  \
0    ZTF17aaaagbn  2762488665315010002     2  86.961796  36.581598  16.874200   
1    ZTF17aaaagbn  2767487322415015006     2  86.961868  36.581544  18.536910   
2    ZTF17aaaagbn   671426215315010008     2  86.961799  36.581603  18.455600   
3    ZTF17aaaagbn   732132045315010014     2  86.961794  36.581591  16.905500   
4    ZTF17aaaagbn   680360175315010014     2  86.961836  36.581570  16.821342   
..            ...                  ...   ...        ...        ...        ...   
995  ZTF17aaashof  2859441963615015008     2  85.440713  27.661613  19.390818   
996  ZTF17aaashof  2554113943615015009     2  85.440684  27.661574  19.094278   
997  ZTF17aaashof  2910331213615015005     2  85.440723  27.661551  19.263351   
998  ZTF17aaashof  1113233693615015005     2  85.440666  27.661722  19.722916   
999  ZTF17aaashof  1469256883615015012     2  85.440591  27.661655  19.507900   

     sigmapsf  magpsf_corr  max_rise  
0    0.053852    17.159657  0.995937  
1    0.100253    16.190163  0.995937  
2    0.179880    16.408390  0.995937  
3    0.037313    17.120249  0.995937  
4    0.043682    17.232500  0.995937  
..        ...          ...       ...  
995  0.171423    16.846428  0.970852  
996  0.139800    16.814178  0.970852  
997  0.158258    16.833520  0.970852  
998  0.215624    16.874247  0.970852  
999  0.219935    16.857134  0.970852  

[1000 rows x 9 columns]]",,88.76213240623474,2025-06-25T01:29:07,0.163,0.079,0.5,0.4444444444444444,0.0,0.0
0.18.1,gpt-4o,v3,39,5,"
# Subquery for Probability: Filter for objects classified as 'CV/Nova' with ranking = 1 and classifier_name = 'lc_classifier_stochastic'
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
AND ranking = 1
AND classifier_name = 'lc_classifier_stochastic'
""""""

# Subquery for Object: Filter for objects with ndet <= 50 and join with the probability subquery
object_subquery = f""""""
SELECT o.oid, o.meanra, o.meandec
FROM object o
INNER JOIN ({probability_subquery}) p ON o.oid = p.oid
WHERE o.ndet <= 50
""""""

# Subquery for Detection: Filter for r-band (fid = 2) and join with the object subquery
detection_subquery = f""""""
SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf_corr, d.sigmapsf_corr, d.magpsf, d.sigmapsf
FROM detection d
INNER JOIN ({object_subquery}) o ON d.oid = o.oid
WHERE d.fid = 2
""""""

# Subquery for Magstat: Calculate the maximum rise from minimum in the r-band (fid = 2) and join with the object subquery
magstat_subquery = f""""""
SELECT m.oid, (m.magmax_corr - m.magmin_corr) AS max_rise
FROM magstat m
INNER JOIN ({object_subquery}) o ON m.oid = o.oid
WHERE m.fid = 2
""""""

# Final Query: Combine results from detection and magstat subqueries, select required columns, order by object identifier, and limit to first 1000 rows
final_query = f""""""
SELECT d.oid, d.candid, d.f_id, d.ra, d.dec, d.magpsf_corr, d.sigmapsf_corr, d.magpsf, d.sigmapsf, m.max_rise
FROM ({detection_subquery}) d
INNER JOIN ({magstat_subquery}) m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
""""""

# Combine all steps into the final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.305591106414795,2025-06-16T11:44:25,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaadasq  1462249394015010007     2   71.777284  -1.224114   
996  ZTF17aaadasq   680356974015010001     2   71.777208  -1.224201   
997  ZTF17aaaddnz  2601135243615015015     2   82.263412  42.077390   
998  ZTF17aaaddnz  2259148213615015003     2   82.263267  42.077525   
999  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   

     magpsf_corr  sigmapsf_corr     magpsf  sigmapsf  max_rise  
0      17.878054       0.021343  19.760700  0.177926  0.524338  
1      17.857359       0.026439  19.648392  0.181106  0.524338  
2      18.342743       0.025855  19.791729  0.166419  0.524338  
3      17.898651       0.022219  19.882864  0.201099  0.524338  
4      17.863106     100.000000  19.678644  0.104125  0.524338  
..           ...            ...        ...       ...       ...  
995    15.950828       0.003799  17.562300  0.056651  0.308908  
996    15.770741     100.000000  19.287691  0.103488  0.308908  
997    16.939540       0.004793  19.438950  0.177483  0.312553  
998    16.913158     100.000000  19.200290  0.124061  0.312553  
999    16.820160     100.000000  18.601990  0.070775  0.312553  

[1000 rows x 10 columns]]",,38.53563642501831,2025-06-25T01:29:50,0.964,0.975,0.625,0.5,0.0,0.0
0.18.1,gpt-4o,v3,39,6,"
# Subquery to filter objects classified as 'CV/Nova' with the highest probability using 'lc_classifier_stochastic'
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
AND ranking = 1
AND classifier_name = 'lc_classifier_stochastic'
""""""

# Main query to join tables and apply conditions
final_query = f""""""
SELECT 
    o.oid, 
    d.candid, 
    d.fid AS f_id, 
    d.ra, 
    d.dec, 
    d.magpsf_corr, 
    d.magpsf, 
    (m.magmax_corr - m.magmin_corr) AS max_rise
FROM 
    ({probability_subquery}) AS p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    magstat m ON o.oid = m.oid AND d.fid = m.fid
WHERE 
    o.ndet <= 50
AND 
    d.fid = 2
AND 
    m.fid = 2
ORDER BY 
    o.oid
LIMIT 1000
""""""

# Final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.798696041107178,2025-06-16T11:44:46,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaadasq  1462249394015010007     2   71.777284  -1.224114   
996  ZTF17aaadasq   680356974015010001     2   71.777208  -1.224201   
997  ZTF17aaaddnz  2601135243615015015     2   82.263412  42.077390   
998  ZTF17aaaddnz  2259148213615015003     2   82.263267  42.077525   
999  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   

     magpsf_corr     magpsf  max_rise  
0      17.878054  19.760700  0.524338  
1      17.857359  19.648392  0.524338  
2      18.342743  19.791729  0.524338  
3      17.898651  19.882864  0.524338  
4      17.863106  19.678644  0.524338  
..           ...        ...       ...  
995    15.950828  17.562300  0.308908  
996    15.770741  19.287691  0.308908  
997    16.939540  19.438950  0.312553  
998    16.913158  19.200290  0.312553  
999    16.820160  18.601990  0.312553  

[1000 rows x 8 columns]]",,16.628387928009033,2025-06-25T01:30:11,0.964,0.975,0.5,0.5,0.0,0.0
0.18.1,gpt-4o,v3,39,7,"
# Subquery for Probability
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
  AND ranking = 1
  AND classifier_name = 'lc_classifier_stochastic'
""""""

# Subquery for Object
object_subquery = f""""""
SELECT oid
FROM object
WHERE ndet <= 50
  AND oid IN ({probability_subquery})
""""""

# Subquery for Detection
detection_subquery = f""""""
SELECT candid, oid, ra, dec, magpsf_corr, magpsf
FROM detection
WHERE fid = 2
  AND oid IN ({object_subquery})
""""""

# Subquery for Magstat
magstat_subquery = f""""""
SELECT oid, magmax_corr, magmin_corr
FROM magstat
WHERE fid = 2
  AND oid IN ({object_subquery})
""""""

# Final Query
full_query = f""""""
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, m.magmax_corr, m.magmin_corr
FROM ({detection_subquery}) d
INNER JOIN ({magstat_subquery}) m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.82784938812256,2025-06-16T11:45:07,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, m.magmax_corr, m.magmin_corr
FROM (
SELECT candid, oid, ra, dec, magpsf_corr, magpsf
FROM detection
WHERE fid = 2
  AND oid IN (
SELECT oid
FROM object
WHERE ndet <= 50
  AND oid IN (
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
  AND ranking = 1
  AND classifier_name = 'lc_classifier_stochastic'
)
)
) d
INNER JOIN (
SELECT oid, magmax_corr, magmin_corr
FROM magstat
WHERE fid = 2
  AND oid IN (
SELECT oid
FROM object
WHERE ndet <= 50
  AND oid IN (
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
  AND ranking = 1
  AND classifier_name = 'lc_classifier_stochastic'
)
)
) m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.7644181251526,2025-06-25T01:34:26,0.0,0.0,0.0,0.0,0.0,0.0
0.18.1,gpt-4o,v3,39,8,"
# Subquery to filter objects classified as 'CV/Nova' with the highest probability
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
  AND ranking = 1
  AND classifier_name = 'lc_classifier'
""""""

# Subquery to filter objects with ndet <= 50
object_subquery = f""""""
SELECT oid
FROM object
WHERE ndet <= 50
  AND oid IN ({probability_subquery})
""""""

# Subquery to get detections in the r-band (fid = 2)
detection_subquery = f""""""
SELECT candid, oid, ra, dec, magpsf_corr, magpsf
FROM detection
WHERE fid = 2
  AND oid IN ({object_subquery})
""""""

# Subquery to get magstat information in the r-band (fid = 2)
magstat_subquery = f""""""
SELECT oid, magmax_corr, magmin_corr
FROM magstat
WHERE fid = 2
  AND oid IN ({object_subquery})
""""""

# Final query combining all subqueries
full_query = f""""""
SELECT d.oid, d.candid, 2 AS f_id, d.ra, d.dec, d.magpsf_corr, d.magpsf, (m.magmax_corr - m.magmin_corr) AS max_rise
FROM ({detection_subquery}) d
INNER JOIN ({magstat_subquery}) m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
""""""
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.779104471206665,2025-06-16T11:45:30,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaagbn   702246145315010012     2   86.961790  36.581644   
1    ZTF17aaaagbn  2766483192415010004     2   86.961805  36.581625   
2    ZTF17aaaagbn   602505115315010004     2   86.961817  36.581604   
3    ZTF17aaaagbn   695401315315010004     2   86.961798  36.581642   
4    ZTF17aaaagbn   708328175315010009     2   86.961840  36.581628   
..            ...                  ...   ...         ...        ...   
995  ZTF17aabocon   831136222915015007     2  104.194366 -17.474977   
996  ZTF17aabocon  1397458062915010024     2  104.194502 -17.474721   
997  ZTF17aabocon  1121232142915015006     2  104.194405 -17.474801   
998  ZTF17aaboory   965267100915015004     2  311.162056  52.811648   
999  ZTF17aaboory  1218428790915015001     2  311.162045  52.811662   

     magpsf_corr     magpsf  max_rise  
0      16.385958  18.616300  0.995937  
1      16.755953  17.530500  0.995937  
2      16.853638  17.187000  0.995937  
3      16.650103  17.544100  0.995937  
4      16.432005  18.311638  0.995937  
..           ...        ...       ...  
995    15.346635  17.874285  1.807092  
996    16.095747  16.339000  1.807092  
997    15.369249  18.132200  1.807092  
998          NaN  18.313990       NaN  
999          NaN  17.700418       NaN  

[1000 rows x 8 columns]]",,17.212065935134888,2025-06-25T01:34:48,0.079,0.079,0.5,0.5,0.0,0.0
0.18.1,gpt-4o,v3,39,9,"
# Subquery to filter objects with the highest probability for class 'CV/Nova' using 'lc_classifier_stochastic'
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
AND classifier_name = 'lc_classifier_stochastic'
AND ranking = 1
""""""

# Subquery to filter objects with ndet <= 50
object_subquery = f""""""
SELECT oid
FROM object
WHERE ndet <= 50
AND oid IN ({probability_subquery})
""""""

# Main query to join with detection and magstat, and select required columns
final_query = f""""""
SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf_corr, d.magpsf, 
       ms.magmax_corr, ms.magmin_corr, (ms.magmax_corr - ms.magmin_corr) AS max_rise
FROM detection d
INNER JOIN ({object_subquery}) o ON d.oid = o.oid
INNER JOIN magstat ms ON d.oid = ms.oid AND d.fid = ms.fid
WHERE d.fid = 2  -- r-band filter
ORDER BY d.oid
LIMIT 1000
""""""

# Final query
full_query = final_query
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,30.38705015182495,2025-06-16T11:46:01,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaadasq  1462249394015010007     2   71.777284  -1.224114   
996  ZTF17aaadasq   680356974015010001     2   71.777208  -1.224201   
997  ZTF17aaaddnz  2601135243615015015     2   82.263412  42.077390   
998  ZTF17aaaddnz  2259148213615015003     2   82.263267  42.077525   
999  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   

     magpsf_corr     magpsf  magmax_corr  magmin_corr  max_rise  
0      17.878054  19.760700    18.342743    17.818405  0.524338  
1      17.857359  19.648392    18.342743    17.818405  0.524338  
2      18.342743  19.791729    18.342743    17.818405  0.524338  
3      17.898651  19.882864    18.342743    17.818405  0.524338  
4      17.863106  19.678644    18.342743    17.818405  0.524338  
..           ...        ...          ...          ...       ...  
995    15.950828  17.562300    15.967023    15.658115  0.308908  
996    15.770741  19.287691    15.967023    15.658115  0.308908  
997    16.939540  19.438950    17.132713    16.820160  0.312553  
998    16.913158  19.200290    17.132713    16.820160  0.312553  
999    16.820160  18.601990    17.132713    16.820160  0.312553  

[1000 rows x 10 columns]]",,14.038449764251709,2025-06-25T01:35:06,0.964,0.975,0.5,0.4,0.0,0.0
0.18.1,gpt-4o,v3,39,10,"
# Sub-query to filter objects classified as 'CV/Nova' with the highest probability
probability_subquery = """"""
SELECT oid
FROM probability
WHERE class_name = 'CV/Nova'
AND classifier_name = 'lc_classifier_stochastic'
AND ranking = 1
""""""

# Sub-query to filter objects with ndet <= 50
object_subquery = """"""
SELECT oid
FROM object
WHERE ndet <= 50
""""""

# Sub-query to filter detections in the r-band (fid = 2)
detection_subquery = """"""
SELECT oid, candid, ra, dec, magpsf_corr, magpsf
FROM detection
WHERE fid = 2
""""""

# Sub-query to get magmax_corr and magmin_corr for r-band (fid = 2)
magstat_subquery = """"""
SELECT oid, magmax_corr, magmin_corr
FROM magstat
WHERE fid = 2
""""""

# Final query combining all sub-queries
final_query = """"""
SELECT d.oid, d.candid, 2 AS f_id, d.ra, d.dec, d.magpsf_corr, d.magpsf, (m.magmax_corr - m.magmin_corr) AS max_rise
FROM ({detection_subquery}) d
INNER JOIN ({probability_subquery}) p ON d.oid = p.oid
INNER JOIN ({object_subquery}) o ON d.oid = o.oid
INNER JOIN ({magstat_subquery}) m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
""""""

# Combine all steps into the final query
full_query = final_query.format(
    detection_subquery=detection_subquery,
    probability_subquery=probability_subquery,
    object_subquery=object_subquery,
    magstat_subquery=magstat_subquery
)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,35.57057785987854,2025-06-16T11:46:37,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaadasq  1462249394015010007     2   71.777284  -1.224114   
996  ZTF17aaadasq   680356974015010001     2   71.777208  -1.224201   
997  ZTF17aaaddnz  2601135243615015015     2   82.263412  42.077390   
998  ZTF17aaaddnz  2259148213615015003     2   82.263267  42.077525   
999  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   

     magpsf_corr     magpsf  max_rise  
0      17.878054  19.760700  0.524338  
1      17.857359  19.648392  0.524338  
2      18.342743  19.791729  0.524338  
3      17.898651  19.882864  0.524338  
4      17.863106  19.678644  0.524338  
..           ...        ...       ...  
995    15.950828  17.562300  0.308908  
996    15.770741  19.287691  0.308908  
997    16.939540  19.438950  0.312553  
998    16.913158  19.200290  0.312553  
999    16.820160  18.601990  0.312553  

[1000 rows x 8 columns]]",,13.753489971160889,2025-06-25T01:35:24,0.964,0.975,0.5,0.5,0.0,0.0
