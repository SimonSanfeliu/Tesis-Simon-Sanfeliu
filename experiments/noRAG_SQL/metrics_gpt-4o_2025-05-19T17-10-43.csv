code_tag,llm_used,prompt_version,query_id,query_run,sql_query,tab_schema,label,query_gen_time,query_gen_date,query_results,query_error,sql_time,sql_date,r_row,p_row,r_col,p_col,N_perfect_row,N_perfect_col
0.16.3,,,8,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygrgk        11      4240  58389.123657  60532.194988      False   
1    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
2    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
..            ...       ...       ...           ...           ...        ...   
179  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
180  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
181  ZTF23aazhprx         2       578  60083.250000  60175.250000       True   
182  ZTF23aazhofz         2      1852  59788.250000  60175.250000       True   
183  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     2      NaN           NaN  ...  60173.182234  60532.194988   
1      False     1      NaN           NaN  ...  60173.169005  60173.169005   
2      False     1      NaN           NaN  ...  60173.169005  60173.169005   
3      False     1      NaN           NaN  ...  60173.178461  60173.178461   
4      False     1      NaN           NaN  ...  60173.176100  60173.176100   
..       ...   ...      ...           ...  ...           ...           ...   
179     True     2      NaN           NaN  ...  60175.185301  60465.343935   
180     True     2      NaN           NaN  ...  60175.192697  60182.239526   
181    False     1      NaN           NaN  ...  60175.179132  60175.179132   
182    False     1      NaN           NaN  ...  60175.181007  60175.181007   
183    False     1      NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0        24.5.2a6     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
179        24.5.1     True             False  stamp_classifier   
180         1.2.0     True             False  stamp_classifier   
181         1.2.0     True             False  stamp_classifier   
182         1.2.0     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.416646       1  
1    stamp_classifier_1.0.4          SN     0.639198       1  
2    stamp_classifier_1.0.4          SN     0.514766       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.526146       1  
..                      ...         ...          ...     ...  
179  stamp_classifier_1.0.4          SN     0.317975       1  
180  stamp_classifier_1.0.4          SN     0.631699       1  
181  stamp_classifier_1.0.4          SN     0.574371       1  
182  stamp_classifier_1.0.4          SN     0.622088       1  
183  stamp_classifier_1.0.4          SN     0.569558       1  

[184 rows x 27 columns]]",,10.286155223846436,2025-05-18T22:37:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,8,1,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SN' 
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.probability > 0.5
  AND object.firstmjd BETWEEN 59440 AND 59444  -- Julian dates for August 17 to August 21, 2021
  AND (object.ndet >= 2 OR probability.probability > 0.5)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.512856245040894,2025-04-28T23:34:39,"[              oid   classifier_name      classifier_version class_name  \
0    ZTF23aauvxgu  stamp_classifier  stamp_classifier_1.0.4         SN   
1    ZTF23aaugtqx  stamp_classifier  stamp_classifier_1.0.4         SN   
2    ZTF23aaucgeg  stamp_classifier  stamp_classifier_1.0.4         SN   
3    ZTF18adrwflu  stamp_classifier  stamp_classifier_1.0.4         SN   
4    ZTF18abhccag  stamp_classifier  stamp_classifier_1.0.4         SN   
..            ...               ...                     ...        ...   
340  ZTF23aaqeuck  stamp_classifier  stamp_classifier_1.0.4         SN   
341  ZTF23aavevjd  stamp_classifier  stamp_classifier_1.0.4         SN   
342  ZTF23aavffkq  stamp_classifier  stamp_classifier_1.0.4         SN   
343  ZTF23aavfdux  stamp_classifier  stamp_classifier_1.0.4         SN   
344  ZTF23aavnqsz  stamp_classifier  stamp_classifier_1.0.4         SN   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.412764        1         7      1787  58691.250000  60152.250000   
1       0.639903        1        13      1393  60150.250000  60179.250000   
2       0.622625        1        83      1389  60149.250000  60201.250000   
3       0.388430        1      1090      2551  58218.508056  60634.133056   
4       0.332478        1         3      2568  58315.250000  60233.250000   
..           ...      ...       ...       ...           ...           ...   
340     0.798089        1        42      1666  60125.500000  60223.500000   
341     0.521393        1         1      1332  60153.500000  60153.500000   
342     0.672242        1        11      1058  60153.500000  60162.500000   
343     0.540236        1         1       864  60153.500000  60153.500000   
344     0.511295        1        11      1044  60153.500000  60161.500000   

     ...      meanra    meandec   sigmara  sigmadec     deltajd      firstmjd  \
0    ...  286.177984   1.849842  0.000006  0.000025    2.045741  60150.202280   
1    ...  224.848497   3.801643  0.000062  0.000044   28.984062  60150.192847   
2    ...  306.009806   1.572354  0.000030  0.000040   50.902813  60150.308704   
3    ...  293.664336  12.923707  0.020408  0.019891  483.930312  60150.202743   
4    ...  279.929714 -20.073153  0.000124  0.000170   82.899537  60150.227512   
..   ...         ...        ...       ...       ...         ...           ...   
340  ...   39.040418  41.657258  0.000050  0.000048   69.984398  60153.466181   
341  ...   71.428212  20.147191       NaN       NaN    0.000000  60153.473704   
342  ...   80.906242  19.240411  0.000031  0.000044    8.986331  60153.495544   
343  ...   82.236441  20.694914       NaN       NaN    0.000000  60153.490694   
344  ...   79.087142  17.145319  0.000063  0.000037    7.996516  60153.488264   

          lastmjd  step_id_corr  diffpos  reference_change  
0    60152.248021         1.2.0     True             False  
1    60179.176910         1.2.0     True             False  
2    60201.211516         1.2.1     True             False  
3    60634.133056      24.5.2a6     True             False  
4    60233.127049         1.2.1     True             False  
..            ...           ...      ...               ...  
340  60223.450579         1.2.1     True             False  
341  60153.473704         1.2.0     True             False  
342  60162.481875         1.2.0     True             False  
343  60153.490694         1.2.0     True             False  
344  60161.484780         1.2.0     True             False  

[345 rows x 27 columns]]",,28.10014820098877,2025-05-18T22:37:51,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,2,"
SELECT * 
FROM object 
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND object.firstmjd BETWEEN 60000 AND 60004  -- Replace with actual Julian dates for August 17 to August 21, 2023
  AND (probability.probability > 0.5 OR object.ndet >= 2)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.834654569625854,2025-04-28T23:34:50,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aavvqcc         1       874  60160.250000  60160.250000      False   
1    ZTF23aavtrsk       184      4331  60156.250000  60255.250000      False   
2    ZTF23aavtqzj       131      4206  60159.250000  60207.250000      False   
3    ZTF23aayjunj        11      1802  60160.260278  60609.143102       True   
4    ZTF23aavwqoh        21      3248  58400.250000  60181.250000       True   
..            ...       ...       ...           ...           ...        ...   
210  ZTF23aawlome         1      1178  60163.500000  60163.500000      False   
211  ZTF23aawlnby         3      1021  60163.500000  60173.500000       True   
212  ZTF23aaynliq        17       900  60163.500000  60200.500000      False   
213  ZTF23aaxbgho         6       857  60163.500000  60173.500000       True   
214  ZTF23aaxaszo       342      2943  59084.465058  60735.137535       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60160.177465  60160.177465   
1      False    42  0.231931      0.243656  ...  60160.187014  60255.137280   
2      False    26 -0.009924           NaN  ...  60160.187488  60207.160185   
3      False    10       NaN           NaN  ...  60160.260278  60609.143102   
4      False    18  0.178982      0.750361  ...  60160.262651  60181.221319   
..       ...   ...       ...           ...  ...           ...           ...   
210    False     1       NaN           NaN  ...  60163.448472  60163.448472   
211    False     3       NaN           NaN  ...  60163.459734  60173.463495   
212    False    11  0.068636           NaN  ...  60163.459734  60200.378287   
213    False     6 -0.008692      0.229774  ...  60163.460208  60173.442025   
214    False   221       NaN           NaN  ...  60163.461296  60735.137535   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.1     True             False  stamp_classifier   
2           1.2.1     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
210         1.2.0     True             False  stamp_classifier   
211         1.2.0     True             False  stamp_classifier   
212         1.2.1     True             False  stamp_classifier   
213         1.2.0     True             False  stamp_classifier   
214        27.4.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.568443       1  
1    stamp_classifier_1.0.4          SN     0.890891       1  
2    stamp_classifier_1.0.4          SN     0.668517       1  
3    stamp_classifier_1.0.4          SN     0.351652       1  
4    stamp_classifier_1.0.4          SN     0.701830       1  
..                      ...         ...          ...     ...  
210  stamp_classifier_1.0.4          SN     0.709408       1  
211  stamp_classifier_1.0.4          SN     0.500361       1  
212  stamp_classifier_1.0.4          SN     0.746097       1  
213  stamp_classifier_1.0.4          SN     0.762870       1  
214  stamp_classifier_1.0.4          SN     0.497768       1  

[215 rows x 27 columns]]",,13.099745988845823,2025-05-18T22:38:04,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,3,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SN' 
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.probability > 0.5
  AND object.firstmjd BETWEEN 59434 AND 59438  -- Corresponding to August 17, 2023, and August 21, 2023
  OR object.ndet >= 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.07533359527588,2025-04-28T23:35:00,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combine the results from Step 1 and Step 2 to get the desired objects
SELECT *
FROM object
WHERE oid IN (
    SELECT oid
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND probability > 0.5
      AND ranking = 1
)
AND ((firstmjd BETWEEN 59434 AND 59438) OR (ndet >= 2))
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.56765794754028,2025-05-18T23:26:45,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,8,4,"
SELECT * 
FROM object 
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND (probability.probability > 0.5 OR object.ndet >= 2)
  AND object.firstmjd BETWEEN 59434 AND 59438  -- Julian dates for August 17, 2023, to August 21, 2023
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.491053342819214,2025-04-28T23:35:11,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF21acgnrfb         3       752  59494.250000  60154.500000       True   
1   ZTF23aavhkjj         2      2003  60154.346863  60539.325671       True   
2   ZTF18adrugmh       129      1951  58263.439676  60802.444711       True   
3   ZTF23aavhwcx         7      3753  59384.417986  60805.436458       True   
4   ZTF21aaaqfqw        11      1865  58261.463125  60533.254780       True   
..           ...       ...       ...           ...           ...        ...   
91  ZTF23aawkmmh         4      2395  60156.500000  60170.500000      False   
92  ZTF23aavrbcv         6      1981  58523.160266  60624.327477       True   
93  ZTF23aavqxos         3      3702  59866.369699  60757.155891       True   
94  ZTF23aaknyni        83      1479  60082.165752  60760.144433      False   
95  ZTF23aaynzyk         3      1162  60157.500000  60173.500000      False   

    stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0     False     1      NaN           NaN  ...  60154.440174  60154.440174   
1      True     2      NaN           NaN  ...  60154.346863  60539.325671   
2     False    23      NaN           NaN  ...  60154.346863  60802.444711   
3      True     2      NaN           NaN  ...  60154.432535  60805.436458   
4     False     3      NaN           NaN  ...  60154.435868  60533.254780   
..      ...   ...      ...           ...  ...           ...           ...   
91    False     4      NaN           NaN  ...  60156.405579  60170.408843   
92    False     2      NaN           NaN  ...  60157.455718  60624.327477   
93    False     2      NaN           NaN  ...  60157.456667  60757.155891   
94    False    53      NaN           NaN  ...  60157.494271  60760.144433   
95    False     3      NaN           NaN  ...  60157.498993  60173.492280   

    step_id_corr  diffpos  reference_change   classifier_name  \
0          1.2.0     True             False  stamp_classifier   
1       24.5.2a6     True             False  stamp_classifier   
2         27.5.6     True             False  stamp_classifier   
3         27.5.6     True             False  stamp_classifier   
4       24.5.2a6     True             False  stamp_classifier   
..           ...      ...               ...               ...   
91         1.2.0     True             False  stamp_classifier   
92      24.5.2a6     True             False  stamp_classifier   
93        27.5.0     True             False  stamp_classifier   
94        27.5.2     True             False  stamp_classifier   
95         1.2.0     True             False  stamp_classifier   

        classifier_version  class_name  probability ranking  
0   stamp_classifier_1.0.4          SN     0.504922       1  
1   stamp_classifier_1.0.4          SN     0.290262       1  
2   stamp_classifier_1.0.4          SN     0.561287       1  
3   stamp_classifier_1.0.4          SN     0.594245       1  
4   stamp_classifier_1.0.4          SN     0.791829       1  
..                     ...         ...          ...     ...  
91  stamp_classifier_1.0.4          SN     0.627166       1  
92  stamp_classifier_1.0.4          SN     0.454150       1  
93  stamp_classifier_1.0.4          SN     0.535688       1  
94  stamp_classifier_1.0.4          SN     0.411847       1  
95  stamp_classifier_1.0.4          SN     0.452850       1  

[96 rows x 27 columns]]",,19.742393255233765,2025-05-18T23:27:12,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,5,"
SELECT * 
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND object.firstmjd BETWEEN 59800 AND 59804  -- Julian dates for August 17 to August 21, 2023
  AND (probability.probability > 0.5 OR object.ndet >= 2)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.03310203552246,2025-04-28T23:35:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aavvqcc         1       874  60160.250000  60160.250000      False   
1    ZTF23aavtrsk       184      4331  60156.250000  60255.250000      False   
2    ZTF23aavtqzj       131      4206  60159.250000  60207.250000      False   
3    ZTF23aayjunj        11      1802  60160.260278  60609.143102       True   
4    ZTF23aavwqoh        21      3248  58400.250000  60181.250000       True   
..            ...       ...       ...           ...           ...        ...   
210  ZTF23aawlome         1      1178  60163.500000  60163.500000      False   
211  ZTF23aawlnby         3      1021  60163.500000  60173.500000       True   
212  ZTF23aaynliq        17       900  60163.500000  60200.500000      False   
213  ZTF23aaxaszo       342      2943  59084.465058  60735.137535       True   
214  ZTF23aaxbgho         6       857  60163.500000  60173.500000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60160.177465  60160.177465   
1      False    42  0.231931      0.243656  ...  60160.187014  60255.137280   
2      False    26 -0.009924           NaN  ...  60160.187488  60207.160185   
3      False    10       NaN           NaN  ...  60160.260278  60609.143102   
4      False    18  0.178982      0.750361  ...  60160.262651  60181.221319   
..       ...   ...       ...           ...  ...           ...           ...   
210    False     1       NaN           NaN  ...  60163.448472  60163.448472   
211    False     3       NaN           NaN  ...  60163.459734  60173.463495   
212    False    11  0.068636           NaN  ...  60163.459734  60200.378287   
213    False   221       NaN           NaN  ...  60163.461296  60735.137535   
214    False     6 -0.008692      0.229774  ...  60163.460208  60173.442025   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.1     True             False  stamp_classifier   
2           1.2.1     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
210         1.2.0     True             False  stamp_classifier   
211         1.2.0     True             False  stamp_classifier   
212         1.2.1     True             False  stamp_classifier   
213        27.4.0     True             False  stamp_classifier   
214         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.568443       1  
1    stamp_classifier_1.0.4          SN     0.890891       1  
2    stamp_classifier_1.0.4          SN     0.668517       1  
3    stamp_classifier_1.0.4          SN     0.351652       1  
4    stamp_classifier_1.0.4          SN     0.701830       1  
..                      ...         ...          ...     ...  
210  stamp_classifier_1.0.4          SN     0.709408       1  
211  stamp_classifier_1.0.4          SN     0.500361       1  
212  stamp_classifier_1.0.4          SN     0.746097       1  
213  stamp_classifier_1.0.4          SN     0.497768       1  
214  stamp_classifier_1.0.4          SN     0.762870       1  

[215 rows x 27 columns]]",,20.94542551040649,2025-05-18T23:27:39,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,6,"
SELECT * 
FROM object 
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND object.firstmjd BETWEEN 60000 + 17 AND 60000 + 21  -- Adjusted for Modified Julian Date
  AND (probability.probability > 0.5 OR object.ndet >= 2)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,9.806586265563965,2025-04-28T23:35:31,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF19aaqyrjv        25      9636  58476.532083  60759.500081       True   
1    ZTF23aazjohh         7      2788  60178.250000  60186.250000      False   
2    ZTF23aazjqov        42      3971  60178.250000  60214.250000      False   
3    ZTF23aazjoiz         6      2853  60178.250000  60186.250000      False   
4    ZTF18acilsts         6      3174  58435.083391  60632.119224       True   
..            ...       ...       ...           ...           ...        ...   
219  ZTF23aazugwe        12      2191  60181.500000  60212.500000       True   
220  ZTF23abamsmu        11      1910  60181.500000  60200.500000       True   
221  ZTF23aazudtr       282      1424  58437.417708  60739.112986       True   
222  ZTF23abcxsbr         4      1666  58814.250000  60200.500000      False   
223  ZTF23aazzgxk        10      2317  60181.500000  60194.500000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0       True     3       NaN           NaN  ...  60178.206181  60759.500081   
1      False     6 -0.009882           NaN  ...  60178.207581  60186.228345   
2      False    42  0.608381           NaN  ...  60178.235880  60214.172407   
3      False     3  0.258396           NaN  ...  60178.208588  60186.243935   
4       True     2       NaN           NaN  ...  60178.208588  60632.119224   
..       ...   ...       ...           ...  ...           ...           ...   
219    False    12  0.867681      1.012818  ...  60181.490069  60212.453982   
220    False    11  0.556196      0.667280  ...  60181.483588  60200.497442   
221    False   170       NaN           NaN  ...  60181.483588  60739.112986   
222    False     2       NaN           NaN  ...  60181.486123  60200.470440   
223    False    10 -0.003635      0.101698  ...  60181.490069  60194.488461   

     step_id_corr  diffpos  reference_change   classifier_name  \
0          27.5.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.1     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
219         1.2.1     True             False  stamp_classifier   
220         1.2.1     True             False  stamp_classifier   
221        27.4.0     True             False  stamp_classifier   
222         1.2.1     True             False  stamp_classifier   
223         1.2.1     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.531398       1  
1    stamp_classifier_1.0.4          SN     0.407398       1  
2    stamp_classifier_1.0.4          SN     0.463087       1  
3    stamp_classifier_1.0.4          SN     0.792339       1  
4    stamp_classifier_1.0.4          SN     0.312209       1  
..                      ...         ...          ...     ...  
219  stamp_classifier_1.0.4          SN     0.659402       1  
220  stamp_classifier_1.0.4          SN     0.490252       1  
221  stamp_classifier_1.0.4          SN     0.544171       1  
222  stamp_classifier_1.0.4          SN     0.374474       1  
223  stamp_classifier_1.0.4          SN     0.610367       1  

[224 rows x 27 columns]]",,21.88218879699707,2025-05-18T23:28:06,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,7,"
SELECT * 
FROM object 
WHERE oid IN (
    SELECT oid 
    FROM probability 
    WHERE class_name = 'SN' 
    AND classifier_name = 'stamp_classifier' 
    AND probability > 0.5
) 
AND (firstmjd BETWEEN 59436 AND 59440)  -- August 17, 2023 to August 21, 2023 in MJD
AND (ndet >= 2 OR oid IN (
    SELECT oid 
    FROM probability 
    WHERE class_name = 'SN' 
    AND classifier_name = 'stamp_classifier' 
    AND probability > 0.5
))
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.180312871932983,2025-04-28T23:35:54,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM object 
WHERE oid IN (
    SELECT oid 
    FROM probability 
    WHERE class_name = 'SN' 
    AND classifier_name = 'stamp_classifier' 
    AND probability > 0.5
    AND ranking = 1
) 
AND (firstmjd BETWEEN 59436 AND 59440)  -- August 17, 2023 to August 21, 2023 in MJD
AND (ndet >= 2 OR oid IN (
    SELECT oid 
    FROM probability 
    WHERE class_name = 'SN' 
    AND classifier_name = 'stamp_classifier' 
    AND probability > 0.5
    AND ranking = 1
))
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.3086187839508,2025-05-18T23:32:25,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,8,8,"
SELECT * 
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND object.firstmjd BETWEEN 59440 AND 59444  -- August 17, 2023 to August 21, 2023 in MJD
  AND (probability.probability > 0.5 OR object.ndet >= 2)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.813979148864746,2025-04-28T23:36:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1090      2551  58218.508056  60634.133056       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF18abhccag         3      2568  58315.250000  60233.250000      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13 -0.039900       0.69668  ...  60150.192847  60179.176910   
1      False     2       NaN           NaN  ...  60150.202280  60152.248021   
2       True   140       NaN           NaN  ...  60150.202743  60634.133056   
3      False     2       NaN           NaN  ...  60150.203218  60553.257732   
4      False     2  1.778375           NaN  ...  60150.227512  60233.127049   
..       ...   ...       ...           ...  ...           ...           ...   
340    False     1       NaN           NaN  ...  60153.490694  60153.490694   
341    False     2       NaN           NaN  ...  60153.488264  60760.241343   
342    False     1       NaN           NaN  ...  60153.473704  60153.473704   
343    False    10       NaN           NaN  ...  60153.488264  60161.484780   
344    False    11       NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2        24.5.2a6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.1     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.332478       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.540236       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.521393       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,22.687819957733154,2025-05-18T23:32:53,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,9,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SN' 
  AND probability.classifier_name = 'stamp_classifier'
  AND (probability.probability > 0.5 OR object.ndet >= 2)
  AND object.firstmjd BETWEEN 60000 AND 60004 -- Replace 60000 and 60004 with the actual MJD values for August 17 and August 21, 2023
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.164272785186768,2025-04-28T23:36:18,"[              oid   classifier_name      classifier_version class_name  \
0    ZTF23aaugtqx  stamp_classifier  stamp_classifier_1.0.4         SN   
1    ZTF23aauvxgu  stamp_classifier  stamp_classifier_1.0.4         SN   
2    ZTF18adrwflu  stamp_classifier  stamp_classifier_1.0.4         SN   
3    ZTF23aauhblv  stamp_classifier  stamp_classifier_1.0.4         SN   
4    ZTF23aawdbyu  stamp_classifier  stamp_classifier_1.0.4         SN   
..            ...               ...                     ...        ...   
340  ZTF23aaveabg  stamp_classifier  stamp_classifier_1.0.4         SN   
341  ZTF23abadofi  stamp_classifier  stamp_classifier_1.0.4         SN   
342  ZTF23aavefel  stamp_classifier  stamp_classifier_1.0.4         SN   
343  ZTF23aavfdux  stamp_classifier  stamp_classifier_1.0.4         SN   
344  ZTF23aavffkq  stamp_classifier  stamp_classifier_1.0.4         SN   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.639903        1        13      1393  60150.250000  60179.250000   
1       0.412764        1         7      1787  58691.250000  60152.250000   
2       0.388430        1      1090      2551  58218.508056  60634.133056   
3       0.410632        1         7      1631  58694.288958  60553.257732   
4       0.480507        1         5      1374  60150.250000  60162.250000   
..           ...      ...       ...       ...           ...           ...   
340     0.322426        1        10      2964  59087.250000  60202.250000   
341     0.745618        1       281      2689  59461.403287  60694.127512   
342     0.615143        1        73      1483  59906.259201  60592.424248   
343     0.540236        1         1       864  60153.500000  60153.500000   
344     0.672242        1        11      1058  60153.500000  60162.500000   

     ...      meanra    meandec   sigmara  sigmadec     deltajd      firstmjd  \
0    ...  224.848497   3.801643  0.000062  0.000044   28.984062  60150.192847   
1    ...  286.177984   1.849842  0.000006  0.000025    2.045741  60150.202280   
2    ...  293.664336  12.923707  0.020408  0.019891  483.930312  60150.202743   
3    ...  293.893110   3.313766  0.085142  0.085000  403.054514  60150.203218   
4    ...  226.822263   2.179942  0.000092  0.000046   12.013160  60150.214896   
..   ...         ...        ...       ...       ...         ...           ...   
340  ...  346.690950  24.576501  0.000182  0.000048   48.781065  60153.442037   
341  ...   22.876804  -9.986458  0.006756  0.006654  540.667049  60153.460463   
342  ...   37.032906  12.187744  0.061490  0.060104  438.959074  60153.465174   
343  ...   82.236441  20.694914       NaN       NaN    0.000000  60153.490694   
344  ...   80.906242  19.240411  0.000031  0.000044    8.986331  60153.495544   

          lastmjd  step_id_corr  diffpos  reference_change  
0    60179.176910         1.2.0     True             False  
1    60152.248021         1.2.0     True             False  
2    60634.133056      24.5.2a6     True             False  
3    60553.257732      24.5.2a6     True             False  
4    60162.228056         1.2.0     True             False  
..            ...           ...      ...               ...  
340  60202.223102         1.2.1     True             False  
341  60694.127512        27.0.0     True             False  
342  60592.424248      24.5.2a6     True             False  
343  60153.490694         1.2.0     True             False  
344  60162.481875         1.2.0     True             False  

[345 rows x 27 columns]]",,12.166676998138428,2025-05-18T23:33:10,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,10,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.probability > 0.5
  AND object.firstmjd BETWEEN 59434 AND 59438  -- Julian dates for August 17 to August 21, 2023
  AND (object.ndet >= 2 OR probability.probability > 0.5)
  AND probability.ranking = 1  -- Default condition for probability table
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.359689235687256,2025-04-28T23:36:31,"[              oid   classifier_name      classifier_version class_name  \
0    ZTF21absbqor  stamp_classifier  stamp_classifier_1.0.4         SN   
1    ZTF21abrfrzc  stamp_classifier  stamp_classifier_1.0.4         SN   
2    ZTF21abrgozx  stamp_classifier  stamp_classifier_1.0.4         SN   
3    ZTF21abslvff  stamp_classifier  stamp_classifier_1.0.4         SN   
4    ZTF21abrfvbj  stamp_classifier  stamp_classifier_1.0.4         SN   
..            ...               ...                     ...        ...   
322  ZTF18abqzpru  stamp_classifier  stamp_classifier_1.0.4         SN   
323  ZTF21abskdnw  stamp_classifier  stamp_classifier_1.0.4         SN   
324  ZTF21abskdjy  stamp_classifier  stamp_classifier_1.0.4         SN   
325  ZTF21abskdnv  stamp_classifier  stamp_classifier_1.0.4         SN   
326  ZTF21abskltm  stamp_classifier  stamp_classifier_1.0.4         SN   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.513863        1         3       567  59434.173299  59436.190486   
1       0.624092        1         1       530  59434.174236  59434.174236   
2       0.778046        1         3       839  59430.178542  59434.212315   
3       0.571693        1         9       852  59434.175174  59458.198009   
4       0.721341        1         4       902  59430.204606  59436.195671   
..           ...      ...       ...       ...           ...           ...   
322     0.712255        1         2       491  59141.344954  59436.463808   
323     0.542701        1         1       939  59436.466736  59436.466736   
324     0.767021        1         1      1070  59436.466736  59436.466736   
325     0.609536        1         1       991  59436.466736  59436.466736   
326     0.741946        1         9       980  58786.321204  59474.468808   

     ...      meanra    meandec   sigmara  sigmadec    deltajd      firstmjd  \
0    ...  228.003004 -11.405108  0.000014  0.000006   2.017187  59434.173299   
1    ...  242.500194   0.776732       NaN       NaN   0.000000  59434.174236   
2    ...  230.983216   4.174032  0.000052  0.000008   0.037141  59434.175174   
3    ...  232.640111   4.252135  0.000066  0.000064  24.022836  59434.175174   
4    ...  223.304012  15.738747  0.000053  0.000046   2.018611  59434.177060   
..   ...         ...        ...       ...       ...        ...           ...   
322  ...   19.129718 -12.604603       NaN       NaN   0.000000  59436.463808   
323  ...   18.080104  33.038645       NaN       NaN   0.000000  59436.466736   
324  ...   14.540964  31.301876       NaN       NaN   0.000000  59436.466736   
325  ...   18.060096  33.078014       NaN       NaN   0.000000  59436.466736   
326  ...   61.050112  27.261544  0.000060  0.000048  37.993912  59436.474896   

          lastmjd      step_id_corr  diffpos  reference_change  
0    59436.190486  correction_1.0.6     True             False  
1    59434.174236  correction_1.0.6     True             False  
2    59434.212315  correction_1.0.6     True             False  
3    59458.198009  correction_1.0.6     True             False  
4    59436.195671  correction_1.0.6     True             False  
..            ...               ...      ...               ...  
322  59436.463808  correction_1.0.6     True             False  
323  59436.466736  correction_1.0.6     True             False  
324  59436.466736  correction_1.0.6     True             False  
325  59436.466736  correction_1.0.6     True             False  
326  59474.468808  correction_1.0.6     True             False  

[327 rows x 27 columns]]",,13.00129461288452,2025-05-18T23:33:29,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,27,0,"
SELECT
    object.oid, object.meanra, object.meandec, object.ndet,
    object.firstMJD, object.deltajd, object.g_r_max,
    probability.classifier_name, probability.class_name,
    probability.ranking, probability.probability
FROM
    object INNER JOIN probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name = 'lc_classifier'
    AND object.ndet >= 100
    AND object.oid IN
(
SELECT
    oid
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND class_name IN ('CEP')
    AND ranking = 1
    AND probability > 0.76
)
",,,,,"[               oid      meanra    meandec  ndet      firstmjd      deltajd  \
0     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
1     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
2     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
3     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
4     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
...            ...         ...        ...   ...           ...          ...   
5455  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5456  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5457  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5458  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5459  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   

      g_r_max classifier_name class_name  ranking  probability  
0         NaN   lc_classifier        AGN       14     0.000104  
1         NaN   lc_classifier        AGN       15     0.000976  
2         NaN   lc_classifier     Blazar       13     0.000312  
3         NaN   lc_classifier     Blazar       13     0.003416  
4         NaN   lc_classifier        CEP        1     0.791208  
...       ...             ...        ...      ...          ...  
5455      NaN   lc_classifier      SNIbc       12     0.000452  
5456      NaN   lc_classifier       SNII       10     0.017820  
5457      NaN   lc_classifier       SNII       12     0.000452  
5458      NaN   lc_classifier        YSO        2     0.092564  
5459      NaN   lc_classifier        YSO        4     0.033216  

[5460 rows x 11 columns]]",,6.982426643371582,2025-05-18T23:33:36,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,27,1,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    object.ndet >= 100
    AND probability.ranking = 1
    AND probability.classifier_name = 'lc_classifier'
    AND probability.class_name = 'Ceph'
    AND probability.probability > 0.76
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,10.118314027786257,2025-04-28T23:36:42,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.803807020187378,2025-05-18T23:33:54,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,2,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    object.ndet >= 100
    AND probability.classifier_name = 'lc_classifier'
    AND probability.class_name = 'Ceph'
    AND probability.ranking = 1
    AND probability.probability > 0.76
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,11.337930917739868,2025-04-28T23:36:53,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.553773164749146,2025-05-18T23:34:13,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,3,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    probability.classifier_name = 'lc_classifier' 
    AND probability.class_name = 'Ceph' 
    AND probability.ranking = 1 
    AND probability.probability > 0.76 
    AND object.ndet >= 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,11.20435643196106,2025-04-28T23:37:04,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.558281421661375,2025-05-18T23:34:30,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,4,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    object.ndet >= 100
    AND probability.classifier_name = 'lc_classifier'
    AND probability.class_name = 'Ceph'
    AND probability.probability > 0.76
    AND probability.ranking = 1
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,18.279829025268555,2025-04-28T23:37:23,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.012946367263794,2025-05-18T23:34:47,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,5,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    p.classifier_name = 'lc_classifier' 
    AND p.class_name = 'Ceph' 
    AND p.ranking = 1 
    AND p.probability > 0.76 
    AND o.ndet >= 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,9.938629627227783,2025-04-28T23:37:32,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.44640564918518,2025-05-18T23:35:06,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,6,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    probability.ranking = 1
    AND probability.classifier_name = 'lc_classifier'
    AND probability.class_name = 'Ceph'
    AND probability.probability > 0.76
    AND object.ndet >= 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,22.88480424880981,2025-04-28T23:37:55,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.246512174606323,2025-05-18T23:35:24,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,7,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.ndet >= 100
    AND p.classifier_name = 'lc_classifier'
    AND p.class_name = 'Ceph'
    AND p.ranking = 1
    AND p.probability > 0.76
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.7889387607574463,2025-04-28T23:37:58,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.866548538208008,2025-05-18T23:35:41,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,8,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.ndet >= 100
    AND p.classifier_name = 'lc_classifier'
    AND p.class_name = 'Ceph'
    AND p.ranking = 1
    AND p.probability > 0.76
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.040435552597046,2025-04-28T23:38:01,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.12077260017395,2025-05-18T23:35:58,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,9,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.ndet >= 100
    AND p.class_name = 'Ceph'
    AND p.probability > 0.76
    AND p.ranking = 1
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,7.69147801399231,2025-04-28T23:38:09,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,10.928571462631226,2025-05-18T23:36:14,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,10,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.ndet >= 100
    AND p.class_name = 'Ceph'
    AND p.probability > 0.76
    AND p.ranking = 1
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,8.117822885513306,2025-04-28T23:38:17,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.243783950805664,2025-05-18T23:36:32,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,17,0,"
SELECT
  *
FROM
  (
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.version, feature.fid
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name = 'AGN'
    AND probability.ranking = 1
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'ExcessVar'
  AND feature.fid = 1
  AND feature.value < -0.001
ORDER BY feature.value ASC
) as sq1
UNION
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.version, feature.fid
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name = 'AGN'
    AND probability.ranking = 1
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'ExcessVar'
  AND feature.fid = 2
  AND feature.value > -0.000001
) as sq2
ORDER BY oid
) AS sq
WHERE
  sq.oid in (
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.version, feature.fid
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name = 'AGN'
    AND probability.ranking = 1
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'ExcessVar'
  AND feature.fid = 1
  AND feature.value < -0.001
ORDER BY feature.value ASC
) as sq1
INTERSECT
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.version, feature.fid
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name = 'AGN'
    AND probability.ranking = 1
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'ExcessVar'
  AND feature.fid = 2
  AND feature.value > -0.000001
) as sq2
ORDER BY oid
)
ORDER BY oid
",,,,,"[             oid     value       name                             version  fid
0   ZTF18aaiakhj -0.001117  ExcessVar                            23.12.25    1
1   ZTF18aaiakhj  0.000230  ExcessVar                              26.0.0    2
2   ZTF18aaiakhj -0.001080  ExcessVar  lc_classifier_1.2.1-P-transitional    1
3   ZTF18aaxzddt  0.000156  ExcessVar                            23.12.25    2
4   ZTF18aaxzddt -0.001317  ExcessVar                         23.12.26a85    1
..           ...       ...        ...                                 ...  ...
90  ZTF21aazgbtp -0.010926  ExcessVar                              24.5.1    1
91  ZTF21aazgbtp  0.009599  ExcessVar                              24.5.1    2
92  ZTF21abduazj -0.001005  ExcessVar                         23.12.26a85    1
93  ZTF21abduazj -0.001005  ExcessVar                              27.5.6    1
94  ZTF21abduazj  0.000000  ExcessVar               lc_classifier_1.2.1-P    2

[95 rows x 5 columns]]",,133.15535855293274,2025-05-19T10:21:58,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,17,1,"
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 2
      AND m.magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 1
      AND (m.ndet = 0 OR m.magsigma = 0) -- No detections or no variability
),
features_union AS (
    SELECT f.oid, f.name, f.value
    FROM feature f
    INNER JOIN agn_objects ao ON f.oid = ao.oid
    WHERE f.fid IN (1, 2) -- Considering features for g and r bands
),
features_intersect AS (
    SELECT f.oid
    FROM feature f
    INNER JOIN agn_objects ao ON f.oid = ao.oid
    WHERE f.fid IN (1, 2)
    GROUP BY f.oid
    HAVING COUNT(DISTINCT f.fid) = 2 -- Ensure both g and r band features exist
)
SELECT o.*
FROM object o
WHERE o.oid IN (
    SELECT oid
    FROM features_union
    WHERE oid IN (SELECT oid FROM features_intersect)
)
AND o.oid IN (SELECT oid FROM agn_objects)
AND o.oid IN (SELECT oid FROM r_band_variability)
AND o.oid IN (SELECT oid FROM g_band_no_detections)
ORDER BY o.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,27.322832107543945,2025-04-28T23:38:44,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 2
      AND m.magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 1
      AND (m.ndet = 0 OR m.magsigma = 0) -- No detections or no variability
),
features_union AS (
    SELECT f.oid, f.name, f.value
    FROM feature f
    WHERE f.fid IN (1, 2) -- Considering features for g and r bands
),
features_intersect AS (
    SELECT f.oid
    FROM feature f
    WHERE f.fid IN (1, 2)
    GROUP BY f.oid
    HAVING COUNT(DISTINCT f.fid) = 2 -- Ensure both g and r band features exist
)
SELECT o.oid, f.name, f.value
FROM object o
JOIN features_union f ON o.oid = f.oid
WHERE o.oid IN (SELECT oid FROM agn_objects)
AND o.oid IN (SELECT oid FROM r_band_variability)
AND o.oid IN (SELECT oid FROM g_band_no_detections)
AND o.oid IN (SELECT oid FROM features_intersect)
ORDER BY o.oid, f.value
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",257.0842683315277,2025-05-19T10:26:23,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,2,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_oids AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
),
features_ordered AS (
    SELECT f.oid, f.name, f.value
    FROM feature f
    INNER JOIN filtered_oids fo ON f.oid = fo.oid
    ORDER BY f.value ASC
)
SELECT o.oid, f.name, f.value
FROM object o
INNER JOIN features_ordered f ON o.oid = f.oid
ORDER BY o.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.39830207824707,2025-04-28T23:39:08,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_oids AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
SELECT o.oid, f.name, f.value
FROM object o
INNER JOIN feature f ON o.oid = f.oid
WHERE o.oid IN (SELECT oid FROM filtered_oids)
ORDER BY o.oid, f.value ASC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.65116834640503,2025-05-19T10:30:42,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,3,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_oids AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
SELECT f.*
FROM feature f
INNER JOIN filtered_oids fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.405792474746704,2025-04-28T23:39:31,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
)
SELECT f.*
FROM feature f
WHERE f.oid IN (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",262.3302435874939,2025-05-19T10:35:13,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,4,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
SELECT f.*
FROM feature f
JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.820398092269897,2025-04-28T23:39:56,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
)
SELECT f.*
FROM feature f
WHERE f.oid IN (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.34672927856445,2025-05-19T10:39:32,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,5,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_no_variability
)
SELECT f.*
FROM feature f
JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.561721086502075,2025-04-28T23:40:21,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
)
SELECT f.*
FROM feature f
WHERE f.oid IN (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_no_variability
)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.6487421989441,2025-05-19T10:43:52,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,6,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_oids AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
SELECT f.*
FROM feature f
INNER JOIN filtered_oids fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.71831083297729,2025-04-28T23:40:45,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
)
SELECT f.*
FROM feature f
WHERE f.oid IN (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.13795948028564,2025-05-19T10:48:12,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,7,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0) -- No detections or no variability
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
SELECT f.oid, f.name, f.value
FROM feature f
INNER JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,25.356778860092163,2025-04-28T23:41:10,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0) -- No detections or no variability
),
filtered_objects AS (
    SELECT a.oid
    FROM agn_objects a
    JOIN r_band_variability r ON a.oid = r.oid
    LEFT JOIN g_band_no_detections_or_no_variability g ON a.oid = g.oid
    WHERE g.oid IS NOT NULL
)
SELECT f.oid, f.name, f.value
FROM feature f
WHERE f.oid IN (SELECT oid FROM filtered_objects)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.57905983924863,2025-05-19T10:52:32,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,8,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0) -- No detections or no variability
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
SELECT f.*
FROM feature f
JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid ASC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.127763032913208,2025-04-28T23:41:34,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0) -- No detections or no variability
),
filtered_objects AS (
    SELECT ao.oid
    FROM agn_objects ao
    JOIN r_band_variability rv ON ao.oid = rv.oid
    LEFT JOIN g_band_no_detections_or_no_variability gv ON ao.oid = gv.oid
    WHERE gv.oid IS NOT NULL
)
SELECT f.*
FROM feature f
JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid ASC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.8524386882782,2025-05-19T10:57:53,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,9,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma <= 0) -- Assuming magsigma <= 0 indicates no variability
),
selected_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
SELECT f.*
FROM feature f
JOIN selected_objects so ON f.oid = so.oid
ORDER BY f.value ASC, f.oid ASC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,26.81316304206848,2025-04-28T23:42:01,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma <= 0) -- Assuming magsigma <= 0 indicates no variability
),
selected_objects AS (
    SELECT ao.oid
    FROM agn_objects ao
    JOIN r_band_variability rv ON ao.oid = rv.oid
    LEFT JOIN g_band_no_detections_or_no_variability gv ON ao.oid = gv.oid
    WHERE gv.oid IS NOT NULL
)
SELECT f.*
FROM feature f
JOIN selected_objects so ON f.oid = so.oid
ORDER BY f.value ASC, f.oid ASC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.39977169036865,2025-05-19T11:04:22,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,10,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_variability
),
ordered_features AS (
    SELECT f.*
    FROM feature f
    INNER JOIN filtered_objects fo ON f.oid = fo.oid
    ORDER BY f.value ASC
)
SELECT o.*
FROM object o
INNER JOIN ordered_features ofe ON o.oid = ofe.oid
ORDER BY o.oid ASC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,21.823970079422,2025-04-28T23:42:23,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_objects AS (
    SELECT ao.oid
    FROM agn_objects ao
    JOIN r_band_variability rv ON ao.oid = rv.oid
    LEFT JOIN g_band_no_variability gv ON ao.oid = gv.oid
    WHERE gv.oid IS NOT NULL
),
ordered_features AS (
    SELECT f.*
    FROM feature f
    INNER JOIN filtered_objects fo ON f.oid = fo.oid
    ORDER BY f.value ASC
)
SELECT o.*
FROM object o
INNER JOIN ordered_features ofe ON o.oid = ofe.oid
ORDER BY o.oid ASC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.08548760414124,2025-05-19T11:09:14,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,37,0,"
SELECT
    *
FROM
  probability
WHERE
    classifier_name = 'lc_classifier'
    AND class_name IN ('SNIa')
    AND ranking=1
ORDER BY probability DESC
LIMIT 200
",,,,,"[              oid classifier_name     classifier_version class_name  \
0    ZTF20acobvxk   lc_classifier  hierarchical_rf_1.1.0       SNIa   
1    ZTF22aalpfln   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2    ZTF21abuyhau   lc_classifier  hierarchical_rf_1.1.0       SNIa   
3    ZTF21abywdxt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
4    ZTF22abqdmwt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
..            ...             ...                    ...        ...   
195  ZTF21aaufthj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
196  ZTF21aarmkuj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
197  ZTF20abgfvav   lc_classifier  hierarchical_rf_1.1.0       SNIa   
198  ZTF20abewogd   lc_classifier  hierarchical_rf_1.1.0       SNIa   
199  ZTF20aairvsi   lc_classifier  hierarchical_rf_1.1.0       SNIa   

     probability  ranking  
0       0.722000        1  
1       0.722000        1  
2       0.720000        1  
3       0.716564        1  
4       0.714568        1  
..           ...      ...  
195     0.636000        1  
196     0.636000        1  
197     0.636000        1  
198     0.636000        1  
199     0.636000        1  

[200 rows x 6 columns]]",,3.899226188659668,2025-05-19T11:09:18,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,37,1,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,12.89289927482605,2025-04-28T23:42:36,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,9.876404762268066,2025-05-19T11:09:32,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,2,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT * 
FROM probability
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,13.24457859992981,2025-04-28T23:42:49,"[              oid classifier_name     classifier_version class_name  \
0    ZTF20acobvxk   lc_classifier  hierarchical_rf_1.1.0       SNIa   
1    ZTF22aalpfln   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2    ZTF21abuyhau   lc_classifier  hierarchical_rf_1.1.0       SNIa   
3    ZTF21abywdxt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
4    ZTF22abqdmwt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
..            ...             ...                    ...        ...   
195  ZTF21aaufthj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
196  ZTF21aarmkuj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
197  ZTF20abgfvav   lc_classifier  hierarchical_rf_1.1.0       SNIa   
198  ZTF20abewogd   lc_classifier  hierarchical_rf_1.1.0       SNIa   
199  ZTF20aairvsi   lc_classifier  hierarchical_rf_1.1.0       SNIa   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.722000        1       102       502  59149.448125  59204.198831   
1       0.722000        1        59      2921  59724.250000  59766.250000   
2       0.720000        1        53      2702  59448.184097  59478.194873   
3       0.716564        1        44      1171  59464.267917  59502.204410   
4       0.714568        1        28       699  59877.250000  59932.250000   
..           ...      ...       ...       ...           ...           ...   
195     0.636000        1        27       659  59313.207350  59361.195984   
196     0.636000        1        35      1237  59306.233287  59350.217257   
197     0.636000        1        44      1264  59019.234178  59063.179873   
198     0.636000        1        57       293  59013.243611  59075.306400   
199     0.636000        1       106      1139  58873.195289  58915.143796   

     ...      meanra    meandec   sigmara  sigmadec    deltajd      firstmjd  \
0    ...   37.673533 -14.569121  0.000080  0.000059  54.750706  59149.448125   
1    ...  224.503742  49.953109  0.000049  0.000022  41.892627  59724.349155   
2    ...  244.075462  37.636849  0.000064  0.000032  28.030926  59450.163947   
3    ...  326.503610  21.962614  0.000025  0.000023  37.007465  59465.196944   
4    ...   28.288162 -14.140191  0.000040  0.000052  53.900000  59878.310451   
..   ...         ...        ...       ...       ...        ...           ...   
195  ...  151.805684  14.773050  0.000036  0.000027  47.988634  59313.207350   
196  ...  136.109002   8.012789  0.000021  0.000015  43.983970  59306.233287   
197  ...  226.922647  32.009601  0.000034  0.000020  43.945695  59019.234178   
198  ...  312.095377  83.077586  0.000341  0.000026  62.062789  59013.243611   
199  ...  108.453967  35.836392  0.000035  0.000043  41.948507  58873.195289   

          lastmjd      step_id_corr  diffpos  reference_change  
0    59204.198831   corr_bulk_0.0.1     True             False  
1    59766.241782               dev     True             False  
2    59478.194873  correction_1.0.6     True             False  
3    59502.204410  correction_1.0.6     True             False  
4    59932.210451             1.1.6     True             False  
..            ...               ...      ...               ...  
195  59361.195984  correction_0.0.1     True             False  
196  59350.217257  correction_0.0.1     True             False  
197  59063.179873   corr_bulk_0.0.1     True             False  
198  59075.306400   corr_bulk_0.0.1     True             False  
199  58915.143796   corr_bulk_0.0.1     True             False  

[200 rows x 27 columns]]",,10.920083045959473,2025-05-19T11:09:47,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,3,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.70656180381775,2025-04-28T23:43:06,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,9.664161443710327,2025-05-19T11:10:00,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,4,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,10.64267349243164,2025-04-28T23:43:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,10.160022974014282,2025-05-19T11:10:15,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,5,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM probability
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,12.443302154541016,2025-04-28T23:43:29,"[              oid classifier_name     classifier_version class_name  \
0    ZTF20acobvxk   lc_classifier  hierarchical_rf_1.1.0       SNIa   
1    ZTF22aalpfln   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2    ZTF21abuyhau   lc_classifier  hierarchical_rf_1.1.0       SNIa   
3    ZTF21abywdxt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
4    ZTF22abqdmwt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
..            ...             ...                    ...        ...   
195  ZTF21aaufthj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
196  ZTF21aarmkuj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
197  ZTF20abgfvav   lc_classifier  hierarchical_rf_1.1.0       SNIa   
198  ZTF20abewogd   lc_classifier  hierarchical_rf_1.1.0       SNIa   
199  ZTF20aairvsi   lc_classifier  hierarchical_rf_1.1.0       SNIa   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.722000        1       102       502  59149.448125  59204.198831   
1       0.722000        1        59      2921  59724.250000  59766.250000   
2       0.720000        1        53      2702  59448.184097  59478.194873   
3       0.716564        1        44      1171  59464.267917  59502.204410   
4       0.714568        1        28       699  59877.250000  59932.250000   
..           ...      ...       ...       ...           ...           ...   
195     0.636000        1        27       659  59313.207350  59361.195984   
196     0.636000        1        35      1237  59306.233287  59350.217257   
197     0.636000        1        44      1264  59019.234178  59063.179873   
198     0.636000        1        57       293  59013.243611  59075.306400   
199     0.636000        1       106      1139  58873.195289  58915.143796   

     ...      meanra    meandec   sigmara  sigmadec    deltajd      firstmjd  \
0    ...   37.673533 -14.569121  0.000080  0.000059  54.750706  59149.448125   
1    ...  224.503742  49.953109  0.000049  0.000022  41.892627  59724.349155   
2    ...  244.075462  37.636849  0.000064  0.000032  28.030926  59450.163947   
3    ...  326.503610  21.962614  0.000025  0.000023  37.007465  59465.196944   
4    ...   28.288162 -14.140191  0.000040  0.000052  53.900000  59878.310451   
..   ...         ...        ...       ...       ...        ...           ...   
195  ...  151.805684  14.773050  0.000036  0.000027  47.988634  59313.207350   
196  ...  136.109002   8.012789  0.000021  0.000015  43.983970  59306.233287   
197  ...  226.922647  32.009601  0.000034  0.000020  43.945695  59019.234178   
198  ...  312.095377  83.077586  0.000341  0.000026  62.062789  59013.243611   
199  ...  108.453967  35.836392  0.000035  0.000043  41.948507  58873.195289   

          lastmjd      step_id_corr  diffpos  reference_change  
0    59204.198831   corr_bulk_0.0.1     True             False  
1    59766.241782               dev     True             False  
2    59478.194873  correction_1.0.6     True             False  
3    59502.204410  correction_1.0.6     True             False  
4    59932.210451             1.1.6     True             False  
..            ...               ...      ...               ...  
195  59361.195984  correction_0.0.1     True             False  
196  59350.217257  correction_0.0.1     True             False  
197  59063.179873   corr_bulk_0.0.1     True             False  
198  59075.306400   corr_bulk_0.0.1     True             False  
199  58915.143796   corr_bulk_0.0.1     True             False  

[200 rows x 27 columns]]",,9.970707654953005,2025-05-19T11:10:29,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,6,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,13.818251132965088,2025-04-28T23:43:43,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,10.69739556312561,2025-05-19T11:10:43,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,7,"
SELECT * 
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,14.260555982589722,2025-04-28T23:43:57,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,9.532353162765505,2025-05-19T11:10:57,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,8,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,13.248966217041016,2025-04-28T23:44:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,9.85399603843689,2025-05-19T11:11:11,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,9,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,13.32813811302185,2025-04-28T23:44:24,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,10.161943912506104,2025-05-19T11:11:25,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,10,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SNIa' 
  AND probability.classifier_name = 'lc_classifier' 
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,12.553942918777466,2025-04-28T23:44:36,"[              oid classifier_name     classifier_version class_name  \
0    ZTF20acobvxk   lc_classifier  hierarchical_rf_1.1.0       SNIa   
1    ZTF22aalpfln   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2    ZTF21abuyhau   lc_classifier  hierarchical_rf_1.1.0       SNIa   
3    ZTF21abywdxt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
4    ZTF22abqdmwt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
..            ...             ...                    ...        ...   
195  ZTF21aaufthj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
196  ZTF21aarmkuj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
197  ZTF20abgfvav   lc_classifier  hierarchical_rf_1.1.0       SNIa   
198  ZTF20abewogd   lc_classifier  hierarchical_rf_1.1.0       SNIa   
199  ZTF20aairvsi   lc_classifier  hierarchical_rf_1.1.0       SNIa   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.722000        1       102       502  59149.448125  59204.198831   
1       0.722000        1        59      2921  59724.250000  59766.250000   
2       0.720000        1        53      2702  59448.184097  59478.194873   
3       0.716564        1        44      1171  59464.267917  59502.204410   
4       0.714568        1        28       699  59877.250000  59932.250000   
..           ...      ...       ...       ...           ...           ...   
195     0.636000        1        27       659  59313.207350  59361.195984   
196     0.636000        1        35      1237  59306.233287  59350.217257   
197     0.636000        1        44      1264  59019.234178  59063.179873   
198     0.636000        1        57       293  59013.243611  59075.306400   
199     0.636000        1       106      1139  58873.195289  58915.143796   

     ...      meanra    meandec   sigmara  sigmadec    deltajd      firstmjd  \
0    ...   37.673533 -14.569121  0.000080  0.000059  54.750706  59149.448125   
1    ...  224.503742  49.953109  0.000049  0.000022  41.892627  59724.349155   
2    ...  244.075462  37.636849  0.000064  0.000032  28.030926  59450.163947   
3    ...  326.503610  21.962614  0.000025  0.000023  37.007465  59465.196944   
4    ...   28.288162 -14.140191  0.000040  0.000052  53.900000  59878.310451   
..   ...         ...        ...       ...       ...        ...           ...   
195  ...  151.805684  14.773050  0.000036  0.000027  47.988634  59313.207350   
196  ...  136.109002   8.012789  0.000021  0.000015  43.983970  59306.233287   
197  ...  226.922647  32.009601  0.000034  0.000020  43.945695  59019.234178   
198  ...  312.095377  83.077586  0.000341  0.000026  62.062789  59013.243611   
199  ...  108.453967  35.836392  0.000035  0.000043  41.948507  58873.195289   

          lastmjd      step_id_corr  diffpos  reference_change  
0    59204.198831   corr_bulk_0.0.1     True             False  
1    59766.241782               dev     True             False  
2    59478.194873  correction_1.0.6     True             False  
3    59502.204410  correction_1.0.6     True             False  
4    59932.210451             1.1.6     True             False  
..            ...               ...      ...               ...  
195  59361.195984  correction_0.0.1     True             False  
196  59350.217257  correction_0.0.1     True             False  
197  59063.179873   corr_bulk_0.0.1     True             False  
198  59075.306400   corr_bulk_0.0.1     True             False  
199  58915.143796   corr_bulk_0.0.1     True             False  

[200 rows x 27 columns]]",,9.321856021881104,2025-05-19T11:11:38,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,,,34,0,"
SELECT
    *
FROM
    feature
WHERE
    (name='Amplitude'
    OR name='Multiband_period')
    AND oid in ('ZTF17aaadpsi','ZTF19aaduncs','ZTF18abnvehl','ZTF19abrqsxy','ZTF19aaduodl','ZTF19aadovdv','ZTF18aammkke','ZTF18abtriul','ZTF17aabwtky','ZTF18abwjpfy')
",,,,,"[              oid              name     value  fid                version
0    ZTF19aaduodl         Amplitude  0.351974    1  lc_classifier_1.2.1-P
1    ZTF18abtriul         Amplitude  0.307038    2  lc_classifier_1.2.1-P
2    ZTF18abtriul  Multiband_period  0.326399   12  lc_classifier_1.2.1-P
3    ZTF19aadovdv         Amplitude  0.217939    2  lc_classifier_1.2.1-P
4    ZTF18aammkke         Amplitude  0.362162    1  lc_classifier_1.2.1-P
..            ...               ...       ...  ...                    ...
337  ZTF18aammkke  Multiband_period  0.653667   12                 27.5.6
338  ZTF18aammkke         Amplitude  0.251297    2                 27.5.6
339  ZTF17aaadpsi  Multiband_period  0.629546   12                 27.5.6
340  ZTF17aaadpsi         Amplitude  0.249162    2                 27.5.6
341  ZTF17aaadpsi         Amplitude  0.307740    1                 27.5.6

[342 rows x 5 columns]]",,3.8223066329956055,2025-05-19T11:11:42,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,1,"
-- Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Sub-query for the 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Sub-query for the 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Combine the results of the two feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Intersect to find common oids between the two feature sub-queries
intersect_features AS (
    SELECT oid FROM amplitude_subquery
    INTERSECT
    SELECT oid FROM multiband_period_subquery
)

-- Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,20.31040573120117,2025-04-28T23:44:57,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""amplitude_subquery""
LINE 3: amplitude_subquery AS (
        ^

[SQL: 
-- Sub-query for the 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    WHERE f.name = 'Amplitude'
      AND f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Sub-query for the 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    WHERE f.name = 'Multiband_period'
      AND f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Combine the results of the two feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
)

-- Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
]
(Background on this error at: https://sqlalche.me/e/20/f405)",21.646074295043945,2025-05-19T11:12:08,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,34,2,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results using UNION and INTERSECT
combined_features AS (
    SELECT * FROM amplitude_feature
    UNION
    SELECT * FROM multiband_period_feature
),

intersected_oids AS (
    SELECT oid FROM amplitude_feature
    INTERSECT
    SELECT oid FROM multiband_period_feature
)

-- Step 5: Final query to filter combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersected_oids)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,15.625924825668337,2025-04-28T23:45:12,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,18.38240933418274,2025-05-19T11:12:31,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,3,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results using UNION
combined_features AS (
    SELECT * FROM amplitude_feature
    UNION
    SELECT * FROM multiband_period_feature
),

-- Step 5: Find common oids using INTERSECT
intersected_oids AS (
    SELECT oid FROM amplitude_feature
    INTERSECT
    SELECT oid FROM multiband_period_feature
)

-- Step 6: Final query to filter combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersected_oids)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,13.969372034072876,2025-04-28T23:45:26,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,12.717614650726318,2025-05-19T11:12:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,4,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results of the sub-queries for 'Amplitude' and 'Multiband_period'
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 5: Intersect to find common oids between 'Amplitude' and 'Multiband_period'
intersect_features AS (
    SELECT oid
    FROM amplitude_subquery
    INTERSECT
    SELECT oid
    FROM multiband_period_subquery
)

-- Step 6: Final query to filter the combined results
SELECT *
FROM combined_features
WHERE oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,18.64547538757324,2025-04-28T23:45:45,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,15.03137469291687,2025-05-19T11:13:07,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,5,"
-- Step 1: Sub-query for Probability Table
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-queries for Each Feature
amplitude_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

multiband_period_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 3: Combine Feature Sub-queries
union_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 4: Intersect Feature Sub-queries
intersect_features AS (
    SELECT oid FROM amplitude_subquery
    INTERSECT
    SELECT oid FROM multiband_period_subquery
)

-- Step 5: Final Query Construction
SELECT uf.*
FROM union_features uf
WHERE uf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,15.227156162261965,2025-04-28T23:46:00,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,14.894315719604492,2025-05-19T11:13:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,6,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results of the feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 5: Find common oids between the feature sub-queries
intersect_features AS (
    SELECT oid
    FROM amplitude_subquery
    INTERSECT
    SELECT oid
    FROM multiband_period_subquery
)

-- Step 6: Final query to filter the combined results
SELECT *
FROM combined_features
WHERE oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,15.267089366912842,2025-04-28T23:46:16,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,27.63832116127014,2025-05-19T11:13:58,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,7,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine results using UNION
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 5: Intersect to ensure oids have both features
intersect_features AS (
    SELECT oid
    FROM amplitude_subquery
    INTERSECT
    SELECT oid
    FROM multiband_period_subquery
)

-- Step 6: Final query to filter combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,17.18593955039978,2025-04-28T23:46:33,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,18.455910444259644,2025-05-19T11:14:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,8,"
-- Sub-query to filter the probability table for the specified oids with default conditions
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Sub-query for 'Amplitude' feature
amplitude_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Amplitude'
),

-- Sub-query for 'Multiband_period' feature
multiband_period_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Multiband_period'
),

-- Combine the results of the sub-queries for 'Amplitude' and 'Multiband_period'
combined_features AS (
    SELECT * FROM amplitude_feature
    UNION
    SELECT * FROM multiband_period_feature
),

-- Intersect to find common oids between the sub-queries for 'Amplitude' and 'Multiband_period'
intersected_oids AS (
    SELECT oid
    FROM amplitude_feature
    INTERSECT
    SELECT oid
    FROM multiband_period_feature
)

-- Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersected_oids)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,15.504189491271973,2025-04-28T23:46:48,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""amplitude_feature""
LINE 3: amplitude_feature AS (
        ^

[SQL: 
-- Sub-query for 'Amplitude' feature
amplitude_feature AS (
    SELECT f.*
    FROM feature f
    WHERE f.name = 'Amplitude'
      AND f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Sub-query for 'Multiband_period' feature
multiband_period_feature AS (
    SELECT f.*
    FROM feature f
    WHERE f.name = 'Multiband_period'
      AND f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Combine the results of the sub-queries for 'Amplitude' and 'Multiband_period'
combined_features AS (
    SELECT * FROM amplitude_feature
    UNION
    SELECT * FROM multiband_period_feature
)

-- Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.163273096084597,2025-05-19T11:14:38,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,34,9,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_features AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_features AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results of the feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_features
    UNION
    SELECT * FROM multiband_period_features
),

-- Step 5: Find common oids between the feature sub-queries
intersect_features AS (
    SELECT oid
    FROM amplitude_features
    INTERSECT
    SELECT oid
    FROM multiband_period_features
)

-- Step 6: Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,14.708109617233276,2025-04-28T23:47:03,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,19.217700242996216,2025-05-19T11:15:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,10,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results of the feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 5: Find common oids between the feature sub-queries
intersect_features AS (
    SELECT oid
    FROM amplitude_subquery
    INTERSECT
    SELECT oid
    FROM multiband_period_subquery
)

-- Step 6: Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,16.277417421340942,2025-04-28T23:47:20,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,17.897935390472412,2025-05-19T11:15:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,1,0,"
SELECT
  sq.oid, sq.value, sq.name, sq.fid as feature_fid, sq.version, sq.ndet, sq.meanra, sq.meandec,
  magstat.magmax, magstat.magmin,  magstat.magmax-magstat.magmin as delta_mag, magstat.fid as magstat_fid
FROM
  (
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 1
  AND feature.fid = 1
) as sq1
UNION
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 0.5
  AND feature.fid = 2
) as sq2
ORDER BY oid
) AS sq
  INNER JOIN magstat
  ON sq.oid = magstat.oid
WHERE
  sq.oid in (
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 1
  AND feature.fid = 1
) as sq1
INTERSECT
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 0.5
  AND feature.fid = 2
) as sq2
ORDER BY oid
)
  AND magstat.ndet > 20
  AND magstat.corrected = TRUE
ORDER BY oid
",,,,,"[              oid      value       name  feature_fid version  ndet  \
0    ZTF18aajadqs  23.218352  Amplitude            1  24.5.1  1177   
1    ZTF18aajadqs  23.218352  Amplitude            1  24.5.1  1177   
2    ZTF18aajadqs  32.419900  Amplitude            2  24.5.1  1177   
3    ZTF18aajadqs  32.419900  Amplitude            2  24.5.1  1177   
4    ZTF18aakixcl  32.346897  Amplitude            2  24.5.1   822   
..            ...        ...        ...          ...     ...   ...   
437  ZTF22aaihxyw  31.858641  Amplitude            1  24.5.1    99   
438  ZTF23aagpjmh   6.896555  Amplitude            2  24.5.1    97   
439  ZTF23aagpjmh   6.896555  Amplitude            2  24.5.1    97   
440  ZTF23aagpjmh   9.379387  Amplitude            1  24.5.1    97   
441  ZTF23aagpjmh   9.379387  Amplitude            1  24.5.1    97   

         meanra    meandec     magmax     magmin  delta_mag  magstat_fid  
0    262.778525  30.297422  20.614600  18.841400   1.773199            1  
1    262.778525  30.297422  20.236600  18.619764   1.616837            2  
2    262.778525  30.297422  20.614600  18.841400   1.773199            1  
3    262.778525  30.297422  20.236600  18.619764   1.616837            2  
4    234.541788  57.603637  20.211306  18.502560   1.708746            1  
..          ...        ...        ...        ...        ...          ...  
437  258.003528   9.019274  20.471000  19.632126   0.838875            2  
438  270.287184  13.851853  20.859700  19.852900   1.006800            1  
439  270.287184  13.851853  20.569700  19.989302   0.580399            2  
440  270.287184  13.851853  20.859700  19.852900   1.006800            1  
441  270.287184  13.851853  20.569700  19.989302   0.580399            2  

[442 rows x 12 columns]]",,71.45126414299011,2025-05-19T11:16:35,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,1,1,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_subquery AS (
    SELECT oid, meanra, meandec, ndet
    FROM object
    WHERE deltajd >= 365
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag_g
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag_r
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
feature_subquery AS (
    SELECT oid, value, name, version, fid AS feature_fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr, mg.delta_mag_g,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr, mr.delta_mag_r
FROM probability_subquery p
INNER JOIN object_subquery o ON p.oid = o.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
INNER JOIN feature_subquery f ON o.oid = f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,25.869852781295776,2025-04-28T23:47:46,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_subquery AS (
    SELECT oid, meanra, meandec, ndet
    FROM object
    WHERE deltajd >= 365
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag_g
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag_r
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
feature_subquery AS (
    SELECT oid, value, name, version, fid AS feature_fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr, mg.delta_mag_g,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr, mr.delta_mag_r
FROM probability_subquery p
INNER JOIN object_subquery o ON p.oid = o.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
INNER JOIN feature_subquery f ON o.oid = f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",256.01489424705505,2025-05-19T11:20:58,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,2,"
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.probability > 0.6
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
time_covered_objects AS (
    SELECT o.oid
    FROM object o
    WHERE o.deltajd >= 365
),
sufficient_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.ndet >= 20
),
magnitude_variations AS (
    SELECT m.oid
    FROM magstat m
    WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
       OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
),
filtered_objects AS (
    SELECT DISTINCT a.oid
    FROM agn_objects a
    INNER JOIN time_covered_objects t ON a.oid = t.oid
    INNER JOIN sufficient_detections s ON a.oid = s.oid
    INNER JOIN magnitude_variations v ON a.oid = v.oid
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr,
       (m.magmax_corr - m.magmin_corr) AS delta_mag, m.fid AS magstat_fid
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN feature f ON fo.oid = f.oid
INNER JOIN magstat m ON fo.oid = m.oid
WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
   OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,27.986515045166016,2025-04-28T23:48:14,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.probability > 0.6
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
time_covered_objects AS (
    SELECT o.oid
    FROM object o
    WHERE o.deltajd >= 365
),
sufficient_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.ndet >= 20
),
magnitude_variations_g AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1
),
magnitude_variations_r AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5
),
filtered_objects AS (
    SELECT DISTINCT a.oid
    FROM agn_objects a
    INNER JOIN time_covered_objects t ON a.oid = t.oid
    INNER JOIN sufficient_detections s ON a.oid = s.oid
    INNER JOIN magnitude_variations_g vg ON a.oid = vg.oid
    INNER JOIN magnitude_variations_r vr ON a.oid = vr.oid
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr,
       (m.magmax_corr - m.magmin_corr) AS delta_mag, m.fid AS magstat_fid
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN feature f ON fo.oid = f.oid
INNER JOIN magstat m ON fo.oid = m.oid
WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
   OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",261.685448884964,2025-05-19T11:25:27,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,3,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
feature_filtered AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, 
       o.meanra, o.meandec, o.ndet, 
       g.magmax_corr AS g_magmax_corr, g.magmin_corr AS g_magmin_corr, 
       r.magmax_corr AS r_magmax_corr, r.magmin_corr AS r_magmin_corr,
       (g.magmax_corr - g.magmin_corr) AS g_delta_mag,
       (r.magmax_corr - r.magmin_corr) AS r_delta_mag
FROM object_filtered o
INNER JOIN feature_filtered f ON o.oid = f.oid
INNER JOIN magstat_g g ON o.oid = g.oid
INNER JOIN magstat_r r ON o.oid = r.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.00185871124268,2025-04-28T23:48:38,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
magstat_filtered AS (
    SELECT oid
    FROM magstat
    WHERE (fid = 1 AND magmax_corr - magmin_corr > 1 AND ndet >= 20)
       OR (fid = 2 AND magmax_corr - magmin_corr > 0.5 AND ndet >= 20)
    GROUP BY oid
    HAVING COUNT(DISTINCT fid) = 2
),
feature_filtered AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, 
       o.meanra, o.meandec, o.ndet, 
       g.magmax_corr AS g_magmax_corr, g.magmin_corr AS g_magmin_corr, 
       r.magmax_corr AS r_magmax_corr, r.magmin_corr AS r_magmin_corr,
       (g.magmax_corr - g.magmin_corr) AS g_delta_mag,
       (r.magmax_corr - r.magmin_corr) AS r_delta_mag
FROM object_filtered o
INNER JOIN feature_filtered f ON o.oid = f.oid
INNER JOIN magstat_filtered m ON o.oid = m.oid
INNER JOIN magstat g ON o.oid = g.oid AND g.fid = 1
INNER JOIN magstat r ON o.oid = r.oid AND r.fid = 2
WHERE g.magmax_corr - g.magmin_corr > 1
  AND r.magmax_corr - r.magmin_corr > 0.5
  AND g.ndet >= 20
  AND r.ndet >= 20
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",262.7784826755524,2025-05-19T11:29:58,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,4,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
time_coverage_subquery AS (
    SELECT oid
    FROM object
    WHERE deltajd >= 365
),
detection_count_subquery AS (
    SELECT oid
    FROM magstat
    WHERE ndet >= 20
),
magnitude_variation_g AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
),
magnitude_variation_r AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
),
valid_objects AS (
    SELECT oid
    FROM probability_subquery
    INTERSECT
    SELECT oid
    FROM time_coverage_subquery
    INTERSECT
    SELECT oid
    FROM detection_count_subquery
    INTERSECT
    SELECT oid
    FROM magnitude_variation_g
    INTERSECT
    SELECT oid
    FROM magnitude_variation_r
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg_g.magmax_corr AS g_magmax_corr, mg_g.magmin_corr AS g_magmin_corr,
       mg_g.magmax_corr - mg_g.magmin_corr AS g_delta_mag,
       mg_r.magmax_corr AS r_magmax_corr, mg_r.magmin_corr AS r_magmin_corr,
       mg_r.magmax_corr - mg_r.magmin_corr AS r_delta_mag
FROM valid_objects vo
JOIN object o ON vo.oid = o.oid
JOIN feature f ON vo.oid = f.oid
JOIN magstat mg_g ON vo.oid = mg_g.oid AND mg_g.fid = 1
JOIN magstat mg_r ON vo.oid = mg_r.oid AND mg_r.fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,26.84137845039368,2025-04-28T23:49:05,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
time_coverage_subquery AS (
    SELECT oid
    FROM object
    WHERE deltajd >= 365
),
detection_count_subquery AS (
    SELECT oid
    FROM magstat
    WHERE ndet >= 20
),
magnitude_variation_g AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
),
magnitude_variation_r AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
),
valid_objects AS (
    SELECT oid
    FROM probability_subquery
    INTERSECT
    SELECT oid
    FROM time_coverage_subquery
    INTERSECT
    SELECT oid
    FROM detection_count_subquery
    INTERSECT
    SELECT oid
    FROM magnitude_variation_g
    INTERSECT
    SELECT oid
    FROM magnitude_variation_r
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg_g.magmax_corr AS g_magmax_corr, mg_g.magmin_corr AS g_magmin_corr,
       mg_g.magmax_corr - mg_g.magmin_corr AS g_delta_mag,
       mg_r.magmax_corr AS r_magmax_corr, mg_r.magmin_corr AS r_magmin_corr,
       mg_r.magmax_corr - mg_r.magmin_corr AS r_delta_mag
FROM valid_objects vo
JOIN object o ON vo.oid = o.oid
JOIN feature f ON vo.oid = f.oid
JOIN magstat mg_g ON vo.oid = mg_g.oid AND mg_g.fid = 1
JOIN magstat mg_r ON vo.oid = mg_r.oid AND mg_r.fid = 2
WHERE o.corrected = TRUE
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.459148645401,2025-05-19T11:34:19,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,5,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
features_filtered AS (
    SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS r_delta_mag
FROM object_filtered o
INNER JOIN features_filtered f ON o.oid = f.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,27.052191257476807,2025-04-28T23:49:32,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
magstat_filtered AS (
    SELECT oid, fid, magmax_corr, magmin_corr
    FROM magstat
    WHERE (fid = 1 AND magmax_corr - magmin_corr > 1 AND ndet >= 20)
       OR (fid = 2 AND magmax_corr - magmin_corr > 0.5 AND ndet >= 20)
),
features_filtered AS (
    SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS r_delta_mag
FROM object_filtered o
INNER JOIN features_filtered f ON o.oid = f.oid
INNER JOIN magstat_filtered mg ON o.oid = mg.oid AND mg.fid = 1
INNER JOIN magstat_filtered mr ON o.oid = mr.oid AND mr.fid = 2
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",269.2589409351349,2025-05-19T11:38:55,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,6,"
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.probability > 0.6
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
time_covered_objects AS (
    SELECT o.oid
    FROM object o
    WHERE o.deltajd >= 365
),
sufficient_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.ndet >= 20
),
magnitude_variations AS (
    SELECT m.oid
    FROM magstat m
    WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
       OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
),
filtered_objects AS (
    SELECT DISTINCT o.oid
    FROM agn_objects o
    INNER JOIN time_covered_objects tco ON o.oid = tco.oid
    INNER JOIN sufficient_detections sd ON o.oid = sd.oid
    INNER JOIN magnitude_variations mv ON o.oid = mv.oid
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr,
       (m.magmax_corr - m.magmin_corr) AS delta_mag, m.fid AS magstat_fid
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN feature f ON fo.oid = f.oid
INNER JOIN magstat m ON fo.oid = m.oid
WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
   OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,25.025559663772583,2025-04-28T23:49:57,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.probability > 0.6
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
time_covered_objects AS (
    SELECT o.oid
    FROM object o
    WHERE o.deltajd >= 365
),
sufficient_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.ndet >= 20
),
magnitude_variations_g AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1
),
magnitude_variations_r AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5
),
filtered_objects AS (
    SELECT DISTINCT o.oid
    FROM agn_objects o
    INNER JOIN time_covered_objects tco ON o.oid = tco.oid
    INNER JOIN sufficient_detections sd ON o.oid = sd.oid
    INNER JOIN magnitude_variations_g mvg ON o.oid = mvg.oid
    INNER JOIN magnitude_variations_r mvr ON o.oid = mvr.oid
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr,
       (m.magmax_corr - m.magmin_corr) AS delta_mag, m.fid AS magstat_fid
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN feature f ON fo.oid = f.oid
INNER JOIN magstat m ON fo.oid = m.oid
WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
   OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",258.83447432518005,2025-05-19T11:43:21,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,7,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
feature_subquery AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
object_subquery AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    WHERE o.deltajd >= 365
      AND o.oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS r_delta_mag
FROM object_subquery o
INNER JOIN feature_subquery f ON o.oid = f.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,26.85095524787903,2025-04-29T11:57:04,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_subquery AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    WHERE o.deltajd >= 365
      AND o.oid IN (SELECT oid FROM probability_subquery)
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
      AND oid IN (SELECT oid FROM object_subquery)
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
      AND oid IN (SELECT oid FROM object_subquery)
),
feature_subquery AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM object_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS r_delta_mag
FROM object_subquery o
INNER JOIN feature_subquery f ON o.oid = f.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",257.58671045303345,2025-05-19T11:47:45,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,8,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
feature_subquery AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND ndet >= 20
      AND (magmax_corr - magmin_corr) > 1
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND ndet >= 20
      AND (magmax_corr - magmin_corr) > 0.5
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    WHERE o.deltajd >= 365
      AND o.oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       (mg.magmax_corr - mg.magmin_corr) AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       (mr.magmax_corr - mr.magmin_corr) AS r_delta_mag
FROM object_filtered o
JOIN feature_subquery f ON o.oid = f.oid
JOIN magstat_g mg ON o.oid = mg.oid
JOIN magstat_r mr ON o.oid = mr.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,29.988709926605225,2025-04-29T11:57:34,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    WHERE o.deltajd >= 365
      AND o.oid IN (SELECT oid FROM probability_subquery)
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND ndet >= 20
      AND (magmax_corr - magmin_corr) > 1
      AND oid IN (SELECT oid FROM object_filtered)
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND ndet >= 20
      AND (magmax_corr - magmin_corr) > 0.5
      AND oid IN (SELECT oid FROM object_filtered)
),
feature_subquery AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM object_filtered)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       (mg.magmax_corr - mg.magmin_corr) AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       (mr.magmax_corr - mr.magmin_corr) AS r_delta_mag
FROM object_filtered o
JOIN feature_subquery f ON o.oid = f.oid
JOIN magstat_g mg ON o.oid = mg.oid
JOIN magstat_r mr ON o.oid = mr.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",270.779881477356,2025-05-19T11:52:23,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,9,"
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT oid
    FROM object
    WHERE deltajd >= 365
      AND ndet >= 20
),
magstat_g AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
),
magstat_r AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
),
filtered_oids AS (
    SELECT oid
    FROM probability_filtered
    INTERSECT
    SELECT oid
    FROM object_filtered
    INTERSECT
    SELECT oid
    FROM magstat_g
    INTERSECT
    SELECT oid
    FROM magstat_r
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr, mg.magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS delta_mag,
       mr.magmax_corr, mr.magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS delta_mag_r
FROM filtered_oids fo
JOIN object o ON fo.oid = o.oid
JOIN feature f ON fo.oid = f.oid
JOIN magstat mg ON fo.oid = mg.oid AND mg.fid = 1
JOIN magstat mr ON fo.oid = mr.oid AND mr.fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.95455765724182,2025-04-29T11:57:58,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT oid, meanra, meandec, ndet
    FROM object
    WHERE deltajd >= 365
      AND ndet >= 20
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, magmax_corr - magmin_corr AS delta_mag
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, magmax_corr - magmin_corr AS delta_mag_r
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
),
filtered_oids AS (
    SELECT pf.oid, o.meanra, o.meandec, o.ndet, mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr, mg.delta_mag AS g_delta_mag, 
           mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr, mr.delta_mag_r AS r_delta_mag
    FROM probability_filtered pf
    JOIN object_filtered o ON pf.oid = o.oid
    JOIN magstat_g mg ON pf.oid = mg.oid
    JOIN magstat_r mr ON pf.oid = mr.oid
)
SELECT fo.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       fo.meanra, fo.meandec, fo.ndet,
       fo.g_magmax_corr, fo.g_magmin_corr, fo.g_delta_mag,
       fo.r_magmax_corr, fo.r_magmin_corr, fo.r_delta_mag
FROM filtered_oids fo
JOIN feature f ON fo.oid = f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",262.7437243461609,2025-05-19T11:56:53,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,10,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_subquery AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
magstat_subquery AS (
    SELECT m.oid, 
           MAX(CASE WHEN m.fid = 1 THEN m.magmax_corr END) AS magmax_g,
           MIN(CASE WHEN m.fid = 1 THEN m.magmin_corr END) AS magmin_g,
           MAX(CASE WHEN m.fid = 2 THEN m.magmax_corr END) AS magmax_r,
           MIN(CASE WHEN m.fid = 2 THEN m.magmin_corr END) AS magmin_r
    FROM magstat m
    INNER JOIN object_subquery o ON m.oid = o.oid
    WHERE m.ndet >= 20
    GROUP BY m.oid
    HAVING (MAX(CASE WHEN m.fid = 1 THEN m.magmax_corr END) - MIN(CASE WHEN m.fid = 1 THEN m.magmin_corr END)) > 1
       AND (MAX(CASE WHEN m.fid = 2 THEN m.magmax_corr END) - MIN(CASE WHEN m.fid = 2 THEN m.magmin_corr END)) > 0.5
),
feature_subquery AS (
    SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       m.magmax_g, m.magmin_g, (m.magmax_g - m.magmin_g) AS delta_mag_g,
       m.magmax_r, m.magmin_r, (m.magmax_r - m.magmin_r) AS delta_mag_r
FROM object_subquery o
INNER JOIN magstat_subquery m ON o.oid = m.oid
INNER JOIN feature_subquery f ON o.oid = f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,29.711732149124146,2025-04-29T11:58:27,"[                  oid       value          name                version  \
0        ZTF17aabijgi   59.193479         gal_b  lc_classifier_1.2.1-P   
1        ZTF17aabijgi  197.129565         gal_l  lc_classifier_1.2.1-P   
2        ZTF17aabijgi   -0.277531       g-r_max  lc_classifier_1.2.1-P   
3        ZTF17aabijgi    0.323918      g-r_mean  lc_classifier_1.2.1-P   
4        ZTF17aabijgi    0.056372  g-r_max_corr  lc_classifier_1.2.1-P   
...               ...         ...           ...                    ...   
2399924  ZTF23abihzqw    2.119052    mean_chinr                 27.4.0   
2399925  ZTF23abihzqw  528.641739      Timespan                 27.4.0   
2399926  ZTF23abihzqw    0.633514  Coordinate_x                 27.4.0   
2399927  ZTF23abihzqw    0.748131  Coordinate_y                 27.4.0   
2399928  ZTF23abihzqw   -0.197382  Coordinate_z                 27.4.0   

         feature_fid      meanra    meandec  ndet   magmax_g   magmin_g  \
0                  0  157.746229  31.048823   430  17.796800  16.126352   
1                  0  157.746229  31.048823   430  17.796800  16.126352   
2                 12  157.746229  31.048823   430  17.796800  16.126352   
3                 12  157.746229  31.048823   430  17.796800  16.126352   
4                 12  157.746229  31.048823   430  17.796800  16.126352   
...              ...         ...        ...   ...        ...        ...   
2399924           12   49.742215 -11.383920   112  19.801842  18.482588   
2399925            0   49.742215 -11.383920   112  19.801842  18.482588   
2399926            0   49.742215 -11.383920   112  19.801842  18.482588   
2399927            0   49.742215 -11.383920   112  19.801842  18.482588   
2399928            0   49.742215 -11.383920   112  19.801842  18.482588   

         delta_mag_g   magmax_r   magmin_r  delta_mag_r  
0           1.670448  17.206097  16.069980     1.136116  
1           1.670448  17.206097  16.069980     1.136116  
2           1.670448  17.206097  16.069980     1.136116  
3           1.670448  17.206097  16.069980     1.136116  
4           1.670448  17.206097  16.069980     1.136116  
...              ...        ...        ...          ...  
2399924     1.319254  18.933052  18.248608     0.684444  
2399925     1.319254  18.933052  18.248608     0.684444  
2399926     1.319254  18.933052  18.248608     0.684444  
2399927     1.319254  18.933052  18.248608     0.684444  
2399928     1.319254  18.933052  18.248608     0.684444  

[2399929 rows x 14 columns]]",,271.1386754512787,2025-05-19T12:01:30,135.71266968325793,9.166937855244883e-05,0.6666666666666666,0.5714285714285714,0.0,0.0
0.16.3,,,16,0,"SELECT
    sq.oid, sq.probability, sq.diffmaglim, sq.fid, sq.mjd,
    magstat.fid as magstat_fid, magstat.dmdt_first
FROM
  (
SELECT
   non_detection.fid, non_detection.diffmaglim, non_detection.mjd, obj_oids.oid, obj_oids.probability
FROM
  (
SELECT
    object.oid, probability.probability
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='stamp_classifier'
    AND probability.class_name='SN'
    AND probability.ranking=1
    AND object.firstmjd > 60188.0
    AND object.firstmjd < 60189.0
) as obj_oids
    INNER JOIN
    non_detection ON non_detection.oid = obj_oids.oid
) AS sq
  INNER JOIN magstat
  ON sq.oid = magstat.oid
WHERE
  magstat.dmdt_first < -0.25
ORDER BY oid
LIMIT 100",,,,,"[             oid  probability  diffmaglim  fid           mjd  magstat_fid  \
0   ZTF18aaiaclp     0.520409     20.4159    1  60161.201343            2   
1   ZTF18aaiaclp     0.520409     20.5201    1  60161.206146            2   
2   ZTF18aaiaclp     0.520409     19.7568    1  60161.283750            2   
3   ZTF18aaiaclp     0.520409     19.5815    1  60163.299884            2   
4   ZTF18aaiaclp     0.520409     19.7775    1  60163.300359            2   
..           ...          ...         ...  ...           ...          ...   
95  ZTF18aaleydm     0.613368     16.7941    2  60158.233981            2   
96  ZTF18aaleydm     0.613368     19.9087    2  60161.343796            2   
97  ZTF18aaleydm     0.613368     20.2772    2  60163.288322            2   
98  ZTF18aaleydm     0.613368     20.6824    2  60165.215347            2   
99  ZTF18aaleydm     0.613368     20.2314    2  60169.290069            2   

    dmdt_first  
0    -0.445361  
1    -0.445361  
2    -0.445361  
3    -0.445361  
4    -0.445361  
..         ...  
95   -0.830610  
96   -0.830610  
97   -0.830610  
98   -0.830610  
99   -0.830610  

[100 rows x 7 columns]]",,8.280636072158813,2025-05-19T12:01:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,16,1,"
WITH ProbSubquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN detection d ON o.oid = d.oid
    WHERE o.firstmjd BETWEEN 59835 AND 59836  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.dmdt_first, m.fid AS magstat_fid
    FROM magstat m
    WHERE m.dmdt_first IS NOT NULL
),
CombinedSubquery AS (
    SELECT p.oid, o.firstmjd, m.dmdt_first, m.magstat_fid
    FROM ProbSubquery p
    INNER JOIN ObjectSubquery o ON p.oid = o.oid
    INNER JOIN FastRisersSubquery m ON p.oid = m.oid
),
FinalResult AS (
    SELECT c.oid, prob.probability, nd.fid, d.diffmaglim, c.magstat_fid, c.dmdt_first
    FROM CombinedSubquery c
    INNER JOIN probability prob ON c.oid = prob.oid
    INNER JOIN non_detection nd ON c.oid = nd.oid
    INNER JOIN detection d ON c.oid = d.oid
    WHERE prob.classifier_name = 'stamp_classifier'
    ORDER BY c.oid
    LIMIT 100
)
SELECT * FROM FinalResult
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.557520151138306,2025-04-29T11:58:50,"[             oid  probability  fid  diffmaglim  magstat_fid  dmdt_first
0   ZTF18adhqsgr     0.182704    1   18.866247            2   -0.331652
1   ZTF18adhqsgr     0.050225    1   18.866247            2   -0.331652
2   ZTF18adhqsgr     0.219864    1   18.866247            2   -0.331652
3   ZTF18adhqsgr     0.371183    1   18.866247            2   -0.331652
4   ZTF18adhqsgr     0.176023    1   18.866247            2   -0.331652
..           ...          ...  ...         ...          ...         ...
95  ZTF18adldnpk     0.153064    1   19.132053            1   -0.558708
96  ZTF18adldnpk     0.058398    1   19.132053            1   -0.558708
97  ZTF18adldnpk     0.203851    1   19.132053            1   -0.558708
98  ZTF18adldnpk     0.356635    1   19.132053            1   -0.558708
99  ZTF18adldnpk     0.228051    1   19.132053            1   -0.558708

[100 rows x 6 columns]]",,142.79166221618652,2025-05-19T12:04:11,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,2,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND ranking = 1
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 59832 AND 59834  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.dmdt_first, m.fid AS magstat_fid
    FROM magstat m
    INNER JOIN ObjectSubquery os ON m.oid = os.oid
    WHERE m.dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
DetectionSubquery AS (
    SELECT d.oid, d.fid, d.diffmaglim, d.mjd
    FROM detection d
    INNER JOIN FastRisersSubquery fr ON d.oid = fr.oid
),
NonDetectionSubquery AS (
    SELECT nd.oid, nd.fid, nd.diffmaglim, nd.mjd
    FROM non_detection nd
    INNER JOIN FastRisersSubquery fr ON nd.oid = fr.oid
),
CombinedLightCurves AS (
    SELECT oid, fid, diffmaglim, mjd FROM DetectionSubquery
    UNION
    SELECT oid, fid, diffmaglim, mjd FROM NonDetectionSubquery
)
SELECT fr.oid, p.probability, clc.fid, clc.diffmaglim, clc.mjd, fr.magstat_fid, fr.dmdt_first
FROM FastRisersSubquery fr
INNER JOIN ProbSubquery p ON fr.oid = p.oid
INNER JOIN CombinedLightCurves clc ON fr.oid = clc.oid
ORDER BY fr.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.131828546524048,2025-04-29T11:59:13,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND ranking = 1
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 60154 AND 60156  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.dmdt_first, m.fid AS magstat_fid
    FROM magstat m
    INNER JOIN ObjectSubquery os ON m.oid = os.oid
    WHERE m.dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
NonDetectionSubquery AS (
    SELECT nd.oid, nd.fid, nd.diffmaglim, nd.mjd
    FROM non_detection nd
    INNER JOIN FastRisersSubquery fr ON nd.oid = fr.oid
),
CombinedLightCurves AS (
    SELECT oid, fid, diffmaglim, mjd FROM NonDetectionSubquery
)
SELECT fr.oid, p.probability, clc.fid, clc.diffmaglim, clc.mjd, fr.magstat_fid, fr.dmdt_first
FROM FastRisersSubquery fr
INNER JOIN ProbSubquery p ON fr.oid = p.oid
INNER JOIN CombinedLightCurves clc ON fr.oid = clc.oid
ORDER BY fr.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.82581758499146,2025-05-19T12:06:26,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,16,3,"
WITH highest_probability_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Julian dates for the first 2 days of September 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL
),
combined_conditions AS (
    SELECT hp.oid, hp.probability, fd.magstat_fid, fd.dmdt_first
    FROM highest_probability_sn hp
    INNER JOIN first_detection_september fs ON hp.oid = fs.oid
    INNER JOIN fast_risers fd ON hp.oid = fd.oid
),
final_selection AS (
    SELECT c.oid, c.probability, d.fid, d.diffmaglim, nd.fid AS non_detection_fid, nd.diffmaglim AS non_detection_diffmaglim, c.magstat_fid, c.dmdt_first
    FROM combined_conditions c
    INNER JOIN detection d ON c.oid = d.oid
    INNER JOIN non_detection nd ON c.oid = nd.oid
)
SELECT *
FROM final_selection
ORDER BY oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.38938474655152,2025-04-29T11:59:34,"[             oid  probability  non_detection_fid  non_detection_diffmaglim  \
0   ZTF18aajcwgf     0.315702                  1                   20.2607   
1   ZTF18aajcwgf     0.315702                  1                   20.5953   
2   ZTF18aajcwgf     0.315702                  1                   20.4298   
3   ZTF18aajcwgf     0.315702                  1                   20.0434   
4   ZTF18aajcwgf     0.315702                  1                   19.8642   
..           ...          ...                ...                       ...   
95  ZTF18aanouik     0.433912                  2                   19.8725   
96  ZTF18aanouik     0.433912                  2                   19.7880   
97  ZTF18aanouik     0.433912                  2                   20.0758   
98  ZTF18aanouik     0.433912                  2                   20.1588   
99  ZTF18aanouik     0.433912                  2                   19.7164   

    magstat_fid  dmdt_first  
0             2   -0.000162  
1             2   -0.000162  
2             2   -0.000162  
3             2   -0.000162  
4             2   -0.000162  
..          ...         ...  
95            2   -0.149276  
96            2   -0.149276  
97            2   -0.149276  
98            2   -0.149276  
99            2   -0.149276  

[100 rows x 6 columns]]",,11.796743154525757,2025-05-19T12:06:42,0.0,0.0,0.5714285714285714,0.6666666666666666,0.0,0.0
0.16.3,gpt-4o,v1,16,4,"
WITH highest_prob_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1, 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming a non-null dmdt_first indicates a fast riser
),
light_curves AS (
    SELECT oid, fid, mjd, diffmaglim
    FROM detection
    UNION
    SELECT oid, fid, mjd, diffmaglim
    FROM non_detection
)
SELECT o.oid, hp.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM highest_prob_sn hp
INNER JOIN first_detection_september fd ON hp.oid = fd.oid
INNER JOIN fast_risers fr ON hp.oid = fr.oid
INNER JOIN light_curves lc ON hp.oid = lc.oid
ORDER BY o.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,18.717886209487915,2025-04-29T11:59:52,"[             oid  probability  fid  diffmaglim  magstat_fid  dmdt_first
0   ZTF17aablcym     0.346393    2     19.5153            2   -0.684187
1   ZTF17aablcym     0.346393    2     19.4186            2   -0.684187
2   ZTF17aablcym     0.346393    2     19.5014            2   -0.684187
3   ZTF17aablcym     0.346393    2     19.3641            2   -0.684187
4   ZTF17aablcym     0.346393    2     19.2112            2   -0.684187
..           ...          ...  ...         ...          ...         ...
95  ZTF18aacstrz     0.849426    2     20.3577            2   -0.437475
96  ZTF18aacstrz     0.849426    2     20.3427            2   -0.437475
97  ZTF18aacstrz     0.849426    2     20.3031            2   -0.437475
98  ZTF18aacstrz     0.849426    2     19.8559            2   -0.437475
99  ZTF18aacstrz     0.849426    2     19.5992            2   -0.437475

[100 rows x 6 columns]]",,11.446389198303224,2025-05-19T12:06:57,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,5,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND ranking = 1
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 59832 AND 59833  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first
    FROM magstat m
    INNER JOIN ObjectSubquery os ON m.oid = os.oid
    WHERE m.dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
LightCurvesSubquery AS (
    SELECT d.oid, d.fid, d.diffmaglim, d.mjd
    FROM detection d
    INNER JOIN ObjectSubquery os ON d.oid = os.oid
    UNION
    SELECT nd.oid, nd.fid, nd.diffmaglim, nd.mjd
    FROM non_detection nd
    INNER JOIN ObjectSubquery os ON nd.oid = os.oid
)
SELECT os.oid, p.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM ObjectSubquery os
INNER JOIN ProbSubquery p ON os.oid = p.oid
INNER JOIN FastRisersSubquery fr ON os.oid = fr.oid
INNER JOIN LightCurvesSubquery lc ON os.oid = lc.oid
ORDER BY os.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,30.14790153503418,2025-04-29T12:00:23,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND ranking = 1
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 60215 AND 60216  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first
    FROM magstat m
    INNER JOIN ObjectSubquery os ON m.oid = os.oid
    WHERE m.dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
LightCurvesSubquery AS (
    SELECT d.oid, d.fid, d.diffmaglim, d.mjd
    FROM detection d
    INNER JOIN ObjectSubquery os ON d.oid = os.oid
    UNION
    SELECT nd.oid, nd.fid, nd.diffmaglim, nd.mjd
    FROM non_detection nd
    INNER JOIN ObjectSubquery os ON nd.oid = os.oid
)
SELECT os.oid, p.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM ObjectSubquery os
INNER JOIN ProbSubquery p ON os.oid = p.oid
INNER JOIN FastRisersSubquery fr ON os.oid = fr.oid
INNER JOIN LightCurvesSubquery lc ON os.oid = lc.oid
ORDER BY os.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.09101176261902,2025-05-19T12:09:11,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,16,6,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 59832 AND 59833  -- First 2 days of September 2023
),
MagstatSubquery AS (
    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first
    FROM magstat m
    INNER JOIN ObjectSubquery o ON m.oid = o.oid
    WHERE m.dmdt_first IS NOT NULL  -- Qualify as fast risers
),
FinalQuery AS (
    SELECT o.oid, p.probability, d.fid, d.diffmaglim, m.magstat_fid, m.dmdt_first
    FROM ObjectSubquery o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    LEFT JOIN detection d ON o.oid = d.oid
    LEFT JOIN non_detection nd ON o.oid = nd.oid
    INNER JOIN MagstatSubquery m ON o.oid = m.oid
    ORDER BY o.oid
    LIMIT 100
)
SELECT * FROM FinalQuery
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,27.73988914489746,2025-04-29T12:00:50,"[Empty DataFrame
Columns: [oid, probability, fid, diffmaglim, magstat_fid, dmdt_first]
Index: []]",,134.08136248588562,2025-05-19T12:11:29,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,7,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
),
ObjectSubquery AS (
    SELECT oid
    FROM object
    WHERE firstmjd >= 59800 AND firstmjd < 59802  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
DetectionSubquery AS (
    SELECT oid, fid, diffmaglim
    FROM detection
),
NonDetectionSubquery AS (
    SELECT oid, fid, diffmaglim
    FROM non_detection
)
SELECT o.oid, p.probability, COALESCE(d.fid, nd.fid) AS fid, COALESCE(d.diffmaglim, nd.diffmaglim) AS diffmaglim, 
       fr.magstat_fid, fr.dmdt_first
FROM ProbSubquery p
INNER JOIN ObjectSubquery o ON p.oid = o.oid
INNER JOIN FastRisersSubquery fr ON o.oid = fr.oid
LEFT JOIN DetectionSubquery d ON o.oid = d.oid
LEFT JOIN NonDetectionSubquery nd ON o.oid = nd.oid
ORDER BY o.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.837432861328125,2025-04-29T12:01:15,"[             oid  probability  fid  diffmaglim  magstat_fid  dmdt_first
0   ZTF18adhqsgr     0.371183    1     19.9850            2   -0.331652
1   ZTF18adhqsgr     0.371183    1     20.2589            2   -0.331652
2   ZTF18adhqsgr     0.371183    1     20.0762            2   -0.331652
3   ZTF18adhqsgr     0.371183    1     20.5440            2   -0.331652
4   ZTF18adhqsgr     0.371183    1     20.4704            2   -0.331652
..           ...          ...  ...         ...          ...         ...
95  ZTF18adldnpk     0.356635    2     20.8644            2   -1.305204
96  ZTF18adldnpk     0.356635    2     20.6728            2   -1.305204
97  ZTF18adldnpk     0.356635    2     20.2712            2   -1.305204
98  ZTF18adnnxlp     0.324971    1     19.8375            1   -2.316015
99  ZTF18adnnxlp     0.324971    1     18.3563            1   -2.316015

[100 rows x 6 columns]]",,46.39285469055176,2025-05-19T12:12:19,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,8,"
WITH stamp_classifier_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1, 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming non-null dmdt_first indicates fast risers
),
combined_criteria AS (
    SELECT sc.oid, sc.probability, fr.magstat_fid, fr.dmdt_first
    FROM stamp_classifier_sn sc
    INNER JOIN first_detection_september fd ON sc.oid = fd.oid
    INNER JOIN fast_risers fr ON sc.oid = fr.oid
),
light_curves AS (
    SELECT d.oid, d.fid, d.diffmaglim
    FROM detection d
    INNER JOIN combined_criteria cc ON d.oid = cc.oid
),
non_detections AS (
    SELECT nd.oid, nd.fid, nd.diffmaglim
    FROM non_detection nd
    INNER JOIN combined_criteria cc ON nd.oid = cc.oid
)
SELECT cc.oid, cc.probability, lc.fid, lc.diffmaglim, cc.magstat_fid, cc.dmdt_first
FROM combined_criteria cc
JOIN light_curves lc ON cc.oid = lc.oid
UNION
SELECT cc.oid, cc.probability, nd.fid, nd.diffmaglim, cc.magstat_fid, cc.dmdt_first
FROM combined_criteria cc
JOIN non_detections nd ON cc.oid = nd.oid
ORDER BY oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.401865005493164,2025-04-29T12:01:38,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH stamp_classifier_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 60154 AND 60156  -- Corrected MJD for September 1, 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming non-null dmdt_first indicates fast risers
),
combined_criteria AS (
    SELECT sc.oid, sc.probability, fr.magstat_fid, fr.dmdt_first
    FROM stamp_classifier_sn sc
    INNER JOIN first_detection_september fd ON sc.oid = fd.oid
    INNER JOIN fast_risers fr ON sc.oid = fr.oid
),
non_detections AS (
    SELECT nd.oid, nd.fid, nd.diffmaglim
    FROM non_detection nd
    INNER JOIN combined_criteria cc ON nd.oid = cc.oid
)
SELECT cc.oid, cc.probability, nd.fid, nd.diffmaglim, cc.magstat_fid, cc.dmdt_first
FROM combined_criteria cc
JOIN non_detections nd ON cc.oid = nd.oid
ORDER BY cc.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.6486706733704,2025-05-19T12:16:36,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,16,9,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
),
ObjectSubquery AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1st, 2023
),
MagstatSubquery AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first > 0  -- Assuming positive dmdt_first indicates fast risers
),
DetectionSubquery AS (
    SELECT oid, fid, diffmaglim
    FROM detection
),
NonDetectionSubquery AS (
    SELECT oid, fid, diffmaglim
    FROM non_detection
)
SELECT o.oid, p.probability, d.fid, d.diffmaglim, m.magstat_fid, m.dmdt_first
FROM ProbSubquery p
INNER JOIN ObjectSubquery o ON p.oid = o.oid
INNER JOIN MagstatSubquery m ON o.oid = m.oid
LEFT JOIN DetectionSubquery d ON o.oid = d.oid
LEFT JOIN NonDetectionSubquery nd ON o.oid = nd.oid
ORDER BY o.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.54674077033997,2025-04-29T12:02:00,"[             oid  probability  fid  diffmaglim  magstat_fid  dmdt_first
0   ZTF19abefque     0.420330    1     19.8350            2    0.008969
1   ZTF19abefque     0.420330    1     19.8697            2    0.008969
2   ZTF19abefque     0.420330    1     20.2178            2    0.008969
3   ZTF19abefque     0.420330    1     19.8693            2    0.008969
4   ZTF19abefque     0.420330    1     19.8071            2    0.008969
..           ...          ...  ...         ...          ...         ...
95  ZTF21abredlz     0.536512    1     17.4591            1    0.307330
96  ZTF21abredlz     0.536512    1     20.6325            1    0.307330
97  ZTF21abredlz     0.536512    1     20.5029            1    0.307330
98  ZTF21abredlz     0.536512    1     19.2707            1    0.307330
99  ZTF21abredlz     0.536512    1     19.2297            1    0.307330

[100 rows x 6 columns]]",,82.4538905620575,2025-05-19T12:18:03,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,10,"
WITH highest_prob_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1, 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming a non-null dmdt_first indicates a fast riser
),
light_curves AS (
    SELECT oid, fid, diffmaglim
    FROM non_detection
    WHERE oid IN (SELECT oid FROM highest_prob_sn)
)
SELECT o.oid, hp.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM highest_prob_sn hp
INNER JOIN first_detection_september fd ON hp.oid = fd.oid
INNER JOIN fast_risers fr ON hp.oid = fr.oid
INNER JOIN light_curves lc ON hp.oid = lc.oid
ORDER BY o.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.89166045188904,2025-04-29T12:02:23,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH highest_prob_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1, 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming a non-null dmdt_first indicates a fast riser
),
light_curves AS (
    SELECT oid, fid, diffmaglim
    FROM non_detection
    WHERE oid IN (SELECT oid FROM highest_prob_sn)
)
SELECT hp.oid, hp.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM highest_prob_sn hp
INNER JOIN first_detection_september fd ON hp.oid = fd.oid
INNER JOIN fast_risers fr ON hp.oid = fr.oid
INNER JOIN light_curves lc ON hp.oid = lc.oid
ORDER BY hp.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.72086262702942,2025-05-19T12:20:17,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,19,0,"SELECT
    object.oid, object.meanra, object.meandec, object.ndet, object.firstmjd,
    probability.class_name, probability.probability
FROM object
INNER JOIN probability
ON object.oid=probability.oid

WHERE
object.firstMJD > 59274.0
AND object.firstMJD < 59305.0
AND object.ndet=1
AND probability.classifier_name='stamp_classifier'
AND probability.ranking=1
AND probability.class_name='asteroid'
AND probability.probability>0.7",,,,,"[                 oid      meanra    meandec  ndet      firstmjd class_name  \
0       ZTF21aanqyov   97.684361  28.217606     1  59274.256574   asteroid   
1       ZTF21aanqjqc   84.403597  10.469394     1  59274.147813   asteroid   
2       ZTF21aanqpxc  157.088644  15.424231     1  59274.212454   asteroid   
3       ZTF21aanqpwg  156.660014  10.679691     1  59274.212454   asteroid   
4       ZTF21aanqpyv  154.226348  12.072717     1  59274.212454   asteroid   
...              ...         ...        ...   ...           ...        ...   
106745  ZTF21aarfnks  266.139917 -15.875644     1  59304.501123   asteroid   
106746  ZTF21aarfnii  277.897321 -13.554262     1  59304.501597   asteroid   
106747  ZTF21aarfngu  283.121650 -13.887437     1  59304.502072   asteroid   
106748  ZTF21aarfnpk  284.087880 -19.583865     1  59304.502072   asteroid   
106749  ZTF21aarfnqs  284.630585 -19.152846     1  59304.502072   asteroid   

        probability  
0          0.760704  
1          0.725208  
2          0.728637  
3          0.700072  
4          0.710321  
...             ...  
106745     1.000000  
106746     1.000000  
106747     1.000000  
106748     1.000000  
106749     1.000000  

[106750 rows x 7 columns]]",,34.30215239524841,2025-05-19T12:20:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,19,1,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59265 AND 59301  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1  -- Ensures only the most likely class is considered
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,29.277488231658936,2025-04-29T12:02:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combine the steps into a single optimized query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE class_name = 'asteroid'
       AND classifier_name = 'stamp_classifier'
       AND probability > 0.7
       AND ranking = 1) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59265 AND 59301  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.90223836898804,2025-05-19T12:25:14,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,2,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,29.50137519836425,2025-04-29T12:03:22,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Step 1: Create a sub-query to filter the probability table with the necessary conditions
WITH filtered_probability AS (
    SELECT oid, class_name, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability > 0.7
      AND ranking = 1
)

-- Step 2: Join the filtered probability results with the object table
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    fp.class_name, 
    fp.probability
FROM 
    object o
INNER JOIN 
    filtered_probability fp ON o.oid = fp.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.9240880012512,2025-05-19T12:29:37,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,3,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.97780704498291,2025-04-29T12:03:39,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combine the steps to form the final optimized query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE ranking = 1
       AND classifier_name = 'stamp_classifier'
       AND class_name = 'asteroid'
       AND probability > 0.7) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",265.76144576072693,2025-05-19T12:34:10,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,4,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1  -- Only the most likely classification
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,19.50720500946045,2025-04-29T12:03:59,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter the probability table first to reduce the dataset size
WITH filtered_probability AS (
    SELECT oid, class_name, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability > 0.7
      AND ranking = 1
)

-- Main query using the filtered probability data
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    fp.class_name, 
    fp.probability
FROM 
    object o
INNER JOIN 
    filtered_probability fp ON o.oid = fp.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.7275013923645,2025-05-19T12:38:43,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,5,"
-- Query to retrieve objects that appeared between March 1st and April 1st, 2021,
-- have at most one detection, and are classified as asteroids by the stamp classifier
-- with a probability greater than 0.7.

SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319 -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1 -- Only consider the most likely classification
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,21.61373972892761,2025-04-29T12:04:20,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final optimized query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE class_name = 'asteroid'
       AND classifier_name = 'stamp_classifier'
       AND probability > 0.7
       AND ranking = 1) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319 -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",255.5814700126648,2025-05-19T12:43:11,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,6,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.probability > 0.7
    AND p.ranking = 1
    AND p.classifier_name = 'stamp_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,21.49788808822632,2025-04-29T12:04:42,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combine the steps into a single query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE ranking = 1
       AND classifier_name = 'stamp_classifier'
       AND class_name = 'asteroid'
       AND probability > 0.7) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.0515480041504,2025-05-19T12:47:32,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,7,"
-- Query to retrieve objects that appeared between March 1st and April 1st of 2021,
-- have at most one detection, and are classified as asteroids by the stamp classifier
-- with a probability greater than 0.7.

SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319 -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1 -- Default condition for probability table
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.84388256072998,2025-04-29T12:04:59,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Join the filtered results from both tables
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    (SELECT oid, meanra, meandec, ndet, firstmjd
     FROM object
     WHERE firstmjd BETWEEN 59288 AND 59319
       AND ndet <= 1) o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE class_name = 'asteroid'
       AND classifier_name = 'stamp_classifier'
       AND probability > 0.7
       AND ranking = 1) p ON o.oid = p.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.65718054771423,2025-05-19T12:51:54,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,8,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59265 AND 59301  -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1  -- Ensures only the most likely class is considered
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,33.252878189086914,2025-04-29T12:05:32,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE class_name = 'asteroid'
       AND classifier_name = 'stamp_classifier'
       AND probability > 0.7
       AND ranking = 1) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59265 AND 59301  -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.790265083313,2025-05-19T12:56:23,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,9,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,14.880460739135742,2025-04-29T12:05:47,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Step 1: Create a sub-query to filter the probability table with the necessary conditions
WITH filtered_probability AS (
    SELECT oid, class_name, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability > 0.7
      AND ranking = 1
)

-- Step 2: Join the filtered probability results with the object table
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    fp.class_name, 
    fp.probability
FROM 
    object o
INNER JOIN 
    filtered_probability fp ON o.oid = fp.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.58263969421387,2025-05-19T13:00:43,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,10,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1  -- Only consider the most likely classifications
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.352998971939087,2025-04-29T12:06:03,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Step 1: Filter the probability table to get only the relevant classifications
WITH filtered_probability AS (
    SELECT oid, class_name, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability > 0.7
      AND ranking = 1
)

-- Step 2: Join the filtered probability with the object table
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    fp.class_name, 
    fp.probability
FROM 
    object o
INNER JOIN 
    filtered_probability fp ON o.oid = fp.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.92501091957087,2025-05-19T13:05:08,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,14,0,"
SELECT
    det.oid, det.candid,
    det.drb, det.fid,
    det.mjd, det.magpsf, det.sigmapsf,
    det.has_stamp,
    ps1.sgscore1, ps1.distpsnr1
FROM
    (SELECT *
    FROM detection
    WHERE oid in ('ZTF23aavzgjg','ZTF23aaynzyk','ZTF23aavqxos','ZTF23aaknyni','ZTF23aavsdtc','ZTF18aandkua','ZTF23aaxfewt','ZTF23aavshwi','ZTF22aawasao','ZTF23aaxgvnt')
    ) as det
    INNER JOIN
    (SELECT *
    FROM ps1_ztf
    WHERE oid in ('ZTF23aavzgjg','ZTF23aaynzyk','ZTF23aavqxos','ZTF23aaknyni','ZTF23aavsdtc','ZTF18aandkua','ZTF23aaxfewt','ZTF23aavshwi','ZTF22aawasao','ZTF23aaxgvnt')
    ) as ps1
    ON det.oid=ps1.oid
WHERE
     (ps1.sgscore1 < 0.5 OR ps1.distpsnr1 > 1)
    AND det.drb > 0.5
",,,,,"[              oid               candid       drb  fid           mjd  \
0    ZTF18aandkua  2434183903015015056  0.994159    1  60188.183901   
1    ZTF18aandkua  2756269351915010002  0.993011    2  60510.269352   
2    ZTF18aandkua  2772265531915010009  0.850113    2  60526.265532   
3    ZTF18aandkua  2979404491915010015  0.696538    1  60733.404491   
4    ZTF18aandkua  2434183903015015056  0.994159    1  60188.183901   
..            ...                  ...       ...  ...           ...   
168  ZTF23aavzgjg  2440173344115015014  0.999983    2  60194.173345   
169  ZTF23aavzgjg  2442207534115015008  0.998886    2  60196.207535   
170  ZTF23aaxfewt  2415290061315015127  0.999312    2  60169.290069   
171  ZTF23aaxgvnt  2415360251315015012  0.866198    1  60169.360255   
172  ZTF23aaynzyk  2419492286015015010  0.999918    2  60173.492280   

        magpsf  sigmapsf  has_stamp  sgscore1  distpsnr1  
0    17.907194  0.180156       True  0.075167   0.326697  
1    19.379133  0.161114       True  0.075167   0.326697  
2    19.641638  0.183068       True  0.075167   0.326697  
3    18.887863  0.175351       True  0.075167   0.326697  
4    17.907194  0.180156       True  0.075167   1.234589  
..         ...       ...        ...       ...        ...  
168  19.315939  0.112186       True  0.500000   8.032105  
169  19.268260  0.174212       True  0.500000   8.032105  
170  18.205078  0.063636       True  0.134304   0.635949  
171  19.366661  0.139281       True  0.987083   1.361963  
172  20.241919  0.203988       True  0.500000   1.575583  

[173 rows x 10 columns]]",,3.857642650604248,2025-05-19T13:05:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,14,1,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
                      'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
                      'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
ORDER BY 
    detection.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.79786443710327,2025-04-29T12:06:24,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,13.29354166984558,2025-05-19T13:05:30,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,2,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,26.72788381576538,2025-04-29T12:06:51,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,12.71803617477417,2025-05-19T13:05:47,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,3,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.magpsf, 
    d.sigmapsf, 
    d.has_stamp, 
    d.drb, 
    p.sgscore1, 
    p.distpsnr1
FROM 
    detection d
INNER JOIN 
    ps1_ztf p ON d.oid = p.oid
WHERE 
    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND d.drb > 0.5
    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,24.335001468658447,2025-04-29T12:07:15,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,10.905076026916504,2025-05-19T13:06:02,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,4,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,24.67517113685608,2025-04-29T12:07:40,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,15.793599843978882,2025-05-19T13:06:22,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,5,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.magpsf, 
    d.sigmapsf, 
    d.has_stamp, 
    d.drb, 
    p.sgscore1, 
    p.distpsnr1
FROM 
    detection d
INNER JOIN 
    ps1_ztf p ON d.oid = p.oid
WHERE 
    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND d.drb > 0.5
    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,17.367687225341797,2025-04-29T12:07:57,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,11.11276650428772,2025-05-19T13:06:37,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,6,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
                      'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
                      'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,23.89245104789734,2025-04-29T12:08:21,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,12.26848840713501,2025-05-19T13:06:53,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,7,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
                      'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
                      'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.434401988983154,2025-04-29T12:08:42,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,16.0296528339386,2025-05-19T13:07:14,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,8,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.magpsf, 
    d.sigmapsf, 
    d.has_stamp, 
    d.drb, 
    p.sgscore1, 
    p.distpsnr1
FROM 
    detection d
INNER JOIN 
    ps1_ztf p ON d.oid = p.oid
WHERE 
    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND d.drb > 0.5
    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)
ORDER BY 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,25.146191596984863,2025-04-29T12:09:07,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,9.820582389831545,2025-05-19T13:07:28,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,9,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
ORDER BY 
    detection.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.004069328308105,2025-04-29T12:09:27,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,13.943351745605469,2025-05-19T13:07:45,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,10,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
ORDER BY 
    detection.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.435705423355103,2025-04-29T12:09:47,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,10.80619502067566,2025-05-19T13:08:01,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,,,30,0,"
select oid, class_name, probability from probability where classifier_name = 'lc_classifier' and ranking = 1;
",,,,,"[                  oid      class_name  probability
0        ZTF19aafofil  Periodic-Other     0.229680
1        ZTF19aafofbw               E     0.483736
2        ZTF18abrqhnl  Periodic-Other     0.556488
3        ZTF19aafofih               E     0.399152
4        ZTF18abwbpny             RRL     0.217056
...               ...             ...          ...
3879860  ZTF19aafofam             LPV     0.469744
3879861  ZTF18accxbpt             LPV     0.414960
3879862  ZTF19aafoexp             LPV     0.619788
3879863  ZTF19abrgubq               E     0.362976
3879864  ZTF19aafoexn             LPV     0.571152

[3879865 rows x 3 columns]]",,39.43916821479797,2025-05-19T13:08:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,1,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.6449902057647705,2025-04-29T12:09:51,"[                  oid      class_name  probability
0        ZTF19aafofil  Periodic-Other     0.229680
1        ZTF19aafofjr             LPV     0.263520
2        ZTF19aafofju             LPV     0.276552
3        ZTF17aabodew             CEP     0.252948
4        ZTF19aadvcrv             LPV     0.267300
...               ...             ...          ...
3879860  ZTF19aafofam             LPV     0.469744
3879861  ZTF18accxbpt             LPV     0.414960
3879862  ZTF19aafoexp             LPV     0.619788
3879863  ZTF19abrgubq               E     0.362976
3879864  ZTF19aafoexn             LPV     0.571152

[3879865 rows x 3 columns]]",,155.7501130104065,2025-05-19T13:12:25,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,2,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.2370994091033936,2025-04-29T12:09:55,"[                  oid      class_name  probability
0        ZTF19aafofil  Periodic-Other     0.229680
1        ZTF19aafofbw               E     0.483736
2        ZTF18abrqhnl  Periodic-Other     0.556488
3        ZTF19aafofih               E     0.399152
4        ZTF18abwbpny             RRL     0.217056
...               ...             ...          ...
3879860  ZTF19aafoexn             LPV     0.571152
3879861  ZTF17aaahtog             CEP     0.284160
3879862  ZTF19adnyuph             YSO     0.302328
3879863  ZTF21aagiijn  Periodic-Other     0.380640
3879864  ZTF19aaumeqp  Periodic-Other     0.646380

[3879865 rows x 3 columns]]",,115.2463240623474,2025-05-19T13:15:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,3,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.4529519081115723,2025-04-29T12:09:58,"[                  oid      class_name  probability
0        ZTF19aafofil  Periodic-Other     0.229680
1        ZTF19aafofbw               E     0.483736
2        ZTF18abrqhnl  Periodic-Other     0.556488
3        ZTF19aafofih               E     0.399152
4        ZTF18abwbpny             RRL     0.217056
...               ...             ...          ...
3879860  ZTF18accxbpt             LPV     0.414960
3879861  ZTF19aafoexp             LPV     0.619788
3879862  ZTF19abrgubq               E     0.362976
3879863  ZTF19aaumeqp  Periodic-Other     0.646380
3879864  ZTF19aafoexn             LPV     0.571152

[3879865 rows x 3 columns]]",,202.42685890197757,2025-05-19T13:20:37,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,4,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.823147773742676,2025-04-29T12:10:02,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",226.91998982429504,2025-05-19T13:26:22,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,30,5,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.7026286125183105,2025-04-29T12:10:05,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: This query uses a sub-query to filter the probability table first, then joins with the object table to optimize performance
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    object o
JOIN 
    (SELECT 
        oid, 
        class_name, 
        probability
     FROM 
        probability
     WHERE 
        ranking = 1 
        AND classifier_name = 'lc_classifier') p
ON 
    o.oid = p.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",256.1473362445832,2025-05-19T13:32:40,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,30,6,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,4.847445487976074,2025-04-29T12:10:10,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: This query uses a sub-query to filter the probability table first, then joins with the object table to optimize performance
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    object o
JOIN 
    (SELECT 
        oid, 
        class_name, 
        probability
     FROM 
        probability
     WHERE 
        ranking = 1 
        AND classifier_name = 'lc_classifier') p
ON 
    o.oid = p.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",256.5616292953491,2025-05-19T13:38:03,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,30,7,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.15111780166626,2025-04-29T12:10:13,"[                  oid      class_name  probability
0        ZTF18abmmeuy               E     0.275264
1        ZTF18abefyrh             LPV     0.574232
2        ZTF22aabbtji             YSO     0.330708
3        ZTF20abmdrvq             YSO     0.396800
4        ZTF21aabjnxk  Periodic-Other     0.394912
...               ...             ...          ...
3879860  ZTF18absrrwx             LPV     0.546816
3879861  ZTF18abihvbc             CEP     0.244900
3879862  ZTF19absiioi  Periodic-Other     0.298816
3879863  ZTF19aapqiel             LPV     0.381920
3879864  ZTF18abuwvgt             YSO     0.444880

[3879865 rows x 3 columns]]",,169.98053073883057,2025-05-19T13:41:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,8,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.731066942214966,2025-04-29T12:10:16,"[                  oid      class_name  probability
0        ZTF18acpcjqt  Periodic-Other     0.214320
1        ZTF22abbapen            SNIa     0.316848
2        ZTF18achbpre             YSO     0.264860
3        ZTF18abaccjy             YSO     0.253344
4        ZTF19abamoio  Periodic-Other     0.515352
...               ...             ...          ...
3879860  ZTF18abgvfqq             RRL     0.442736
3879861  ZTF19aawscwh  Periodic-Other     0.345040
3879862  ZTF18admdbcq             LPV     0.297220
3879863  ZTF20aclyjhs             YSO     0.512244
3879864  ZTF17aaabzhb               E     0.519552

[3879865 rows x 3 columns]]",,241.233327627182,2025-05-19T13:47:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,9,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.8162426948547363,2025-04-29T12:10:19,"[                  oid      class_name  probability
0        ZTF18acpcjqt  Periodic-Other     0.214320
1        ZTF22abbapen            SNIa     0.316848
2        ZTF18achbpre             YSO     0.264860
3        ZTF18abaccjy             YSO     0.253344
4        ZTF19abamoio  Periodic-Other     0.515352
...               ...             ...          ...
3879860  ZTF18aczvfvc             YSO     0.287184
3879861  ZTF18aacercn  Periodic-Other     0.453024
3879862  ZTF18abgvfqq             RRL     0.442736
3879863  ZTF19aawscwh  Periodic-Other     0.345040
3879864  ZTF18admdbcq             LPV     0.297220

[3879865 rows x 3 columns]]",,189.83420252799988,2025-05-19T13:53:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,10,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.055508613586426,2025-04-29T12:10:22,"[                  oid      class_name  probability
0        ZTF18acpcjqt  Periodic-Other     0.214320
1        ZTF22abbapen            SNIa     0.316848
2        ZTF18achbpre             YSO     0.264860
3        ZTF18abaccjy             YSO     0.253344
4        ZTF19abamoio  Periodic-Other     0.515352
...               ...             ...          ...
3879860  ZTF18abgvfqq             RRL     0.442736
3879861  ZTF19aawscwh  Periodic-Other     0.345040
3879862  ZTF18admdbcq             LPV     0.297220
3879863  ZTF18aabfgkh            DSCT     0.269384
3879864  ZTF18aczvfvc             YSO     0.287184

[3879865 rows x 3 columns]]",,160.77106308937073,2025-05-19T13:58:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,22,0,"
SELECT
    *
FROM
    object INNER JOIN (
    SELECT
        *
    FROM
        probability
    WHERE
        classifier_name='lc_classifier'
        AND ranking=1
    ) AS probability_oid
    ON object.oid=probability_oid.oid
WHERE
    probability_oid.classifier_name='lc_classifier'
    AND object.firstmjd BETWEEN 58239.0 AND 58270.0
",,,,,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aawlppv       908      1717  58105.160417  59630.538495   
1       ZTF18aajtlcd      1904      5180  58205.500278  60811.456192   
2       ZTF18aaimjyg       447      4628  58218.387095  60775.431019   
3       ZTF18aaueakr       619      3789  58244.431759  60811.400370   
4       ZTF18abacgio        92       460  58261.483102  59266.552072   
...              ...       ...       ...           ...           ...   
101025  ZTF18aakqxdt       931      2972  58210.293727  60814.286181   
101026  ZTF18aawcers       423      4231  58245.460185  60785.488704   
101027  ZTF18aaxymrv       386      2126  58218.497569  60786.443160   
101028  ZTF18aajlfiu      1513      2750  58208.351551  60705.529977   
101029  ZTF18aabesro       241      2906  58158.533403  60458.259306   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd  \
0            True     True   550  1.172323      1.562664  ...  58261.467812   
1            True    False   646       NaN           NaN  ...  58242.414109   
2            True    False   117       NaN           NaN  ...  58269.298079   
3            True    False   406       NaN           NaN  ...  58252.440405   
4            True     True    62  2.985790      2.832980  ...  58261.483102   
...           ...      ...   ...       ...           ...  ...           ...   
101025       True    False   298       NaN           NaN  ...  58248.247407   
101026       True    False   312       NaN           NaN  ...  58259.446007   
101027       True    False   192       NaN           NaN  ...  58257.457187   
101028       True    False   368       NaN           NaN  ...  58248.219225   
101029       True    False    79  1.259530      1.056960  ...  58242.240312   

             lastmjd      step_id_corr  diffpos  reference_change  \
0       59630.538495  correction_1.0.6    False              True   
1       60811.456192            27.5.6    False             False   
2       60775.431019            27.5.4     True             False   
3       60811.400370            27.5.6    False              True   
4       59266.552072  correction_0.0.1    False              True   
...              ...               ...      ...               ...   
101025  60814.286181            27.5.6     True              True   
101026  60785.488704            27.5.6    False              True   
101027  60786.443160            27.5.6    False             False   
101028  60705.529977            27.3.0     True             False   
101029  60458.259306            24.4.1    False             False   

        classifier_name     classifier_version      class_name  probability  \
0         lc_classifier  hierarchical_rf_1.1.0             CEP     0.323104   
1         lc_classifier  hierarchical_rf_1.1.0             RRL     0.658688   
2         lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.572600   
3         lc_classifier  hierarchical_rf_1.1.0               E     0.496008   
4         lc_classifier  hierarchical_rf_1.1.0             LPV     0.609024   
...                 ...                    ...             ...          ...   
101025    lc_classifier  hierarchical_rf_1.1.0               E     0.356680   
101026    lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.600096   
101027    lc_classifier  hierarchical_rf_1.1.0             LPV     0.746700   
101028    lc_classifier  hierarchical_rf_1.1.0             RRL     0.385152   
101029    lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.717288   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
101025       1  
101026       1  
101027       1  
101028       1  
101029       1  

[101030 rows x 27 columns]]",,18.51029849052429,2025-05-19T13:59:25,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,22,1,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd BETWEEN 58262.0 AND 58292.0
AND probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.941379308700561,2025-04-29T12:10:25,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd BETWEEN 58262.0 AND 58292.0
AND probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",173.74449706077576,2025-05-19T14:03:19,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,22,2,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND object.firstmjd BETWEEN 58262.0 AND 58292.0 -- MJD dates for June 1st and July 1st, 2018
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.0648434162139893,2025-04-29T12:10:28,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18abajxju      1833      3059  58259.465440  60811.464572   
1       ZTF18abbtiul       107      2902  58252.483102  60755.535359   
2       ZTF18abacifs        21      2124  58254.461458  60706.562153   
3       ZTF18ababklf       656      3784  58257.458565  60805.442917   
4       ZTF18abdpjny       193      1782  58283.426424  60692.222789   
...              ...       ...       ...           ...           ...   
333273  ZTF18aawcepd       133      4255  58259.446458  60807.398889   
333274  ZTF18aazuozg       137      1994  58231.486412  60811.469815   
333275  ZTF18aayefjr        85      2385  58274.401447  60756.511123   
333276  ZTF18abcdgiu        28      2449  58287.449676  60807.390949   
333277  ZTF18abaiwqx       237      3636  58282.393993  60775.457222   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   702      NaN           NaN  ...  58287.421169   
1            True    False    66      NaN           NaN  ...  58286.403380   
2            True     True    10      NaN           NaN  ...  58281.397859   
3            True    False   394      NaN           NaN  ...  58281.379583   
4            True    False   162      NaN           NaN  ...  58283.426424   
...           ...      ...   ...      ...           ...  ...           ...   
333273       True    False    79      NaN           NaN  ...  58290.380498   
333274       True    False    92      NaN           NaN  ...  58273.461018   
333275       True    False    53      NaN           NaN  ...  58274.401447   
333276       True     True    21      NaN           NaN  ...  58287.449676   
333277       True    False   140      NaN           NaN  ...  58282.393993   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60811.464572        27.5.6    False             False   
1       60755.535359        27.5.0    False              True   
2       60706.562153        27.3.0    False              True   
3       60805.442917        27.5.6    False              True   
4       60692.222789        27.0.0    False             False   
...              ...           ...      ...               ...   
333273  60807.398889        27.5.6     True             False   
333274  60811.469815        27.5.6     True             False   
333275  60756.511123        27.5.0     True             False   
333276  60807.390949        27.5.6    False             False   
333277  60775.457222        27.5.4    False              True   

        classifier_name     classifier_version      class_name  probability  \
0         lc_classifier  hierarchical_rf_1.1.0             RRL     0.919320   
1         lc_classifier  hierarchical_rf_1.1.0             YSO     0.499776   
2         lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.406468   
3         lc_classifier  hierarchical_rf_1.1.0               E     0.505440   
4         lc_classifier  hierarchical_rf_1.1.0             RRL     0.506880   
...                 ...                    ...             ...          ...   
333273    lc_classifier   lc_classifier_1.1.13             LPV     0.514556   
333274    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.369352   
333275    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.179228   
333276    lc_classifier   lc_classifier_1.1.13             YSO     0.335400   
333277    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.231072   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333273       1  
333274       1  
333275       1  
333276       1  
333277       1  

[333278 rows x 27 columns]]",,159.41529417037964,2025-05-19T14:06:48,0.2693259427892705,0.0816435528297697,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,3,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND object.firstmjd BETWEEN 58262.0 AND 58292.0 -- MJD for June 1st, 2018 is 58262.0 and for July 1st, 2018 is 58292.0
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.121047019958496,2025-04-29T12:10:31,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18abcjxvz       139      4252  58289.423403  60814.433287   
1       ZTF18aawawpd      1159      3044  58259.408484  60773.330857   
2       ZTF18abackkb        93      1768  58255.419479  60636.108530   
3       ZTF18aaxyupv       220      2205  58273.442616  60811.399896   
4       ZTF18abacrsv        63      2266  58252.487859  60618.119248   
...              ...       ...       ...           ...           ...   
333273  ZTF18abajwyv       426      3994  58247.473079  60761.517650   
333274  ZTF18aaxvbwk      2220      4019  58257.474583  60689.123982   
333275  ZTF18aayvigf       773      2808  58217.507188  60804.481539   
333276  ZTF18aaxdjjh      1063      2146  58266.439653  60810.464919   
333277  ZTF18aaxdaiv       516      2353  58262.478611  60804.453901   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   105      NaN           NaN  ...  58289.423403   
1            True    False   419      NaN           NaN  ...  58284.381794   
2            True     True    47      NaN           NaN  ...  58281.397396   
3            True    False   115      NaN           NaN  ...  58273.442616   
4            True    False    46      NaN           NaN  ...  58281.403218   
...           ...      ...   ...      ...           ...  ...           ...   
333273       True    False   172      NaN           NaN  ...  58287.420718   
333274       True    False  2000      NaN           NaN  ...  58272.472523   
333275       True    False   581      NaN           NaN  ...  58277.374074   
333276       True    False   755      NaN           NaN  ...  58266.439653   
333277       True    False   316      NaN           NaN  ...  58266.361076   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60814.433287        27.5.6    False             False   
1       60773.330857        27.5.4    False             False   
2       60636.108530      24.5.2a6    False              True   
3       60811.399896        27.5.6    False              True   
4       60618.119248      24.5.2a6    False              True   
...              ...           ...      ...               ...   
333273  60761.517650        27.5.2     True              True   
333274  60689.123982        26.2.0     True              True   
333275  60804.481539        27.5.6    False              True   
333276  60810.464919        27.5.6    False             False   
333277  60804.453901        27.5.6     True              True   

        classifier_name     classifier_version      class_name  probability  \
0         lc_classifier  hierarchical_rf_1.1.0             YSO     0.306816   
1         lc_classifier  hierarchical_rf_1.1.0             AGN     0.431408   
2         lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.448704   
3         lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.292348   
4         lc_classifier  hierarchical_rf_1.1.0             YSO     0.401400   
...                 ...                    ...             ...          ...   
333273    lc_classifier   lc_classifier_1.1.13               E     0.385344   
333274    lc_classifier   lc_classifier_1.1.13             LPV     0.810648   
333275    lc_classifier   lc_classifier_1.1.13             LPV     0.836400   
333276    lc_classifier   lc_classifier_1.1.13             LPV     0.319680   
333277    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.359160   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333273       1  
333274       1  
333275       1  
333276       1  
333277       1  

[333278 rows x 27 columns]]",,98.79071235656738,2025-05-19T14:09:01,0.2693259427892705,0.0816435528297697,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,4,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd BETWEEN 58262.0 AND 58292.0
AND probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.791452169418335,2025-04-29T12:10:34,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aaxyooo       105      2200  58230.455706  60708.565370   
1       ZTF18abcknah        68      1958  58105.078889  60594.199224   
2       ZTF18abacggr        29      2070  58281.396944  60481.339757   
3       ZTF18abackkb        93      1768  58255.419479  60636.108530   
4       ZTF18aayepxk       337      2128  58105.084317  60807.398889   
...              ...       ...       ...           ...           ...   
333273  ZTF18aaxyurs       247      1725  58261.439259  60795.420162   
333274  ZTF18abfsdht       311      4553  58217.508171  60802.446134   
333275  ZTF18abahfxr       500      2009  58247.439340  60810.423356   
333276  ZTF18abasfvt       362      2006  58246.449919  60814.431377   
333277  ZTF18aayuvny       456      2134  58230.455706  60773.380764   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False    65       NaN           NaN  ...  58262.382407   
1            True    False    44       NaN           NaN  ...  58289.452107   
2            True    False    14  1.228825      1.376523  ...  58281.396944   
3            True     True    47       NaN           NaN  ...  58281.397396   
4            True    False   192       NaN           NaN  ...  58274.400972   
...           ...      ...   ...       ...           ...  ...           ...   
333273       True    False   148       NaN           NaN  ...  58273.443530   
333274       True    False   116       NaN           NaN  ...  58290.376678   
333275       True    False   273       NaN           NaN  ...  58282.335035   
333276       True    False   289       NaN           NaN  ...  58283.427384   
333277       True    False   286       NaN           NaN  ...  58277.373148   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60708.565370        27.3.0    False             False   
1       60594.199224      24.5.2a6    False             False   
2       60481.339757        24.5.1    False             False   
3       60636.108530      24.5.2a6    False              True   
4       60807.398889        27.5.6     True              True   
...              ...           ...      ...               ...   
333273  60795.420162        27.5.6     True              True   
333274  60802.446134        27.5.6     True             False   
333275  60810.423356        27.5.6    False             False   
333276  60814.431377        27.5.6    False              True   
333277  60773.380764        27.5.4    False              True   

        classifier_name     classifier_version      class_name  probability  \
0         lc_classifier  hierarchical_rf_1.1.0             YSO     0.333656   
1         lc_classifier  hierarchical_rf_1.1.0             YSO     0.413364   
2         lc_classifier  hierarchical_rf_1.1.0             YSO     0.513856   
3         lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.448704   
4         lc_classifier  hierarchical_rf_1.1.0             LPV     0.805920   
...                 ...                    ...             ...          ...   
333273    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.536256   
333274    lc_classifier   lc_classifier_1.1.13             YSO     0.154224   
333275    lc_classifier   lc_classifier_1.1.13             LPV     0.739552   
333276    lc_classifier   lc_classifier_1.1.13             YSO     0.274068   
333277    lc_classifier   lc_classifier_1.1.13             LPV     0.759320   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333273       1  
333274       1  
333275       1  
333276       1  
333277       1  

[333278 rows x 27 columns]]",,119.26362371444702,2025-05-19T14:11:26,0.2693259427892705,0.0816435528297697,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,5,"
SELECT *
FROM object
WHERE firstmjd BETWEEN 58262.0 AND 58292.0
AND oid IN (
    SELECT oid
    FROM probability
    WHERE ranking = 1
    AND classifier_name = 'lc_classifier'
)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.518473148345947,2025-04-29T12:10:39,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aaxdttw      2564      5822  58198.370440  60698.510255   
1       ZTF17aackkjh       325      2752  58117.558866  60814.302755   
2       ZTF18aaavrvw      1646      3270  58156.449988  60814.322940   
3       ZTF18aawsnqe       134      2689  58246.430694  60802.482674   
4       ZTF18abapylu        97      2479  58247.460544  60497.316481   
...              ...       ...       ...           ...           ...   
189601  ZTF18abcroxj      1332      2073  58104.130706  60758.509988   
189602  ZTF18abcrnps       370      2080  58095.079676  60665.118461   
189603  ZTF18abcrrjb        15      1566  58291.477593  59451.284607   
189604  ZTF18aargaub        93      7473  58245.275486  60731.468241   
189605  ZTF18aahysuo        62      6085  58211.464907  60750.391389   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      meanra  \
0            True    False   283      NaN           NaN  ...  212.475839   
1            True    False   119      NaN           NaN  ...  204.374704   
2            True    False   460      NaN           NaN  ...  207.684089   
3            True    False    34      NaN           NaN  ...  290.387042   
4            True     True    23      NaN           NaN  ...  290.608030   
...           ...      ...   ...      ...           ...  ...         ...   
189601       True    False   954      NaN           NaN  ...  312.620808   
189602       True    False   243      NaN           NaN  ...  317.153732   
189603       True     True     6      NaN           NaN  ...  312.261332   
189604       True    False    28      NaN           NaN  ...  237.331305   
189605       True    False    22      NaN           NaN  ...  231.875814   

          meandec   sigmara  sigmadec      deltajd      firstmjd  \
0       61.608586  0.009210  0.004379  2436.205382  58262.304873   
1       30.341264  0.007199  0.006213  2552.034664  58262.268090   
2       37.618657  0.004179  0.003310  2552.052697  58262.270243   
3       11.492464  0.014876  0.014577  2540.102581  58262.380093   
4       11.003531  0.024997  0.024537  2234.936389  58262.380093   
...           ...       ...       ...          ...           ...   
189601  53.421059  0.004089  0.002437  2467.033866  58291.476123   
189602  53.241328  0.008588  0.005139  2373.642338  58291.476123   
189603  38.051506  0.000029  0.000007  1159.807014  58291.477593   
189604  29.799974  0.015474  0.013428  2446.168461  58285.299780   
189605  36.112383  0.017661  0.014268  2465.091609  58285.299780   

             lastmjd      step_id_corr  diffpos reference_change  
0       60698.510255            27.1.0    False            False  
1       60814.302755            27.5.6     True            False  
2       60814.322940            27.5.6    False            False  
3       60802.482674            27.5.6    False            False  
4       60497.316481          24.5.2a6    False            False  
...              ...               ...      ...              ...  
189601  60758.509988            27.5.0     True            False  
189602  60665.118461            26.2.0    False            False  
189603  59451.284607  correction_1.0.6    False            False  
189604  60731.468241            27.4.0    False            False  
189605  60750.391389            27.5.2     True            False  

[189606 rows x 22 columns]]",,104.7991659641266,2025-05-19T14:13:38,0.1490943284173018,0.1435081168317458,0.8148148148148148,1.0,0.0,0.0
0.16.3,gpt-4o,v1,22,6,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd BETWEEN 58262.0 AND 58292.0
AND probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.6400551795959473,2025-04-29T12:10:42,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18abacgkh       114      1046  58234.481863  60724.512569   
1       ZTF18aayepxk       337      2128  58105.084317  60807.398889   
2       ZTF18abadmbr       567      2263  58262.477650  60814.469942   
3       ZTF18abajkru       166      2162  58104.088542  60539.339109   
4       ZTF18aajquyw       137      2016  58208.479653  60533.237153   
...              ...       ...       ...           ...           ...   
333273  ZTF18abcfwoz      1398      2957  58270.406991  60810.457627   
333274  ZTF18aajnyaz       131      2636  58111.468287  60723.454641   
333275  ZTF18abahgtc      1338      2215  58282.335035  60804.399456   
333276  ZTF18abbwqfu       125      1822  58218.504826  60786.439838   
333277  ZTF18abbkkat       522      1803  58218.504826  60705.563090   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd  \
0            True     True    60       NaN           NaN  ...  58281.396944   
1            True    False   192       NaN           NaN  ...  58274.400972   
2            True    False   503       NaN           NaN  ...  58281.431609   
3            True    False    74  1.026388      1.545877  ...  58282.403461   
4            True    False    70  0.215720      0.933115  ...  58272.266806   
...           ...      ...   ...       ...           ...  ...           ...   
333273       True    False   973       NaN           NaN  ...  58288.333148   
333274       True    False    49       NaN           NaN  ...  58282.257998   
333275       True    False   441       NaN           NaN  ...  58282.335035   
333276       True    False    51       NaN           NaN  ...  58287.314086   
333277       True    False   213       NaN           NaN  ...  58285.333715   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60724.512569        27.4.0    False             False   
1       60807.398889        27.5.6     True              True   
2       60814.469942        27.5.6    False             False   
3       60539.339109      24.5.2a6    False              True   
4       60533.237153      24.5.2a6    False             False   
...              ...           ...      ...               ...   
333273  60810.457627        27.5.6     True             False   
333274  60723.454641        27.4.0     True             False   
333275  60804.399456        27.5.6     True             False   
333276  60786.439838        27.5.6    False             False   
333277  60705.563090        27.3.0    False             False   

        classifier_name     classifier_version      class_name  probability  \
0         lc_classifier  hierarchical_rf_1.1.0             LPV     0.303680   
1         lc_classifier  hierarchical_rf_1.1.0             LPV     0.805920   
2         lc_classifier  hierarchical_rf_1.1.0             CEP     0.153408   
3         lc_classifier  hierarchical_rf_1.1.0             YSO     0.402780   
4         lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.568344   
...                 ...                    ...             ...          ...   
333273    lc_classifier   lc_classifier_1.1.13             LPV     0.388352   
333274    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.211584   
333275    lc_classifier   lc_classifier_1.1.13             LPV     0.725560   
333276    lc_classifier   lc_classifier_1.1.13             YSO     0.379320   
333277    lc_classifier   lc_classifier_1.1.13             LPV     0.796800   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333273       1  
333274       1  
333275       1  
333276       1  
333277       1  

[333278 rows x 27 columns]]",,150.27404022216797,2025-05-19T14:17:07,0.2693259427892705,0.0816435528297697,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,7,"
SELECT *
FROM object
WHERE firstmjd BETWEEN 58262.0 AND 58292.0
AND oid IN (
    SELECT oid
    FROM probability
    WHERE ranking = 1
    AND classifier_name = 'lc_classifier'
)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.949136257171631,2025-04-29T12:10:47,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aahsdhg       211      2794  58217.236701  60734.387257   
1       ZTF18aaakeie       694      1889  58131.465891  60351.392882   
2       ZTF18aaxdttw      2564      5822  58198.370440  60698.510255   
3       ZTF18aaisils       773      5903  58210.317234  60754.331007   
4       ZTF18aauxznx       154      2204  58255.304329  60814.345081   
...              ...       ...       ...           ...           ...   
189601  ZTF18abbmprb       605      1884  58234.461655  60807.457500   
189602  ZTF18abbmngu       500      1982  58219.510301  60811.400370   
189603  ZTF18abbmprh       683      1595  58234.461655  60811.442025   
189604  ZTF18abbmmiu      1124      3973  58203.505984  60811.442025   
189605  ZTF18abcccqp        86      2025  58285.421516  60759.514375   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      meanra  \
0            True    False    72       NaN           NaN  ...  190.087250   
1            True    False   263 -0.395701     -0.114059  ...  200.335226   
2            True    False   283       NaN           NaN  ...  212.475839   
3            True    False   276       NaN           NaN  ...  214.716843   
4            True    False    70       NaN           NaN  ...  230.798272   
...           ...      ...   ...       ...           ...  ...         ...   
189601       True    False   439       NaN           NaN  ...  288.279405   
189602      False    False   352       NaN           NaN  ...  286.600459   
189603       True    False   468       NaN           NaN  ...  288.061166   
189604       True    False   783       NaN           NaN  ...  282.255195   
189605       True    False    33       NaN           NaN  ...  295.880522   

          meandec   sigmara  sigmadec      deltajd      firstmjd  \
0       34.889508  0.009994  0.008198  2472.118148  58262.269109   
1       18.464623  0.027976  0.026536  2142.118657  58262.275220   
2       61.608586  0.009210  0.004379  2436.205382  58262.304873   
3       64.407756  0.009103  0.003932  2492.026134  58262.304873   
4       80.087790  0.050892  0.008760  2552.036470  58262.308611   
...           ...       ...       ...          ...           ...   
189601  27.130243  0.003600  0.003204  2522.036470  58285.421030   
189602  27.174945  0.004425  0.003936  2525.979340  58285.421030   
189603  27.731024  0.003635  0.003217  2526.020995  58285.421030   
189604  28.537486  0.002794  0.002455  2526.020995  58285.421030   
189605  33.661162  0.014540  0.012102  2474.092859  58285.421516   

             lastmjd  step_id_corr  diffpos reference_change  
0       60734.387257        27.4.0    False            False  
1       60404.393877         1.2.1    False             True  
2       60698.510255        27.1.0    False            False  
3       60754.331007        27.5.0     True            False  
4       60814.345081        27.5.6    False            False  
...              ...           ...      ...              ...  
189601  60807.457500        27.5.6    False            False  
189602  60811.400370        27.5.6     True             True  
189603  60811.442025        27.5.6     True            False  
189604  60811.442025        27.5.6     True            False  
189605  60759.514375        27.5.0    False            False  

[189606 rows x 22 columns]]",,71.96771168708801,2025-05-19T14:19:25,0.1490943284173018,0.1435081168317458,0.8148148148148148,1.0,0.0,0.0
0.16.3,gpt-4o,v1,22,8,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd BETWEEN 58262.0 AND 58292.0
AND probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.121972560882568,2025-04-29T12:10:52,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18abcjxvz       139      4252  58289.423403  60814.433287   
1       ZTF18aayepxk       337      2128  58105.084317  60807.398889   
2       ZTF18abadmbr       567      2263  58262.477650  60814.469942   
3       ZTF18abajkru       166      2162  58104.088542  60539.339109   
4       ZTF18aajquyw       137      2016  58208.479653  60533.237153   
...              ...       ...       ...           ...           ...   
333273  ZTF18ababkgl        79      1332  58246.463611  60794.480474   
333274  ZTF18abadmsq       118      2318  58281.434410  60781.489444   
333275  ZTF18abcpdjx       542      2088  58246.449456  60795.475475   
333276  ZTF18aazjcjp        22      4710  58224.454097  60678.406586   
333277  ZTF18aamwlmh       224      2310  58229.286863  60814.325764   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   105       NaN           NaN  ...  58289.423403   
1            True    False   192       NaN           NaN  ...  58274.400972   
2            True    False   503       NaN           NaN  ...  58281.431609   
3            True    False    74  1.026388      1.545877  ...  58282.403461   
4            True    False    70  0.215720      0.933115  ...  58272.266806   
...           ...      ...   ...       ...           ...  ...           ...   
333273       True     True    39       NaN           NaN  ...  58281.380046   
333274       True    False    61       NaN           NaN  ...  58281.434410   
333275       True    False   287       NaN           NaN  ...  58290.454387   
333276       True    False    11       NaN           NaN  ...  58279.305428   
333277       True    False   133       NaN           NaN  ...  58279.305428   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60814.433287        27.5.6    False             False   
1       60807.398889        27.5.6     True              True   
2       60814.469942        27.5.6    False             False   
3       60539.339109      24.5.2a6    False              True   
4       60533.237153      24.5.2a6    False             False   
...              ...           ...      ...               ...   
333273  60794.480474        27.5.6    False             False   
333274  60781.489444        27.5.6    False              True   
333275  60795.475475        27.5.6    False             False   
333276  60678.406586        26.2.0    False             False   
333277  60814.325764        27.5.6    False             False   

        classifier_name     classifier_version      class_name  probability  \
0         lc_classifier  hierarchical_rf_1.1.0             YSO     0.306816   
1         lc_classifier  hierarchical_rf_1.1.0             LPV     0.805920   
2         lc_classifier  hierarchical_rf_1.1.0             CEP     0.153408   
3         lc_classifier  hierarchical_rf_1.1.0             YSO     0.402780   
4         lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.568344   
...                 ...                    ...             ...          ...   
333273    lc_classifier   lc_classifier_1.1.13             YSO     0.308688   
333274    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.350244   
333275    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.337652   
333276    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.285440   
333277    lc_classifier   lc_classifier_1.1.13  Periodic-Other     0.470532   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333273       1  
333274       1  
333275       1  
333276       1  
333277       1  

[333278 rows x 27 columns]]",,169.88686060905457,2025-05-19T14:23:39,0.2693259427892705,0.0816435528297697,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,9,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND object.firstmjd BETWEEN 58262.0 AND 58292.0 -- MJD dates for June 1st and July 1st, 2018
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.71767520904541,2025-04-29T12:10:55,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aayxofs       247      5254  58246.471586  60645.154676   
1       ZTF18abcknah        68      1958  58105.078889  60594.199224   
2       ZTF18abacggr        29      2070  58281.396944  60481.339757   
3       ZTF18abackpc        26       628  58281.402743  58811.071065   
4       ZTF18aapmame       795      3002  58203.497975  60537.181632   
...              ...       ...       ...           ...           ...   
333273  ZTF18aayntru       150      2176  58219.509826  60805.446262   
333274  ZTF18aazutnv       149      1948  58218.510556  60353.549838   
333275  ZTF18abaygzp       221      1938  58276.421088  60797.452072   
333276  ZTF18abbdnxx       303      2173  58207.526157  60807.458912   
333277  ZTF18abcdbdi        50      1999  58246.449456  60694.117049   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   122       NaN           NaN  ...  58277.453009   
1            True    False    44       NaN           NaN  ...  58289.452107   
2            True    False    14  1.228825      1.376523  ...  58281.396944   
3            True     True    23  0.729321      0.861556  ...  58281.402743   
4            True    False   163  0.955479      0.935795  ...  58278.369537   
...           ...      ...   ...       ...           ...  ...           ...   
333273       True    False    87       NaN           NaN  ...  58276.373113   
333274       True     True    58  2.438211      2.932892  ...  58280.410289   
333275       True    False   161       NaN           NaN  ...  58284.337014   
333276       True    False   191       NaN           NaN  ...  58284.394896   
333277       True    False    47       NaN           NaN  ...  58287.433958   

             lastmjd     step_id_corr  diffpos  reference_change  \
0       60645.154676         24.5.2a6    False              True   
1       60594.199224         24.5.2a6    False             False   
2       60481.339757           24.5.1    False             False   
3       58811.071065  corr_bulk_0.0.1    False              True   
4       60537.181632         24.5.2a6    False             False   
...              ...              ...      ...               ...   
333273  60805.446262           27.5.6    False             False   
333274  60353.549838  corr_bulk_0.0.1    False             False   
333275  60797.452072           27.5.6    False             False   
333276  60807.458912           27.5.6    False             False   
333277  60694.117049           27.0.0    False              True   

        classifier_name     classifier_version      class_name  probability  \
0         lc_classifier  hierarchical_rf_1.1.0             LPV     0.599872   
1         lc_classifier  hierarchical_rf_1.1.0             YSO     0.413364   
2         lc_classifier  hierarchical_rf_1.1.0             YSO     0.513856   
3         lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.611448   
4         lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.679228   
...                 ...                    ...             ...          ...   
333273    lc_classifier  hierarchical_rf_1.1.0             LPV     0.617396   
333274    lc_classifier  hierarchical_rf_1.1.0             LPV     0.775720   
333275    lc_classifier  hierarchical_rf_1.1.0             YSO     0.260384   
333276    lc_classifier  hierarchical_rf_1.1.0             LPV     0.694120   
333277    lc_classifier  hierarchical_rf_1.1.0  Periodic-Other     0.632460   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333273       1  
333274       1  
333275       1  
333276       1  
333277       1  

[333278 rows x 27 columns]]",,241.39705991744995,2025-05-19T14:29:08,0.2693259427892705,0.0816435528297697,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,10,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND object.firstmjd BETWEEN 58262.0 AND 58292.0 -- MJD dates for June 1st, 2018 and July 1st, 2018
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.048074960708618,2025-04-29T12:11:00,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aaakbte       691      2350  58131.516667  60774.400393   
1       ZTF17aackkjh       325      2752  58117.558866  60814.302755   
2       ZTF18aaavrvw      1646      3270  58156.449988  60814.322940   
3       ZTF18aawsnqe       134      2689  58246.430694  60802.482674   
4       ZTF18abapylu        97      2479  58247.460544  60497.316481   
...              ...       ...       ...           ...           ...   
189601  ZTF18abbubqb       138      2241  58257.473669  60807.401458   
189602  ZTF18abbugiy       144      3002  58247.466968  60776.494236   
189603  ZTF18abbukyl       146      3043  58258.452361  60811.411887   
189604  ZTF18abbudau       100      2627  58271.500000  59881.250000   
189605  ZTF18abbujtf       320      2826  58258.452361  60606.198530   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      meanra  \
0            True    False   293       NaN           NaN  ...  204.543844   
1            True    False   119       NaN           NaN  ...  204.374704   
2            True    False   460       NaN           NaN  ...  207.684089   
3            True    False    34       NaN           NaN  ...  290.387042   
4            True     True    23       NaN           NaN  ...  290.608030   
...           ...      ...   ...       ...           ...  ...         ...   
189601       True    False    78       NaN           NaN  ...  313.899182   
189602       True    False    62       NaN           NaN  ...  324.174126   
189603       True    False    63       NaN           NaN  ...  321.285312   
189604       True    False    25  1.114313      1.385934  ...  320.691161   
189605       True    False   213       NaN           NaN  ...  323.081400   

          meandec   sigmara  sigmadec      deltajd      firstmjd  \
0       16.324698  0.004289  0.004116  2512.125174  58262.275220   
1       30.341264  0.007199  0.006213  2552.034664  58262.268090   
2       37.618657  0.004179  0.003310  2552.052697  58262.270243   
3       11.492464  0.014876  0.014577  2540.102581  58262.380093   
4       11.003531  0.024997  0.024537  2234.936389  58262.380093   
...           ...       ...       ...          ...           ...   
189601  41.404469  0.010878  0.008159  2520.971840  58286.429618   
189602  44.655277  0.012928  0.009196  2490.064143  58286.430093   
189603  47.505766  0.014003  0.009459  2524.981794  58286.430093   
189604  50.871171  0.000178  0.000088  1594.814236  58286.430093   
189605  49.078032  0.052411  0.034331  2319.768437  58286.430093   

             lastmjd  step_id_corr  diffpos reference_change  
0       60774.400393        27.5.4     True            False  
1       60814.302755        27.5.6     True            False  
2       60814.322940        27.5.6    False            False  
3       60802.482674        27.5.6    False            False  
4       60497.316481      24.5.2a6    False            False  
...              ...           ...      ...              ...  
189601  60807.401458        27.5.6     True             True  
189602  60776.494236        27.5.6    False            False  
189603  60811.411887        27.5.6    False             True  
189604  59881.244329         1.1.6    False            False  
189605  60606.198530      24.5.2a6    False             True  

[189606 rows x 22 columns]]",,209.11705255508423,2025-05-19T14:33:37,0.1490943284173018,0.1435081168317458,0.8148148148148148,1.0,0.0,0.0
0.16.3,,,12,0,"
SELECT o.oid, o.meanra, o.meandec

FROM (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
    AND probability.ranking = 1
    AND object.firstmjd > 59988.0
    AND object.firstmjd < 60197.0
) as o
WHERE
    q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);
",,,,,"[             oid      meanra    meandec
0   ZTF23aazxfdh   11.327556  -2.327343
1   ZTF23aazneeg  357.339861 -17.674648
2   ZTF23aazxair   14.098124   0.520434
3   ZTF23abawaav  359.369924  -5.159571
4   ZTF23abbbrbi  358.010245  -4.224612
5   ZTF23abbbygf   16.168206  -1.053601
6   ZTF23aazwytj    0.881927 -10.744196
7   ZTF23abbkepd   13.835889   5.077601
8   ZTF23abapoiv    5.230048  -1.758021
9   ZTF23abbjstt   13.706127  -3.710276
10  ZTF23ababooa  347.699685 -15.441363
11  ZTF23aazkvym  357.860400 -11.907847
12  ZTF23abbbybs   12.780815  -5.443683
13  ZTF23abaychv   12.394942  -3.037759
14  ZTF23aaovxwf  351.140762 -19.056710
15  ZTF23aapnlvr  352.465073 -11.202974
16  ZTF23aaowayh  356.647299 -13.542643
17  ZTF23aapvrkk    0.175006 -12.236802
18  ZTF23aapvzyq  359.503657 -11.916706
19  ZTF23aaohpnv    8.491958   4.082251
20  ZTF23aapgxic    7.748520   5.157252
21  ZTF23aapqtxd    8.879058   2.147919
22  ZTF23abbygzm  343.960147 -17.448733
23  ZTF23abcvivc  358.337513  -5.886772
24  ZTF23aaqixha    8.509318  -9.703939
25  ZTF23aazxiuu    6.501685  -0.884798
26  ZTF23aaqixyp    6.388770  -7.758614
27  ZTF23abbefkk    9.982778   6.622644
28  ZTF23aazwshk   10.101225   4.791153
29  ZTF23abawaqe  352.826653 -18.783349
30  ZTF23aaqygof  345.346057 -18.765263
31  ZTF23aapwihe   17.827492   0.742945
32  ZTF23aaretvs   15.263196  -2.912866
33  ZTF23aarfbvs   11.196881  -2.378468
34  ZTF23aarffak  356.743944 -19.262242
35  ZTF23aarfpck    6.464097   2.183000
36  ZTF23aaqluoo  358.419121 -17.190397
37  ZTF23aascfrd  354.052083  -7.437187
38  ZTF23abbbomo  345.634527 -19.724748
39  ZTF23aapgjtm  351.100632 -14.425906
40  ZTF23aasyvbf    9.411387  -4.281495
41  ZTF23aatzjdo    1.226893 -13.502189
42  ZTF23aaovzyu  349.534040 -12.976046
43  ZTF23aaumlxn    6.423729  -1.050326
44  ZTF23aaaweph    1.307964 -11.502395
45  ZTF23aaaweph    1.307964 -11.502395
46  ZTF23aazsfpa  356.794110 -16.513073
47  ZTF23abbjtdn    6.232715   1.033046
48  ZTF23aavlyvc  359.897395  -6.376741
49  ZTF23aavmycb    7.102145   0.441236
50  ZTF23aawqydv   19.468501   0.780816
51  ZTF23aaxavca    9.017651   1.801565
52  ZTF23aaxavca    9.017651   1.801565
53  ZTF23aaxbfyp    4.112309 -10.371170
54  ZTF23aaxbfzl   16.973081   1.732003
55  ZTF23aaxtrgs    1.760985  -9.567699
56  ZTF23abbitkh   10.628642   8.028922
57  ZTF23aaxtdpc    9.048410  -2.151892
58  ZTF22abrrqkf  351.152588 -13.510948]",,38.74311971664429,2025-05-19T14:34:18,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,12,1,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.9805116653442383,2025-04-29T12:11:04,"[             oid     meanra    meandec
0   ZTF23aapwihe  17.827492   0.742945
1   ZTF23aapvrkk   0.175006 -12.236802
2   ZTF23aaohpnv   8.491958   4.082251
3   ZTF23aapgxic   7.748520   5.157252
4   ZTF23aapqtxd   8.879058   2.147919
5   ZTF23aarfbvs  11.196881  -2.378468
6   ZTF23aaqixha   8.509318  -9.703939
7   ZTF23aaqixyp   6.388770  -7.758614
8   ZTF23aaretvs  15.263196  -2.912866
9   ZTF23aatzjdo   1.226893 -13.502189
10  ZTF23aarfpck   6.464097   2.183000
11  ZTF23aasyvbf   9.411387  -4.281495
12  ZTF23aaumlxn   6.423729  -1.050326
13  ZTF23aaaweph   1.307964 -11.502395
14  ZTF23aaaweph   1.307964 -11.502395
15  ZTF23aavmycb   7.102145   0.441236
16  ZTF23aaxbfzl  16.973081   1.732003
17  ZTF23aaxbfyp   4.112309 -10.371170
18  ZTF23aawqydv  19.468501   0.780816
19  ZTF23aaxavca   9.017651   1.801565
20  ZTF23aaxavca   9.017651   1.801565
21  ZTF23aaxtrgs   1.760985  -9.567699
22  ZTF23aazxair  14.098124   0.520434
23  ZTF23aazwytj   0.881927 -10.744196
24  ZTF23aaxtdpc   9.048410  -2.151892
25  ZTF23abbefkk   9.982778   6.622644
26  ZTF23aazwshk  10.101225   4.791153
27  ZTF23abbbybs  12.780815  -5.443683
28  ZTF23aazxfdh  11.327556  -2.327343
29  ZTF23aazxiuu   6.501685  -0.884798
30  ZTF23abapoiv   5.230048  -1.758021
31  ZTF23abaychv  12.394942  -3.037759
32  ZTF23abbbygf  16.168206  -1.053601
33  ZTF23abbjstt  13.706127  -3.710276
34  ZTF23abbitkh  10.628642   8.028922
35  ZTF23abbkepd  13.835889   5.077601
36  ZTF23abbjtdn   6.232715   1.033046
37  ZTF23abdhvab  17.532746   2.468053
38  ZTF23abchvcs  13.272933  -1.453402]",,133.56713581085205,2025-05-19T14:36:43,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,2,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.610280513763428,2025-04-29T12:11:08,"[             oid     meanra    meandec
0   ZTF23aapqtxd   8.879058   2.147919
1   ZTF23aapvrkk   0.175006 -12.236802
2   ZTF23aaohpnv   8.491958   4.082251
3   ZTF23aapgxic   7.748520   5.157252
4   ZTF23aapwihe  17.827492   0.742945
5   ZTF23aarfbvs  11.196881  -2.378468
6   ZTF23aaqixha   8.509318  -9.703939
7   ZTF23aaqixyp   6.388770  -7.758614
8   ZTF23aaretvs  15.263196  -2.912866
9   ZTF23aarfpck   6.464097   2.183000
10  ZTF23aaumlxn   6.423729  -1.050326
11  ZTF23aaaweph   1.307964 -11.502395
12  ZTF23aasyvbf   9.411387  -4.281495
13  ZTF23aatzjdo   1.226893 -13.502189
14  ZTF23aaaweph   1.307964 -11.502395
15  ZTF23aavmycb   7.102145   0.441236
16  ZTF23aaxbfzl  16.973081   1.732003
17  ZTF23abapoiv   5.230048  -1.758021
18  ZTF23aaxavca   9.017651   1.801565
19  ZTF23aaxavca   9.017651   1.801565
20  ZTF23aaxbfyp   4.112309 -10.371170
21  ZTF23aazwytj   0.881927 -10.744196
22  ZTF23aazxair  14.098124   0.520434
23  ZTF23aawqydv  19.468501   0.780816
24  ZTF23aaxtrgs   1.760985  -9.567699
25  ZTF23aaxtdpc   9.048410  -2.151892
26  ZTF23abbefkk   9.982778   6.622644
27  ZTF23aazwshk  10.101225   4.791153
28  ZTF23aazxfdh  11.327556  -2.327343
29  ZTF23aazxiuu   6.501685  -0.884798
30  ZTF23abbbybs  12.780815  -5.443683
31  ZTF23abaychv  12.394942  -3.037759
32  ZTF23abbkepd  13.835889   5.077601
33  ZTF23abbjstt  13.706127  -3.710276
34  ZTF23abbbygf  16.168206  -1.053601
35  ZTF23abbitkh  10.628642   8.028922
36  ZTF23abbjtdn   6.232715   1.033046
37  ZTF23abdhvab  17.532746   2.468053
38  ZTF23abchvcs  13.272933  -1.453402]",,25.958651065826416,2025-05-19T14:37:26,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,3,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.3914794921875,2025-04-29T12:11:13,"[             oid     meanra    meandec
0   ZTF23aapqtxd   8.879058   2.147919
1   ZTF23aaohpnv   8.491958   4.082251
2   ZTF23aapgxic   7.748520   5.157252
3   ZTF23aapvrkk   0.175006 -12.236802
4   ZTF23aaxtdpc   9.048410  -2.151892
5   ZTF23aasyvbf   9.411387  -4.281495
6   ZTF23aatzjdo   1.226893 -13.502189
7   ZTF23aavmycb   7.102145   0.441236
8   ZTF23aaxbfzl  16.973081   1.732003
9   ZTF23aawqydv  19.468501   0.780816
10  ZTF23aaxavca   9.017651   1.801565
11  ZTF23aaxavca   9.017651   1.801565
12  ZTF23aaxbfyp   4.112309 -10.371170
13  ZTF23aarfbvs  11.196881  -2.378468
14  ZTF23aaqixha   8.509318  -9.703939
15  ZTF23aaqixyp   6.388770  -7.758614
16  ZTF23aapwihe  17.827492   0.742945
17  ZTF23aaretvs  15.263196  -2.912866
18  ZTF23aarfpck   6.464097   2.183000
19  ZTF23aaumlxn   6.423729  -1.050326
20  ZTF23aaaweph   1.307964 -11.502395
21  ZTF23aaaweph   1.307964 -11.502395
22  ZTF23aaxtrgs   1.760985  -9.567699
23  ZTF23abbefkk   9.982778   6.622644
24  ZTF23aazxair  14.098124   0.520434
25  ZTF23aazwytj   0.881927 -10.744196
26  ZTF23aazwshk  10.101225   4.791153
27  ZTF23abbbygf  16.168206  -1.053601
28  ZTF23abapoiv   5.230048  -1.758021
29  ZTF23abbbybs  12.780815  -5.443683
30  ZTF23abaychv  12.394942  -3.037759
31  ZTF23aazxfdh  11.327556  -2.327343
32  ZTF23aazxiuu   6.501685  -0.884798
33  ZTF23abbitkh  10.628642   8.028922
34  ZTF23abbjstt  13.706127  -3.710276
35  ZTF23abchvcs  13.272933  -1.453402
36  ZTF23abdhvab  17.532746   2.468053
37  ZTF23abbkepd  13.835889   5.077601
38  ZTF23abbjtdn   6.232715   1.033046]",,20.902193069458008,2025-05-19T14:37:57,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,4,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.62554383277893,2025-04-29T12:11:17,"[             oid     meanra    meandec
0   ZTF23aaohpnv   8.491958   4.082251
1   ZTF23aapvrkk   0.175006 -12.236802
2   ZTF23aapgxic   7.748520   5.157252
3   ZTF23aapqtxd   8.879058   2.147919
4   ZTF23aarfbvs  11.196881  -2.378468
5   ZTF23aaqixha   8.509318  -9.703939
6   ZTF23aaqixyp   6.388770  -7.758614
7   ZTF23aapwihe  17.827492   0.742945
8   ZTF23aaretvs  15.263196  -2.912866
9   ZTF23aatzjdo   1.226893 -13.502189
10  ZTF23aarfpck   6.464097   2.183000
11  ZTF23aaumlxn   6.423729  -1.050326
12  ZTF23aasyvbf   9.411387  -4.281495
13  ZTF23aaxtrgs   1.760985  -9.567699
14  ZTF23aaaweph   1.307964 -11.502395
15  ZTF23aaaweph   1.307964 -11.502395
16  ZTF23aawqydv  19.468501   0.780816
17  ZTF23aavmycb   7.102145   0.441236
18  ZTF23aaxbfzl  16.973081   1.732003
19  ZTF23aaxavca   9.017651   1.801565
20  ZTF23aaxavca   9.017651   1.801565
21  ZTF23aaxbfyp   4.112309 -10.371170
22  ZTF23aaxtdpc   9.048410  -2.151892
23  ZTF23abbefkk   9.982778   6.622644
24  ZTF23aazwytj   0.881927 -10.744196
25  ZTF23aazxair  14.098124   0.520434
26  ZTF23aazwshk  10.101225   4.791153
27  ZTF23abbbybs  12.780815  -5.443683
28  ZTF23abapoiv   5.230048  -1.758021
29  ZTF23aazxfdh  11.327556  -2.327343
30  ZTF23aazxiuu   6.501685  -0.884798
31  ZTF23abaychv  12.394942  -3.037759
32  ZTF23abbitkh  10.628642   8.028922
33  ZTF23abbbygf  16.168206  -1.053601
34  ZTF23abbjstt  13.706127  -3.710276
35  ZTF23abbjtdn   6.232715   1.033046
36  ZTF23abdhvab  17.532746   2.468053
37  ZTF23abbkepd  13.835889   5.077601
38  ZTF23abchvcs  13.272933  -1.453402]",,19.839051723480225,2025-05-19T14:38:27,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,5,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.8718278408050537,2025-04-29T12:11:21,"[             oid     meanra    meandec
0   ZTF23aaaweph   1.307964 -11.502395
1   ZTF23aapwihe  17.827492   0.742945
2   ZTF23aaretvs  15.263196  -2.912866
3   ZTF23aarfpck   6.464097   2.183000
4   ZTF23aatzjdo   1.226893 -13.502189
5   ZTF23aapvrkk   0.175006 -12.236802
6   ZTF23aaohpnv   8.491958   4.082251
7   ZTF23aapgxic   7.748520   5.157252
8   ZTF23aapqtxd   8.879058   2.147919
9   ZTF23aarfbvs  11.196881  -2.378468
10  ZTF23aaqixha   8.509318  -9.703939
11  ZTF23aaqixyp   6.388770  -7.758614
12  ZTF23aaumlxn   6.423729  -1.050326
13  ZTF23aasyvbf   9.411387  -4.281495
14  ZTF23aaaweph   1.307964 -11.502395
15  ZTF23aaxtrgs   1.760985  -9.567699
16  ZTF23aavmycb   7.102145   0.441236
17  ZTF23aaxbfzl  16.973081   1.732003
18  ZTF23aaxavca   9.017651   1.801565
19  ZTF23aaxavca   9.017651   1.801565
20  ZTF23aaxbfyp   4.112309 -10.371170
21  ZTF23aawqydv  19.468501   0.780816
22  ZTF23aazwytj   0.881927 -10.744196
23  ZTF23aaxtdpc   9.048410  -2.151892
24  ZTF23abapoiv   5.230048  -1.758021
25  ZTF23aazxair  14.098124   0.520434
26  ZTF23abbefkk   9.982778   6.622644
27  ZTF23aazwshk  10.101225   4.791153
28  ZTF23aazxfdh  11.327556  -2.327343
29  ZTF23aazxiuu   6.501685  -0.884798
30  ZTF23abbbygf  16.168206  -1.053601
31  ZTF23abbbybs  12.780815  -5.443683
32  ZTF23abaychv  12.394942  -3.037759
33  ZTF23abbitkh  10.628642   8.028922
34  ZTF23abbjstt  13.706127  -3.710276
35  ZTF23abbkepd  13.835889   5.077601
36  ZTF23abbjtdn   6.232715   1.033046
37  ZTF23abchvcs  13.272933  -1.453402
38  ZTF23abdhvab  17.532746   2.468053]",,20.085403203964237,2025-05-19T14:38:58,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,6,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.172250986099243,2025-04-29T12:11:25,"[             oid     meanra    meandec
0   ZTF23aapvrkk   0.175006 -12.236802
1   ZTF23aapwihe  17.827492   0.742945
2   ZTF23aapqtxd   8.879058   2.147919
3   ZTF23aaohpnv   8.491958   4.082251
4   ZTF23aapgxic   7.748520   5.157252
5   ZTF23aarfbvs  11.196881  -2.378468
6   ZTF23aaqixha   8.509318  -9.703939
7   ZTF23aaqixyp   6.388770  -7.758614
8   ZTF23aaretvs  15.263196  -2.912866
9   ZTF23aaumlxn   6.423729  -1.050326
10  ZTF23aarfpck   6.464097   2.183000
11  ZTF23aasyvbf   9.411387  -4.281495
12  ZTF23aavmycb   7.102145   0.441236
13  ZTF23aatzjdo   1.226893 -13.502189
14  ZTF23aaaweph   1.307964 -11.502395
15  ZTF23aaaweph   1.307964 -11.502395
16  ZTF23aaxbfzl  16.973081   1.732003
17  ZTF23aaxavca   9.017651   1.801565
18  ZTF23aawqydv  19.468501   0.780816
19  ZTF23aaxavca   9.017651   1.801565
20  ZTF23aaxtrgs   1.760985  -9.567699
21  ZTF23aaxbfyp   4.112309 -10.371170
22  ZTF23aazwytj   0.881927 -10.744196
23  ZTF23aaxtdpc   9.048410  -2.151892
24  ZTF23abbkepd  13.835889   5.077601
25  ZTF23abbefkk   9.982778   6.622644
26  ZTF23aazwshk  10.101225   4.791153
27  ZTF23aazxfdh  11.327556  -2.327343
28  ZTF23aazxiuu   6.501685  -0.884798
29  ZTF23abbbygf  16.168206  -1.053601
30  ZTF23abbitkh  10.628642   8.028922
31  ZTF23aazxair  14.098124   0.520434
32  ZTF23abapoiv   5.230048  -1.758021
33  ZTF23abbbybs  12.780815  -5.443683
34  ZTF23abaychv  12.394942  -3.037759
35  ZTF23abbjstt  13.706127  -3.710276
36  ZTF23abchvcs  13.272933  -1.453402
37  ZTF23abbjtdn   6.232715   1.033046
38  ZTF23abdhvab  17.532746   2.468053]",,19.059557914733887,2025-05-19T14:39:27,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,7,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.948074102401733,2025-04-29T12:11:30,"[             oid     meanra    meandec
0   ZTF23aaohpnv   8.491958   4.082251
1   ZTF23aapvrkk   0.175006 -12.236802
2   ZTF23aapgxic   7.748520   5.157252
3   ZTF23aapqtxd   8.879058   2.147919
4   ZTF23aarfbvs  11.196881  -2.378468
5   ZTF23aaqixha   8.509318  -9.703939
6   ZTF23aaqixyp   6.388770  -7.758614
7   ZTF23aaumlxn   6.423729  -1.050326
8   ZTF23aapwihe  17.827492   0.742945
9   ZTF23aaretvs  15.263196  -2.912866
10  ZTF23aarfpck   6.464097   2.183000
11  ZTF23aasyvbf   9.411387  -4.281495
12  ZTF23aatzjdo   1.226893 -13.502189
13  ZTF23aavmycb   7.102145   0.441236
14  ZTF23aaaweph   1.307964 -11.502395
15  ZTF23aaaweph   1.307964 -11.502395
16  ZTF23aaxbfzl  16.973081   1.732003
17  ZTF23aaxavca   9.017651   1.801565
18  ZTF23aawqydv  19.468501   0.780816
19  ZTF23aaxavca   9.017651   1.801565
20  ZTF23aaxtrgs   1.760985  -9.567699
21  ZTF23aaxbfyp   4.112309 -10.371170
22  ZTF23abbefkk   9.982778   6.622644
23  ZTF23aazwytj   0.881927 -10.744196
24  ZTF23aaxtdpc   9.048410  -2.151892
25  ZTF23aazxair  14.098124   0.520434
26  ZTF23aazwshk  10.101225   4.791153
27  ZTF23abapoiv   5.230048  -1.758021
28  ZTF23aazxfdh  11.327556  -2.327343
29  ZTF23aazxiuu   6.501685  -0.884798
30  ZTF23abbbygf  16.168206  -1.053601
31  ZTF23abbbybs  12.780815  -5.443683
32  ZTF23abaychv  12.394942  -3.037759
33  ZTF23abbitkh  10.628642   8.028922
34  ZTF23abbjstt  13.706127  -3.710276
35  ZTF23abbjtdn   6.232715   1.033046
36  ZTF23abbkepd  13.835889   5.077601
37  ZTF23abdhvab  17.532746   2.468053
38  ZTF23abchvcs  13.272933  -1.453402]",,23.580984115600582,2025-05-19T14:40:01,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,8,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.944629669189453,2025-04-29T12:11:34,"[             oid     meanra    meandec
0   ZTF23aaohpnv   8.491958   4.082251
1   ZTF23aapvrkk   0.175006 -12.236802
2   ZTF23aapgxic   7.748520   5.157252
3   ZTF23aapqtxd   8.879058   2.147919
4   ZTF23aapwihe  17.827492   0.742945
5   ZTF23aarfbvs  11.196881  -2.378468
6   ZTF23aaqixha   8.509318  -9.703939
7   ZTF23aaqixyp   6.388770  -7.758614
8   ZTF23aaretvs  15.263196  -2.912866
9   ZTF23aasyvbf   9.411387  -4.281495
10  ZTF23aaumlxn   6.423729  -1.050326
11  ZTF23aarfpck   6.464097   2.183000
12  ZTF23aaaweph   1.307964 -11.502395
13  ZTF23aatzjdo   1.226893 -13.502189
14  ZTF23aaaweph   1.307964 -11.502395
15  ZTF23aavmycb   7.102145   0.441236
16  ZTF23aaxbfzl  16.973081   1.732003
17  ZTF23aawqydv  19.468501   0.780816
18  ZTF23aaxavca   9.017651   1.801565
19  ZTF23aaxavca   9.017651   1.801565
20  ZTF23aazxair  14.098124   0.520434
21  ZTF23aaxtdpc   9.048410  -2.151892
22  ZTF23aazwytj   0.881927 -10.744196
23  ZTF23aaxtrgs   1.760985  -9.567699
24  ZTF23aaxbfyp   4.112309 -10.371170
25  ZTF23abapoiv   5.230048  -1.758021
26  ZTF23abbefkk   9.982778   6.622644
27  ZTF23aazwshk  10.101225   4.791153
28  ZTF23aazxfdh  11.327556  -2.327343
29  ZTF23aazxiuu   6.501685  -0.884798
30  ZTF23abbjstt  13.706127  -3.710276
31  ZTF23abbbygf  16.168206  -1.053601
32  ZTF23abbbybs  12.780815  -5.443683
33  ZTF23abaychv  12.394942  -3.037759
34  ZTF23abbitkh  10.628642   8.028922
35  ZTF23abbkepd  13.835889   5.077601
36  ZTF23abdhvab  17.532746   2.468053
37  ZTF23abbjtdn   6.232715   1.033046
38  ZTF23abchvcs  13.272933  -1.453402]",,20.26924443244934,2025-05-19T14:40:32,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,9,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.006241083145142,2025-04-29T12:11:38,"[             oid     meanra    meandec
0   ZTF23aatzjdo   1.226893 -13.502189
1   ZTF23aaumlxn   6.423729  -1.050326
2   ZTF23aasyvbf   9.411387  -4.281495
3   ZTF23aapvrkk   0.175006 -12.236802
4   ZTF23aaohpnv   8.491958   4.082251
5   ZTF23aapgxic   7.748520   5.157252
6   ZTF23aapqtxd   8.879058   2.147919
7   ZTF23aarfbvs  11.196881  -2.378468
8   ZTF23aaqixha   8.509318  -9.703939
9   ZTF23aaqixyp   6.388770  -7.758614
10  ZTF23aapwihe  17.827492   0.742945
11  ZTF23aaretvs  15.263196  -2.912866
12  ZTF23aarfpck   6.464097   2.183000
13  ZTF23aavmycb   7.102145   0.441236
14  ZTF23aaaweph   1.307964 -11.502395
15  ZTF23aaaweph   1.307964 -11.502395
16  ZTF23aawqydv  19.468501   0.780816
17  ZTF23aaxbfzl  16.973081   1.732003
18  ZTF23aaxavca   9.017651   1.801565
19  ZTF23aaxavca   9.017651   1.801565
20  ZTF23aazxfdh  11.327556  -2.327343
21  ZTF23aaxbfyp   4.112309 -10.371170
22  ZTF23aaxtdpc   9.048410  -2.151892
23  ZTF23aazwytj   0.881927 -10.744196
24  ZTF23aazxair  14.098124   0.520434
25  ZTF23aaxtrgs   1.760985  -9.567699
26  ZTF23abbefkk   9.982778   6.622644
27  ZTF23aazwshk  10.101225   4.791153
28  ZTF23aazxiuu   6.501685  -0.884798
29  ZTF23abapoiv   5.230048  -1.758021
30  ZTF23abbbybs  12.780815  -5.443683
31  ZTF23abaychv  12.394942  -3.037759
32  ZTF23abbbygf  16.168206  -1.053601
33  ZTF23abbitkh  10.628642   8.028922
34  ZTF23abbjstt  13.706127  -3.710276
35  ZTF23abchvcs  13.272933  -1.453402
36  ZTF23abbkepd  13.835889   5.077601
37  ZTF23abbjtdn   6.232715   1.033046
38  ZTF23abdhvab  17.532746   2.468053]",,21.12243175506592,2025-05-19T14:41:03,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,10,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.978456974029541,2025-04-29T12:11:42,"[             oid     meanra    meandec
0   ZTF23aaohpnv   8.491958   4.082251
1   ZTF23aapvrkk   0.175006 -12.236802
2   ZTF23aapgxic   7.748520   5.157252
3   ZTF23aavmycb   7.102145   0.441236
4   ZTF23aapqtxd   8.879058   2.147919
5   ZTF23aarfbvs  11.196881  -2.378468
6   ZTF23aaqixha   8.509318  -9.703939
7   ZTF23aaqixyp   6.388770  -7.758614
8   ZTF23aaumlxn   6.423729  -1.050326
9   ZTF23aasyvbf   9.411387  -4.281495
10  ZTF23aaaweph   1.307964 -11.502395
11  ZTF23aaaweph   1.307964 -11.502395
12  ZTF23aapwihe  17.827492   0.742945
13  ZTF23aaretvs  15.263196  -2.912866
14  ZTF23aarfpck   6.464097   2.183000
15  ZTF23aatzjdo   1.226893 -13.502189
16  ZTF23aaxbfzl  16.973081   1.732003
17  ZTF23aaxavca   9.017651   1.801565
18  ZTF23aawqydv  19.468501   0.780816
19  ZTF23aaxavca   9.017651   1.801565
20  ZTF23aaxtrgs   1.760985  -9.567699
21  ZTF23aaxbfyp   4.112309 -10.371170
22  ZTF23aazxfdh  11.327556  -2.327343
23  ZTF23aaxtdpc   9.048410  -2.151892
24  ZTF23aazxair  14.098124   0.520434
25  ZTF23abbefkk   9.982778   6.622644
26  ZTF23aazwshk  10.101225   4.791153
27  ZTF23aazwytj   0.881927 -10.744196
28  ZTF23aazxiuu   6.501685  -0.884798
29  ZTF23abbbygf  16.168206  -1.053601
30  ZTF23abapoiv   5.230048  -1.758021
31  ZTF23abbbybs  12.780815  -5.443683
32  ZTF23abaychv  12.394942  -3.037759
33  ZTF23abbitkh  10.628642   8.028922
34  ZTF23abbjstt  13.706127  -3.710276
35  ZTF23abdhvab  17.532746   2.468053
36  ZTF23abbkepd  13.835889   5.077601
37  ZTF23abbjtdn   6.232715   1.033046
38  ZTF23abchvcs  13.272933  -1.453402]",,20.337087154388428,2025-05-19T14:41:34,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,,,57,0,"WITH catalog (id, obj_ra, obj_dec, r_deg) AS (
VALUES
('id_1', 354.67, 15.954, 0.00833333),
('id_2', 20.7993, 1.00331, 0.00555556)
)
SELECT
    c.id, c.obj_ra, c.obj_dec, r_deg, oid, ndet,
    meanra, meandec, firstmjd
FROM
    catalog AS c, object AS o
WHERE
    q3c_join(c.obj_ra, c.obj_dec, o.meanra, o.meandec, c.r_deg)
ORDER BY lastmjd DESC",,,,,"[     id    obj_ra   obj_dec     r_deg           oid  ndet      meanra  \
0  id_1  354.6700  15.95400  0.008333  ZTF18acfqezx     2  354.671235   
1  id_1  354.6700  15.95400  0.008333  ZTF22acabgbb     1  354.663704   
2  id_1  354.6700  15.95400  0.008333  ZTF20abyptpc    96  354.670313   
3  id_2   20.7993   1.00331  0.005556  ZTF20abywohm    89   20.799247   
4  id_2   20.7993   1.00331  0.005556  ZTF18abqyaix    46   20.799251   

     meandec      firstmjd  
0  15.954552  58431.216979  
1  15.955837  59935.163229  
2  15.954038  59098.360544  
3   1.003320  59073.419086  
4   1.003313  59073.419086  ]",,4.1273193359375,2025-05-19T14:41:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,57,1,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd,
        i.identifier, 
        i.ra AS input_ra, 
        i.dec AS input_dec, 
        i.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects i
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(o.meandec)) * SIN(RADIANS(i.dec)) + COS(RADIANS(o.meandec)) * COS(RADIANS(i.dec)) * COS(RADIANS(o.meanra - i.ra)))) <= i.search_radius)
)
SELECT 
    identifier, 
    input_ra AS ra, 
    input_dec AS dec, 
    search_radius, 
    oid AS ztf_identifier, 
    ndet AS number_of_detections, 
    meanra AS mean_ra, 
    meandec AS mean_dec, 
    firstmjd AS first_detection_date
FROM 
    ztf_objects
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,42.59938836097717,2025-04-29T12:12:25,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,204.81985116004944,2025-05-19T14:45:12,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,2,"
WITH distance_calculation AS (
    SELECT 
        oid,
        meanra,
        meandec,
        ndet,
        firstmjd,
        lastmjd,
        -- Calculate distance from id_1
        DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 354.67)))) * 3600 AS distance_id_1,
        -- Calculate distance from id_2
        DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 20.7993)))) * 3600 AS distance_id_2
    FROM 
        object
),
filtered_objects AS (
    SELECT 
        oid,
        meanra,
        meandec,
        ndet,
        firstmjd,
        lastmjd
    FROM 
        distance_calculation
    WHERE 
        distance_id_1 <= 30 OR distance_id_2 <= 20
)
SELECT 
    'id_1' AS input_identifier,
    354.67 AS input_ra,
    15.954 AS input_dec,
    30/3600.0 AS search_radius_deg,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
WHERE 
    DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30

UNION

SELECT 
    'id_2' AS input_identifier,
    20.7993 AS input_ra,
    1.00331 AS input_dec,
    20/3600.0 AS search_radius_deg,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
WHERE 
    DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,26.44642853736877,2025-04-29T12:12:51,[None],"(psycopg2.errors.UndefinedColumn) column ""mjdendhist"" does not exist
LINE 62:     mjdendhist DESC -- Corrected column name from lastmjd to...
             ^

[SQL: 
WITH distance_calculation AS (
    SELECT 
        oid,
        meanra,
        meandec,
        ndet,
        firstmjd,
        mjdendhist, -- Corrected column name from lastmjd to mjdendhist
        -- Calculate distance from id_1
        DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 354.67)))) * 3600 AS distance_id_1,
        -- Calculate distance from id_2
        DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 20.7993)))) * 3600 AS distance_id_2
    FROM 
        object
),
filtered_objects AS (
    SELECT 
        oid,
        meanra,
        meandec,
        ndet,
        firstmjd,
        mjdendhist -- Corrected column name from lastmjd to mjdendhist
    FROM 
        distance_calculation
    WHERE 
        distance_id_1 <= 30 OR distance_id_2 <= 20
)
SELECT 
    'id_1' AS input_identifier,
    354.67 AS input_ra,
    15.954 AS input_dec,
    30/3600.0 AS search_radius_deg,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
WHERE 
    DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30

UNION

SELECT 
    'id_2' AS input_identifier,
    20.7993 AS input_ra,
    1.00331 AS input_dec,
    20/3600.0 AS search_radius_deg,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
WHERE 
    DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20
ORDER BY 
    mjdendhist DESC -- Corrected column name from lastmjd to mjdendhist
]
(Background on this error at: https://sqlalche.me/e/20/f405)",15.86721420288086,2025-05-19T14:45:34,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,57,3,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
nearby_objects AS (
    SELECT 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd,
        io.identifier, 
        io.ra AS input_ra, 
        io.dec AS input_dec, 
        io.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects io
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(io.dec)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(io.dec)) * COS(RADIANS(o.meandec)) * COS(RADIANS(io.ra - o.meanra)))) <= io.search_radius)
)
SELECT 
    identifier, 
    input_ra AS ra, 
    input_dec AS dec, 
    search_radius, 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd
FROM 
    nearby_objects
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.21096420288086,2025-04-29T12:13:14,"[  identifier        ra       dec  search_radius           oid  ndet  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx     2   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb     1   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc    96   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm    89   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix    46   

       meanra    meandec      firstmjd  
0  354.671235  15.954552  58431.216979  
1  354.663704  15.955837  59935.163229  
2  354.670313  15.954038  59098.360544  
3   20.799247   1.003320  59073.419086  
4   20.799251   1.003313  59073.419086  ]",,160.8648407459259,2025-05-19T14:48:21,1.0,1.0,0.5555555555555556,0.5555555555555556,1.0,0.0
0.16.3,gpt-4o,v1,57,4,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
filtered_objects AS (
    SELECT 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd,
        io.identifier, 
        io.ra AS input_ra, 
        io.dec AS input_dec, 
        io.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects io
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(io.dec)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(io.dec)) * COS(RADIANS(o.meandec)) * COS(RADIANS(io.ra - o.meanra)))) <= io.search_radius)
)
SELECT 
    fo.identifier, 
    fo.input_ra AS ra, 
    fo.input_dec AS dec, 
    fo.search_radius, 
    fo.oid AS ztf_identifier, 
    fo.ndet AS number_of_detections, 
    fo.meanra AS mean_ra, 
    fo.meandec AS mean_dec, 
    fo.firstmjd AS first_detection_date
FROM 
    filtered_objects fo
ORDER BY 
    fo.lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,20.540930032730103,2025-04-29T12:13:35,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,161.57007122039795,2025-05-19T14:51:08,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,5,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date
    FROM 
        object o
    JOIN 
        input_objects io
    ON 
        (acos(sin(radians(io.dec)) * sin(radians(o.meandec)) + cos(radians(io.dec)) * cos(radians(o.meandec)) * cos(radians(io.ra - o.meanra))) * 180/pi()) <= io.search_radius
)
SELECT 
    io.identifier,
    io.ra AS input_ra,
    io.dec AS input_dec,
    io.search_radius,
    ztf.ztf_identifier,
    ztf.number_of_detections,
    ztf.mean_ra,
    ztf.mean_dec,
    ztf.first_detection_date
FROM 
    input_objects io
JOIN 
    ztf_objects ztf
ON 
    true
ORDER BY 
    ztf.last_detection_date DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.944085597991943,2025-04-29T12:13:57,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date
    FROM 
        object o
    WHERE EXISTS (
        SELECT 1
        FROM input_objects io
        WHERE (acos(sin(radians(io.dec)) * sin(radians(o.meandec)) + cos(radians(io.dec)) * cos(radians(o.meandec)) * cos(radians(io.ra - o.meanra))) * 180/pi()) <= io.search_radius
    )
)
SELECT 
    io.identifier,
    io.ra AS input_ra,
    io.dec AS input_dec,
    io.search_radius,
    ztf.ztf_identifier,
    ztf.number_of_detections,
    ztf.mean_ra,
    ztf.mean_dec,
    ztf.first_detection_date
FROM 
    input_objects io
JOIN 
    ztf_objects ztf
ON 
    true
ORDER BY 
    ztf.last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.0459039211273,2025-05-19T14:55:26,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,57,6,"
WITH id_1_objects AS (
    SELECT 
        oid, 
        meanra, 
        meandec, 
        ndet, 
        firstmjd, 
        lastmjd,
        (2 * asin(sqrt(sin(radians((meandec - 15.954) / 2))^2 + cos(radians(15.954)) * cos(radians(meandec)) * sin(radians((meanra - 354.67) / 2))^2))) * 180/pi() * 3600 AS distance_arcsec
    FROM 
        object
    WHERE 
        (2 * asin(sqrt(sin(radians((meandec - 15.954) / 2))^2 + cos(radians(15.954)) * cos(radians(meandec)) * sin(radians((meanra - 354.67) / 2))^2))) * 180/pi() * 3600 <= 30
),
id_2_objects AS (
    SELECT 
        oid, 
        meanra, 
        meandec, 
        ndet, 
        firstmjd, 
        lastmjd,
        (2 * asin(sqrt(sin(radians((meandec - 1.00331) / 2))^2 + cos(radians(1.00331)) * cos(radians(meandec)) * sin(radians((meanra - 20.7993) / 2))^2))) * 180/pi() * 3600 AS distance_arcsec
    FROM 
        object
    WHERE 
        (2 * asin(sqrt(sin(radians((meandec - 1.00331) / 2))^2 + cos(radians(1.00331)) * cos(radians(meandec)) * sin(radians((meanra - 20.7993) / 2))^2))) * 180/pi() * 3600 <= 20
),
combined_objects AS (
    SELECT * FROM id_1_objects
    UNION
    SELECT * FROM id_2_objects
)
SELECT 
    'id_1' AS input_identifier,
    354.67 AS input_ra,
    15.954 AS input_dec,
    30/3600.0 AS search_radius_deg,
    co.oid AS ztf_identifier,
    co.ndet AS number_of_detections,
    co.meanra AS mean_ra,
    co.meandec AS mean_dec,
    co.firstmjd AS first_detection_date
FROM 
    combined_objects co
ORDER BY 
    co.lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.898033380508423,2025-04-29T12:14:23,"[  input_identifier  input_ra  input_dec  search_radius_deg           oid  \
0             id_1    354.67     15.954           0.008333  ZTF18acfqezx   
1             id_1    354.67     15.954           0.008333  ZTF22acabgbb   
2             id_1    354.67     15.954           0.008333  ZTF20abyptpc   
3             id_1    354.67     15.954           0.008333  ZTF20abywohm   
4             id_1    354.67     15.954           0.008333  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,59.38972616195679,2025-05-19T14:56:31,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,7,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd,
        io.identifier AS input_identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects io
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(io.dec)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(io.dec)) * COS(RADIANS(o.meandec)) * COS(RADIANS(io.ra - o.meanra)))) <= io.search_radius)
)
SELECT 
    input_identifier AS identifier,
    input_ra AS ra,
    input_dec AS dec,
    search_radius,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    ztf_objects
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,27.32415270805359,2025-04-29T12:14:51,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,160.53618168830872,2025-05-19T14:59:18,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,8,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
filtered_objects AS (
    SELECT 
        o.oid, 
        o.meanra, 
        o.meandec, 
        o.ndet, 
        o.firstmjd, 
        o.lastmjd,
        io.identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects io
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(io.dec)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(io.dec)) * COS(RADIANS(o.meandec)) * COS(RADIANS(io.ra - o.meanra)))) <= io.search_radius)
)
SELECT 
    identifier,
    input_ra AS ra,
    input_dec AS dec,
    search_radius,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.372729063034058,2025-04-29T12:15:14,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,161.32847380638125,2025-05-19T15:02:05,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,9,"
WITH id_1_objects AS (
    SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
    FROM object
    WHERE (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600) <= 30
),
id_2_objects AS (
    SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
    FROM object
    WHERE (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600) <= 20
),
combined_objects AS (
    SELECT * FROM id_1_objects
    UNION
    SELECT * FROM id_2_objects
)
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    co.oid AS ztf_identifier, co.ndet AS number_of_detections, 
    co.meanra AS mean_ra, co.meandec AS mean_dec, 
    co.firstmjd AS first_detection_date
FROM combined_objects co
ORDER BY co.lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.021767616271973,2025-04-29T12:15:37,"[  input_identifier  input_ra  input_dec  search_radius_deg           oid  \
0             id_1  354.6700   15.95400           0.008333  ZTF18acfqezx   
1             id_1  354.6700   15.95400           0.008333  ZTF22acabgbb   
2             id_1  354.6700   15.95400           0.008333  ZTF20abyptpc   
3             id_2   20.7993    1.00331           0.005556  ZTF20abywohm   
4             id_2   20.7993    1.00331           0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,98.13261294364928,2025-05-19T15:03:49,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,10,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date,
        i.identifier,
        i.ra AS input_ra,
        i.dec AS input_dec,
        i.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects i
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(o.meandec)) * SIN(RADIANS(i.dec)) + COS(RADIANS(o.meandec)) * COS(RADIANS(i.dec)) * COS(RADIANS(o.meanra - i.ra)))) <= i.search_radius)
)
SELECT 
    identifier,
    input_ra AS ra,
    input_dec AS dec,
    search_radius,
    ztf_identifier,
    number_of_detections,
    mean_ra,
    mean_dec,
    first_detection_date
FROM 
    ztf_objects
ORDER BY 
    last_detection_date DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.898801803588867,2025-04-29T12:15:56,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,160.30252170562744,2025-05-19T15:06:35,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,,,75,0,"SELECT
    *
FROM
    ss_ztf
WHERE
    ssnamenr != 'null'
LIMIT 100",,,,,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF19abxgnls   978299663015015029       0.0     19.0   165003
96  ZTF19abxgnlv   978299666115015019       0.0     18.6    22372
97  ZTF19abxgnvm   978299665915015007       0.0     18.6    70052
98  ZTF19abxgnyg   978299665615015026       0.0     18.1    47269
99  ZTF19abxgobf   978300113215015003       0.0     18.6   151419

[100 rows x 5 columns]]",,3.588672876358032,2025-05-19T15:06:41,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,75,1,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.0303070545196533,2025-04-29T12:15:58,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,9.163937330245972,2025-05-19T15:06:57,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,2,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.227222204208374,2025-04-29T12:16:01,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,8.83754014968872,2025-05-19T15:07:12,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,3,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.4657740592956543,2025-04-29T12:16:03,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,10.36057710647583,2025-05-19T15:07:28,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,4,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.3090202808380127,2025-04-29T12:16:06,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,8.820140600204468,2025-05-19T15:07:42,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,5,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.3580243587493896,2025-04-29T12:16:08,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,8.564531564712524,2025-05-19T15:07:57,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,6,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.798748254776001,2025-04-29T12:16:11,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,9.65537691116333,2025-05-19T15:08:12,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,7,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,5.494010210037232,2025-04-29T12:16:17,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,9.530295848846436,2025-05-19T15:08:27,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,8,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.9541432857513428,2025-04-29T12:16:20,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,8.839513063430786,2025-05-19T15:08:42,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,9,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,4.195446968078613,2025-04-29T12:16:24,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,9.782940864562988,2025-05-19T15:08:57,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,10,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.882386922836304,2025-04-29T12:16:27,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,8.565168619155884,2025-05-19T15:09:11,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,,,43,0,"SELECT
    oid, candid, xpos, ypos, scorr
FROM
    dataquality
WHERE
    oid IN ('ZTF20acwrybw','ZTF22abugigx')
    AND fid = 2",,,,,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,3.7234983444213863,2025-05-19T15:09:17,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,1,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx')
  AND fid = 2  -- Filter for r-band
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.901644229888916,2025-04-29T12:16:40,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.64674949645996,2025-05-19T15:09:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,2,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.765151023864746,2025-04-29T12:16:54,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.41102409362793,2025-05-19T15:09:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,3,"
-- Query to retrieve r-band epochs for specified ZTF identifiers from the dataquality table
SELECT 
    dq.oid,          -- ZTF identifier
    dq.candid,       -- Candidate identifier
    dq.xpos,         -- X-image position
    dq.ypos,         -- Y-image position
    dq.scorr         -- Peak-pixel signal-to-noise ratio
FROM 
    dataquality dq
INNER JOIN 
    object o ON dq.oid = o.oid
WHERE 
    dq.fid = 2       -- Filter for r-band
    AND dq.oid IN ('ZTF20acwrybw', 'ZTF22abugigx') -- Filter for specified ZTF identifiers
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.559078216552734,2025-04-29T12:17:06,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.830127954483032,2025-05-19T15:10:04,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,4,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,15.066186666488647,2025-04-29T12:17:21,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,8.680962562561035,2025-05-19T15:10:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,5,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.80086064338684,2025-04-29T12:17:35,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.449154615402222,2025-05-19T15:10:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,6,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,16.79169273376465,2025-04-29T12:17:52,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,8.975782632827759,2025-05-19T15:10:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,7,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.864027738571169,2025-04-29T12:18:06,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.53909420967102,2025-05-19T15:11:04,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,8,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') 
  AND fid = 2  -- Filter for r-band observations
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.126296758651732,2025-04-29T12:18:18,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,10.37638521194458,2025-05-19T15:11:20,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,9,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.849597215652466,2025-04-29T12:18:30,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.444186210632324,2025-05-19T15:11:35,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,10,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE fid = 2
AND oid IN ('ZTF20acwrybw', 'ZTF22abugigx')
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.844850778579712,2025-04-29T12:18:43,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.562256813049316,2025-05-19T15:11:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,89,0,"SELECT
    *
FROM
    dataquality
WHERE
    oid in
(
SELECT
    oid
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'SN'
    AND probability > 0.7
LIMIT 50
)",,,,,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF18acdwbaz   673537544115015012    1   709.5567  1661.6480  2.027854   
1    ZTF18acdwbaz   676528904115015008    1   712.3257  1670.6439  1.987450   
2    ZTF18acdxqut   674211515915015000    1  1681.7228   141.0574  1.083098   
3    ZTF18acegmfb   675086715015015192    2  2719.5066  1896.5934  4.250494   
4    ZTF18acegmfb   943380905015015086    2  2779.8765  1823.8898  8.435654   
..            ...                  ...  ...        ...        ...       ...   
326  ZTF20aakodol  1152522884715025002    1   627.3890  1301.2200  0.803935   
327  ZTF20aakodol  1157497264715015007    2   604.9568  1313.9073  0.755228   
328  ZTF20aakodol  1160481484715015004    1   614.7220  1297.0100  1.348870   
329  ZTF20aakodol  1160519024715015015    2   612.1415  1297.8774  1.100947   
330  ZTF18acdxncl   674199991015015008    1   605.3236   534.9726  7.233617   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   -0.149502  3.640000     0.952    709.5567  ...     0.000039     0.042994   
1   -0.206371  2.890000     0.968    712.3257  ...     0.000023     0.034294   
2   -0.213511  3.560000     0.842    141.0574  ...     0.000020     0.037380   
3    1.987608  1.194705     0.997    352.9935  ...     0.000005     0.027519   
4    1.545690  3.020000     0.929    292.6235  ...     0.000002     0.021096   
..        ...       ...       ...         ...  ...          ...          ...   
326  0.066540  5.380000     0.519    627.3890  ...     0.000017     0.037412   
327 -0.132717  3.560000     0.534    604.9568  ...     0.000009     0.047133   
328  0.556310  2.350000     0.959    614.7220  ...     0.000011     0.031838   
329  0.297612  1.810000     0.976    612.1415  ...     0.000006     0.041995   
330  0.549895  1.860000     0.983    534.9726  ...     0.000025     0.037103   

     nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0       207.0 -0.072322  0.000067 -0.000047  26.1780   0.628  0.311797   
1       213.0 -0.058934  0.000038 -0.000027  26.1800   0.630  0.319190   
2       336.0 -0.062246  0.000029 -0.000022  26.2435   0.717  0.321442   
3      1998.0  0.101051  0.000011 -0.000007  26.3340   0.630  0.152404   
4      2029.0  0.094315  0.000005 -0.000004  26.2510   0.623  0.149834   
..        ...       ...       ...       ...      ...     ...       ...   
326       NaN -0.081786  0.000035       NaN      NaN     NaN       NaN   
327     542.0  0.117271  0.000017 -0.000011  26.3590   0.571  0.312159   
328       NaN -0.045579  0.000021       NaN      NaN     NaN       NaN   
329     543.0  0.109494  0.000011 -0.000007  26.3630   0.572  0.314149   
330     242.0 -0.072000  0.000030 -0.000025  26.2355   0.855  0.333310   

     exptime  
0       30.0  
1       30.0  
2       30.0  
3       30.0  
4       30.0  
..       ...  
326      NaN  
327     30.0  
328      NaN  
329     30.0  
330     30.0  

[331 rows x 32 columns]]",,4.485183954238892,2025-05-19T15:11:56,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,89,1,"
-- Retrieve all columns from the 'dataquality' table for ZTF objects with a probability greater than 0.7 of being supernovae in the 'stamp_classifier'
SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.89173674583435,2025-04-29T12:18:56,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF18acepwhb  3035293994215010006    1  1799.1951  1430.3015  1.422107   
1   ZTF18acepwhb  3006362934215010005    1  1816.9524  1388.3185  1.322618   
2   ZTF18acepwhb  3000301584215010003    1  1793.7170  1437.9727  0.932530   
3   ZTF18acepwhb  2971283044215010002    1  1805.4958  1387.0756  1.102425   
4   ZTF18acepwhb   733538924215015011    2  1748.7603  1410.4648  1.821868   
5   ZTF18acepwhb  1140200014215010006    1  1799.3862  1322.9138  0.967421   
6   ZTF18acepwhb  1395493334215010002    1  1790.6500  1333.5900  1.153400   
7   ZTF18acepwhb   689426204215015002    2  1772.0754  1330.1783  3.531938   
8   ZTF18acepwhb   722505354215015006    2  1756.1020  1368.1593  1.639529   
9   ZTF18acepwhb   718421214215015004    2  1768.5230  1336.3529  4.946634   
10  ZTF18acepwhb  1414494014215010000    1  1828.9562  1363.4049  1.110666   
11  ZTF18acepwhb  1444368814215010004    1  1781.4800  1339.6700  1.040390   
12  ZTF18acepwhb  1035512294215010009    1  1825.2100  1265.2300  1.198770   
13  ZTF18acepwhb  1144280964215010008    1  1809.1200  1288.4500  1.126210   
14  ZTF18acepwhb  1095508784215010016    1  1787.5690  1352.3339  1.277958   
15  ZTF18acepwhb  1101471254215010029    1  1784.8700  1331.5400  1.381810   
16  ZTF18acepwhb  1218236904215010002    1  1812.4500  1292.0900  0.927878   
17  ZTF18acepwhb  1419473844215020003    1  1825.8200  1333.9500  0.717675   
18  ZTF18acepwhb  1201309614215010009    1  1792.4702  1339.2358  1.493032   
19  ZTF18acepwhb  1473445874215010003    1  1808.9100  1411.0000  1.519380   
20  ZTF18acepwhb  1150303204215010010    1  1796.6770  1326.3638  1.438502   
21  ZTF18acepwhb   740447504215015004    2  1746.0465  1389.6224  1.798760   
22  ZTF18acepwhb   863206794215010001    1  1779.5900  1287.6300  1.021470   
23  ZTF18acepwhb  1439470774215010003    1  1815.3500  1396.1500  0.859456   
24  ZTF18acepwhb   883255524215010006    1  1767.1259  1273.4832  1.114801   
25  ZTF18acepwhb  1232199104215010002    1  1813.2054  1283.2985  1.048380   
26  ZTF18acepwhb  1141194184215010008    1  1799.3700  1266.6100  1.340250   
27  ZTF18acepwhb  1127240794215010003    1  1822.9200  1269.4700  1.124250   
28  ZTF18acepwhb  1119367474215010008    1  1808.4735  1325.6104  1.483667   
29  ZTF18acepwhb   696529294215015004    2  1749.0598  1379.6888  7.783030   
30  ZTF18acepwhb   714535604215015009    2  1770.3113  1354.0288  3.648279   
31  ZTF18acepwhb  1212261034215010001    1  1802.3000  1304.7300  1.506080   
32  ZTF18acepwhb  1266207224215010000    1  1819.0790  1297.4062  1.593329   
33  ZTF18acepwhb  1241307694215010001    1  1802.7800  1279.6800  1.012890   
34  ZTF18acepwhb  1118425794215010004    1  1796.5721  1326.9830  1.581544   
35  ZTF18acepwhb  1397497194215010002    1  1824.0600  1337.1400  0.754927   
36  ZTF18acepwhb  1247366114215010003    1  1817.8800  1222.4300  0.791909   
37  ZTF18acepwhb   898193324215010002    1  1806.9100  1272.1200  1.212430   
38  ZTF18acepwhb   696490404215015002    1  1771.0290  1368.5430  7.296356   
39  ZTF18acepwhb  1058428984215010006    1  1803.8599  1300.9244  1.000966   
40  ZTF18acepwhb  1121433904215010013    1  1784.7535  1315.0978  1.142668   
41  ZTF18acepwhb  1126450554215010012    1  1793.6100  1332.7100  1.035430   
42  ZTF18acepwhb   678548334215015009    2  1754.0398  1375.3625  2.323662   
43  ZTF18acepwhb  1209218124215010005    1  1805.8673  1299.4221  1.968249   
44  ZTF18acepwhb   855206604215010011    1  1758.5800  1299.9200  1.111440   
45  ZTF18acepwhb  1411512244215010003    1  1807.7849  1367.6812  1.205262   
46  ZTF18acepwhb  1463436304215010000    1  1796.1800  1412.3400  0.920178   
47  ZTF18acepwhb  1113432674215010012    1  1791.6400  1333.8200  1.259460   
48  ZTF18acepwhb  1124261624215010002    1  1802.8800  1299.5000  1.221680   
49  ZTF18acepwhb   686556204215015005    2  1757.6821  1377.9930  8.376562   

         sky     fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.063254  2.42000     0.944   1273.3049  ...     0.000015     0.039846   
1  -0.062739  2.06000     0.983   1255.5476  ...     0.000010     0.038418   
2   0.267832  1.91000     0.960   1278.7830  ...     0.000013     0.036146   
3  -0.352399  2.66000     0.984   1267.0042  ...     0.000013     0.037951   
4   0.286352  2.60000     0.979   1323.7397  ...     0.000008     0.040395   
5  -0.034452  2.31000     0.959   1273.1138  ...     0.000013     0.042609   
6   0.096318  2.80000     0.536   1281.8500  ...     0.000023     0.037294   
7   1.121081  1.93000     0.983   1300.4246  ...     0.000012     0.042946   
8   0.655342  1.93000     0.983   1316.3980  ...     0.000009     0.040862   
9   0.559485  2.08000     0.996   1303.9770  ...     0.000009     0.039873   
10 -0.309576  3.28000     0.886   1243.5438  ...     0.000016     0.038296   
11  0.211259  6.16000     0.579   1291.0200  ...     0.000024     0.038100   
12 -0.364919  1.62000     0.752   1247.2900  ...     0.000021     0.035886   
13  0.154182  3.71000     0.840   1263.3800  ...     0.000026     0.040858   
14 -1.167474  2.56000     0.925   1284.9310  ...     0.000017     0.047380   
15 -3.513330  3.54000     0.934   1287.6300  ...     0.000018     0.033434   
16 -0.268899  1.26030     0.878   1260.0500  ...     0.000019     0.033365   
17 -0.072547  2.32000     0.793   1246.6800  ...     0.000071     0.065623   
18 -0.183099  3.09000     0.949   1280.0298  ...     0.000016     0.043772   
19  0.144828  2.76000     0.867   1263.5900  ...     0.000015     0.031145   
20 -0.302671  2.38000     0.955   1275.8230  ...     0.000020     0.046891   
21  0.239482  2.23000     0.979   1326.4535  ...     0.000008     0.038260   
22 -0.525577  2.35000     0.960   1287.6300  ...     0.000000     0.000000   
23  0.384318  4.48000     0.576   1257.1500  ...     0.000043     0.050056   
24  0.055436  2.28000     0.737   1273.4832  ...     0.000016     0.040714   
25 -0.237323  2.60000     0.977   1259.2946  ...     0.000014     0.038576   
26 -0.184348  2.34000     0.934   1266.6100  ...     0.000020     0.035035   
27 -0.010099  2.35000     0.607   1249.5800  ...     0.000025     0.037069   
28  0.064032  2.71000     0.943   1264.0265  ...     0.000018     0.047318   
29  0.321977  2.03000     0.983   1323.4402  ...     0.000008     0.039153   
30  0.484341  2.07000     0.983   1302.1887  ...     0.000007     0.039167   
31 -0.013483  1.46000     0.729   1270.2000  ...     0.000032     0.044024   
32 -0.159795  2.65000     0.930   1253.4210  ...     0.000018     0.042462   
33 -0.027850  2.30000     0.961   1269.7200  ...     0.000014     0.030149   
34 -0.250713  2.56000     0.918   1275.9279  ...     0.000017     0.047624   
35  0.447590  3.19000     0.736   1248.4400  ...     0.000028     0.039557   
36 -0.734995  2.28000     0.953   1222.4300  ...     0.000023     0.036350   
37 -0.152141  1.22472     0.941   1265.5900  ...     0.000026     0.037518   
38 -0.217568  2.21000     0.983   1301.4710  ...     0.000016     0.038585   
39  0.167236  2.78000     0.751   1268.6401  ...     0.000019     0.042881   
40  0.152025  4.31000     0.879   1287.7465  ...     0.000028     0.055723   
41 -0.396766  3.02000     0.919   1278.8900  ...     0.000020     0.035218   
42  0.542015  2.29000     0.983   1318.4602  ...     0.000008     0.038416   
43 -0.080353  2.60000     0.975   1266.6327  ...     0.000013     0.037847   
44 -0.029618  2.90000     0.610   1299.9200  ...     0.000000     0.000000   
45  0.033038  2.17000     0.962   1264.7151  ...     0.000012     0.038740   
46  0.592508  1.30220     0.755   1276.3200  ...     0.000018     0.032956   
47  0.487138  3.19000     0.701   1280.8600  ...     0.000021     0.036187   
48 -0.274796  3.03761     0.019   1269.6200  ...     0.000061     0.046635   
49  0.389691  1.87000     0.983   1314.8179  ...     0.000008     0.039485   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0      453.0 -0.081869  0.000023 -0.000017  26.2340   0.649  0.303471     30.0  
1      449.0 -0.095480  0.000016 -0.000012  26.2510   0.654  0.302961     30.0  
2      448.0 -0.071043  0.000021 -0.000016  26.1950   0.635  0.300133     30.0  
3      441.0 -0.084584  0.000020 -0.000015  26.2070   0.626  0.298816     30.0  
4      454.0  0.108265  0.000013 -0.000010  26.3900   0.652  0.305234     30.0  
5      456.0 -0.102039  0.000020 -0.000015  26.1840   0.658  0.303260     30.0  
6        NaN -0.080619  0.000039       NaN      NaN     NaN       NaN      NaN  
7      458.0  0.106377  0.000018 -0.000014  26.3340   0.663  0.305686     30.0  
8      458.0  0.107468  0.000014 -0.000010  26.3820   0.665  0.305938     30.0  
9      457.0  0.103292  0.000014 -0.000011  26.3930   0.663  0.304618     30.0  
10     452.0 -0.070671  0.000024 -0.000018  26.3050   0.652  0.302768     30.0  
11       NaN -0.093708  0.000040       NaN      NaN     NaN       NaN      NaN  
12       NaN -0.099859  0.000032       NaN      NaN     NaN       NaN      NaN  
13       NaN -0.100333  0.000041       NaN      NaN     NaN       NaN      NaN  
14     462.0 -0.109814  0.000026 -0.000020  26.2725   0.663  0.305396     30.0  
15       NaN -0.073705  0.000030       NaN      NaN     NaN       NaN      NaN  
16       NaN -0.083475  0.000031       NaN      NaN     NaN       NaN      NaN  
17       NaN -0.055152  0.000118       NaN      NaN     NaN       NaN      NaN  
18     455.0 -0.097572  0.000025 -0.000018  26.2230   0.655  0.303904     30.0  
19       NaN -0.083783  0.000023       NaN      NaN     NaN       NaN      NaN  
20     455.0 -0.098178  0.000031 -0.000023  26.2050   0.655  0.303587     30.0  
21     455.0  0.102285  0.000011 -0.000009  26.3610   0.660  0.305454     30.0  
22       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
23       NaN -0.071955  0.000075       NaN      NaN     NaN       NaN      NaN  
24     450.0 -0.084185  0.000024 -0.000018  26.0250   0.661  0.303692     30.0  
25     457.0 -0.078745  0.000022 -0.000016  26.2330   0.654  0.303163     30.0  
26       NaN -0.091982  0.000031       NaN      NaN     NaN       NaN      NaN  
27       NaN -0.063156  0.000044       NaN      NaN     NaN       NaN      NaN  
28     455.0 -0.109182  0.000028 -0.000021  26.2380   0.654  0.302421     30.0  
29     459.0  0.104967  0.000012 -0.000009  26.3870   0.662  0.305037     30.0  
30     461.0  0.106872  0.000011 -0.000008  26.3850   0.663  0.305278     30.0  
31       NaN -0.064060  0.000054       NaN      NaN     NaN       NaN      NaN  
32     451.0 -0.084096  0.000028 -0.000021  26.2210   0.650  0.302328     30.0  
33       NaN -0.074691  0.000022       NaN      NaN     NaN       NaN      NaN  
34     458.0 -0.112659  0.000026 -0.000019  26.0960   0.661  0.304590     30.0  
35       NaN -0.061409  0.000049       NaN      NaN     NaN       NaN      NaN  
36       NaN -0.050137  0.000038       NaN      NaN     NaN       NaN      NaN  
37       NaN -0.065991  0.000048       NaN      NaN     NaN       NaN      NaN  
38     438.0 -0.074462  0.000025 -0.000018  26.2365   0.633  0.300035     30.0  
39     446.0 -0.083294  0.000030 -0.000022  26.0660   0.635  0.300221     30.0  
40     446.0 -0.119896  0.000043 -0.000032  26.2385   0.652  0.304151     30.0  
41       NaN -0.077390  0.000030       NaN      NaN     NaN       NaN      NaN  
42     458.0  0.101474  0.000012 -0.000009  26.3710   0.663  0.304966     30.0  
43     453.0 -0.079465  0.000021 -0.000015  26.2100   0.650  0.302299     30.0  
44       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
45     459.0 -0.087854  0.000019 -0.000014  26.3040   0.650  0.303342     30.0  
46       NaN -0.096531  0.000031       NaN      NaN     NaN       NaN      NaN  
47       NaN -0.083709  0.000032       NaN      NaN     NaN       NaN      NaN  
48       NaN -0.078621  0.000129       NaN      NaN     NaN       NaN      NaN  
49     457.0  0.104272  0.000013 -0.000010  26.3660   0.662  0.304993     30.0  

[50 rows x 32 columns]]",,10.469695568084717,2025-05-19T15:12:15,0.1612903225806451,2.24,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,2,"
-- Select all columns from the dataquality table for ZTF objects with a probability greater than 0.7 of being supernovae
SELECT dq.*
FROM dataquality dq
INNER JOIN probability p ON dq.oid = p.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.931897163391112,2025-04-29T12:19:10,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF19aaejtrn   753557091215015003    1   324.4111   624.3238  1.818290   
1   ZTF19aaejtrn   772540331215015007    2   314.1729   636.0852  0.999778   
2   ZTF19aaejtrn   757503951215015003    1   322.1801   581.3360  1.330184   
3   ZTF19aaejtrn   757545101215015000    2   321.0790   589.8533  0.904400   
4   ZTF19aaejtrn   793523661215015019    2   317.9175   630.7490  1.624912   
5   ZTF19aaejtrn   752526621215015000    1   308.2440   636.5660  0.950449   
6   ZTF19acmxeyg  1035502334515015007    1   813.5280  2810.3100  1.070520   
7   ZTF19acmxeyg  1035524514515015006    2   807.9399  2816.1208  1.234947   
8   ZTF19aauoisv   884448516315015009    1  1287.4400  1523.3800  1.424640   
9   ZTF19aauoisv   899446626315015006    2  1334.2325  1529.9176  1.286916   
10  ZTF19aauoisv   915423886315015010    2  1330.7184  1592.0615  1.156705   
11  ZTF19aauoisv   903433596315015008    2  1335.1404  1395.8328  1.241645   
12  ZTF19aauoisv   918469526315015016    2  1347.3398  1564.6950  1.866209   
13  ZTF19aauoisv   906443846315015008    1  1328.7700  1389.4100  1.108980   
14  ZTF19aauoisv   946448426315015016    2  1361.7568  1564.0824  1.533073   
15  ZTF19aauoisv   887475786315015009    2  1318.6685  1507.6003  2.196493   
16  ZTF19aauoisv   924470286315015027    2  1323.8295  1569.0566  1.239544   
17  ZTF19aauoisv   887449406315015012    1  1334.1908  1495.2416  0.888079   
18  ZTF19aauoisv   940406216315015010    2  1369.2100  1568.8300  0.970180   
19  ZTF19aauoisv   912435156315015011    2  1335.5345  1394.1082  1.856381   
20  ZTF19aauoisv   915469976315015010    1  1343.0700  1601.9000  1.052770   
21  ZTF19aauoisv   896435636315015004    2  1350.2690  1498.7164  1.211335   
22  ZTF19aauoisv   937403256315015009    2  1359.5500  1548.0500  1.397650   
23  ZTF19aauoisv   909463766315015015    1  1324.1700  1419.6300  1.289790   
24  ZTF19aauoisv   918432856315015013    1  1350.9300  1555.0300  1.216500   
25  ZTF19aauoisv   943408076315015034    2  1346.9486  1570.0806  0.818075   
26  ZTF19aauoisv   909437536315015005    2  1336.1100  1409.3700  1.590790   
27  ZTF19aauoisv   881403146315015014    2  1247.7401  1520.2694  1.239598   
28  ZTF19aauoisv   890450376315015008    1  1343.1800  1510.3600  0.950336   
29  ZTF19aauoisv   884475816315015009    2  1300.3400  1523.0600  0.784217   
30  ZTF19aaupvqe   862293984415015002    2  2126.2021   768.5243  3.024125   
31  ZTF19aaehfio   753258493615015102    2  2299.9172  2724.9985  1.260840   
32  ZTF19acngjwj  1036197653315015033    2  1718.8647  1996.5663  1.967310   
33  ZTF19acngokx  1036199503715015016    2   492.1387  2811.4200  6.478342   
34  ZTF20abgoxbw  1266263700415015006    2  2149.4463  1732.3878  3.434562   
35  ZTF19aaeomsn   813248636015015017    2   567.6623  1401.3966  1.740267   
36  ZTF19aaeomsn   805255996015015031    2   573.3575  1435.4648  1.776970   
37  ZTF19aaeomsn   760425576015015004    2   580.1277  1465.6010  4.207238   
38  ZTF19aaeomsn   826287116015015001    2   593.1771  1452.6720  1.060840   
39  ZTF19aaeomsn   826261366015015006    1   583.1310  1450.4500  1.624240   
40  ZTF19aaeomsn   821286846015015019    1   577.0930  1409.2000  1.025540   
41  ZTF19aaeomsn   789362746015015002    2   584.8457  1427.5388  4.768587   
42  ZTF19aaeomsn   813259666015015011    1   581.1610  1407.2500  0.824302   
43  ZTF19aaeomsn   784321456015015003    1   552.4579  1432.7032  2.348924   
44  ZTF19aaeomsn   818307936015015009    2   576.2610  1413.5000  1.871520   
45  ZTF19aaeomsn   772493056015015013    2   565.2668  1454.8853  2.026595   
46  ZTF19aaeomsn   802366456015025007    1   558.2800  1438.1500  1.064850   
47  ZTF19aaeomsn   780289666015015008    1   541.7670  1425.1200  1.528370   
48  ZTF19aaeomsn   768484106015015020    1   556.3883  1474.3649  7.116538   
49  ZTF19aaeomsn   780397806015015015    2   553.4838  1441.4379  1.125269   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.445397  3.910000     0.982    324.4111  ...     0.000009     0.038586   
1  -0.079054  2.910000     0.968    314.1729  ...     0.000004     0.040425   
2   0.737166  2.770000     0.981    322.1801  ...     0.000010     0.042184   
3   0.011809  2.340000     0.982    321.0790  ...     0.000004     0.035671   
4  -0.043555  2.180000     0.989    317.9175  ...     0.000002     0.031061   
5  -0.850638  2.210230     0.727    308.2440  ...     0.000000     0.000000   
6   0.104584  3.340000     0.880    270.1880  ...     0.000004     0.030734   
7   0.958672  2.220000     0.873    264.3791  ...     0.000002     0.034308   
8  -0.220728  5.760000     0.365   1287.4400  ...     0.000000     0.000000   
9  -0.244795  1.970000     0.973   1334.2325  ...     0.000002     0.031731   
10  0.313165  2.580000     0.917   1330.7184  ...     0.000002     0.031556   
11  0.383529  2.350000     0.951   1335.1404  ...     0.000002     0.032705   
12 -0.124202  1.960000     0.904   1347.3398  ...     0.000002     0.030375   
13 -0.087119  2.350000     0.666   1328.7700  ...     0.000003     0.029223   
14  0.030384  1.920000     0.898   1361.7568  ...     0.000002     0.031302   
15  0.275318  2.020000     0.982   1318.6685  ...     0.000002     0.030183   
16  0.124427  2.270000     0.943   1323.8295  ...     0.000002     0.029228   
17  0.314821  1.920000     0.814   1334.1908  ...     0.000002     0.028035   
18  0.435810  2.070000     0.869   1369.2100  ...     0.000001     0.019469   
19 -0.300860  2.820000     0.924   1335.5345  ...     0.000002     0.032058   
20 -0.069326  1.282660     0.631   1343.0700  ...     0.000003     0.028485   
21  0.230583  1.106897     0.958   1350.2690  ...     0.000003     0.035666   
22 -0.160527  3.480000     0.747   1359.5500  ...     0.000002     0.023284   
23 -0.103735  1.270290     0.704   1324.1700  ...     0.000003     0.027304   
24 -0.110923  1.323850     0.387   1350.9300  ...     0.000003     0.027011   
25  0.191765  1.780000     0.763   1346.9486  ...     0.000002     0.029563   
26  0.190832  1.194710     0.836   1336.1100  ...     0.000002     0.024282   
27 -0.198695  2.690000     0.962   1247.7401  ...     0.000002     0.033590   
28 -0.029161  2.250000     0.744   1343.1800  ...     0.000003     0.028375   
29 -0.511068  5.220000     0.325   1300.3400  ...     0.000000     0.000000   
30 -0.695591  3.260000     0.980    768.5243  ...     0.000008     0.046307   
31 -0.009117  2.140000     0.979    355.5015  ...     0.000002     0.029619   
32  0.185024  2.240000     0.978   1083.9337  ...     0.000012     0.043712   
33  0.268176  2.020000     0.985    269.0800  ...     0.000010     0.044590   
34  0.110278  2.790000     0.999    923.0537  ...     0.000003     0.036596   
35 -0.110985  2.320000     0.955    567.6623  ...     0.000031     0.045845   
36  0.108888  2.670000     0.918    573.3575  ...     0.000028     0.046427   
37  0.049783  2.480000     0.982    580.1277  ...     0.000022     0.043038   
38 -0.123220  2.650000     0.915    593.1771  ...     0.000018     0.043100   
39 -0.207164  1.357990     0.558    583.1310  ...     0.000000     0.000000   
40 -0.176583  1.201290     0.684    577.0930  ...     0.000000     0.000000   
41  0.044691  1.910000     0.980    584.8457  ...     0.000027     0.043883   
42 -0.017346  1.900000     0.608    581.1610  ...     0.000000     0.000000   
43  0.390576  2.100000     0.979    552.4579  ...     0.000054     0.046127   
44  0.207641  1.119660     0.995    576.2610  ...     0.000000     0.000000   
45  0.214599  3.330000     0.976    565.2668  ...     0.000031     0.048907   
46 -0.143811  5.910000     0.491    558.2800  ...     0.000000     0.000000   
47  0.462627  4.940000     0.976    541.7670  ...     0.000000     0.000000   
48 -0.084103  5.690000     0.896    556.3883  ...     0.000039     0.037519   
49  0.200869  4.180000     0.860    553.4838  ...     0.000163     0.056591   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0     1231.0 -0.039883  0.000022 -0.000013  26.216000   0.526  0.229591   
1     1439.0  0.103003  0.000008 -0.000005  25.871000   0.559  0.269354   
2     1244.0 -0.066948  0.000024 -0.000014  25.868000   0.529  0.226611   
3     1455.0  0.068177  0.000009 -0.000006  25.831000   0.558  0.267938   
4     1444.0  0.089260  0.000004 -0.000002  26.244000   0.559  0.267454   
5        NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
6        NaN -0.037164  0.000010       NaN        NaN     NaN       NaN   
7     1412.0  0.095777  0.000005 -0.000003  26.179000   0.544  0.272150   
8        NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
9     1813.0  0.083581  0.000004 -0.000003  26.088000   0.579  0.266782   
10    1819.0  0.086070  0.000004 -0.000002  26.128000   0.576  0.265028   
11    1766.0  0.085591  0.000004 -0.000003  26.112000   0.581  0.266474   
12    1825.0  0.086416  0.000003 -0.000002  26.118000   0.580  0.266890   
13       NaN -0.059022  0.000007       NaN        NaN     NaN       NaN   
14    1822.0  0.086790  0.000003 -0.000002  26.119000   0.580  0.267588   
15    1823.0  0.083405  0.000003 -0.000002  26.109000   0.581  0.266079   
16    1825.0  0.080110  0.000003 -0.000002  26.148000   0.579  0.266740   
17    1805.0 -0.048645  0.000005 -0.000003  26.064000   0.580  0.268205   
18       NaN  0.081735  0.000003       NaN        NaN     NaN       NaN   
19    1774.0  0.090512  0.000003 -0.000002  26.135000   0.580  0.267407   
20       NaN -0.038434  0.000006       NaN        NaN     NaN       NaN   
21    1813.0  0.085503  0.000006 -0.000004  26.109000   0.582  0.267872   
22       NaN  0.084550  0.000004       NaN        NaN     NaN       NaN   
23       NaN -0.053432  0.000006       NaN        NaN     NaN       NaN   
24       NaN -0.054772  0.000006       NaN        NaN     NaN       NaN   
25    1824.0  0.082858  0.000003 -0.000002  26.125000   0.580  0.266772   
26       NaN  0.085682  0.000005       NaN        NaN     NaN       NaN   
27    1823.0  0.087375  0.000005 -0.000003  25.949000   0.580  0.265480   
28       NaN -0.037470  0.000006       NaN        NaN     NaN       NaN   
29       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
30     576.0  0.117686  0.000014 -0.000010  26.248000   0.571  0.312262   
31    1854.0  0.090697  0.000004 -0.000003  26.306000   0.520  0.232132   
32     325.0  0.111201  0.000016 -0.000013  26.221000   0.688  0.328375   
33     464.0  0.115030  0.000014 -0.000011  26.216500   0.730  0.318468   
34    1024.0  0.100031  0.000005 -0.000004  26.324000   0.614  0.297947   
35     233.0  0.094439  0.000040 -0.000032  26.187000   0.871  0.339115   
36     236.0  0.103537  0.000036 -0.000029  26.187000   0.860  0.335632   
37     232.0  0.099030  0.000028 -0.000023  25.661499   0.847  0.336308   
38     235.0  0.104491  0.000023 -0.000019  26.164000   0.871  0.336677   
39       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
40       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
41     233.0  0.093371  0.000035 -0.000029  25.846000   0.850  0.337238   
42       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
43     184.0 -0.061716  0.000091 -0.000064  25.663500   0.646  0.321778   
44       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
45     235.0  0.108342  0.000040 -0.000032  25.833000   0.850  0.336317   
46       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
47       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
48     217.0 -0.019749  0.000055 -0.000043  26.183000   0.798  0.337073   
49      93.0  0.112847  0.000229 -0.000180  26.175000   0.786  0.306941   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5       NaN  
6       NaN  
7      30.0  
8       NaN  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13      NaN  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18      NaN  
19     30.0  
20      NaN  
21     30.0  
22      NaN  
23      NaN  
24      NaN  
25     30.0  
26      NaN  
27     30.0  
28      NaN  
29      NaN  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39      NaN  
40      NaN  
41     30.0  
42      NaN  
43     30.0  
44      NaN  
45     30.0  
46      NaN  
47      NaN  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.725200891494753,2025-05-19T15:12:30,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,3,"
-- Query to find at most 50 ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
-- and return all columns from the 'dataquality' table for such objects.

SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN' -- Filter for supernovae class
  AND p.classifier_name = 'stamp_classifier' -- Use the stamp classifier
  AND p.probability > 0.7 -- Probability greater than 0.7
  AND p.ranking = 1 -- Only the most likely probabilities
LIMIT 50 -- Limit the results to at most 50 objects
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.644443988800049,2025-04-29T12:19:24,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF19acscbjy  1047072595515015007    2  2727.2446  2876.8367  9.632692   
1    ZTF19acscfbz  1047080341815015024    2  1397.9468  2671.8680  0.625092   
2    ZTF19acscfbz  1058094941815015034    2  1363.5815  2690.0540  0.906637   
3    ZTF19acscfbz  1387159171815015025    2  1443.5073  2803.0200  2.077774   
4    ZTF19acscfbz  1396205101815015028    2  1414.2253  2716.8547  1.355666   
..            ...                  ...  ...        ...        ...       ...   
133  ZTF20abisply  1273187113915015004    2  2566.9350  1500.6024  2.029356   
134  ZTF19acudlnz  1057099254215015004    1  2326.0970   854.9266  1.798888   
135  ZTF19acudlnz  1058098214215015001    2  2332.7300   880.5780  1.763480   
136  ZTF19acudlnz  1058128624215015000    1  2329.0469   864.4458  1.837740   
137  ZTF19acudlnz  1065073914215015003    1  2326.9660   890.2112  0.991515   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    0.416640  1.990000     0.983    203.6634  ...     0.000003     0.036674   
1    2.041878  1.203920     0.936    408.6320  ...     0.000006     0.031380   
2    0.083880  1.352168     0.932    390.4461  ...     0.000006     0.035059   
3    2.170358  1.209155     0.992    277.4801  ...     0.000008     0.035283   
4   -1.191186  1.476100     0.989    363.6453  ...     0.000006     0.035396   
..        ...       ...       ...         ...  ...          ...          ...   
133  0.056886  2.070000     0.983    505.5649  ...     0.000007     0.042921   
134  0.187156  3.780000     0.959    746.4030  ...     0.000009     0.042993   
135 -0.524206  4.770000     0.970    739.7680  ...     0.000006     0.032578   
136  0.492488  2.940000     0.981    743.4531  ...     0.000010     0.043410   
137  1.801689  2.400000     0.981    745.5339  ...     0.000011     0.043850   

     nmatches  clrcoeff  clrcounc  zpclrcov   zpmed  clrmed    clrrms  exptime  
0      1635.0  0.088105  0.000005 -0.000003  26.157   0.541  0.286179     30.0  
1      1541.0  0.099371  0.000006 -0.000006  26.222   0.908  0.226894     30.0  
2      1544.0  0.119656  0.000006 -0.000006  26.296   0.908  0.226244     30.0  
3      1526.0  0.105906  0.000008 -0.000007  26.414   0.910  0.232609     30.0  
4      1546.0  0.118785  0.000006 -0.000006  26.458   0.910  0.229226     30.0  
..        ...       ...       ...       ...     ...     ...       ...      ...  
133     574.0  0.110000  0.000013 -0.000009  26.285   0.561  0.308615     30.0  
134    1112.0 -0.082256  0.000017 -0.000012  26.083   0.586  0.267337     30.0  
135       NaN  0.103465  0.000011       NaN     NaN     NaN       NaN      NaN  
136    1152.0 -0.071225  0.000018 -0.000012  26.052   0.595  0.270612     30.0  
137    1005.0 -0.080014  0.000024 -0.000015  25.812   0.555  0.251455     30.0  

[138 rows x 32 columns]]",,11.09004044532776,2025-05-19T15:12:48,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,4,"
-- Query to find at most 50 ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
SELECT dq.*
FROM dataquality dq
INNER JOIN (
    SELECT oid
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND probability > 0.7
      AND ranking = 1
    LIMIT 50
) AS filtered_prob ON dq.oid = filtered_prob.oid
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,17.661300659179688,2025-04-29T12:19:42,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF20abmdexk  1292443311215015003    2  1095.4972  1230.4945  1.585970   
1    ZTF20abmdkib  1292445640015015010    2  2983.9860  1527.8438  2.074762   
2    ZTF19aamrxsj   805210014415015010    2  2817.1470  1466.5931  1.486976   
3    ZTF19aamrltt   805142073815015020    1  1854.7996  1162.1932  1.542480   
4    ZTF19aaldnhc   787255323615015018    1  1616.6863   711.1474  1.666698   
..            ...                  ...  ...        ...        ...       ...   
236  ZTF19aalzrrz   843361630715015026    2   969.3312  1501.7794  2.131719   
237  ZTF19aalzrrz   846218650715015016    1   967.5820  1454.3400  1.224960   
238  ZTF19aalzrrz   852250044215015013    2  2480.4937  2219.6487  1.915556   
239  ZTF19aalzrrz   852383050715015006    1   994.2580  1384.4700  1.173090   
240  ZTF19aalzrrz   858233490715015014    2   983.1449  1379.5706  1.411776   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    0.107778  2.920000     0.877   1095.4972  ...     0.000021     0.044509   
1    0.446753  1.890000     0.981     88.5138  ...     0.000014     0.040218   
2    0.081381  3.240000     0.976    255.3531  ...     0.000003     0.042407   
3   -1.514853  2.510000     0.982   1162.1932  ...     0.000006     0.036739   
4   -0.253964  4.730000     0.792    711.1474  ...     0.000027     0.038519   
..        ...       ...       ...         ...  ...          ...          ...   
236  0.037769  2.290000     0.998    969.3312  ...     0.000011     0.046380   
237  0.116490  4.190000     0.494    967.5820  ...     0.000000     0.000000   
238 -0.097546  1.224724     0.827    592.0064  ...     0.000013     0.046241   
239  0.133687  1.391300     0.542    994.2580  ...     0.000000     0.000000   
240  0.140052  1.830000     0.953    983.1449  ...     0.000012     0.043244   

     nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0       320.0  0.099006  0.000033 -0.000024  26.3280   0.656  0.312626   
1       360.0  0.101531  0.000017 -0.000014  26.2485   0.777  0.314285   
2      1702.0  0.106263  0.000007 -0.000004  26.3070   0.561  0.280899   
3      1526.0 -0.053464  0.000014 -0.000008  26.2150   0.533  0.239135   
4       394.0 -0.037324  0.000051 -0.000034  25.7315   0.594  0.263866   
..        ...       ...       ...       ...      ...     ...       ...   
236     323.0  0.115271  0.000017 -0.000013  26.2200   0.712  0.339311   
237       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN   
238     314.0  0.115424  0.000019 -0.000014  26.3790   0.747  0.333640   
239       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN   
240     327.0  0.103119  0.000018 -0.000014  26.2120   0.705  0.335543   

     exptime  
0       30.0  
1       30.0  
2       30.0  
3       30.0  
4       30.0  
..       ...  
236     30.0  
237      NaN  
238     30.0  
239      NaN  
240     30.0  

[241 rows x 32 columns]]",,11.639082908630373,2025-05-19T15:13:06,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,5,"
-- Retrieve all columns from the 'dataquality' table for ZTF objects with a probability greater than 0.7 of being supernovae
SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,23.98081350326538,2025-04-29T12:20:07,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF20aauulmv  1200255795215015021    2  2589.3750  2394.9650  1.085427   
1   ZTF20aauwhyi  1202374793715015028    1  1781.5482  2660.1150  2.787677   
2   ZTF20aauwhyi  1216447873715015025    1  1825.5319  2601.6484  1.868345   
3   ZTF20aauwhyi  1207424213715015024    2  1775.3433  2648.0706  1.777779   
4   ZTF20aauwhyi  1217421583715015022    1  1803.1550  2611.1250  1.177906   
5   ZTF20aauwhyi  1214358593715015004    2  1834.6504  2602.2463  2.505876   
6   ZTF20aauwhyi  1222303343715015004    2  1808.7100  2675.0700  1.165940   
7   ZTF20aauwhyi  1224282673715015003    2  1817.8115  2585.0432  1.821716   
8   ZTF20aauwhyi  1221385533715015006    2  1808.1840  2622.4678  1.558213   
9   ZTF20aauwhyi  1213424973715015032    1  1810.4042  2602.3804  2.051409   
10  ZTF20aauwhyi  1211404663715015027    1  1817.1082  2611.2085  1.346352   
11  ZTF20aauwhyi  1216398443715015016    2  1814.1425  2602.2761  2.628983   
12  ZTF20aauwhyi  1212401143715015024    1  1808.9569  2630.4583  1.670585   
13  ZTF20aauwhyi  1200462193715015048    2  1780.4825  2665.3170  2.430525   
14  ZTF20aauwhyi  1218448753715015005    1  1811.1012  2625.6284  1.046143   
15  ZTF20aauwhyi  1226275943715015009    2  1804.5087  2622.7393  2.807371   
16  ZTF20aauwhyi  1219352073715015007    2  1822.0277  2631.0708  0.907476   
17  ZTF20aauwhyi  1201422913715015032    2  1787.9553  2664.2224  1.522271   
18  ZTF20aauwhyi  1231287103715015008    2  1804.1346  2648.0354  1.222862   
19  ZTF20aauwhyi  1217415993715015009    2  1811.1578  2606.8098  2.045018   
20  ZTF20aauwhyi  1213361623715015029    2  1822.8771  2602.3200  2.620669   
21  ZTF20aauwhyi  1202349753715015024    2  1782.9600  2657.7290  3.292775   
22  ZTF20aauwhyi  1220319833715015004    2  1831.6025  2611.2605  1.696781   
23  ZTF20aauwhyi  1210407263715015016    2  1815.3226  2634.3706  4.633706   
24  ZTF20aauwhyi  1211347843715015020    2  1810.0756  2602.9905  1.768683   
25  ZTF20aauwhyi  1209427093715015022    1  1811.9670  2622.0610  1.159653   
26  ZTF20aauwhyi  1214440643715015011    1  1807.9070  2599.6560  2.354191   
27  ZTF20aauwhyi  1201416053715015026    1  1774.5786  2661.0798  2.927698   
28  ZTF20aauwhyi  1220278323715015002    2  1800.9104  2605.5085  2.222969   
29  ZTF20aauwhyi  1200395703715015024    1  1772.2299  2665.3162  1.552611   
30  ZTF20aauwhyi  1208329843715015020    2  1791.3867  2632.0269  2.820947   
31  ZTF20aauwpel  1210411430415015004    2  2624.1590  1866.6025  2.958115   
32  ZTF20aauwpel  1231279950415015005    2  2627.8374  1886.0559  0.762874   
33  ZTF20aauwpel  1216387970415015012    2  2632.0576  1833.3292  2.021693   
34  ZTF20aauwpel  1213349210415015009    2  2613.0872  1832.4597  2.917474   
35  ZTF20aauwpel  1201408400415015021    1  2591.9043  1896.2673  1.728043   
36  ZTF20aauwpel  1240296930415015026    2  2613.0444  1863.5431  1.428687   
37  ZTF20aauwpel  1207427450415015010    2  2595.4860  1881.1191  1.527869   
38  ZTF20aauwpel  1213281400415015021    1  2633.8723  1858.0801  1.680522   
39  ZTF20aauwpel  1200449540415015023    2  2582.5070  1900.0906  1.822906   
40  ZTF20aauwpel  1200393780415015012    1  2588.1748  1901.2830  1.094582   
41  ZTF20aauwpel  1219278790415015008    2  2611.5700  1858.0100  1.446210   
42  ZTF20aauwpel  1237259860415015014    2  2609.4500  1852.3700  1.250650   
43  ZTF20aauwpel  1202368720415015016    1  2603.7097  1894.0688  1.189523   
44  ZTF20aauwpel  1219324750415015005    2  2629.7320  1862.9899  1.085782   
45  ZTF20aauwpel  1202326770415015009    2  2598.8667  1891.8083  1.737958   
46  ZTF20aauwpel  1210349600415015022    1  2612.7878  1864.0182  1.129080   
47  ZTF20aauwpel  1201428960415015013    2  2596.5215  1898.0458  1.770410   
48  ZTF20aauwpel  1220288180415015009    2  2624.2400  1842.8700  1.448650   
49  ZTF19acxowen  1073440114115015004    2  1499.9269   763.7695  0.931287   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.556348  3.560000     0.907    483.1251  ...     0.000009     0.042411   
1   0.234115  3.370000     0.982    420.3851  ...     0.000011     0.043484   
2   0.062107  4.940000     0.884    478.8516  ...     0.000007     0.038693   
3  -0.293249  4.760000     0.982    432.4294  ...     0.000007     0.046912   
4  -0.094950  2.230000     0.707    469.3750  ...     0.000008     0.038483   
5  -0.113909  3.380000     0.999    478.2536  ...     0.000005     0.044728   
6   1.574940  1.095430     0.983    405.4310  ...     0.000014     0.039213   
7   0.224786  1.089646     0.972    495.4568  ...     0.000006     0.044549   
8  -0.337654  1.640000     0.998    458.0323  ...     0.000007     0.047135   
9   0.303457  5.180000     0.974    478.1196  ...     0.000009     0.040683   
10  0.145205  4.910000     0.969    469.2915  ...     0.000007     0.034114   
11  0.068652  4.680000     0.981    478.2238  ...     0.000005     0.043045   
12 -0.113809  3.490000     0.980    450.0418  ...     0.000007     0.034014   
13 -0.007204  3.400000     0.981    415.1831  ...     0.000007     0.048041   
14  0.044254  1.271529     0.833    454.8716  ...     0.000007     0.033719   
15 -0.017396  1.119661     0.629    457.7608  ...     0.000005     0.042718   
16 -0.278947  1.292466     0.903    449.4292  ...     0.000006     0.047992   
17  0.113296  3.130000     0.983    416.2775  ...     0.000006     0.047237   
18  0.122782  2.350000     0.910    432.4646  ...     0.000007     0.045790   
19 -0.063882  2.910000     0.999    473.6903  ...     0.000005     0.043683   
20  0.202113  4.330000     0.977    478.1799  ...     0.000005     0.043303   
21  0.126496  3.200000     0.982    422.7709  ...     0.000005     0.044380   
22  0.121236  3.160000     0.962    469.2394  ...     0.000007     0.049051   
23  0.416211  3.910000     0.976    446.1293  ...     0.000006     0.044440   
24  0.196790  2.480000     0.976    477.5096  ...     0.000005     0.044730   
25  0.266001  2.820000     0.980    458.4389  ...     0.000007     0.032814   
26  0.068333  5.350000     0.967    480.8440  ...     0.000006     0.033725   
27  0.266272  3.090000     0.921    419.4202  ...     0.000012     0.042218   
28  0.370396  1.061758     0.986    474.9914  ...     0.000007     0.046691   
29  0.143007  3.130000     0.966    415.1838  ...     0.000013     0.042231   
30  0.099743  3.730000     0.984    448.4732  ...     0.000005     0.044758   
31  0.080244  2.070000     0.981    448.3410  ...     0.000009     0.042326   
32  0.061218  2.030000     0.949    444.6625  ...     0.000009     0.043384   
33  0.077198  2.430000     0.977    440.4423  ...     0.000008     0.041524   
34  0.200399  2.080000     0.980    459.4129  ...     0.000009     0.041068   
35 -0.274646  2.730000     0.967    480.5957  ...     0.000010     0.036710   
36 -0.044536  2.410000     0.895    459.4556  ...     0.000011     0.043415   
37 -0.355564  4.730000     0.926    477.0139  ...     0.000012     0.044283   
38 -0.026946  3.310000     0.909    438.6277  ...     0.000014     0.051002   
39  0.182595  3.460000     0.628    489.9930  ...     0.000009     0.041283   
40 -0.324723  2.880000     0.965    484.3251  ...     0.000011     0.038925   
41  0.226728  1.720000     0.975    460.9280  ...     0.000008     0.025048   
42  0.169471  1.196030     0.850    463.0470  ...     0.000008     0.023956   
43  0.098461  2.360000     0.963    468.7903  ...     0.000013     0.042610   
44  0.388832  2.050000     0.993    442.7681  ...     0.000009     0.043085   
45  0.103858  1.960000     0.980    473.6334  ...     0.000008     0.042823   
46 -0.200483  2.550000     0.844    459.7122  ...     0.000008     0.034679   
47 -0.083141  3.250000     0.968    475.9786  ...     0.000009     0.043862   
48  0.658412  3.360000     1.000    448.2620  ...     0.000014     0.032189   
49  0.373053  3.310000     0.981    763.7695  ...     0.000025     0.053731   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0      418.0  0.102896  0.000015 -0.000011  26.2320   0.619  0.327774     30.0  
1      592.0 -0.085028  0.000018 -0.000013  25.9990   0.587  0.323276     30.0  
2      598.0 -0.086581  0.000011 -0.000008  26.2260   0.599  0.323288     30.0  
3      594.0  0.117927  0.000012 -0.000008  26.2630   0.593  0.323438     30.0  
4      593.0 -0.080327  0.000013 -0.000009  26.2180   0.590  0.322675     30.0  
5      604.0  0.115816  0.000009 -0.000006  26.3460   0.598  0.324487     30.0  
6        NaN  0.122225  0.000024       NaN      NaN     NaN       NaN      NaN  
7      597.0  0.114085  0.000010 -0.000007  26.3270   0.595  0.323750     30.0  
8      602.0  0.118612  0.000012 -0.000008  26.3450   0.589  0.323574     30.0  
9      597.0 -0.082723  0.000015 -0.000010  26.1670   0.595  0.323545     30.0  
10     599.0 -0.064338  0.000012 -0.000008  26.2130   0.589  0.323347     30.0  
11     598.0  0.112992  0.000008 -0.000006  26.3490   0.600  0.324381     30.0  
12     594.0 -0.062323  0.000012 -0.000008  26.1890   0.586  0.324022     30.0  
13     599.0  0.122007  0.000012 -0.000008  26.2930   0.598  0.324347     30.0  
14     598.0 -0.064333  0.000011 -0.000008  26.2080   0.589  0.322730     30.0  
15     599.0  0.113480  0.000008 -0.000005  26.3170   0.589  0.322422     30.0  
16     600.0  0.125474  0.000010 -0.000007  26.3300   0.593  0.323310     30.0  
17     598.0  0.125381  0.000009 -0.000007  26.2940   0.598  0.323460     30.0  
18     599.0  0.114999  0.000011 -0.000008  26.3180   0.590  0.323324     30.0  
19     602.0  0.113830  0.000009 -0.000006  26.3260   0.600  0.324148     30.0  
20     601.0  0.112473  0.000009 -0.000006  26.2960   0.600  0.324257     30.0  
21     598.0  0.115465  0.000009 -0.000006  26.1360   0.597  0.323510     30.0  
22     608.0  0.127168  0.000011 -0.000008  26.3350   0.590  0.323154     30.0  
23     597.0  0.112862  0.000010 -0.000007  26.3040   0.598  0.323592     30.0  
24     601.0  0.117911  0.000009 -0.000006  26.3100   0.599  0.324333     30.0  
25     600.0 -0.055368  0.000012 -0.000008  26.1830   0.589  0.322785     30.0  
26     593.0 -0.067957  0.000011 -0.000007  26.2190   0.590  0.321426     30.0  
27     588.0 -0.073102  0.000020 -0.000014  26.1880   0.586  0.321154     30.0  
28     598.0  0.117267  0.000012 -0.000008  26.3220   0.599  0.324186     30.0  
29     586.0 -0.066047  0.000022 -0.000015  26.1870   0.573  0.320203     30.0  
30     593.0  0.117096  0.000009 -0.000006  26.2870   0.598  0.324398     30.0  
31     492.0  0.106249  0.000014 -0.000010  26.2950   0.663  0.315036     30.0  
32     495.0  0.110313  0.000014 -0.000010  26.3280   0.667  0.315120     30.0  
33     492.0  0.107283  0.000012 -0.000009  26.3670   0.670  0.313590     30.0  
34     486.0  0.101315  0.000014 -0.000010  26.3205   0.668  0.313069     30.0  
35     494.0 -0.076443  0.000016 -0.000012  26.2800   0.663  0.314076     30.0  
36     488.0  0.101946  0.000018 -0.000013  26.3370   0.668  0.313612     30.0  
37     493.0  0.103405  0.000019 -0.000014  26.2770   0.667  0.314550     30.0  
38     492.0 -0.124239  0.000023 -0.000017  26.2660   0.665  0.312985     30.0  
39     487.0  0.103154  0.000014 -0.000010  26.3140   0.667  0.313141     30.0  
40     487.0 -0.082004  0.000018 -0.000013  26.2840   0.664  0.314204     30.0  
41       NaN  0.106575  0.000013       NaN      NaN     NaN       NaN      NaN  
42       NaN  0.110927  0.000012       NaN      NaN     NaN       NaN      NaN  
43     488.0 -0.092250  0.000020 -0.000015  26.0680   0.663  0.314878     30.0  
44     496.0  0.107541  0.000014 -0.000010  26.3500   0.665  0.315426     30.0  
45     493.0  0.110397  0.000013 -0.000009  26.2790   0.664  0.314662     30.0  
46     490.0 -0.080040  0.000012 -0.000009  26.2660   0.665  0.313564     30.0  
47     491.0  0.111911  0.000014 -0.000010  26.3230   0.667  0.315577     30.0  
48       NaN  0.115777  0.000022       NaN      NaN     NaN       NaN      NaN  
49     389.0  0.121349  0.000034 -0.000027  26.2860   0.780  0.321691     30.0  

[50 rows x 32 columns]]",,9.570128440856934,2025-05-19T15:13:22,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,6,"
SELECT dq.* 
FROM dataquality dq
INNER JOIN probability p ON dq.oid = p.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.864831447601318,2025-04-29T12:20:19,"[             oid               candid  fid       xpos       ypos      chipsf  \
0   ZTF19adcfsad  1133516354015015000    2  2144.3306   549.6666    1.802824   
1   ZTF19adcfsad  1141442004015015004    2  2150.9560   535.4630    0.926971   
2   ZTF19adcfsad  1121457444015015001    1  2138.2961   527.8297    1.054478   
3   ZTF19adcfsad  1127358374015015004    2  2152.9092   522.9108    1.057613   
4   ZTF19adcfsad  1141414644015015002    1  2147.6200   532.4090    1.135860   
5   ZTF19adcfsad  1154339574015015004    1  2160.2800   541.5620    1.174420   
6   ZTF19adcfsad  1096485974015015001    2  2144.0422   564.2923    1.511720   
7   ZTF19adcfsad  1138316434015015001    2  2136.3005   555.1815    1.214668   
8   ZTF19adcfsad  1150472834015015001    2  2149.8100   550.2740    1.771520   
9   ZTF19adcfsad  1105480794015015001    2  2136.9827   558.5193    6.322125   
10  ZTF19adcfsad  1124487004015015005    1  2148.9800   545.5670    1.243320   
11  ZTF19adcfsad  1144419944015015008    1  2147.3733   520.1364    1.345547   
12  ZTF19adcfsad  1147399014015015005    2  2148.6956   548.0069    1.145037   
13  ZTF19adcfsad  1092545724015015001    1  2134.9830   578.3250    2.030743   
14  ZTF19adcfsad  1160404944015015001    2  2167.2869   549.0409    0.871341   
15  ZTF19adcfsad  1154453284015015002    2  2154.4680   545.7641    2.033204   
16  ZTF19adcfsad  1130497654015015001    2  2122.1133   567.9968    0.896047   
17  ZTF19adcfsad  1102541294015015002    1  2155.5550   560.5925    6.988640   
18  ZTF19adcfsad  1092566574015015002    2  2137.9160   579.7135    3.188386   
19  ZTF19adcfsad  1157398934015015000    1  2143.5700   567.2740    1.799900   
20  ZTF19adcfsad  1117500894015015000    2  2140.1946   542.6494    2.751228   
21  ZTF19adcfsad  1096541144015015002    1  2140.8218   560.2478    1.857029   
22  ZTF19adcfsad  1099504674015015003    1  2161.0996   546.8075    2.738599   
23  ZTF20aaayrmp  1101554803715015036    2   236.9895  2487.4695    1.592971   
24  ZTF20aaayrmp  1095505123715015023    1   226.2842  2493.1170    1.447813   
25  ZTF20aaayrmp  1101498313715015019    1   234.2615  2477.2980    1.512089   
26  ZTF20aaayrmp  1098555273715015016    2   229.8300  2494.5234    2.713565   
27  ZTF20aaayrmp  1098533723715015016    1   246.9498  2493.0264    1.153477   
28  ZTF18acnjjsz   684256530915015102    2   231.6847  2183.9917    1.364343   
29  ZTF20aaadcfk  1095162311115015014    2  1454.8887  2586.1294    1.460375   
30  ZTF19aapkyuk   826224101615015001    2  2208.9500   299.6760    1.585320   
31  ZTF19aapkyuk   826207465615015007    1  2440.1700  1273.1300    1.257760   
32  ZTF19aapkyuk   828203035615015007    2  2424.9160  1231.0981    0.893359   
33  ZTF19aapkyuk   821275542915015002    1  2699.3800   165.6080    1.274310   
34  ZTF19aaplgrm   828216953115015017    2  1765.6205  1740.6951    1.875466   
35  ZTF20abouxil  1302354013415015013    2   261.1684   819.9432    1.346020   
36  ZTF20abovdqx  1302376215415015030    2   446.2697  1810.6458    1.943355   
37  ZTF20abovebr  1302376213015015000    2   327.2920   277.8524    4.799468   
38  ZTF20aboruot  1301459565915015019    2   640.9976  1447.2502    1.098119   
39  ZTF20aavuvsa  1209190314115015010    1  1241.5406  1063.9220    1.190069   
40  ZTF20aavwaji  1209225862815015012    1   466.3624   696.7385    1.693961   
41  ZTF20aavwaji  1209270032815015007    1   459.7222   695.7345    1.434030   
42  ZTF20aaaxacu  1155274622015015024    1  2908.3900  2099.7600    1.766180   
43  ZTF20aaaxacu  1140289932015015036    2  2893.5260  2154.5945   14.331607   
44  ZTF20aaaxacu  1161210812015015006    1  2892.8200  2106.2700    1.518370   
45  ZTF20aaaxacu  1110402342015015018    1  2902.6110  2125.4575  150.506620   
46  ZTF20aaaxacu  1150232882015015035    2  2903.6074  2112.9304    4.258526   
47  ZTF20aaaxacu  1110340212015015024    2  2900.1235  2122.7805   35.439484   
48  ZTF20aaaxacu  1145300012015015030    2  2894.2344  2113.2883    4.903770   
49  ZTF20aaaxacu  1132294302015015020    2  2900.2278  2098.0068    1.827754   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.789880  1.143382     0.989    549.6666  ...     0.000014     0.048864   
1  -0.301226  2.080000     0.979    535.4630  ...     0.000012     0.047318   
2  -0.229887  3.880000     0.659    527.8297  ...     0.000029     0.046633   
3   0.032940  2.380000     0.978    522.9108  ...     0.000012     0.047135   
4   0.123876  2.480000     0.762    532.4090  ...     0.000017     0.033024   
5  -0.033919  2.540000     0.603    541.5620  ...     0.000021     0.035756   
6   0.114140  3.040000     0.982    564.2923  ...     0.000012     0.048865   
7  -0.036345  1.437078     0.891    555.1815  ...     0.000024     0.054283   
8   0.073367  4.680000     0.971    550.2740  ...     0.000013     0.028646   
9   0.058874  1.830000     0.983    558.5193  ...     0.000010     0.046336   
10 -0.288620  2.970000     0.533    545.5670  ...     0.000025     0.038342   
11  0.299992  2.840000     0.930    520.1364  ...     0.000020     0.046160   
12 -0.252742  2.300000     0.976    548.0069  ...     0.000012     0.046460   
13  0.103915  2.710000     0.982    578.3250  ...     0.000015     0.039095   
14  1.417830  1.940000     0.956    549.0409  ...     0.000017     0.051833   
15  0.213809  2.510000     0.977    545.7641  ...     0.000009     0.044697   
16 -0.568680  4.630000     0.683    567.9968  ...     0.000021     0.053195   
17  0.121878  2.930000     0.988    560.5925  ...     0.000019     0.043426   
18  0.146666  2.030000     0.983    579.7135  ...     0.000009     0.043788   
19 -0.297544  1.568410     0.400    567.2740  ...     0.000021     0.035920   
20  0.229807  2.650000     0.989    542.6494  ...     0.000009     0.045211   
21 -0.011225  3.890000     0.980    560.2478  ...     0.000027     0.046153   
22  0.185283  2.270000     0.983    546.8075  ...     0.000017     0.041529   
23  2.664471  2.520000     0.967    236.9895  ...     0.000022     0.051402   
24  1.739284  2.420000     0.930    226.2842  ...     0.000037     0.047884   
25  0.997738  2.860000     0.961    234.2615  ...     0.000037     0.044699   
26  3.252834  2.620000     0.988    229.8300  ...     0.000024     0.051386   
27  2.011919  3.000000     0.838    246.9498  ...     0.000031     0.042834   
28  1.382423  3.390000     0.948    231.6847  ...     0.000062     0.060905   
29  0.732846  2.360000     0.983    494.3707  ...     0.000004     0.026595   
30 -0.009249  1.590000     0.877    299.6760  ...     0.000000     0.000000   
31 -0.096251  1.283890     0.520    632.3310  ...     0.000000     0.000000   
32  0.047532  1.730000     0.775    647.5840  ...     0.000024     0.041450   
33 -0.276092  1.660000     0.677    165.6080  ...     0.000000     0.000000   
34  0.318652  2.670000     0.997   1306.8795  ...     0.000014     0.046786   
35  0.912583  1.890000     0.975    261.1684  ...     0.000004     0.028286   
36  0.333541  2.270000     0.981    446.2697  ...     0.000003     0.036751   
37  0.350873  1.960000     0.989    277.8524  ...     0.000002     0.036620   
38  0.156595  1.800000     0.866    640.9976  ...     0.000011     0.041351   
39 -0.079898  2.500000     0.918   1063.9220  ...     0.000021     0.031928   
40 -0.248867  2.700000     0.932    466.3624  ...     0.000008     0.034069   
41 -0.418388  2.000000     0.882    459.7222  ...     0.000007     0.030405   
42 -0.099173  4.740000     0.644    164.1080  ...     0.000039     0.046470   
43  0.083227  2.300000     0.995    178.9740  ...     0.000017     0.048899   
44  0.757969  1.980000     0.963    179.6830  ...     0.000023     0.032879   
45 -0.099558  2.050000     0.991    169.8888  ...     0.000017     0.038943   
46  0.041429  2.160000     0.982    168.8925  ...     0.000014     0.047505   
47 -0.635645  2.030000     0.985    172.3764  ...     0.000011     0.047402   
48 -0.089751  2.020000     0.989    178.2657  ...     0.000017     0.047907   
49  0.325030  2.390000     0.983    172.2721  ...     0.000013     0.046606   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0      377.0  0.119865  0.000023 -0.000017  26.478000   0.648  0.321958   
1      375.0  0.119809  0.000019 -0.000014  26.454000   0.648  0.322784   
2      360.0 -0.066222  0.000048 -0.000034  26.321499   0.617  0.315642   
3      376.0  0.119191  0.000018 -0.000013  26.434000   0.646  0.324023   
4        NaN -0.057173  0.000028       NaN        NaN     NaN       NaN   
5        NaN -0.069117  0.000034       NaN        NaN     NaN       NaN   
6      376.0  0.125646  0.000020 -0.000014  26.462000   0.646  0.320787   
7      376.0  0.118133  0.000038 -0.000028  26.417000   0.646  0.322329   
8        NaN  0.129557  0.000021       NaN        NaN     NaN       NaN   
9      375.0  0.120680  0.000017 -0.000012  26.451000   0.645  0.321001   
10       NaN -0.066794  0.000045       NaN        NaN     NaN       NaN   
11     375.0 -0.091762  0.000032 -0.000023  26.303000   0.642  0.322199   
12     378.0  0.116964  0.000018 -0.000013  26.460499   0.646  0.323149   
13     376.0 -0.073424  0.000025 -0.000018  26.342000   0.633  0.319678   
14     378.0  0.124585  0.000027 -0.000019  26.406000   0.641  0.323778   
15     375.0  0.118046  0.000014 -0.000010  26.459000   0.645  0.321653   
16     381.0  0.121653  0.000033 -0.000024  26.461000   0.642  0.320709   
17     371.0 -0.082872  0.000031 -0.000022  26.334000   0.637  0.321043   
18     379.0  0.113276  0.000015 -0.000011  26.474000   0.645  0.321376   
19       NaN -0.068646  0.000035       NaN        NaN     NaN       NaN   
20     376.0  0.117999  0.000015 -0.000011  26.471000   0.643  0.322986   
21     356.0 -0.074627  0.000046 -0.000032  26.348500   0.611  0.310734   
22     372.0 -0.082051  0.000027 -0.000019  26.339000   0.638  0.320609   
23     278.0  0.130067  0.000030 -0.000024  26.334000   0.795  0.323482   
24     280.0 -0.089065  0.000050 -0.000040  26.178000   0.795  0.323173   
25     274.0 -0.074902  0.000051 -0.000040  26.193500   0.789  0.320471   
26     281.0  0.127481  0.000032 -0.000026  26.353000   0.798  0.323248   
27     280.0 -0.076101  0.000042 -0.000033  26.192501   0.795  0.323703   
28     282.0  0.109303  0.000084 -0.000067  25.648000   0.763  0.322276   
29    2024.0  0.089917  0.000003 -0.000003  26.359000   1.164  0.231592   
30       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
31       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
32     156.0  0.107166  0.000036 -0.000027  26.231000   0.699  0.316394   
33       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
34     333.0  0.114258  0.000018 -0.000015  26.278000   0.767  0.337850   
35    1437.0  0.102077  0.000009 -0.000006  26.579000   0.631  0.187959   
36    1332.0  0.096876  0.000005 -0.000003  26.268000   0.563  0.293662   
37    1549.0  0.106639  0.000004 -0.000003  26.254000   0.549  0.276279   
38     340.0  0.103837  0.000015 -0.000012  26.325000   0.735  0.329294   
39     281.0 -0.028542  0.000030 -0.000023  26.250000   0.745  0.331986   
40     597.0 -0.057501  0.000015 -0.000010  26.159000   0.582  0.308792   
41     596.0 -0.050998  0.000012 -0.000008  26.167000   0.582  0.309869   
42       NaN -0.079760  0.000069       NaN        NaN     NaN       NaN   
43     402.0  0.109922  0.000026 -0.000019  26.363000   0.691  0.327149   
44       NaN -0.035305  0.000044       NaN        NaN     NaN       NaN   
45     391.0 -0.069474  0.000026 -0.000019  26.263000   0.665  0.318243   
46     400.0  0.115262  0.000021 -0.000016  26.319500   0.689  0.322151   
47     402.0  0.121632  0.000017 -0.000013  26.364000   0.691  0.322490   
48     400.0  0.109066  0.000025 -0.000019  26.391000   0.674  0.322838   
49     399.0  0.115367  0.000019 -0.000015  26.368000   0.688  0.321231   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4       NaN  
5       NaN  
6      30.0  
7      30.0  
8       NaN  
9      30.0  
10      NaN  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19      NaN  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30      NaN  
31      NaN  
32     30.0  
33      NaN  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42      NaN  
43     30.0  
44      NaN  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.40177297592163,2025-05-19T15:13:38,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,7,"
-- Query to find at most 50 ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
-- and return all columns from the 'dataquality' table for such objects.

SELECT dq.*
FROM dataquality dq
INNER JOIN probability p ON dq.oid = p.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,17.409234762191772,2025-04-29T12:20:37,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF18acqyvag   733421265415015005    2   600.4921   675.1288  0.930764   
1   ZTF18acqyvag   727483405415015004    2   592.0786   682.8944  0.963688   
2   ZTF18acqyvag   721525975415015001    1   594.7110   641.0350  0.940806   
3   ZTF18acqyvag   711482095415015002    2   582.9580   634.5954  1.691345   
4   ZTF18acqyvag   714441155415015001    1   595.7785   647.0966  1.272245   
5   ZTF18acqyvag   689521315415015007    1   592.2675   636.2259  1.419890   
6   ZTF18acqyvag   726479375415015001    1   587.6730   685.3850  1.077730   
7   ZTF18acqyvag   696463655415015004    1   588.3531   635.9513  1.348111   
8   ZTF18acqyvag   733443735415015009    1   603.6674   674.6312  1.499396   
9   ZTF18acqyvag   711525275415015003    1   614.0897   639.0793  1.046632   
10  ZTF18acqyvag   718441255415015002    2   593.0167   619.9032  1.248086   
11  ZTF18acqyvag   718498265415015000    1   599.9497   614.2033  0.899829   
12  ZTF18acqyvag   726420675415015005    2   587.2430   688.6920  1.058570   
13  ZTF18acrcqaj   693359822515015009    2  2602.3508  1045.1652  1.179341   
14  ZTF20aafdvwa  1108145093115015004    1  2987.0654  1206.6610  1.810442   
15  ZTF18acrhcdf   694482071115015000    2  2586.2117   642.1962  1.224211   
16  ZTF20aafcljq  1133462005515015003    1  1458.3300  2089.4700  1.051410   
17  ZTF20aafcljq  1157496815515015009    2  1453.2100  2110.6900  2.117940   
18  ZTF20aafcljq  1107504915515015002    1  1437.9924  2102.9148  1.047050   
19  ZTF20aafcljq  1127545245515015008    2  1457.9268  2084.9436  3.218816   
20  ZTF20aafcljq  1127520725515015006    1  1472.8951  2082.6729  1.623316   
21  ZTF20aafcljq  1133534295515015010    2  1453.1250  2097.1572  2.247869   
22  ZTF20aafcljq  1130557605515015009    2  1422.5260  2114.1182  1.427648   
23  ZTF20aafcljq  1118444805515015009    1  1451.8562  2064.0317  1.082830   
24  ZTF20aafcljq  1118559135515015004    2  1450.1548  2084.1008  1.691318   
25  ZTF20aafcljq  1121483245515015016    1  1452.2684  2069.7847  1.284741   
26  ZTF20aafcljq  1121554615515015008    2  1450.3400  2075.4000  2.273350   
27  ZTF20aafcljq  1139523875515015010    2  1442.6289  2100.8354  3.356986   
28  ZTF20aafcljq  1149459525515015008    2  1451.4705  2096.9778  3.835772   
29  ZTF20aafcljq  1110519865515015007    2  1446.9211  2090.9148  2.406340   
30  ZTF20aafcljq  1182456525515015009    2  1432.7273  2103.8635  2.290933   
31  ZTF20aafcljq  1160506685515015022    2  1466.8022  2099.1704  4.869920   
32  ZTF20aafcljq  1149524135515015019    1  1466.2100  2106.0000  1.899650   
33  ZTF20aafcljq  1110463075515015006    1  1449.8732  2074.5190  1.737126   
34  ZTF20aafcljq  1124560015515015003    2  1441.8492  2088.2668  1.104807   
35  ZTF20aafcljq  1136544065515015008    1  1441.3300  2110.5400  0.689015   
36  ZTF20aafcljq  1144498485515015014    2  1448.9510  2068.1511  4.298236   
37  ZTF20aafcljq  1144443245515015020    1  1447.1880  2055.1084  1.915969   
38  ZTF20aafcljq  1124540465515015009    1  1447.7627  2087.4548  1.222924   
39  ZTF18acrhekw   694512522315015004    2   868.8529  1525.7281  0.967692   
40  ZTF18acpwpta   687518345815015000    1   222.1042   144.4012  1.520683   
41  ZTF18acpwlgh   687480644815015012    1  1281.4231  2413.5957  1.716136   
42  ZTF18acrmdni   695450436215015012    2   928.3289  2955.8806  1.935687   
43  ZTF18acrmeuu   695450434415015171    2  2352.9941  2603.1372  0.644079   
44  ZTF20aacxsny  1098482395315015012    1  2320.7422  1720.8652  1.730178   
45  ZTF20aacxsny  1095480575315015010    1  2318.1900  1735.8200  1.335820   
46  ZTF20aacxsny  1098438775315015012    2  2331.3347  1717.3512  2.436939   
47  ZTF20aacxsny  1095456315315015012    2  2327.7200  1728.5500  1.184360   
48  ZTF20aadckor  1095450312515015007    2  1011.1800  1989.4500  0.818553   
49  ZTF20aadckor  1117433542515015018    1  1017.6682  1976.1031  1.165574   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.362507  2.280000     0.783    600.4921  ...     0.000006     0.039391   
1  -0.137512  4.340000     0.918    592.0786  ...     0.000006     0.037769   
2   0.782333  3.190000     0.892    594.7110  ...     0.000000     0.000000   
3   0.096805  3.210000     0.961    582.9580  ...     0.000005     0.037277   
4   0.172086  2.480000     0.973    595.7785  ...     0.000007     0.031433   
5   0.112728  2.370000     0.738    592.2675  ...     0.000010     0.041980   
6  -0.405342  2.000000     0.430    587.6730  ...     0.000000     0.000000   
7  -1.974593  2.200000     0.927    588.3531  ...     0.000016     0.036834   
8  -0.016036  2.550000     0.901    603.6674  ...     0.000008     0.028844   
9   0.194431  2.600000     0.971    614.0897  ...     0.000008     0.036743   
10  0.092101  2.090000     0.980    593.0167  ...     0.000005     0.036462   
11  0.209978  2.500000     0.977    599.9497  ...     0.000010     0.033613   
12 -0.195437  3.600000     0.696    587.2430  ...     0.000000     0.000000   
13 -0.119370  2.360000     0.983    470.1492  ...     0.000007     0.042080   
14  0.222485  2.240000     0.974     85.4346  ...     0.000041     0.043663   
15 -0.142070  3.720000     0.994    486.2883  ...     0.000008     0.047248   
16  1.569010  2.520000     0.994    991.0260  ...     0.000018     0.038183   
17  0.261903  2.350000     0.669    969.8100  ...     0.000006     0.023526   
18  1.012112  6.140000     0.971    977.5853  ...     0.000033     0.044358   
19  0.633406  1.810000     0.980    995.5565  ...     0.000005     0.040408   
20  0.160967  2.610000     0.979    997.8272  ...     0.000010     0.036107   
21  1.005041  1.510000     0.978    983.3428  ...     0.000009     0.042942   
22  0.237035  2.500000     0.975    966.3819  ...     0.000007     0.043785   
23  0.370293  2.460000     0.982   1016.4682  ...     0.000011     0.033961   
24  0.378796  2.350000     0.980    996.3991  ...     0.000007     0.042646   
25  0.009765  4.550000     0.954   1010.7154  ...     0.000014     0.040849   
26  0.519529  2.440000     0.830   1005.1000  ...     0.000007     0.025950   
27  1.039415  2.230000     0.982    979.6646  ...     0.000008     0.042436   
28  0.393368  1.570000     0.992    983.5222  ...     0.000005     0.039238   
29  0.872300  1.950000     0.982    989.5851  ...     0.000006     0.041456   
30  0.794477  1.170675     0.981    976.6364  ...     0.000006     0.040434   
31  0.398230  2.540000     0.951    981.3296  ...     0.000007     0.040490   
32 -0.047526  1.860000     0.708    974.4970  ...     0.000010     0.030351   
33  1.518199  3.500000     0.983   1005.9809  ...     0.000025     0.044533   
34  0.389714  4.460000     0.585    992.2331  ...     0.000008     0.042827   
35  1.120460  1.808720     0.700    969.9550  ...     0.000028     0.041653   
36  0.555749  1.760000     0.988   1012.3488  ...     0.000006     0.040815   
37  0.239127  1.252765     0.741   1025.3917  ...     0.000010     0.039437   
38  0.086231  4.280000     0.934    993.0452  ...     0.000013     0.038110   
39 -0.274436  3.380000     0.975    868.8529  ...     0.000052     0.064900   
40  0.186419  3.470000     0.460    144.4012  ...     0.000019     0.033223   
41 -0.092022  3.610000     0.934    666.9044  ...     0.000009     0.034885   
42 -6.437701  1.830000     0.999    124.6194  ...     0.000019     0.048262   
43 -1.167144  1.820000     0.988    477.3629  ...     0.000020     0.048932   
44 -1.045369  3.120000     0.949    751.7578  ...     0.000022     0.049718   
45 -1.293370  3.740000     0.687    754.3130  ...     0.000023     0.038029   
46 -0.968113  3.250000     0.971    741.1652  ...     0.000009     0.038252   
47 -0.937751  1.347490     0.893    744.7800  ...     0.000010     0.024367   
48 -0.541847  1.211760     0.799   1011.1800  ...     0.000019     0.022564   
49  0.023717  3.050000     0.904   1017.6682  ...     0.000050     0.048078   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0      615.0  0.103219  0.000009 -0.000007  26.2680   0.662  0.309772     30.0  
1      614.0  0.095087  0.000009 -0.000007  26.2550   0.663  0.309716     30.0  
2        NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
3      612.0  0.096192  0.000008 -0.000006  26.2680   0.655  0.310640     30.0  
4      613.0 -0.057004  0.000011 -0.000008  26.2440   0.664  0.310375     30.0  
5      606.0 -0.094887  0.000016 -0.000012  26.2320   0.650  0.308258     30.0  
6        NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
7      538.0 -0.023473  0.000028 -0.000019  26.2460   0.595  0.292803     30.0  
8      617.0 -0.027622  0.000013 -0.000009  26.2460   0.655  0.310276     30.0  
9      617.0 -0.081192  0.000012 -0.000009  26.2500   0.655  0.307660     30.0  
10     613.0  0.094378  0.000008 -0.000006  26.2810   0.656  0.310249     30.0  
11     593.0 -0.051904  0.000016 -0.000011  26.2590   0.635  0.306983     30.0  
12       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
13     744.0  0.108629  0.000011 -0.000008  26.3470   0.638  0.300261     30.0  
14     276.0 -0.091859  0.000045 -0.000041  26.1990   0.844  0.301977     30.0  
15    1117.0  0.098321  0.000015 -0.000010  26.1600   0.594  0.288761     30.0  
16       NaN -0.025618  0.000038       NaN      NaN     NaN       NaN      NaN  
17       NaN  0.114478  0.000011       NaN      NaN     NaN       NaN      NaN  
18     334.0 -0.029434  0.000082 -0.000047  26.2560   0.475  0.264398     30.0  
19     521.0  0.108312  0.000009 -0.000006  26.3270   0.576  0.314179     30.0  
20     519.0 -0.061440  0.000018 -0.000012  26.3030   0.576  0.314414     30.0  
21     522.0  0.101164  0.000016 -0.000011  26.3150   0.576  0.316448     30.0  
22     520.0  0.112203  0.000013 -0.000009  26.3090   0.587  0.314325     30.0  
23     515.0 -0.044651  0.000019 -0.000013  26.0570   0.560  0.313909     30.0  
24     522.0  0.108867  0.000012 -0.000008  25.9920   0.573  0.315080     30.0  
25     512.0 -0.063303  0.000025 -0.000017  26.2540   0.568  0.313346     30.0  
26       NaN  0.106708  0.000013       NaN      NaN     NaN       NaN      NaN  
27     520.0  0.105208  0.000014 -0.000009  26.3120   0.578  0.314899     30.0  
28     523.0  0.104424  0.000009 -0.000006  26.3050   0.576  0.315014     30.0  
29     522.0  0.106593  0.000011 -0.000008  26.2980   0.583  0.315199     30.0  
30     522.0  0.104200  0.000011 -0.000007  26.2750   0.573  0.314735     30.0  
31     519.0  0.101801  0.000012 -0.000008  26.2950   0.576  0.314567     30.0  
32       NaN -0.058956  0.000018       NaN      NaN     NaN       NaN      NaN  
33     429.0 -0.022213  0.000055 -0.000034  26.0500   0.518  0.287138     30.0  
34     524.0  0.103649  0.000015 -0.000010  26.3270   0.573  0.316113     30.0  
35       NaN -0.018910  0.000068       NaN      NaN     NaN       NaN      NaN  
36     519.0  0.107150  0.000010 -0.000007  26.3110   0.576  0.314814     30.0  
37     521.0 -0.078007  0.000018 -0.000012  26.2670   0.586  0.316226     30.0  
38     515.0 -0.054818  0.000023 -0.000016  26.3130   0.560  0.312327     30.0  
39     327.0  0.108852  0.000086 -0.000060  26.2440   0.620  0.324790     30.0  
40     289.0 -0.053486  0.000026 -0.000021  26.1550   0.777  0.325124     30.0  
41     769.0 -0.035187  0.000016 -0.000011  26.0360   0.634  0.303626     30.0  
42     416.0  0.103842  0.000029 -0.000022  26.0410   0.694  0.319420     30.0  
43     412.0  0.108346  0.000027 -0.000021  26.2575   0.788  0.323667     30.0  
44     421.0 -0.101036  0.000030 -0.000024  26.2850   0.749  0.328650     30.0  
45       NaN -0.079722  0.000033       NaN      NaN     NaN       NaN      NaN  
46     424.0  0.090824  0.000013 -0.000010  26.3140   0.758  0.328405     30.0  
47       NaN  0.093022  0.000013       NaN      NaN     NaN       NaN      NaN  
48       NaN  0.116538  0.000025       NaN      NaN     NaN       NaN      NaN  
49     196.0 -0.092825  0.000068 -0.000054  26.2880   0.848  0.325061     30.0  

[50 rows x 32 columns]]",,9.684754848480225,2025-05-19T15:13:54,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,8,"
SELECT dq.* 
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.117942571640016,2025-04-29T12:20:50,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF20aagqifz  2811485780415015019    1  1009.2222  3048.0413  1.186502   
1   ZTF20aagqifz  2801481600415015011    1  1010.0506  3020.4573  1.300918   
2   ZTF20aagqifz  2124399370415015014    1  1069.0713  3052.8560  0.820386   
3   ZTF20aagqifz  2119443950415015013    2  1077.8523  3063.9128  1.034677   
4   ZTF20aagqifz  2119414130415015015    1  1091.5327  3044.4430  1.451592   
5   ZTF20aagqifz  2103441850415015014    1  1088.0603  3024.3690  1.114238   
6   ZTF20aagqifz  2100424470415015023    1  1088.8983  3036.5989  1.249106   
7   ZTF20aagqifz  2098462910415015014    1  1093.5474  3049.1890  1.742281   
8   ZTF20aagqifz  2096463440415015011    1  1094.6730  3041.6526  1.243588   
9   ZTF20aagqifz  2094442390415015009    1  1104.8676  3037.7854  0.953847   
10  ZTF20aagqifz  2092483460415015011    1  1080.4469  3035.9602  1.528272   
11  ZTF20aagqifz  2089476340415015018    1  1075.0028  3056.1580  0.795885   
12  ZTF20aagqifz  2087406700415015002    1  1068.6602  3036.0950  1.066638   
13  ZTF20aagqifz  1776319620415015010    1  1072.7646  3012.1958  0.874511   
14  ZTF20aagqifz  1771337430415015022    1  1057.7980  3037.3050  1.263788   
15  ZTF20aagqifz  1769372780415015015    1  1066.5624  3039.8008  1.211256   
16  ZTF20aagqifz  1764350960415015019    1  1062.7054  3036.9512  1.222805   
17  ZTF20aagqifz  1764323270415015014    2  1043.3646  3043.7983  1.124196   
18  ZTF20aagqifz  1113231880415015009    2   989.1310  2990.8600  1.220510   
19  ZTF20aagqifz  1122159430415015008    1   981.8165  2967.9426  1.591691   
20  ZTF20aagqifz  1139169250415015010    1   969.8665  2991.1519  1.217901   
21  ZTF20aagqifz  1123206200415015014    1   984.3240  2974.1477  1.263840   
22  ZTF20aagqifz  1139137830415015012    2   985.4140  2992.1700  1.743270   
23  ZTF20aagqifz  1117189500415015019    1   984.4227  2977.9553  1.120178   
24  ZTF20aagqifz  1126179280415015007    2   977.2720  2975.2800  0.899435   
25  ZTF20aagqifz  1113203580415015015    1   993.3334  2980.0444  0.642262   
26  ZTF20aagqifz  1120227330415015017    2   976.0790  2939.8200  0.996964   
27  ZTF20aagqifz  1122159430415025009    1   981.8340  2967.9200  1.608050   
28  ZTF20aagqifz  1120168510415015005    1   971.4220  2979.2700  1.451860   
29  ZTF20aagqifz  1119178640415015005    2   987.0431  2971.7727  1.245714   
30  ZTF20aagqifz  1108195540415015012    2   990.7170  2968.9200  1.514860   
31  ZTF20aagqifz  1106186930415015007    2   971.9780  2986.2600  0.884870   
32  ZTF20aagqifz  1123160600415015006    2   981.1890  2978.7900  1.317280   
33  ZTF18actafyj   702257261615015004    2    88.6971   684.8946  1.356573   
34  ZTF20aagrjoj  1113236466315015001    2  2971.0950   118.1713  1.459665   
35  ZTF18actaexm   702255890515015003    2  3000.1345  2935.8750  1.564398   
36  ZTF20aagscib  1113253285515015003    2   374.6217  1104.8109  2.875119   
37  ZTF20aazongd  1276478413815015002    2  1838.2600   261.3680  1.078820   
38  ZTF20aazongd  1281358643815015001    2  1847.1874   241.2517  1.120944   
39  ZTF20aazongd  1282388203815015000    2  1874.8800   250.6520  0.848583   
40  ZTF20aazongd  1285452113815015003    2  1864.0900   267.3610  1.557480   
41  ZTF20aazongd  1291372043815015001    2  1866.0457   253.5026  1.773327   
42  ZTF20aazongd  1296484533815015001    2  1872.6982   257.5655  1.674507   
43  ZTF20aazongd  1264390723815015003    1  1819.9600   227.8990  0.987160   
44  ZTF20aazongd  1272472413815015001    2  1868.5530   258.7812  1.630750   
45  ZTF20aazongd  1292419243815015001    2  1839.3317   253.8165  1.214084   
46  ZTF20aazongd  1264472623815015001    2  1845.3418   288.7882  1.326890   
47  ZTF20aazongd  1290464013815015002    2  1845.2253   249.3100  1.227960   
48  ZTF20aazongd  1297437403815015003    2  1887.9749   270.8384  0.939578   
49  ZTF20aazongd  1283452283815015001    2  1842.2500   262.0490  1.028900   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.004952  2.190000     0.903     32.4588  ...     0.000005     0.031404   
1   0.168492  2.060000     0.919     60.0428  ...     0.000005     0.033672   
2   0.336220  3.830000     0.811     27.6441  ...     0.000006     0.033130   
3   1.087828  2.970000     0.960     16.5872  ...     0.000003     0.032542   
4   0.083151  2.590000     0.978     36.0568  ...     0.000008     0.038029   
5  -0.035768  2.180000     0.927     56.1312  ...     0.000004     0.028996   
6  -0.365561  3.800000     0.778     43.9012  ...     0.000006     0.033840   
7   0.396474  2.230000     0.962     31.3110  ...     0.000005     0.029286   
8   0.296813  2.120000     0.864     38.8473  ...     0.000005     0.028745   
9   0.460994  1.810000     0.827     42.7147  ...     0.000005     0.029860   
10  0.075127  2.640000     0.910     44.5397  ...     0.000005     0.029566   
11  0.293957  4.200000     0.917     24.3420  ...     0.000006     0.033692   
12  0.296374  1.780000     0.870     44.4051  ...     0.000006     0.032659   
13 -0.122449  2.450000     0.933     68.3043  ...     0.000007     0.031215   
14 -0.322848  2.760000     0.789     43.1950  ...     0.000005     0.031279   
15  0.348146  2.320000     0.924     40.6991  ...     0.000005     0.032220   
16 -0.237081  2.750000     0.805     43.5489  ...     0.000006     0.039507   
17 -0.351611  1.153008     0.818     36.7016  ...     0.000004     0.034943   
18 -0.825281  1.224720     0.718     89.6430  ...     0.000003     0.019229   
19 -0.216488  2.050000     0.925    112.5573  ...     0.000005     0.033694   
20  0.007308  2.110000     0.856     89.3481  ...     0.000006     0.034353   
21  0.223618  3.130000     0.896    106.3522  ...     0.000007     0.037384   
22 -0.475717  1.610000     0.951     88.3323  ...     0.000004     0.022520   
23  0.436911  2.880000     0.889    102.5446  ...     0.000007     0.037641   
24  0.034442  2.920000     0.695    105.2250  ...     0.000005     0.024549   
25 -0.284390  4.410000     0.865    100.4556  ...     0.000009     0.040359   
26  2.602270  2.450000     0.912    140.6810  ...     0.000006     0.028238   
27 -0.237248  2.040000     0.925    112.5790  ...     0.000005     0.026359   
28  0.511080  1.272770     0.565    101.2340  ...     0.000008     0.031608   
29  0.222628  1.960000     0.930    108.7273  ...     0.000003     0.032596   
30  0.338076  1.205230     0.820    111.5800  ...     0.000003     0.019563   
31 -0.625773  1.340440     0.970     94.2356  ...     0.000005     0.025478   
32 -0.444508  1.930000     0.815    101.7130  ...     0.000003     0.020398   
33 -1.251560  2.110000     0.980     88.6971  ...     0.000019     0.045872   
34  0.946912  3.500000     0.887    101.4051  ...     0.000005     0.029763   
35  1.217123  2.620000     0.982     72.3654  ...     0.000015     0.038441   
36  0.932064  2.430000     0.984    374.6217  ...     0.000001     0.018071   
37 -0.764803  3.600000     0.779    261.3680  ...     0.000002     0.023845   
38 -0.553278  1.374175     0.844    241.2517  ...     0.000006     0.047529   
39 -0.041739  2.350000     0.963    250.6520  ...     0.000003     0.025374   
40 -0.704572  1.374170     0.875    267.3610  ...     0.000002     0.023588   
41  0.158553  2.900000     0.949    253.5026  ...     0.000002     0.035391   
42  0.213532  1.102610     0.993    257.5655  ...     0.000002     0.033853   
43 -0.054763  1.472890     0.527    227.8990  ...     0.000005     0.035537   
44  0.016959  1.860000     0.954    258.7812  ...     0.000002     0.033139   
45  0.101883  3.820000     0.926    253.8165  ...     0.000002     0.033838   
46  0.519903  1.940000     0.975    288.7882  ...     0.000002     0.035335   
47  0.030889  1.950000     0.953    249.3100  ...     0.000002     0.033415   
48  0.269862  1.740000     0.957    270.8384  ...     0.000002     0.034215   
49 -0.518982  1.502600     0.746    262.0490  ...     0.000006     0.039644   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0      969.0 -0.064884  0.000008 -0.000006  26.317000   0.638  0.284538   
1      965.0 -0.078609  0.000008 -0.000006  26.268000   0.636  0.282868   
2      954.0 -0.061380  0.000011 -0.000008  26.335000   0.633  0.280091   
3      963.0  0.090272  0.000005 -0.000004  26.365000   0.643  0.288164   
4      957.0 -0.072400  0.000013 -0.000010  26.219000   0.642  0.286585   
5      953.0 -0.058383  0.000007 -0.000005  26.294000   0.642  0.286913   
6      960.0 -0.064942  0.000010 -0.000007  26.283000   0.645  0.286834   
7      955.0 -0.058088  0.000007 -0.000005  26.330000   0.638  0.286933   
8      958.0 -0.052397  0.000008 -0.000006  26.300499   0.642  0.287727   
9      958.0 -0.054713  0.000008 -0.000006  26.311000   0.638  0.286913   
10     963.0 -0.055506  0.000008 -0.000006  26.338000   0.643  0.287764   
11     962.0 -0.072385  0.000009 -0.000007  26.347000   0.643  0.286736   
12     960.0 -0.058970  0.000010 -0.000008  26.287000   0.634  0.282252   
13     945.0 -0.039021  0.000012 -0.000008  26.346000   0.633  0.279118   
14     968.0 -0.066814  0.000008 -0.000006  26.343000   0.638  0.285096   
15     965.0 -0.073370  0.000008 -0.000006  26.358000   0.642  0.284880   
16     970.0 -0.100023  0.000009 -0.000007  26.341000   0.643  0.286574   
17     974.0  0.096636  0.000006 -0.000004  26.378000   0.642  0.285154   
18       NaN  0.086727  0.000005       NaN        NaN     NaN       NaN   
19     978.0 -0.073537  0.000009 -0.000006  26.292000   0.643  0.285355   
20     973.0 -0.072528  0.000010 -0.000007  26.277000   0.642  0.284290   
21     972.0 -0.076291  0.000012 -0.000009  26.275000   0.642  0.284018   
22       NaN  0.086520  0.000006       NaN        NaN     NaN       NaN   
23     979.0 -0.080061  0.000011 -0.000008  26.315000   0.643  0.284507   
24       NaN  0.097269  0.000008       NaN        NaN     NaN       NaN   
25     971.0 -0.081317  0.000014 -0.000010  26.249000   0.638  0.282738   
26       NaN  0.088305  0.000010       NaN        NaN     NaN       NaN   
27       NaN -0.072879  0.000009       NaN        NaN     NaN       NaN   
28       NaN -0.079478  0.000013       NaN        NaN     NaN       NaN   
29     980.0  0.089572  0.000005 -0.000004  26.347000   0.646  0.286865   
30       NaN  0.094349  0.000005       NaN        NaN     NaN       NaN   
31       NaN  0.098545  0.000008       NaN        NaN     NaN       NaN   
32       NaN  0.093525  0.000005       NaN        NaN     NaN       NaN   
33     295.0  0.121319  0.000024 -0.000020  26.300000   0.866  0.310363   
34    1862.0  0.084281  0.000005 -0.000005  26.166000   0.888  0.228282   
35     284.0  0.092305  0.000020 -0.000016  26.322000   0.803  0.321922   
36    1914.0  0.076836  0.000005 -0.000003  26.294000   0.470  0.142354   
37       NaN  0.097433  0.000004       NaN        NaN     NaN       NaN   
38    1594.0  0.102828  0.000010 -0.000007  26.345000   0.584  0.291704   
39       NaN  0.105219  0.000005       NaN        NaN     NaN       NaN   
40       NaN  0.104150  0.000004       NaN        NaN     NaN       NaN   
41    1601.0  0.093674  0.000004 -0.000003  26.376000   0.585  0.291050   
42    1598.0  0.092712  0.000003 -0.000002  26.398000   0.584  0.290255   
43       NaN -0.071475  0.000010       NaN        NaN     NaN       NaN   
44    1602.0  0.090282  0.000003 -0.000002  26.397000   0.584  0.290570   
45    1597.0  0.089761  0.000003 -0.000002  26.394000   0.584  0.290343   
46    1594.0  0.095359  0.000004 -0.000002  26.365000   0.584  0.290800   
47    1599.0  0.091119  0.000003 -0.000002  26.391000   0.584  0.291054   
48    1590.0  0.091560  0.000003 -0.000002  26.376000   0.583  0.290503   
49       NaN  0.093390  0.000012       NaN        NaN     NaN       NaN   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18      NaN  
19     30.0  
20     30.0  
21     30.0  
22      NaN  
23     30.0  
24      NaN  
25     30.0  
26      NaN  
27      NaN  
28      NaN  
29     30.0  
30      NaN  
31      NaN  
32      NaN  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37      NaN  
38     30.0  
39      NaN  
40      NaN  
41     30.0  
42     30.0  
43      NaN  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49      NaN  

[50 rows x 32 columns]]",,11.355304718017578,2025-05-19T15:14:12,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,9,"
-- Retrieve all columns from the 'dataquality' table for ZTF objects with a high probability of being supernovae
SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,14.054017543792725,2025-04-29T12:21:05,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF18acvgehz   726477983615015014    1  1848.2600  2994.7000  1.141980   
1   ZTF18acvgehz   732455783615015055    2  1851.5511  2962.7446  1.213882   
2   ZTF18acvgehz   727434323615015027    2  1845.7721  2995.2927  1.043176   
3   ZTF18acvgehz   728514443615015034    1  1848.8438  2955.0266  1.337068   
4   ZTF18acvgehz   718435123615015035    2  1866.3400  2928.8900  1.242460   
5   ZTF18acvgehz   726440763615015048    2  1851.7491  2995.4531  1.288159   
6   ZTF18acvgehz   737417093615015027    2  1865.6500  2946.6200  1.759590   
7   ZTF18acvgehz   718442633615015034    2  1868.5219  2929.5674  2.591470   
8   ZTF18acvgehz   738478643615015038    2  1852.3038  3003.1353  1.471935   
9   ZTF18acvgehz   721516623615015006    1  1837.9400  2947.4800  1.060740   
10  ZTF18acvgehz   737430713615015045    1  1856.9279  2944.8945  1.375498   
11  ZTF18acvgehz   710465283615015019    1  1861.1613  2979.5925  1.160312   
12  ZTF18acvgjqv  1082489420915015004    2  2405.0900  1286.6200  1.191320   
13  ZTF18acvgjqv   721509660915015001    1  2343.5107  1316.2094  1.034398   
14  ZTF18acvgjqv  1125301410915015002    2  2410.7900  1263.9500  0.733933   
15  ZTF18acvgjqv   803218090915025008    2  2345.7610  1333.4185  1.210485   
16  ZTF18acvgjqv   803175170915025005    1  2354.7500  1328.4800  0.871324   
17  ZTF18acvgjqv   780236360915015004    1  2341.2000  1329.8500  1.161410   
18  ZTF18acvgjqv   726470570915015010    1  2336.6338  1347.6465  1.260282   
19  ZTF18acvgjqv   757174870915015002    1  2364.6897  1281.3289  1.994460   
20  ZTF18acvgjqv   818196060915015012    1  2370.4840  1284.7998  0.961041   
21  ZTF18acvgjqv  1121243150915015003    2  2415.4700  1216.2400  0.997083   
22  ZTF18acvgjqv   806198240915015006    1  2354.7400  1307.7800  1.115210   
23  ZTF18acvgjqv   772221770915015002    2  2340.9026  1327.8993  1.216444   
24  ZTF18acvgjqv  1092447900915015003    2  2404.0415  1292.1107  1.365320   
25  ZTF18acvgjqv  1076452090915015004    2  2403.2800  1225.8300  1.404370   
26  ZTF18acvgjqv   710475390915015000    1  2351.3200  1322.8500  1.016940   
27  ZTF18acvgjqv  1123308170915015002    2  2426.1100  1265.5500  0.904787   
28  ZTF18acvgjqv   732428410915015005    1  2351.2456  1327.9229  1.537794   
29  ZTF18acvgjqv   760412560915015010    2  2359.4182  1328.9298  1.025182   
30  ZTF18acvgjqv   732466860915015001    2  2352.9866  1324.2390  1.155405   
31  ZTF18acvgjqv   780340150915015000    2  2354.5588  1310.5560  1.226056   
32  ZTF18acvgjqv   851224900915015009    1  2346.5650  1182.8505  0.948921   
33  ZTF18acvgjqv  1117304430915015006    2  2417.6700  1253.4300  1.167790   
34  ZTF18acvgjqv  1012532540915015003    2  2414.7100  1202.2800  1.288090   
35  ZTF18acvgjqv  1141285640915015004    2  2419.0085  1247.3245  0.894473   
36  ZTF18acvgjqv   792241450915015011    1  2362.3500  1324.0900  1.056540   
37  ZTF18acvgjqv   888217470915015005    2  2383.6860  1148.3623  1.234156   
38  ZTF18acvgjqv   751514440915015000    2  2350.8100  1315.0700  0.864819   
39  ZTF18acvgjqv   882240390915015004    1  2371.9500  1164.4400  0.901469   
40  ZTF18acvgjqv   754238040915015020    2  2361.2107  1310.7065  2.781952   
41  ZTF18acvgjqv   863222480915015002    2  2367.2678  1200.8860  1.116186   
42  ZTF18acvgjqv   826215310915015010    2  2378.8970  1322.8445  1.450332   
43  ZTF18acvgjqv   813220550915015015    2  2366.3916  1281.2747  3.534299   
44  ZTF18acvgjqv   726429150915015004    2  2341.9930  1341.1527  1.153758   
45  ZTF18acvgjqv  1126324370915015004    2  2436.2300  1262.4600  1.131860   
46  ZTF18acvgjqv   768427280915015006    1  2345.2515  1337.4773  2.996294   
47  ZTF18acvgjqv   840164750915015007    2  2377.3535  1307.5880  1.754130   
48  ZTF18acvgjqv   753519200915015010    1  2363.3354  1290.7352  1.031187   
49  ZTF18acvgjqv   837175160915015006    1  2367.3300  1315.1400  1.059650   

         sky     fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.148367  5.52000     0.681     85.7968  ...     0.000000     0.000000   
1  -0.271858  3.32000     0.940    117.7553  ...     0.000009     0.043160   
2  -0.587061  3.31000     0.946     85.2072  ...     0.000008     0.044155   
3  -0.400668  3.55000     0.945    125.4733  ...     0.000013     0.040474   
4  -0.315047  2.26000     0.974    151.6110  ...     0.000000     0.000000   
5   0.073826  3.44000     0.957     85.0468  ...     0.000008     0.046010   
6  -0.236627  2.85000     0.893    133.8790  ...     0.000000     0.000000   
7   0.378006  2.31000     1.000    150.9325  ...     0.000007     0.041591   
8   0.916076  2.06000     0.957     77.3647  ...     0.000007     0.039501   
9  -0.506728  1.34279     0.989    133.0160  ...     0.000000     0.000000   
10 -0.151336  2.68000     0.739    135.6055  ...     0.000014     0.038584   
11  0.283938  2.36000     0.789    100.9075  ...     0.000007     0.027171   
12  0.008813  3.06000     0.919    667.4150  ...     0.000008     0.023151   
13  0.302031  1.89000     0.982    728.9892  ...     0.000021     0.039203   
14 -0.678310  1.82177     0.375    661.7110  ...     0.000012     0.028308   
15 -0.412832  4.00000     0.912    726.7390  ...     0.000012     0.045616   
16 -0.074644  6.74000     0.845    717.7510  ...     0.000000     0.000000   
17 -0.002674  2.24000     0.968    731.3040  ...     0.000000     0.000000   
18  0.182371  3.79000     0.966    735.8663  ...     0.000020     0.042632   
19 -0.107767  4.10000     0.961    707.8103  ...     0.000019     0.046908   
20 -0.351648  2.39000     0.948    702.0161  ...     0.000018     0.040448   
21 -0.206974  1.33217     0.666    657.0260  ...     0.000008     0.022938   
22 -0.000554  3.91000     0.681    717.7550  ...     0.000000     0.000000   
23 -0.398925  2.94000     0.980    731.5975  ...     0.000011     0.045451   
24  0.443543  2.28000     0.954    668.4584  ...     0.000007     0.037400   
25 -0.029599  1.11825     0.948    669.2210  ...     0.000017     0.034867   
26 -0.139900  4.18000     0.591    721.1830  ...     0.000000     0.000000   
27 -0.021696  1.34044     0.552    646.3930  ...     0.000007     0.021587   
28 -0.037089  4.14000     0.927    721.2545  ...     0.000016     0.036448   
29 -0.864690  3.66000     0.888    713.0818  ...     0.000035     0.055665   
30  0.065728  2.40000     0.982    719.5134  ...     0.000007     0.037287   
31  0.027740  2.33000     0.999    717.9411  ...     0.000018     0.052311   
32 -0.330592  2.23000     0.868    725.9351  ...     0.000011     0.036576   
33  0.144409  4.27000     0.755    654.8290  ...     0.000006     0.019667   
34  0.064027  2.54000     0.945    657.7880  ...     0.000008     0.024092   
35 -0.090768  2.33000     0.850    653.4914  ...     0.000008     0.040313   
36 -0.246465  2.73000     0.518    710.1450  ...     0.000047     0.047704   
37 -0.061448  2.38000     0.975    688.8139  ...     0.000009     0.043993   
38 -0.585029  6.04000     0.957    721.6890  ...     0.000000     0.000000   
39  0.080825  1.47289     0.460    700.5470  ...     0.000000     0.000000   
40 -0.146133  2.04000     0.982    711.2893  ...     0.000007     0.039029   
41 -0.251340  1.68000     0.997    705.2322  ...     0.000012     0.043685   
42  0.101757  2.51000     0.977    693.6031  ...     0.000006     0.038284   
43  0.374739  2.40000     0.979    706.1083  ...     0.000008     0.040055   
44 -0.218685  4.08000     0.972    730.5070  ...     0.000008     0.038098   
45 -0.266708  2.35000     0.522    636.2730  ...     0.000007     0.022162   
46  0.153465  2.21000     0.981    727.2486  ...     0.000010     0.030355   
47 -0.556638  2.70000     0.971    695.1464  ...     0.000007     0.043084   
48  0.327685  3.25000     0.977    709.1645  ...     0.000028     0.041860   
49  0.227827  2.11000     0.991    705.1720  ...     0.000000     0.000000   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
1      562.0  0.108748  0.000014 -0.000010  26.324501   0.650  0.308880   
2      565.0  0.114917  0.000013 -0.000009  26.312000   0.650  0.309095   
3      539.0 -0.078838  0.000022 -0.000016  26.134000   0.615  0.300899   
4        NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
5      563.0  0.121316  0.000013 -0.000010  26.302000   0.651  0.309937   
6        NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
7      559.0  0.110349  0.000011 -0.000008  26.339000   0.649  0.308596   
8      559.0  0.100787  0.000011 -0.000008  26.120000   0.651  0.308119   
9        NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
10     557.0 -0.061302  0.000022 -0.000016  26.140000   0.630  0.306920   
11     562.0 -0.035241  0.000012 -0.000008  26.032000   0.648  0.309453   
12       NaN  0.098305  0.000011       NaN        NaN     NaN       NaN   
13     355.0 -0.058203  0.000039 -0.000026  26.292000   0.562  0.299536   
14       NaN  0.105875  0.000017       NaN        NaN     NaN       NaN   
15     454.0  0.110622  0.000017 -0.000013  26.257000   0.717  0.323228   
16       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
17       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
18     383.0 -0.079768  0.000036 -0.000025  26.263000   0.585  0.298976   
19     432.0 -0.096253  0.000029 -0.000021  26.161499   0.684  0.318660   
20     429.0 -0.066320  0.000027 -0.000020  25.798000   0.674  0.319287   
21       NaN  0.102089  0.000011       NaN        NaN     NaN       NaN   
22       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
23     454.0  0.113111  0.000016 -0.000012  26.194000   0.714  0.322511   
24     458.0  0.092403  0.000011 -0.000008  26.338000   0.717  0.323158   
25       NaN  0.095766  0.000025       NaN        NaN     NaN       NaN   
26       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
27       NaN  0.099629  0.000010       NaN        NaN     NaN       NaN   
28     445.0 -0.046682  0.000024 -0.000018  26.286000   0.685  0.319103   
29     431.0  0.087375  0.000053 -0.000040  25.001000   0.692  0.318861   
30     456.0  0.094054  0.000010 -0.000007  26.286000   0.712  0.322929   
31     451.0  0.118053  0.000027 -0.000020  26.236000   0.702  0.323827   
32     447.0 -0.075698  0.000016 -0.000012  26.131000   0.712  0.322761   
33       NaN  0.097861  0.000008       NaN        NaN     NaN       NaN   
34       NaN  0.101833  0.000012       NaN        NaN     NaN       NaN   
35     460.0  0.101398  0.000011 -0.000008  26.310000   0.720  0.325129   
36       NaN -0.026081  0.000096       NaN        NaN     NaN       NaN   
37     449.0  0.111964  0.000013 -0.000010  26.145000   0.702  0.324114   
38       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
39       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
40     456.0  0.099130  0.000010 -0.000008  26.267000   0.717  0.323494   
41     450.0  0.099887  0.000018 -0.000014  26.130000   0.717  0.325223   
42     458.0  0.098748  0.000009 -0.000007  26.233000   0.712  0.323709   
43     453.0  0.100515  0.000011 -0.000009  26.217000   0.717  0.324350   
44     455.0  0.091344  0.000012 -0.000009  26.262000   0.717  0.324205   
45       NaN  0.105062  0.000010       NaN        NaN     NaN       NaN   
46     454.0 -0.045541  0.000015 -0.000011  26.222000   0.707  0.324906   
47     451.0  0.113000  0.000011 -0.000008  26.223000   0.712  0.324295   
48     344.0 -0.042516  0.000050 -0.000034  26.224000   0.571  0.302792   
49       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   

    exptime  
0       NaN  
1      30.0  
2      30.0  
3      30.0  
4       NaN  
5      30.0  
6       NaN  
7      30.0  
8      30.0  
9       NaN  
10     30.0  
11     30.0  
12      NaN  
13     30.0  
14      NaN  
15     30.0  
16      NaN  
17      NaN  
18     30.0  
19     30.0  
20     30.0  
21      NaN  
22      NaN  
23     30.0  
24     30.0  
25      NaN  
26      NaN  
27      NaN  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33      NaN  
34      NaN  
35     30.0  
36      NaN  
37     30.0  
38      NaN  
39      NaN  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45      NaN  
46     30.0  
47     30.0  
48     30.0  
49      NaN  

[50 rows x 32 columns]]",,9.627604007720947,2025-05-19T15:14:28,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,10,"
-- Select all columns from the dataquality table for ZTF objects with a probability greater than 0.7 of being supernovae
SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN' -- Filter for supernova class
  AND p.classifier_name = 'stamp_classifier' -- Use the stamp classifier
  AND p.probability > 0.7 -- Probability condition
  AND p.ranking = 1 -- Only consider the most likely class
LIMIT 50 -- Limit the results to at most 50 objects
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.2511727809906,2025-04-29T12:21:17,"[             oid              candid  fid       xpos       ypos     chipsf  \
0   ZTF19aaunhii  858435551115015045    2  2118.0874  1927.2917   5.452446   
1   ZTF19aaurhox  906201085115015037    1  2412.6570  2711.6707   2.678345   
2   ZTF19aaurhox  906201556215015018    1  2123.1736  2690.9016   0.916354   
3   ZTF19aaurhox  903372816215015011    2  2096.9340  2711.1743   0.859547   
4   ZTF19aaurhox  930178936215015034    2  2150.1057  2899.1309   1.069997   
5   ZTF19aaurhox  893347776215015005    1  2104.4250  2912.1042   2.067589   
6   ZTF19aaurhox  893223805115015009    1  2429.7927  2931.5580   2.525564   
7   ZTF19aaurhox  884282696215015006    2  2099.3188  2865.2188   5.593331   
8   ZTF19aaurhox  887228345115015025    1  2421.4840  2865.1182   7.327455   
9   ZTF19aaurhox  912249365115015040    1  2422.0066  2733.8830   1.554244   
10  ZTF19aaurhox  899304346215015012    1  2102.3687  2848.9192   1.097762   
11  ZTF19aaurhox  903222975115015060    1  2411.3486  2740.6904   1.821810   
12  ZTF19aaurhox  918312075115015027    1  2391.4500  2876.8200   1.315080   
13  ZTF19aaurhox  878353806215015011    1  2076.4883  2894.7935  15.709648   
14  ZTF19aaurhox  899202116215015004    2  2120.2207  2851.4450   3.367738   
15  ZTF19aaurhox  899203515115015015    2  2410.9292  2872.9890   1.162083   
16  ZTF19aaurhox  921256246215015011    2  2125.2349  2879.2747   1.655365   
17  ZTF19aaurhox  862449646215015012    1  2079.6820  2874.2660   1.375574   
18  ZTF19aaurhox  878324516215015011    2  2096.9956  2894.7150   7.789774   
19  ZTF19aaurhox  884340496215015011    1  2085.6443  2872.1180   6.624379   
20  ZTF19aaurhox  890221415115015016    1  2431.2715  2869.2695   3.552444   
21  ZTF19aaurhox  893284836215015006    2  2130.9539  2909.7060   2.001012   
22  ZTF19aaurhox  906245035115015025    2  2395.5580  2724.5442  11.479801   
23  ZTF19aaurhox  864228342215015006    2  2576.9001  2313.3510   1.296691   
24  ZTF19aaurhox  862370025115015013    2  2370.5112  2900.2415   2.103512   
25  ZTF19aaurhox  909312235115015015    2  2401.3582  2757.2922   4.076539   
26  ZTF19aaurhox  865346005115015008    2  2361.7832  2864.6602   1.353393   
27  ZTF19aaurhox  862387616215015007    2  2076.6104  2876.8987   1.254141   
28  ZTF19aaurhox  878297815115015009    2  2372.4070  2912.5650  20.143017   
29  ZTF19aaurhox  915318375115015015    2  2401.9224  2929.6726   2.026856   
30  ZTF19aaurhox  896284536215015005    2  2110.6172  2832.4731   2.819755   
31  ZTF19aaurhox  918216245115015021    2  2415.0989  2890.7126   1.494941   
32  ZTF19aaurhox  887321856215015007    2  2099.3200  2859.0840   5.640215   
33  ZTF19aaurhox  930197376215015029    1  2135.4600  2897.1500   1.000470   
34  ZTF19aaurhox  884341895115015029    1  2374.7683  2890.1636   3.253323   
35  ZTF19aaurhox  887244186215015028    1  2136.6450  2848.3616   8.096786   
36  ZTF19aaurhox  881220175115015027    1  2383.7834  2872.9583   5.901999   
37  ZTF19aaurhox  899302935115015014    1  2389.8052  2867.4624   1.193978   
38  ZTF19aaurhox  930199225115015030    1  2412.7500  2914.9800   1.441410   
39  ZTF19aaurhox  930181255115015027    2  2430.9320  2917.6565   1.462485   
40  ZTF19aaurhox  909320526215015024    2  2120.0470  2738.7505   1.717398   
41  ZTF19aaurhox  903263265115015014    2  2399.3208  2748.7654   2.630050   
42  ZTF19aaurhox  924226495115015012    2  2419.7188  2890.6100   1.498943   
43  ZTF19aaurhox  884279845115015016    2  2388.5278  2885.2568  13.499000   
44  ZTF19aaurhox  937206925115015024    2  2420.7350  2900.6900   1.416566   
45  ZTF19aaurhox  881280546215015015    2  2084.6372  2864.6433  13.566373   
46  ZTF19aaurhox  863284242215015013    2  2576.2031  2323.7024   1.565817   
47  ZTF19aaurhox  890285615115015016    2  2409.4937  2848.1860   8.404515   
48  ZTF19aaurhox  873368816215015010    2  2062.0637  2912.7012   6.993025   
49  ZTF19aaurhox  903243846215015015    1  2125.6530  2722.2666   1.127177   

         sky     fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.152973  1.66000     0.969    954.4125  ...     0.000002     0.031738   
1   0.281155  2.38000     0.977    368.8293  ...     0.000006     0.033742   
2  -1.412516  2.33000     0.893    389.5984  ...     0.000006     0.033619   
3  -2.062414  3.31000     0.980    369.3256  ...     0.000006     0.041385   
4  -0.101487  1.75000     0.960    181.3691  ...     0.000005     0.038228   
5  -0.220518  2.86000     0.982    168.3958  ...     0.000007     0.032470   
6   0.933619  2.20000     0.986    148.9418  ...     0.000008     0.032778   
7   0.014243  2.90000     0.979    215.2812  ...     0.000004     0.040343   
8  -0.099133  2.21000     0.982    215.3819  ...     0.000006     0.029582   
9  -0.260092  2.21000     0.784    346.6170  ...     0.000007     0.032799   
10  0.511810  2.45000     0.974    231.5808  ...     0.000009     0.036468   
11 -0.008678  2.28000     0.966    339.8095  ...     0.000006     0.031948   
12  0.094400  2.02000     0.583    203.6750  ...     0.000006     0.028067   
13 -0.066495  2.69000     0.988    185.7066  ...     0.000006     0.032225   
14  0.195571  2.30000     0.983    229.0550  ...     0.000004     0.037811   
15 -0.231458  1.75000     0.983    207.5110  ...     0.000005     0.040745   
16 -0.153941  1.75000     0.975    201.2254  ...     0.000005     0.039048   
17  0.238629  2.50000     0.927    206.2340  ...     0.000005     0.030159   
18 -0.111614  2.80000     0.982    185.7849  ...     0.000005     0.040911   
19  0.087238  2.65000     0.982    208.3821  ...     0.000005     0.030065   
20  0.081136  2.29000     0.999    211.2305  ...     0.000006     0.031136   
21 -0.491752  2.49000     0.982    170.7939  ...     0.000005     0.039749   
22  0.126471  2.06000     1.000    355.9559  ...     0.000005     0.039413   
23  0.274578  2.18000     0.986    495.5998  ...     0.000006     0.043955   
24 -0.112779  2.04000     0.934    180.2585  ...     0.000005     0.039447   
25  0.232829  1.80000     0.986    323.2077  ...     0.000005     0.038389   
26 -2.642177  2.20000     0.976    215.8398  ...     0.000009     0.046273   
27  0.164745  2.50000     0.945    203.6012  ...     0.000006     0.041868   
28  0.257397  1.92000     1.000    167.9350  ...     0.000004     0.037942   
29 -0.176689  1.96000     0.976    150.8273  ...     0.000005     0.039333   
30 -0.485071  2.42000     0.986    248.0268  ...     0.000008     0.047113   
31 -0.062965  2.00000     0.972    189.7874  ...     0.000004     0.037476   
32  0.056189  2.98000     0.982    221.4159  ...     0.000010     0.047482   
33  0.324299  2.37000     0.583    183.3490  ...     0.000005     0.026952   
34 -0.075219  2.37000     0.982    190.3364  ...     0.000006     0.034729   
35  0.245014  2.34000     0.985    232.1384  ...     0.000007     0.034863   
36 -0.088207  2.03000     0.983    207.5417  ...     0.000005     0.031225   
37  0.446249  2.27000     0.981    213.0375  ...     0.000010     0.034810   
38  0.179048  1.29124     0.641    165.5230  ...     0.000007     0.029457   
39 -0.064343  1.67000     0.967    162.8436  ...     0.000004     0.036929   
40 -2.144944  2.14000     0.979    341.7495  ...     0.000004     0.037761   
41 -0.388799  2.24000     0.998    331.7346  ...     0.000006     0.041519   
42  0.291347  1.09254     0.949    189.8900  ...     0.000006     0.041090   
43  0.334878  1.87000     0.983    195.2431  ...     0.000004     0.038372   
44  0.096152  1.80000     0.898    179.8101  ...     0.000004     0.038205   
45  0.073072  2.36000     1.000    215.8568  ...     0.000005     0.039490   
46 -0.084460  2.13000     0.985    496.2969  ...     0.000006     0.042131   
47  0.217793  1.49000     0.983    232.3140  ...     0.000005     0.039613   
48 -0.186783  2.45000     0.983    167.7989  ...     0.000005     0.041209   
49 -1.475509  3.30000     0.914    358.2333  ...     0.000007     0.031852   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0     1638.0  0.085267  0.000005 -0.000003  26.1580   0.515  0.258241     30.0  
1      730.0 -0.063422  0.000010 -0.000007  26.1360   0.606  0.312943     30.0  
2      770.0 -0.059197  0.000011 -0.000007  26.1030   0.584  0.309390     30.0  
3      770.0  0.097343  0.000011 -0.000007  26.0900   0.591  0.309518     30.0  
4      768.0  0.092634  0.000009 -0.000006  26.1180   0.566  0.308556     30.0  
5      727.0 -0.035162  0.000015 -0.000009  26.1230   0.550  0.298451     30.0  
6      725.0 -0.031827  0.000015 -0.000010  26.1450   0.553  0.298062     30.0  
7      775.0  0.103414  0.000008 -0.000005  26.1190   0.583  0.309786     30.0  
8      752.0 -0.039140  0.000010 -0.000007  26.0460   0.584  0.309160     30.0  
9      737.0 -0.048951  0.000012 -0.000008  26.1470   0.603  0.311807     30.0  
10     717.0 -0.043054  0.000019 -0.000012  26.0820   0.539  0.292216     30.0  
11     735.0 -0.053846  0.000010 -0.000007  26.1050   0.603  0.312393     30.0  
12       NaN -0.050554  0.000011       NaN      NaN     NaN       NaN      NaN  
13     770.0 -0.051773  0.000011 -0.000007  26.0790   0.566  0.308359     30.0  
14     778.0  0.097987  0.000007 -0.000005  26.0570   0.581  0.308405     30.0  
15     764.0  0.102840  0.000009 -0.000006  26.0960   0.589  0.310938     30.0  
16     772.0  0.097076  0.000009 -0.000006  26.0890   0.581  0.308726     30.0  
17     772.0 -0.051284  0.000009 -0.000006  26.0540   0.582  0.310404     30.0  
18     767.0  0.105154  0.000008 -0.000006  26.0870   0.571  0.309389     30.0  
19     768.0 -0.048025  0.000009 -0.000006  26.0740   0.567  0.308884     30.0  
20     747.0 -0.039295  0.000012 -0.000008  26.1360   0.578  0.308731     30.0  
21     765.0  0.099890  0.000009 -0.000006  26.1150   0.566  0.307395     30.0  
22     735.0  0.099962  0.000008 -0.000006  26.1500   0.610  0.312725     30.0  
23     745.0  0.112058  0.000010 -0.000007  26.2860   0.611  0.311003     30.0  
24     762.0  0.099330  0.000008 -0.000006  26.1035   0.595  0.310653     30.0  
25     740.0  0.095369  0.000008 -0.000006  26.1255   0.604  0.311723     30.0  
26     746.0  0.098065  0.000017 -0.000011  26.0300   0.602  0.311705     30.0  
27     771.0  0.100360  0.000011 -0.000007  26.0870   0.582  0.308228     30.0  
28     762.0  0.097966  0.000007 -0.000005  26.1220   0.602  0.311338     30.0  
29     772.0  0.097509  0.000009 -0.000006  26.1430   0.602  0.310211     30.0  
30     781.0  0.112244  0.000014 -0.000009  26.1390   0.584  0.309169     30.0  
31     777.0  0.094290  0.000007 -0.000005  26.1200   0.589  0.310234     30.0  
32     772.0  0.102327  0.000017 -0.000012  26.2335   0.584  0.307635     30.0  
33       NaN -0.052726  0.000010       NaN      NaN     NaN       NaN      NaN  
34     762.0 -0.061379  0.000011 -0.000008  26.1070   0.591  0.310589     30.0  
35     775.0 -0.050521  0.000013 -0.000009  25.9350   0.569  0.309123     30.0  
36     755.0 -0.053302  0.000009 -0.000006  26.0830   0.593  0.312406     30.0  
37     682.0 -0.015468  0.000021 -0.000013  26.1200   0.535  0.291044     30.0  
38       NaN -0.046887  0.000012       NaN      NaN     NaN       NaN      NaN  
39     768.0  0.091825  0.000008 -0.000005  26.1415   0.589  0.307999     30.0  
40     770.0  0.098005  0.000007 -0.000005  26.0800   0.586  0.308852     30.0  
41     740.0  0.102107  0.000010 -0.000007  26.1270   0.610  0.312456     30.0  
42     774.0  0.099450  0.000010 -0.000007  26.1510   0.591  0.309601     30.0  
43     774.0  0.097445  0.000007 -0.000005  26.1100   0.602  0.312022     30.0  
44     775.0  0.099321  0.000007 -0.000005  26.1020   0.596  0.309527     30.0  
45     774.0  0.097926  0.000009 -0.000006  26.0910   0.582  0.308482     30.0  
46     748.0  0.105885  0.000009 -0.000007  26.3045   0.618  0.311305     30.0  
47     761.0  0.099361  0.000008 -0.000006  26.1460   0.596  0.312490     30.0  
48     768.0  0.104186  0.000009 -0.000006  26.0900   0.570  0.308014     30.0  
49     767.0 -0.035029  0.000012 -0.000008  26.0880   0.578  0.308568     30.0  

[50 rows x 32 columns]]",,11.232206583023071,2025-05-19T15:14:47,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,72,0,"SELECT
    *
FROM
    reference
WHERE
    oid = 'ZTF20actnuls'
    AND rfid = '712120223'",,,,,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,4.078667640686035,2025-05-19T15:14:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,1,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' 
AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.361714601516724,2025-04-29T12:21:20,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.608572959899902,2025-05-19T15:15:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,2,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.4109840393066406,2025-04-29T12:21:23,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.149540424346924,2025-05-19T15:15:25,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,3,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.1434648036956787,2025-04-29T12:21:25,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,10.600252628326416,2025-05-19T15:15:42,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,4,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.624880075454712,2025-04-29T12:21:28,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.208685874938965,2025-05-19T15:15:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,5,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.4820804595947266,2025-04-29T12:21:31,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,8.660752296447754,2025-05-19T15:16:11,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,6,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' 
AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,5.683007478713989,2025-04-29T12:21:37,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.785791158676147,2025-05-19T15:16:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,7,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.343341112136841,2025-04-29T12:21:39,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,8.907143831253052,2025-05-19T15:16:43,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,8,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.183988571166992,2025-04-29T12:21:41,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.578568935394289,2025-05-19T15:16:59,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,9,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.622476577758789,2025-04-29T12:21:44,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.11368441581726,2025-05-19T15:17:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,10,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.7047982215881348,2025-04-29T12:21:47,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.28194284439087,2025-05-19T15:17:29,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,103,0,"SELECT
    *
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ps1_ztf
    ON object.oid = ps1_ztf.oid
WHERE
    classifier_name = 'lc_classifier'
    AND class_name NOT IN ('SNIa','SNII','SNIbc','SLSN')
    AND probability > 0.7
    AND distpsnr1 > 5
ORDER BY distpsnr1
LIMIT 200
",,,,,,"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: SELECT
    *
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ps1_ztf
    ON object.oid = ps1_ztf.oid
WHERE
    classifier_name = 'lc_classifier'
    AND class_name NOT IN ('SNIa','SNII','SNIbc','SLSN')
    AND probability > 0.7
    AND distpsnr1 > 5
ORDER BY distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",248.13171195983887,2025-05-19T15:21:41,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,103,1,"
-- Subquery to filter probability table for non-supernova classes with probability > 0.7
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join object, filtered_probability, and ps1_ztf tables
SELECT o.*, p.*, ps.*
FROM object o
INNER JOIN filtered_probability fp ON o.oid = fp.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,23.784273147583008,2025-04-29T12:22:11,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to filter probability table for non-supernova classes with probability > 0.7
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join object, filtered_probability, and ps1_ztf tables
SELECT o.*, fp.*, ps.*
FROM object o
INNER JOIN filtered_probability fp ON o.oid = fp.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.82477498054504,2025-05-19T15:27:16,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,103,2,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
  AND probability.probability > 0.7
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,23.82468056678772,2025-04-29T12:22:35,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 53 columns]]",,136.22766852378845,2025-05-19T15:29:52,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,103,3,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
  AND probability.probability > 0.7
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,19.51356410980225,2025-04-29T12:22:54,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 53 columns]]",,37.744056940078735,2025-05-19T15:30:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,103,4,"
-- Subquery to filter probability table for objects with specific conditions
WITH filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join tables and apply conditions
SELECT *
FROM object
INNER JOIN filtered_probabilities ON object.oid = filtered_probabilities.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,17.91724944114685,2025-04-29T12:23:12,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 53 columns]]",,143.29341316223145,2025-05-19T15:33:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,103,5,"
SELECT 
    o.*, 
    p.*, 
    ps.*
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
INNER JOIN 
    ps1_ztf ps ON o.oid = ps.oid
WHERE 
    ps.distpsnr1 > 5
    AND p.ranking = 1
    AND p.classifier_name = 'lc_classifier'
    AND p.probability > 0.7
    AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
ORDER BY 
    ps.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,16.294819116592407,2025-04-29T12:23:29,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""p""
LINE 15:     p.*, 
             ^

[SQL: 
-- Step 1: Create a sub-query to filter the probability table with the necessary conditions
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Step 2: Join the filtered probability results with the object and ps1_ztf tables
SELECT 
    o.*, 
    p.*, 
    ps.*
FROM 
    object o
INNER JOIN 
    filtered_probability fp ON o.oid = fp.oid
INNER JOIN 
    ps1_ztf ps ON o.oid = ps.oid
WHERE 
    ps.distpsnr1 > 5
ORDER BY 
    ps.distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/f405)",133.06358289718628,2025-05-19T15:36:14,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,103,6,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
  AND probability.probability > 0.7
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,15.656266927719116,2025-04-29T12:23:44,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 53 columns]]",,61.59502696990967,2025-05-19T15:38:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,103,7,"
-- Subquery to filter probability table for objects with ranking = 1, classifier_name = 'lc_classifier', and probability > 0.7
-- Exclude supernova classes by using a WHERE clause with NOT IN for class_name
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join object, probability, and ps1_ztf tables
SELECT *
FROM object
INNER JOIN filtered_probability ON object.oid = filtered_probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1 ASC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,21.19888615608216,2025-04-29T12:24:06,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
17  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
18  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
19  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
20  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
21  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
22  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
23  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
24  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
25  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
26  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
27  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
28  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
29  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
30  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
31  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
32  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
33  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
5     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
8     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
9     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
17    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
18    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
19    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
20    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
21    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
22    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
23    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
24    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
25    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
26    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
27    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
28    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
29    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
30    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
31    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
32    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
33    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.389175       13    False    False   False  
2    18.5940       0.5   20.264050       13    False    False   False  
3    18.5940       0.5   20.264050       13    False    False   False  
4    18.5940       0.5   20.427036       13    False    False   False  
5    18.5940       0.5   20.427036       13    False    False   False  
6    18.5940       0.5   20.684048       13    False    False   False  
7    18.5940       0.5   20.684048       13    False    False   False  
8    17.4021       0.5   20.600231       13    False    False   False  
9    17.4021       0.5   20.600231       13    False    False   False  
10   17.4021       0.5   20.477049       13    False    False   False  
11   17.4021       0.5   20.477049       13    False    False   False  
12   18.5940       0.5   20.177076       13    False    False   False  
13   18.5940       0.5   20.177076       13    False    False   False  
14   17.4021       0.5   20.354027       13    False    False   False  
15   17.4021       0.5   20.354027       13    False    False   False  
16   18.5940       0.5   20.425758       13    False    False   False  
17   18.5940       0.5   20.425758       13    False    False   False  
18   18.5940       0.5   19.845686       13    False    False   False  
19   18.5940       0.5   19.845686       13    False    False   False  
20   17.4021       0.5   20.266893       13    False    False   False  
21   17.4021       0.5   20.266893       13    False    False   False  
22   17.4021       0.5   20.013437       12    False    False   False  
23   17.4021       0.5   20.013437       12    False    False   False  
24   17.4021       0.5   20.242962       13    False    False   False  
25   17.4021       0.5   20.242962       13    False    False   False  
26   18.5940       0.5   19.857320       13    False    False   False  
27   18.5940       0.5   19.857320       13    False    False   False  
28   17.4021       0.5   20.165024       13    False    False   False  
29   17.4021       0.5   20.165024       13    False    False   False  
30   17.4021       0.5   20.004354       13    False    False   False  
31   17.4021       0.5   20.004354       13    False    False   False  
32 -999.0000    -999.0 -999.000000        2    False    False   False  
33 -999.0000    -999.0 -999.000000        1    False    False   False  

[34 rows x 53 columns]]",,91.14074039459229,2025-05-19T15:40:03,1.8888888888888888,0.5294117647058824,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,103,8,"
SELECT *
FROM object
INNER JOIN (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
) AS prob_filtered ON object.oid = prob_filtered.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,19.75401306152344,2025-04-29T12:24:25,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,162.8968846797943,2025-05-19T15:44:15,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.16.3,gpt-4o,v1,103,9,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
  AND probability.probability > 0.7
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.798010110855103,2025-04-29T12:24:46,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 53 columns]]",,41.004300355911255,2025-05-19T15:45:22,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,103,10,"
-- Subquery to filter probability table for non-supernova classes with probability > 0.7
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join tables and apply conditions
SELECT *
FROM object
INNER JOIN filtered_probability ON object.oid = filtered_probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.07724237442017,2025-04-29T12:25:06,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,38.5042519569397,2025-05-19T15:46:21,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.16.3,,,54,0,"SELECT
    *
FROM
    non_detection
WHERE
    oid IN ('ZTF23abtcveg','ZTF23abudlls')
    AND diffmaglim > 19.5",,,,,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,3.905519485473633,2025-05-19T15:46:30,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,1,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.705353260040283,2025-04-29T12:25:09,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.566689729690552,2025-05-19T15:46:52,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,2,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.117048978805542,2025-04-29T12:25:11,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.37499213218689,2025-05-19T15:47:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,3,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.391714572906494,2025-04-29T12:25:14,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.583252668380737,2025-05-19T15:47:29,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,4,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.302300453186035,2025-04-29T12:25:16,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.414977073669434,2025-05-19T15:47:47,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,5,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.127150774002075,2025-04-29T12:25:18,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.610822677612305,2025-05-19T15:48:04,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,6,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.57853364944458,2025-04-29T12:25:21,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,9.60214138031006,2025-05-19T15:48:22,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,7,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.1756234169006348,2025-04-29T12:25:23,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,7.927661657333374,2025-05-19T15:48:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,8,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.330539464950561,2025-04-29T12:25:26,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.756446599960327,2025-05-19T15:48:56,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,9,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.194096565246582,2025-04-29T12:25:28,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.100924015045166,2025-05-19T15:49:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,10,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,1.8536944389343264,2025-04-29T12:25:30,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,9.05345892906189,2025-05-19T15:49:29,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,99,0,"SELECT
    *
FROM
    forced_photometry
WHERE
    oid in
(
SELECT
    object.oid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    firstmjd > 60310
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability = 1
ORDER BY firstmjd
LIMIT 10
)
",,,,,"[              pid           oid           mjd  fid          ra        dec  \
0   2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
1   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
2   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
3   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
4   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None  100.000000  100.000000  ...   20.395599          1   
1   None  None  100.000000  100.000000  ...   20.335699          1   
2   None  None   24.218550    5.723178  ...   20.183001          1   
3   None  None   21.659468    0.900523  ...   19.729099          1   
4   None  None  100.000000  100.000000  ...   20.528500          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,3.909888505935669,2025-05-19T15:49:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,99,1,"
-- Retrieve all columns from the 'forced_photometry' table for ZTF objects
-- that have a first detection date later than MJD 60310 and a probability of 1 of being an asteroid
-- in the stamp classifier, ordered by the first detection date and limited to 10 objects.

SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.probability = 1
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,13.485816240310667,2025-04-29T12:25:43,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,9.422439813613892,2025-05-19T15:50:00,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,2,"
-- Query to find at most 10 ZTF objects with specific conditions
SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.probability = 1
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,13.431059122085571,2025-04-29T12:25:57,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,10.10518741607666,2025-05-19T15:50:19,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,3,"
-- Select all columns from the forced_photometry table for objects meeting the specified conditions
SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability = 1
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,17.221472024917603,2025-04-29T12:26:14,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,9.328407764434814,2025-05-19T15:50:37,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,4,"
-- Retrieve all columns from the forced_photometry table for ZTF objects
-- that have a first detection date later than mjd=60310 days
-- and a probability of 1 of being an asteroid in the stamp classifier
-- Limit the results to at most 10 objects, ordered by the first detection date

SELECT fp.*
FROM forced_photometry fp
INNER JOIN object o ON fp.oid = o.oid
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability = 1
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,14.238971948623655,2025-04-29T12:26:28,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,8.946887731552124,2025-05-19T15:50:55,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,5,"
-- Subquery to filter objects with first detection date later than MJD 60310
WITH filtered_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to filter probabilities for asteroids with probability 1 in the stamp classifier
filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the filtered results and retrieve all columns from forced_photometry
SELECT fp.*
FROM filtered_objects fo
INNER JOIN filtered_probabilities fpb ON fo.oid = fpb.oid
INNER JOIN forced_photometry fp ON fo.oid = fp.oid
ORDER BY (SELECT firstmjd FROM object WHERE oid = fo.oid) ASC
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,16.2199387550354,2025-04-29T12:26:45,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to filter objects with first detection date later than MJD 60310
WITH filtered_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to filter probabilities for asteroids with probability 1 in the stamp classifier
filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the filtered results and retrieve all columns from forced_photometry
SELECT fp.*
FROM forced_photometry fp
INNER JOIN filtered_objects fo ON fp.oid = fo.oid
INNER JOIN filtered_probabilities fpb ON fp.oid = fpb.oid
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.6431405544281,2025-05-19T15:55:15,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,99,6,"
SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.probability = 1
  AND p.classifier_name = 'stamp_classifier'
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,17.331674814224243,2025-04-29T12:27:03,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,9.91969084739685,2025-05-19T15:55:34,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,7,"
SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability = 1
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,14.255781412124634,2025-04-29T12:27:18,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,9.884544610977173,2025-05-19T15:55:53,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,8,"
-- Retrieve all columns from the 'forced_photometry' table for ZTF objects
-- that have a first detection date later than MJD 60310 and a probability of 1 of being an asteroid
-- in the 'stamp_classifier', ordered by the first detection date, limited to 10 results.

SELECT fp.*
FROM forced_photometry fp
INNER JOIN object o ON fp.oid = o.oid
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability = 1
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,18.297711849212646,2025-04-29T12:27:37,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,16.58569097518921,2025-05-19T15:56:19,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,9,"
-- Subquery to select oids from the object table with firstmjd > 60310
WITH selected_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to select oids from the probability table with the specified conditions
selected_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the results and retrieve all columns from forced_photometry
SELECT fp.*
FROM forced_photometry fp
INNER JOIN (
    SELECT so.oid
    FROM selected_objects so
    INNER JOIN selected_probabilities sp ON so.oid = sp.oid
) filtered_oids ON fp.oid = filtered_oids.oid
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,24.44525146484375,2025-04-29T12:28:01,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to select oids from the object table with firstmjd > 60310
WITH selected_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to select oids from the probability table with the specified conditions
selected_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the results and retrieve all columns from forced_photometry
SELECT fp.*
FROM forced_photometry fp
WHERE fp.oid IN (
    SELECT so.oid
    FROM selected_objects so
    INNER JOIN selected_probabilities sp ON so.oid = sp.oid
)
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.62499952316284,2025-05-19T16:00:38,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,99,10,"
-- Subquery to select oids from the object table with firstmjd > 60310
WITH selected_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to select oids from the probability table with the specified conditions
selected_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the subqueries and retrieve data from forced_photometry
SELECT fp.*
FROM forced_photometry fp
INNER JOIN selected_objects so ON fp.oid = so.oid
INNER JOIN selected_probabilities sp ON fp.oid = sp.oid
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,20.063894748687744,2025-04-29T12:28:22,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to select oids from the object table with firstmjd > 60310
WITH selected_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to select oids from the probability table with the specified conditions
selected_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the subqueries and retrieve data from forced_photometry
SELECT fp.*
FROM forced_photometry fp
WHERE fp.oid IN (
    SELECT so.oid
    FROM selected_objects so
    INNER JOIN selected_probabilities sp ON so.oid = sp.oid
)
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.45017170906067,2025-05-19T16:05:00,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,40,0,"SELECT
    oid_catalog, ra, dec, w1mpro, w2mpro,
    w1sigmpro, w2sigmpro, j_m_2mass, j_msig_2mass
FROM
    allwise
WHERE
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 0.000277778)",,,,,"[           oid_catalog         ra        dec  w1mpro  w2mpro  w1sigmpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842  13.735       0.03   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,23.244356155395508,2025-05-19T16:05:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,1,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.433444738388061,2025-04-29T12:28:25,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,14.799449920654297,2025-05-19T16:05:58,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,2,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.843703269958496,2025-04-29T12:28:29,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,15.072061538696287,2025-05-19T16:06:24,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,3,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.133241891860962,2025-04-29T12:28:33,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,14.968029737472534,2025-05-19T16:06:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,4,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,2.954166412353516,2025-04-29T12:28:36,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,15.21149730682373,2025-05-19T16:07:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,5,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(dec)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.5436906814575195,2025-04-29T12:28:40,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,15.307823181152344,2025-05-19T16:07:41,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,6,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.9698987007141113,2025-04-29T12:28:44,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,18.08627462387085,2025-05-19T16:08:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,7,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.217031478881836,2025-04-29T12:28:47,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,18.025094270706177,2025-05-19T16:08:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,8,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.478934526443481,2025-04-29T12:28:51,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,15.396000146865845,2025-05-19T16:09:08,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,9,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(dec)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.446058988571167,2025-04-29T12:28:54,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,16.092958211898804,2025-05-19T16:09:36,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,10,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.094377040863037,2025-04-29T12:28:58,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,14.557645320892334,2025-05-19T16:10:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,80,0,"SELECT
    *
FROM
    xmatch
WHERE
    oid IN ('ZTF22abcmmkz','ZTF18abbufof')
    AND dist < 0.5",,,,,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,3.577197790145874,2025-05-19T16:10:08,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,1,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.1769816875457764,2025-04-29T12:29:00,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,8.675793409347534,2025-05-19T16:10:28,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,2,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.942670583724976,2025-04-29T12:29:03,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,8.749269247055054,2025-05-19T16:10:45,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,3,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.24397087097168,2025-04-29T12:29:05,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,9.024502754211426,2025-05-19T16:11:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,4,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,1.8834493160247805,2025-04-29T12:29:07,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,8.41873025894165,2025-05-19T16:11:20,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,5,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.657191753387451,2025-04-29T12:29:11,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,8.994430780410767,2025-05-19T16:11:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,6,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.158827543258667,2025-04-29T12:29:13,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,8.522997379302979,2025-05-19T16:11:56,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,7,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.408405065536499,2025-04-29T12:29:15,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,9.726295232772827,2025-05-19T16:12:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,8,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.1392173767089844,2025-04-29T12:29:18,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,9.141648769378662,2025-05-19T16:12:33,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,9,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.2119715213775635,2025-04-29T12:29:20,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,8.640360832214355,2025-05-19T16:12:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,10,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.608182668685913,2025-04-29T12:29:23,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,8.145519018173218,2025-05-19T16:13:07,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,45,0,"SELECT
    COUNT(chipsf)
FROM
    dataquality
WHERE
    oid IN ('ZTF23abjikaf','ZTF20achlced')
    AND chipsf >= 5",,,,,"[   count
0     81]",,3.782593965530396,2025-05-19T16:13:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,1,"
-- Count the number of rows in the dataquality table for specific ZTF object identifiers
-- where the reduced chi-square value (chipsf) is at least 5
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.67042875289917,2025-04-29T12:29:34,"[   count
0     81]",,9.012585878372192,2025-05-19T16:13:37,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,2,"
SELECT COUNT(*)
FROM dataquality
WHERE chipsf >= 5
AND oid IN ('ZTF23abjikaf', 'ZTF20achlced')
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.762644529342651,2025-04-29T12:29:47,"[   count
0     81]",,8.6168053150177,2025-05-19T16:13:54,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,3,"
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.412947177886965,2025-04-29T12:29:58,"[   count
0     81]",,8.929900407791138,2025-05-19T16:14:11,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,4,"
SELECT COUNT(*) 
FROM dataquality 
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') 
AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.545251846313477,2025-04-29T12:30:08,"[   count
0     81]",,8.679789066314697,2025-05-19T16:14:30,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,5,"
SELECT COUNT(*) 
FROM dataquality 
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') 
AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.893950462341309,2025-04-29T12:30:21,"[   count
0     81]",,8.777594566345215,2025-05-19T16:14:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,6,"
-- Count the number of rows in the dataquality table where the reduced chi-square (chipsf) is at least 5
-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'
SELECT COUNT(*)
FROM dataquality
WHERE chipsf >= 5
AND oid IN ('ZTF23abjikaf', 'ZTF20achlced')
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.434345245361328,2025-04-29T12:30:33,"[   count
0     81]",,9.537280082702637,2025-05-19T16:15:06,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,7,"
-- Count the number of rows in the dataquality table where the reduced chi-square value (chipsf) is at least 5
-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.97732663154602,2025-04-29T12:30:45,"[   count
0     81]",,9.729403972625732,2025-05-19T16:15:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,8,"
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.72496509552002,2025-04-29T12:30:54,"[   count
0     81]",,8.505799293518066,2025-05-19T16:15:43,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,9,"
-- Count the number of rows in the dataquality table for specific objects with a minimum reduced chi-square value of 5
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.233624696731567,2025-04-29T12:31:06,"[   count
0     81]",,9.823879957199097,2025-05-19T16:16:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,10,"
-- Count the number of rows in the 'dataquality' table for specific objects with a minimum reduced chi-square value of 5
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.806450843811035,2025-04-29T12:31:19,"[   count
0     81]",,9.296444416046144,2025-05-19T16:16:20,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,63,0,"SELECT
    *
FROM
    probability
WHERE
    oid IN ('ZTF21aaobkmg','ZTF21aaomuka')
    AND classifier_name = 'lc_classifier'
    AND ranking <= 2
ORDER BY ranking",,,,,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,3.8017477989196777,2025-05-19T16:16:30,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,1,"
SELECT *
FROM probability
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')
  AND classifier_name = 'lc_classifier'
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.568111181259156,2025-04-29T12:31:21,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.835268259048462,2025-05-19T16:16:54,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,2,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.2544596195220947,2025-04-29T12:31:23,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.640422105789185,2025-05-19T16:17:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,3,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.301586866378784,2025-04-29T12:31:26,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.251456260681152,2025-05-19T16:17:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,4,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.841839551925659,2025-04-29T12:31:31,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.540362358093262,2025-05-19T16:17:46,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,5,"
SELECT *
FROM probability
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')
  AND classifier_name = 'lc_classifier'
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.605892181396484,2025-04-29T12:31:35,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.071545839309692,2025-05-19T16:18:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,6,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.664682149887085,2025-04-29T12:31:38,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.076316356658936,2025-05-19T16:18:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,7,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.808694362640381,2025-04-29T12:31:41,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.069602012634276,2025-05-19T16:18:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,8,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.2322256565093994,2025-04-29T12:31:43,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.062656164169312,2025-05-19T16:18:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,9,"
SELECT *
FROM probability
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')
  AND classifier_name = 'lc_classifier'
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.2144694328308105,2025-04-29T12:31:46,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.887110948562622,2025-05-19T16:19:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,10,"
SELECT *
FROM probability
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')
  AND classifier_name = 'lc_classifier'
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.4753777980804443,2025-04-29T12:31:48,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.828410148620605,2025-05-19T16:19:31,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,73,0,"SELECT
    oid, ssnamenr, ssmagnr
FROM
    ss_ztf
WHERE
    oid = 'ZTF21acitntz'
",,,,,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,3.511991500854492,2025-05-19T16:19:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,1,"
SELECT object.oid, ss_ztf.ssnamenr, ss_ztf.ssmagnr
FROM object
INNER JOIN ss_ztf ON object.oid = ss_ztf.oid
WHERE object.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,12.515936851501465,2025-04-29T12:32:01,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,8.939454555511475,2025-05-19T16:20:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,2,"
-- Query to find the MPC name and MPC magnitude of the nearest known Solar System object for the ZTF object 'ZTF21acitntz'
SELECT 
    o.oid, 
    s.ssnamenr AS mpc_name, 
    s.ssmagnr AS mpc_magnitude
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,13.836305379867554,2025-04-29T12:32:15,"[            oid mpc_name  mpc_magnitude
0  ZTF21acitntz    17427           18.6]",,10.682245016098022,2025-05-19T16:20:19,1.0,1.0,0.3333333333333333,0.3333333333333333,1.0,0.0
0.16.3,gpt-4o,v1,73,3,"
-- Query to find the MPC name and MPC magnitude of the nearest known Solar System object for the ZTF object 'ZTF21acitntz'
SELECT 
    o.oid, 
    s.ssnamenr, 
    s.ssmagnr
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,11.324328422546388,2025-04-29T12:32:26,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,8.779866933822632,2025-05-19T16:20:37,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,4,"
SELECT 
    ss_ztf.oid, 
    ss_ztf.ssnamenr, 
    ss_ztf.ssmagnr
FROM 
    ss_ztf
WHERE 
    ss_ztf.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,10.922685146331789,2025-04-29T12:32:37,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,9.088481187820436,2025-05-19T16:20:55,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,5,"
SELECT 
    ss.oid AS ztf_object_identifier, 
    ss.ssnamenr AS mpc_name, 
    ss.ssmagnr AS mpc_magnitude
FROM 
    ss_ztf ss
WHERE 
    ss.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,5.457814931869507,2025-04-29T12:32:42,"[  ztf_object_identifier mpc_name  mpc_magnitude
0          ZTF21acitntz    17427           18.6]",,9.067713499069214,2025-05-19T16:21:12,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,73,6,"
-- Query to find the MPC name and MPC magnitude of the nearest known Solar System object for the ZTF object 'ZTF21acitntz'
SELECT 
    o.oid, 
    s.ssnamenr AS mpc_name, 
    s.ssmagnr AS mpc_magnitude
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,13.94395637512207,2025-04-29T12:32:56,"[            oid mpc_name  mpc_magnitude
0  ZTF21acitntz    17427           18.6]",,9.352396488189695,2025-05-19T16:21:28,1.0,1.0,0.3333333333333333,0.3333333333333333,1.0,0.0
0.16.3,gpt-4o,v1,73,7,"
SELECT 
    ss.oid, 
    ss.ssnamenr AS mpc_name, 
    ss.ssmagnr AS mpc_magnitude
FROM 
    ss_ztf ss
WHERE 
    ss.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,12.970305681228638,2025-04-29T12:33:09,"[            oid mpc_name  mpc_magnitude
0  ZTF21acitntz    17427           18.6]",,8.926506042480469,2025-05-19T16:21:45,1.0,1.0,0.3333333333333333,0.3333333333333333,1.0,0.0
0.16.3,gpt-4o,v1,73,8,"
-- Query to find the MPC name and MPC magnitude of the nearest known Solar System object for the ZTF object 'ZTF21acitntz'
SELECT 
    o.oid,          -- ZTF object identifier
    s.ssnamenr,     -- MPC name of the nearest known Solar System object
    s.ssmagnr       -- MPC magnitude of the nearest known Solar System object
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'  -- Filter for the specific ZTF object
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,24.985079526901245,2025-04-29T12:33:35,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,9.259878635406494,2025-05-19T16:22:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,9,"
-- Query to retrieve the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object
SELECT 
    o.oid,          -- ZTF object identifier
    s.ssnamenr,     -- MPC name of the nearest known Solar System object
    s.ssmagnr       -- MPC magnitude of the nearest known Solar System object
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'  -- Filter for the specific ZTF object
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,13.362083673477173,2025-04-29T12:33:48,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,9.066770553588867,2025-05-19T16:22:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,10,"
SELECT 
    ss_ztf.oid AS ztf_object_identifier, 
    ss_ztf.ssnamenr AS mpc_name, 
    ss_ztf.ssmagnr AS mpc_magnitude
FROM 
    ss_ztf
WHERE 
    ss_ztf.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,3.229830503463745,2025-04-29T12:33:51,"[  ztf_object_identifier mpc_name  mpc_magnitude
0          ZTF21acitntz    17427           18.6]",,8.997186422348022,2025-05-19T16:22:38,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,,,92,0,"SELECT
    oid, classifier_version, class_name, probability
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking = 1
    AND oid in
(
SELECT
    oid
FROM
    magstat
WHERE
    fid = 1
    AND ndet >= 10
    AND ndubious = 0
ORDER BY oid
LIMIT 500
)
",,,,,"[              oid     classifier_version      class_name  probability
0    ZTF17aaaaaxb  hierarchical_rf_1.1.0  Periodic-Other     0.402136
1    ZTF17aaaaaxb   lc_classifier_1.1.13  Periodic-Other     0.384480
2    ZTF17aaaadiz  hierarchical_rf_1.1.0               E     0.282672
3    ZTF17aaaadiz   lc_classifier_1.1.13  Periodic-Other     0.258560
4    ZTF17aaaadyg  hierarchical_rf_1.1.0  Periodic-Other     0.553136
..            ...                    ...             ...          ...
914  ZTF17aaaaaas   lc_classifier_1.1.13  Periodic-Other     0.260952
915  ZTF17aaaaegw  hierarchical_rf_1.1.0             YSO     0.717024
916  ZTF17aaaaegw   lc_classifier_1.1.13             YSO     0.611064
917  ZTF17aaaabel  hierarchical_rf_1.1.0               E     0.371840
918  ZTF17aaaabel   lc_classifier_1.1.13  Periodic-Other     0.440128

[919 rows x 4 columns]]",,4.767277002334595,2025-05-19T16:22:47,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,92,1,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 entries
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,18.554712772369385,2025-04-29T12:34:10,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
),
-- Sub-query to get classification details with ranking 1 for the light curve classifier
filtered_probabilities AS (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
)
-- Main query to join the filtered results and limit the output
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN filtered_detections d ON o.oid = d.oid
INNER JOIN filtered_probabilities p ON o.oid = p.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 entries
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.60398030281067,2025-05-19T16:27:10,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,2,"
-- Select the required columns from the object and probability tables
SELECT 
    object.oid AS ""ZTF identifier"", 
    probability.classifier_version, 
    probability.class_name, 
    probability.probability
FROM 
    object
-- Join with the detection table to filter based on g band detections and dubious corrections
INNER JOIN (
    SELECT oid
    FROM detection
    WHERE fid = 1 -- g band
    AND dubious = FALSE
    GROUP BY oid
    HAVING COUNT(*) >= 10
) AS valid_detections ON object.oid = valid_detections.oid
-- Join with the probability table to get classification information
INNER JOIN probability ON object.oid = probability.oid
WHERE 
    probability.ranking = 1 -- Only include probabilities with ranking 1
    AND probability.classifier_name = 'lc_classifier'
ORDER BY 
    object.oid
LIMIT 500 -- Limit the results to at most 500 entries
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,18.46792721748352,2025-04-29T12:34:28,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final query combining the sub-queries with the object table
SELECT 
    object.oid AS ""ZTF identifier"", 
    prob.classifier_version, 
    prob.class_name, 
    prob.probability
FROM 
    object
-- Join with the sub-query for valid detections
INNER JOIN (
    SELECT oid
    FROM detection
    WHERE fid = 1 -- g band
    AND dubious = FALSE
    GROUP BY oid
    HAVING COUNT(*) >= 10
) AS valid_detections ON object.oid = valid_detections.oid
-- Join with the sub-query for probabilities
INNER JOIN (
    SELECT oid, classifier_version, class_name, probability
    FROM probability
    WHERE ranking = 1
    AND classifier_name = 'lc_classifier'
) AS prob ON object.oid = prob.oid
ORDER BY 
    object.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.51215314865112,2025-05-19T16:31:32,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,3,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.555657625198364,2025-04-29T12:34:46,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
),
-- Sub-query to get classification details with ranking 1 for the light curve classifier
filtered_probabilities AS (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
)
-- Main query to join the filtered results and limit the output
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN filtered_detections d ON o.oid = d.oid
INNER JOIN filtered_probabilities p ON o.oid = p.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.4930443763733,2025-05-19T16:35:52,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,4,"
-- Select the required columns from the probability table
SELECT 
    p.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    -- Join the probability table with the object and detection tables
    probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    (
        -- Subquery to filter detections in the g band with no dubious corrections
        SELECT 
            oid
        FROM 
            detection
        WHERE 
            fid = 1 -- g band
            AND dubious = FALSE
        GROUP BY 
            oid
        HAVING 
            COUNT(*) >= 10 -- At least 10 detections
    ) d ON o.oid = d.oid
WHERE 
    -- Apply default conditions for the probability table
    p.ranking = 1
    AND p.classifier_name = 'lc_classifier'
ORDER BY 
    o.oid
LIMIT 500
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.75227999687195,2025-04-29T12:35:04,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final query combining the subqueries
SELECT 
    p.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    -- Use the optimized subquery for probability
    (SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1
        AND classifier_name = 'lc_classifier') p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    -- Use the optimized subquery for detection
    (SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10) d ON o.oid = d.oid
ORDER BY 
    o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",255.69491839408877,2025-05-19T16:40:17,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,5,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,15.064086437225342,2025-04-29T12:35:19,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
),
-- Sub-query to get classification details with ranking 1 for the light curve classifier
filtered_probabilities AS (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
)
-- Main query to select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the filtered detections sub-query
INNER JOIN filtered_detections d ON o.oid = d.oid
-- Join with the filtered probabilities sub-query
INNER JOIN filtered_probabilities p ON o.oid = p.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.33556079864505,2025-05-19T16:44:39,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,6,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification probabilities
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,15.981138467788696,2025-04-29T12:35:35,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
),
-- Sub-query to get the most likely classification probabilities
filtered_probabilities AS (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
)
-- Main query to select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the filtered detections sub-query
INNER JOIN filtered_detections d ON o.oid = d.oid
-- Join with the filtered probabilities sub-query
INNER JOIN filtered_probabilities p ON o.oid = p.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.17339706420896,2025-05-19T16:49:01,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,7,"
-- Subquery to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_objects AS (
    SELECT oid
    FROM detection
    WHERE fid = 1 -- g band
      AND dubious = FALSE
    GROUP BY oid
    HAVING COUNT(*) >= 10
)

-- Main query to select required information
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
JOIN 
    filtered_objects fo ON o.oid = fo.oid
JOIN 
    probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid
LIMIT 500
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.928287267684937,2025-04-29T12:35:53,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_objects AS (
    SELECT oid
    FROM detection
    WHERE fid = 1 -- g band
      AND dubious = FALSE
    GROUP BY oid
    HAVING COUNT(*) >= 10
),

-- Subquery to filter probabilities with ranking 1 and light curve classifier
filtered_probabilities AS (
    SELECT oid, classifier_version, class_name, probability
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
)

-- Main query to select required information
SELECT 
    o.oid AS ""ZTF identifier"", 
    fp.classifier_version, 
    fp.class_name, 
    fp.probability
FROM 
    object o
JOIN 
    filtered_objects fo ON o.oid = fo.oid
JOIN 
    filtered_probabilities fp ON o.oid = fp.oid
ORDER BY 
    o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.8788638114929,2025-05-19T16:53:22,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,8,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get the classifier version, class name, and probability
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid
LIMIT 500 -- Limit the results to 500
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,22.5619695186615,2025-04-29T12:36:16,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
),
-- Sub-query to filter probabilities with ranking 1 and light curve classifier
filtered_probabilities AS (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
)
-- Main query to join the filtered results and select the required columns
SELECT 
    o.oid AS ""ZTF identifier"", 
    fp.classifier_version, 
    fp.class_name, 
    fp.probability
FROM 
    object o
-- Join with the filtered detections
INNER JOIN filtered_detections fd ON o.oid = fd.oid
-- Join with the filtered probabilities
INNER JOIN filtered_probabilities fp ON o.oid = fp.oid
ORDER BY 
    o.oid
LIMIT 500 -- Limit the results to 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.29160118103027,2025-05-19T16:57:42,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,9,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,19.27679324150085,2025-04-29T12:36:35,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final query combining the sub-queries with the object table
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the filtered detections sub-query
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the filtered probabilities sub-query
INNER JOIN (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
) p ON o.oid = p.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.30657649040225,2025-05-19T17:02:03,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,10,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.55406904220581,2025-04-29T12:36:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
)

-- Main query to select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the filtered detections sub-query
INNER JOIN filtered_detections d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
) p ON o.oid = p.oid
ORDER BY 
    o.oid
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.4780216217041,2025-05-19T17:06:26,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,102,0,"SELECT
    *
FROM
    magstat
WHERE
    oid IN
(
SELECT
    probability.oid
FROM
    probability INNER JOIN
    xmatch
    ON probability.oid = xmatch.oid
    INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    w1mpro > 12
    AND w1mpro < 13
    AND classifier_name = 'lc_classifier'
    AND class_name = 'AGN'
    AND probability > 0.6
LIMIT 50
)",,,,,"[              oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0    ZTF18acnnxyp    1    False       True   220         0         NaN   
1    ZTF18acnnxyp    2    False       True   187         0         NaN   
2    ZTF19aaslszp    1    False       True    14         0         NaN   
3    ZTF19aaslszp    2    False       True    38         0         NaN   
4    ZTF19accprws    1    False       True   100         0         NaN   
..            ...  ...      ...        ...   ...       ...         ...   
103  ZTF18abtmeds    2    False       True   236         1         NaN   
104  ZTF18acbycof    1     True       True     6         0         NaN   
105  ZTF18acbycof    2     True       True    10         0         NaN   
106  ZTF19acbuwdb    1    False       True    34         2         NaN   
107  ZTF19acbuwdb    2    False       True    55         2         NaN   

     dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0         NaN            NaN       NaN  ...       16.470194    16.636536   
1         NaN            NaN       NaN  ...       16.283157    16.750060   
2         NaN            NaN       NaN  ...       18.339777    18.424961   
3         NaN            NaN       NaN  ...       17.458006    17.704653   
4         NaN            NaN       NaN  ...       17.323280    17.430521   
..        ...            ...       ...  ...             ...          ...   
103       NaN            NaN       NaN  ...       16.518640    16.809933   
104       NaN            NaN       NaN  ...       17.237503    17.254923   
105       NaN            NaN       NaN  ...       16.987440    17.048979   
106       NaN            NaN       NaN  ...       17.277626    17.629467   
107       NaN            NaN       NaN  ...       16.736994    16.936043   

     magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0      16.110912       0.084070     16.525469      16.636536  58450.504   
1      16.046688       0.075749     16.228830      16.425951  58438.523   
2      18.263086       0.045689     18.313805      18.424961  60120.430   
3      17.340534       0.096294     17.387550      17.511440  58627.406   
4      16.601112       0.097823     17.425760      17.407330  58760.336   
..           ...            ...           ...            ...        ...   
103    16.114622       0.146693     16.563980      16.188840  58425.230   
104    17.131426            NaN     17.234760      17.244194  58397.360   
105    16.947750            NaN     17.048979      17.007450  58423.310   
106    17.136470       0.114029     17.136470      17.192860  58850.426   
107    16.610060       0.084905     16.610060      16.637360  58833.380   

       lastmjd        step_id_corr  saturation_rate  
0    60734.402              27.4.0              0.0  
1    60687.350              27.4.0              0.0  
2    60651.098              26.0.0              0.0  
3    60651.120              26.0.0              0.0  
4    60674.094              26.2.0              0.0  
..         ...                 ...              ...  
103  60706.164              27.3.0              0.0  
104  58514.176  bulk_version_0.0.1              0.0  
105  58493.113  bulk_version_0.0.1              0.0  
106  60699.363              27.4.0              0.0  
107  60710.290              27.4.0              0.0  

[108 rows x 28 columns]]",,6.40769624710083,2025-05-19T17:06:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,102,1,"
-- Retrieve all columns from the magstat table for ZTF objects that meet the specified conditions
SELECT magstat.*
FROM probability
INNER JOIN allwise ON probability.oid = allwise.oid_catalog
INNER JOIN magstat ON probability.oid = magstat.oid
WHERE probability.class_name = 'AGN'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
  AND probability.probability > 0.6
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,14.472545623779297,2025-04-29T12:37:07,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,22.732484102249146,2025-05-19T17:07:12,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,2,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,17.43251872062683,2025-04-29T12:37:25,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,11.172560930252075,2025-05-19T17:07:33,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,3,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,13.447794198989868,2025-04-29T12:37:38,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,11.129830837249756,2025-05-19T17:07:52,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,4,"
-- Retrieve all columns from the magstat table for ZTF objects that meet the specified conditions
SELECT magstat.*
FROM magstat
INNER JOIN (
    -- Subquery to filter probability table for AGN classification with probability > 0.6
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
) AS prob_filtered ON magstat.oid = prob_filtered.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,14.706976652145386,2025-04-29T12:37:53,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,10.786997318267822,2025-05-19T17:08:13,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,5,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,11.973395109176636,2025-04-29T12:38:05,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.636293172836304,2025-05-19T17:10:57,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,6,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,11.554211378097534,2025-04-29T12:38:16,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,10.729020118713379,2025-05-19T17:11:12,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,7,"
SELECT magstat.*
FROM magstat
INNER JOIN (
    SELECT probability.oid
    FROM probability
    INNER JOIN allwise ON probability.oid = allwise.oid_catalog
    WHERE probability.class_name = 'AGN'
      AND probability.classifier_name = 'lc_classifier'
      AND probability.ranking = 1
      AND probability.probability > 0.6
      AND allwise.w1mpro BETWEEN 12 AND 13
) AS filtered_objects ON magstat.oid = filtered_objects.oid
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,12.917136669158936,2025-04-29T12:38:29,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.395044088363647,2025-05-19T17:11:26,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,8,"
SELECT magstat.*
FROM probability
INNER JOIN allwise ON probability.oid = allwise.oid_catalog
INNER JOIN magstat ON probability.oid = magstat.oid
WHERE probability.class_name = 'AGN'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
  AND probability.probability > 0.6
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,11.741945743560793,2025-04-29T12:38:41,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,11.623579502105713,2025-05-19T17:11:41,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,9,"
-- Retrieve all columns from the magstat table for ZTF objects that meet the specified conditions
SELECT magstat.*
FROM probability
INNER JOIN allwise ON probability.oid = allwise.oid_catalog
INNER JOIN magstat ON probability.oid = magstat.oid
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,13.174476623535156,2025-04-29T12:38:54,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.061639308929443,2025-05-19T17:11:54,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,10,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid
WHERE probability.class_name = 'AGN'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,29.123444080352783,2025-04-29T12:39:24,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,10.817741632461548,2025-05-19T17:12:09,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,81,0,"SELECT
    oid, dist
FROM
    xmatch
WHERE
    oid_catalog = 'J163603.54-065228.7'",,,,,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,3.501375436782837,2025-05-19T17:12:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,81,1,"
SELECT xmatch.oid, xmatch.dist
FROM xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE allwise.oid_catalog = 'J163603.54-065228.7'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,10.37748408317566,2025-04-29T12:39:34,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,71.92569136619568,2025-05-19T17:13:29,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,2,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,11.360469341278076,2025-04-29T12:39:45,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,40.030768156051636,2025-05-19T17:14:13,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,3,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Specific object in the ALLWISE catalog
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,13.342161893844604,2025-04-29T12:39:59,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,8.75759768486023,2025-05-19T17:14:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,81,4,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    xmatch.oid_catalog = 'J163603.54-065228.7' 
    AND xmatch.catid = 'ALLWISE'  -- Ensure the catalog is ALLWISE
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.300841331481934,2025-04-29T12:40:11,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,9.034810066223145,2025-05-19T17:14:39,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,5,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.6146559715271,2025-04-29T12:40:24,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,9.030608415603638,2025-05-19T17:14:51,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,6,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,10.859402894973757,2025-04-29T12:40:35,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,8.378003358840942,2025-05-19T17:15:03,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,7,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,11.808361530303957,2025-04-29T12:40:47,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,8.798429727554321,2025-05-19T17:15:16,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,8,"
SELECT x.oid, x.dist
FROM xmatch x
INNER JOIN allwise a ON x.oid_catalog = a.oid_catalog
WHERE x.oid_catalog = 'J163603.54-065228.7'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.279777526855469,2025-04-29T12:40:59,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,8.101569890975952,2025-05-19T17:15:28,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,81,9,"
SELECT x.oid, x.dist
FROM xmatch x
INNER JOIN allwise a ON x.oid_catalog = a.oid_catalog
WHERE a.oid_catalog = 'J163603.54-065228.7'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,11.896523237228394,2025-04-29T12:41:11,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,40.69377541542053,2025-05-19T17:16:12,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,10,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.37247920036316,2025-04-29T12:41:26,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,9.275506496429443,2025-05-19T17:16:25,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,69,0,"SELECT
    *
FROM
    ps1_ztf
WHERE
    oid IN ('ZTF21abstkhj','ZTF22aacqjeb','ZTF21aamwpdf')
    AND sgscore1 < 0.2",,,,,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,3.4446656703948975,2025-05-19T17:16:29,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,1,"
SELECT *
FROM ps1_ztf
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')
  AND sgscore1 < 0.2
","['CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.9020817279815674,2025-04-29T12:41:29,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.487571001052856,2025-05-19T17:16:42,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,2,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.706266164779663,2025-04-29T12:41:32,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.659703731536865,2025-05-19T17:16:54,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,3,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.955204486846924,2025-04-29T12:41:35,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.650449752807617,2025-05-19T17:17:07,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,4,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.755599021911621,2025-04-29T12:41:38,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.129837274551392,2025-05-19T17:17:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,5,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.7846031188964844,2025-04-29T12:41:41,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.756541967391968,2025-05-19T17:17:32,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,6,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.4305574893951416,2025-04-29T12:41:43,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.36443567276001,2025-05-19T17:17:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,7,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.4075019359588623,2025-04-29T12:41:46,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.925858974456787,2025-05-19T17:17:56,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,8,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.7553837299346924,2025-04-29T12:41:49,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,9.002363920211792,2025-05-19T17:18:08,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,9,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.5588979721069336,2025-04-29T12:41:51,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,9.020448446273804,2025-05-19T17:18:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,10,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.4319491386413574,2025-04-29T12:41:54,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.429737329483032,2025-05-19T17:18:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,61,0,"SELECT
    *
FROM
    magstat
WHERE
    ndet >= 10
    AND magmedian > 19
    AND maglast < 17
ORDER BY oid
LIMIT 30
",,,,,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,139.8477439880371,2025-05-19T17:20:54,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,1,"
SELECT * 
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,5.152464389801025,2025-04-29T12:41:59,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,10.016597986221313,2025-05-19T17:21:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,2,"
SELECT * 
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.472766160964966,2025-04-29T12:42:02,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,9.99821400642395,2025-05-19T17:21:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,3,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.4967682361602783,2025-04-29T12:42:04,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,10.0004723072052,2025-05-19T17:21:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,4,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,6.220038652420044,2025-04-29T12:42:10,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,10.004513263702393,2025-05-19T17:21:55,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,5,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.472074508666992,2025-04-29T12:42:13,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,9.754507303237915,2025-05-19T17:22:09,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,6,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,5.027093410491943,2025-04-29T12:42:18,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,9.501847982406616,2025-05-19T17:22:24,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,7,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,4.0302488803863525,2025-04-29T12:42:22,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,9.834702253341675,2025-05-19T17:22:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,8,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.72204327583313,2025-04-29T12:42:25,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,10.152395248413086,2025-05-19T17:22:54,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,9,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.409656047821045,2025-04-29T12:42:27,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,10.279491424560547,2025-05-19T17:23:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,10,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.736592531204224,2025-04-29T12:42:30,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaadzhc    1    False       True   511         1         NaN   
3   ZTF17aaagzbe    1    False       True    44         0         NaN   
4   ZTF17aaahyqe    1    False       True   142         0         NaN   
5   ZTF17aaaihhg    1    False       True    12         0         NaN   
6   ZTF17aaakimh    2    False       True    31         0         NaN   
7   ZTF17aaakkku    1    False       True    12         0         NaN   
8   ZTF17aaaskut    1    False       True    32         0   -0.324131   
9   ZTF17aaastit    1    False       True   113         0         NaN   
10  ZTF17aaaswvx    1    False       True   626         2         NaN   
11  ZTF17aaatnbo    1    False       True    48         1         NaN   
12  ZTF17aaawcom    1    False       True   167         0         NaN   
13  ZTF17aaawgek    1    False       True   228         1         NaN   
14  ZTF17aaawqfk    1    False       True   547         0         NaN   
15  ZTF17aaazpbo    1    False       True    71         0         NaN   
16  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
17  ZTF17aabghja    1    False       True    13         0         NaN   
18  ZTF17aabunmx    1    False       True   312         0         NaN   
19  ZTF17aabunmx    2    False       True   397         0         NaN   
20  ZTF17aabyrpg    1    False       True   137         0         NaN   
21  ZTF17aaccevp    1    False       True    11         0         NaN   
22  ZTF17aacgwrb    1    False       True    38         2         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadlpa    1    False       True   252         0         NaN   
27  ZTF18aaadqso    2    False       True   106         0         NaN   
28  ZTF18aaajdrc    1    False       True    41         1         NaN   
29  ZTF18aaakpie    2    False       True    23         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       21.460747   100.000000   
3        NaN            NaN       NaN  ...       17.365470    17.422337   
4        NaN            NaN       NaN  ...       20.069712    22.804115   
5        NaN            NaN       NaN  ...       17.421630    17.455881   
6        NaN            NaN       NaN  ...             NaN          NaN   
7        NaN            NaN       NaN  ...       14.078731    14.078731   
8  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
9        NaN            NaN       NaN  ...       16.442953    18.112616   
10       NaN            NaN       NaN  ...       18.349104    19.250978   
11       NaN            NaN       NaN  ...       17.135637    17.261750   
12       NaN            NaN       NaN  ...       19.099104    19.469353   
13       NaN            NaN       NaN  ...       19.328012   100.000000   
14       NaN            NaN       NaN  ...       18.957174    19.962952   
15       NaN            NaN       NaN  ...       19.877234    20.651594   
16 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
17       NaN            NaN       NaN  ...       17.486992    17.543646   
18       NaN            NaN       NaN  ...       18.589832    20.429623   
19       NaN            NaN       NaN  ...       18.273699    19.876719   
20       NaN            NaN       NaN  ...       18.814323    19.148642   
21       NaN            NaN       NaN  ...       17.028027    17.059195   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       18.335806    20.369053   
27       NaN            NaN       NaN  ...       19.958225   100.000000   
28       NaN            NaN       NaN  ...       16.955814    17.002485   
29       NaN            NaN       NaN  ...             NaN          NaN   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     16.083296      21.991580     16.891030      21.257313  58272.406   
3     15.648982       0.269482     15.648982      17.358065  58437.430   
4     16.589040       1.203840     16.789545      18.917585  58371.516   
5     15.928150       0.414757     15.928150      17.446985  58441.460   
6           NaN            NaN           NaN            NaN  58422.350   
7     14.078731       0.000000     14.078731            NaN  58431.227   
8     16.271450       0.356419     16.348988      17.441607  58352.426   
9     16.405207       0.495029     18.062143      16.432556  58374.473   
10    14.450059       0.715195     16.425968      17.780094  58349.434   
11    16.205920       0.224303     16.205920      16.905798  58382.460   
12    15.268386       1.541127     16.175684      19.311296  58693.320   
13    15.210840      23.411800     16.430265      22.726280  58323.426   
14    15.072848       1.047149     16.728190      18.982880  58281.430   
15    16.041350       1.493395     16.566166      19.743600  58764.504   
16    15.912502       0.444554     15.912502            NaN  58346.367   
17    15.858172       0.454879     15.858172      16.802483  58434.438   
18    14.942116       1.196816     15.745890      18.834373  58286.457   
19    15.012147       1.023591     15.772438      18.416862  58289.453   
20    13.964068       1.636876     15.538330      16.012342  58480.490   
21    15.907078       0.337792     15.907078      17.018574  59149.477   
22          NaN            NaN           NaN            NaN  58430.420   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    15.581983       1.343872     16.347864      19.501814  58426.450   
27    14.369963       8.126190     15.869367      14.531776  58434.200   
28    15.961990       0.163007     15.961990      16.664300  58440.473   
29          NaN            NaN           NaN            NaN  58510.223   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60811.450        27.5.6              0.0  
3   60695.180        27.0.0              0.0  
4   60795.176        27.5.6              0.0  
5   59509.418        27.4.0              0.0  
6   60530.445        24.5.1              0.0  
7   60616.367        24.5.1              0.0  
8   59860.350         1.2.0              0.0  
9   60693.203        27.0.0              0.0  
10  60743.176        27.4.0              0.0  
11  60608.457        27.4.0              0.0  
12  60788.484        27.5.6              0.0  
13  60811.473        27.5.6              0.0  
14  60814.470        27.5.6              0.0  
15  60730.150        27.4.0              0.0  
16  59460.380         1.2.0              0.0  
17  60717.360        27.5.0              0.0  
18  60814.470        27.5.6              0.0  
19  60814.434        27.5.6              0.0  
20  60787.230        27.5.6              0.0  
21  60635.324        27.4.0              0.0  
22  60619.414        24.5.1              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60806.220        27.5.6              0.0  
27  60685.170        26.2.0              0.0  
28  60689.402        26.2.0              0.0  
29  60321.188        24.5.1              0.0  

[30 rows x 28 columns]]",,10.305725336074829,2025-05-19T17:23:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,104,0,"SELECT
    sq1.oid,
    ss_ztf.candid, ss_ztf.ssdistnr, ss_ztf.ssmagnr,
    ss_ztf.ssnamenr, dataquality.fid,
    dataquality.fwhm, dataquality.nmatches,
    dataquality.exptime
FROM
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.9
    AND classifier_version = 'stamp_classifier_1.0.4'
LIMIT 30
) as sq1
INNER JOIN
ss_ztf
ON sq1.oid = ss_ztf.oid
INNER JOIN
dataquality
ON ss_ztf.oid = dataquality.oid
AND ss_ztf.candid = dataquality.candid",,,,,"[             oid               candid  ssdistnr  ssmagnr ssnamenr  fid  \
0   ZTF24abnlfji  2846346934215015007       0.0     18.4    14203    1   
1   ZTF24abnlfjr  2846347883315015005       0.0     18.2    39866    1   
2   ZTF24abnlfjt  2846347405115015006       0.0     18.2    81919    1   
3   ZTF24abnlfma  2846346461315015046       0.0     18.3    19722    1   
4   ZTF24abnlfjw  2846347401115015000       0.0     16.7    77612    1   
5   ZTF24abnlfjx  2846347401115015001       0.0     17.9    27146    1   
6   ZTF24abnlfku  2846345996115015021       0.0     18.2    22792    1   
7   ZTF24abnlfog  2846346931615015096       0.0     18.5    12232    1   
8   ZTF24abnlfoi  2846346931615015095       0.0     18.7    97686    1   
9   ZTF24abnlfoj  2846346931315015000       0.0     18.1    24908    1   
10  ZTF24abnlfok  2846346931315015020       0.0     19.2    25934    1   
11  ZTF24abnlfpf  2846347881315015026       0.0     18.3    74114    1   
12  ZTF24abnlfql  2846353190115015005       0.0     17.4     7605    1   
13  ZTF24abnlfqp  2846353192715015001       1.0     18.3   622792    1   
14  ZTF24abnlfqs  2846353193815015005       1.0     18.1   136150    1   
15  ZTF24abnlfrc  2846353662615015002       0.0     18.7   334050    1   
16  ZTF24abnlfri  2846354143415015002       0.0     16.3    54808    1   
17  ZTF24abnlfsf  2846354141615015002       0.0     18.6   116221    1   
18  ZTF24abnlfsg  2846347880315015008       0.0     17.1    32916    1   
19  ZTF24abnlfsk  2846355615815015000       0.0     17.8    11930    1   
20  ZTF24abnlfsl  2846355615815015003       0.0     18.7   288394    1   
21  ZTF24abnlfso  2846355612815015005       0.0     17.8    20864    1   
22  ZTF24abnlfsy  2846355610915015013       0.0     16.9    20196    1   
23  ZTF24abnlfsv  2846355615515015002       0.0     13.1      402    1   
24  ZTF24abnlfta  2846355614315015000       0.0     17.9    77613    1   
25  ZTF24abnlfth  2846353663415015002       0.0     17.8    13617    1   
26  ZTF24abnlfti  2846353663415015003       0.0     18.5   201410    1   
27  ZTF24abnlftk  2846353660015015010       0.0     18.3    74114    1   

        fwhm  nmatches  exptime  
0   2.900000       850     30.0  
1   1.910000      2114     30.0  
2   2.980000      1795     30.0  
3   2.430000       901     30.0  
4   2.480000      1601     30.0  
5   2.530000      1601     30.0  
6   4.560000      1111     30.0  
7   3.040000      1538     30.0  
8   1.373025      1538     30.0  
9   3.490000       981     30.0  
10  3.690000       981     30.0  
11  3.360000      1189     30.0  
12  1.700000      1713     30.0  
13  2.080000      1384     30.0  
14  2.220000      1917     30.0  
15  1.990000      2096     30.0  
16  1.930000      1063     30.0  
17  2.360000      1311     30.0  
18  2.040000      2241     30.0  
19  2.740000       203     30.0  
20  2.230000       203     30.0  
21  2.740000       169     30.0  
22  2.910000       178     30.0  
23  2.430000       162     30.0  
24  2.310000       192     30.0  
25  1.830000       562     30.0  
26  2.080000       562     30.0  
27  2.570000      1222     30.0  ]",,3.380957841873169,2025-05-19T17:23:30,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,104,1,"
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.nid AS number_of_ps1_calibrators_used,  -- Assuming 'nid' is the number of PS1 calibrators used
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
WHERE 
    p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.classifier_version = 'stamp_classifier_1.0.4'
    AND p.probability > 0.9
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.595694065094,2025-04-29T12:42:55,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 12:     d.exptime AS exposure_time
             ^

[SQL: 
-- Final Query: Combine all steps into a single query
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.distnr AS fwhm_from_sextractor, -- Assuming 'distnr' is used as a placeholder for FWHM
    d.nid AS number_of_ps1_calibrators_used,  -- Assuming 'nid' is the number of PS1 calibrators used
    d.exptime AS exposure_time
FROM 
    (SELECT 
        p.oid
    FROM 
        probability p
    WHERE 
        p.class_name = 'asteroid'
        AND p.classifier_name = 'stamp_classifier'
        AND p.classifier_version = 'stamp_classifier_1.0.4'
        AND p.probability > 0.9
        AND p.ranking = 1
    LIMIT 30) AS filtered_prob
INNER JOIN 
    object o ON filtered_prob.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
]
(Background on this error at: https://sqlalche.me/e/20/f405)",19.698493003845215,2025-05-19T17:23:56,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,2,"
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_identifier,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.classifier_version = 'stamp_classifier_1.0.4'
    AND p.probability > 0.9
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.386061429977417,2025-04-29T12:43:16,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 11:     d.exptime AS exposure_time  -- Assuming 'exptime' is a v...
             ^

[SQL: 
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_identifier,
    d.sigmapsf AS fwhm_from_sextractor,  -- Corrected column name
    d.nid AS number_of_ps1_calibrators_used,  -- Assuming 'nid' as the closest match for calibrators
    d.exptime AS exposure_time  -- Assuming 'exptime' is a valid column, though not listed in schema
FROM 
    probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.classifier_version = 'stamp_classifier_1.0.4'
    AND p.probability > 0.9
    AND p.ranking = 1
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.955166339874268,2025-05-19T17:24:12,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,3,"
-- Subquery to filter objects with a probability > 0.9 of being an asteroid
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Main query to retrieve the required information
SELECT 
    o.oid AS ztf_object_id,
    d.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    p.nmtchps AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_objects fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ps1_ztf p ON d.candid = p.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,27.12235307693481,2025-04-29T12:43:43,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time
             ^

[SQL: 
-- Subquery to filter objects with a probability > 0.9 of being an asteroid
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Main query to retrieve the required information
SELECT 
    o.oid AS ztf_object_id,
    d.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    -- Removed fwhm_from_sextractor as it does not exist in the schema
    p.nmtchps AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_objects fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ps1_ztf p ON d.candid = p.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.372681856155396,2025-05-19T17:24:30,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,4,"
-- Step 1: Subquery to filter probability table for asteroids with probability > 0.9
WITH filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Step 2: Join with object, ss_ztf, and detection tables
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_to_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_identifier,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_probabilities fp
INNER JOIN 
    object o ON fp.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,21.79699301719665,2025-04-29T12:44:05,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time
             ^

[SQL: 
-- Step 1: Subquery to filter probability table for asteroids with probability > 0.9
WITH filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Step 2: Join with object, ss_ztf, and detection tables
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_to_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_identifier,
    d.magpsf AS fwhm_from_sextractor, -- Corrected column name
    p.nmtchps AS number_of_ps1_calibrators_used, -- Corrected table and column name
    d.exptime AS exposure_time
FROM 
    filtered_probabilities fp
INNER JOIN 
    object o ON fp.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
INNER JOIN 
    ps1_ztf p ON s.candid = p.candid -- Added join to ps1_ztf for calibrators
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.823050022125244,2025-05-19T17:24:47,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,5,"
-- Subquery to filter oids from the probability table
WITH filtered_oids AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Main query to join tables and retrieve the required information
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_identifier,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_oids fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.7346785068512,2025-04-29T12:44:27,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time -- Corrected column name
             ^

[SQL: 
-- Subquery to filter oids from the probability table
WITH filtered_oids AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Main query to join tables and retrieve the required information
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_identifier,
    d.magpsf AS fwhm_from_sextractor, -- Corrected column name
    d.nid AS number_of_ps1_calibrators_used, -- Corrected column name
    d.exptime AS exposure_time -- Corrected column name
FROM 
    filtered_oids fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.74830675125122,2025-05-19T17:25:04,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,6,"
SELECT 
    p.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.magpsf AS fwhm, 
    d.nid AS ncalib, 
    d.exptime
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.probability > 0.9 
    AND p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,20.583189249038696,2025-04-29T12:44:48,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 11:     d.exptime  -- Removed as it does not exist in the schema
             ^

[SQL: 
SELECT 
    p.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.sigmapsf AS fwhm,  -- Corrected column name for FWHM
    d.nid AS ncalib, 
    d.exptime  -- Removed as it does not exist in the schema
FROM 
    (SELECT oid 
     FROM probability 
     WHERE probability > 0.9 
       AND class_name = 'asteroid' 
       AND classifier_name = 'stamp_classifier' 
       AND classifier_version = 'stamp_classifier_1.0.4' 
       AND ranking = 1
     LIMIT 30) p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.267618179321289,2025-05-19T17:25:23,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,7,"
SELECT 
    p.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_from_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS nearest_solar_system_object_name, 
    d.fid AS filter_id, 
    d.fwhm AS fwhm_from_sextractor, 
    d.ncalib AS number_of_ps1_calibrators_used, 
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,28.706850051879883,2025-04-29T12:45:17,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 11:     d.exptime AS exposure_time
             ^

[SQL: 
SELECT 
    p.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_from_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS nearest_solar_system_object_name, 
    d.fid AS filter_id, 
    d.magpsf AS fwhm_from_sextractor,  -- Corrected column name
    d.rb AS number_of_ps1_calibrators_used,  -- Corrected column name
    d.exptime AS exposure_time
FROM 
    (SELECT oid 
     FROM probability 
     WHERE class_name = 'asteroid' 
       AND classifier_name = 'stamp_classifier' 
       AND classifier_version = 'stamp_classifier_1.0.4' 
       AND probability > 0.9 
       AND ranking = 1
     LIMIT 30) p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.85171127319336,2025-05-19T17:25:40,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,8,"
SELECT 
    p.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.fwhm, 
    d.ncalib, 
    d.exptime
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.431063413619995,2025-04-29T12:45:35,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 19:             d.exptime
                     ^

[SQL: 
SELECT 
    subquery.oid, 
    subquery.candid, 
    subquery.ssdistnr, 
    subquery.ssmagnr, 
    subquery.ssnamenr, 
    subquery.fid, 
    subquery.exptime
FROM 
    (
        SELECT 
            p.oid, 
            s.candid, 
            s.ssdistnr, 
            s.ssmagnr, 
            s.ssnamenr, 
            d.fid, 
            d.exptime
        FROM 
            probability p
        INNER JOIN 
            ss_ztf s ON p.oid = s.oid
        INNER JOIN 
            detection d ON s.candid = d.candid
        WHERE 
            p.class_name = 'asteroid' 
            AND p.classifier_name = 'stamp_classifier' 
            AND p.classifier_version = 'stamp_classifier_1.0.4' 
            AND p.probability > 0.9 
            AND p.ranking = 1
        LIMIT 30
    ) AS subquery
]
(Background on this error at: https://sqlalche.me/e/20/f405)",16.093068838119507,2025-05-19T17:26:01,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,9,"
-- Step 1: Subquery to filter objects with the specified probability conditions
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Step 2: Join with object, ss_ztf, and detection tables
SELECT 
    o.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.fwhm, 
    d.ncalib, 
    d.exptime
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
INNER JOIN detection d ON s.candid = d.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.10161542892456,2025-04-29T12:45:54,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime
             ^

[SQL: 
-- Step 1: Subquery to filter objects with the specified probability conditions
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Step 2: Join with object, ss_ztf, and detection tables
SELECT 
    o.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.magpsf AS fwhm,  -- Assuming 'fwhm' was intended to be 'magpsf' as 'fwhm' does not exist
    d.nid AS ncalib,   -- Assuming 'ncalib' was intended to be 'nid' as 'ncalib' does not exist
    d.exptime
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
INNER JOIN detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",15.752451658248901,2025-05-19T17:26:20,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,10,"
-- Subquery to filter objects with the specified probability conditions
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Main query to join tables and retrieve the required information
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_objects fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.491296529769897,2025-04-29T12:46:13,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time -- Corrected column name
             ^

[SQL: 
-- Subquery to filter objects with the specified probability conditions
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Main query to join tables and retrieve the required information
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.distnr AS fwhm_from_sextractor, -- Corrected column name
    d.nid AS number_of_ps1_calibrators_used, -- Corrected column name
    d.exptime AS exposure_time -- Corrected column name
FROM 
    filtered_objects fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.827345609664917,2025-05-19T17:26:40,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,71,0,"SELECT
    rfid, oid, candid, magnr, sigmagnr
FROM
    reference
WHERE
    oid IN ('ZTF20aczxeud','ZTF21aappfdu','ZTF22aacqjeb')
    AND fid = 1
ORDER BY oid",,,,,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,3.446259021759033,2025-05-19T17:26:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,1,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,16.078418254852295,2025-04-29T12:46:29,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,9.141547203063965,2025-05-19T17:26:59,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,2,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1  -- Filter for g band
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,13.624054670333862,2025-04-29T12:46:43,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,8.943618297576904,2025-05-19T17:27:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,3,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1  -- Filter ID 1 corresponds to the g band
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.946117162704468,2025-04-29T12:46:56,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,11.057918787002563,2025-05-19T17:27:28,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,4,"
-- Query to retrieve reference information for specific ZTF objects in the 'g' band
SELECT 
    rfid,  -- Identifier of the reference
    oid,   -- ZTF identifier
    candid, -- Candidate identifier
    magnr, -- Magnitude of the nearest reference object
    sigmagnr -- Uncertainty of the magnitude
FROM 
    reference
WHERE 
    oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') -- Filter for specific ZTF identifiers
    AND fid = 1 -- Filter for 'g' band
ORDER BY 
    oid -- Sort results by ZTF identifier
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,15.541321516036987,2025-04-29T12:47:11,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,10.24610424041748,2025-05-19T17:27:46,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,5,"
SELECT 
    rfid, 
    oid, 
    candid, 
    magnr, 
    sigmagnr
FROM 
    reference
WHERE 
    oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') 
    AND fid = 1  -- Filter for g band
ORDER BY 
    oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.86180591583252,2025-04-29T12:47:24,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,9.572604179382324,2025-05-19T17:28:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,6,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,10.791408777236938,2025-04-29T12:47:35,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,8.539082765579224,2025-05-19T17:28:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,7,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,10.71144151687622,2025-04-29T12:47:46,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,9.178838968276978,2025-05-19T17:28:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,8,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.378373384475708,2025-04-29T12:47:58,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,9.532920360565186,2025-05-19T17:28:41,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,9,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,11.183799982070925,2025-04-29T12:48:10,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,8.715487003326416,2025-05-19T17:28:55,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,10,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.440671920776367,2025-04-29T12:48:22,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,40.54358172416687,2025-05-19T17:29:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,42,0,"SELECT
    oid, candid, fid, chipsf, fwhm, classtar,
    nbad, magzpsci, magzpsciunc, exptime
FROM
    dataquality
WHERE
    oid = 'ZTF21aapnixl'
ORDER BY chipsf
",,,,,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,3.495335817337036,2025-05-19T17:29:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,1,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.200922966003418,2025-04-29T12:48:25,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,9.439017295837402,2025-05-19T17:29:59,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,2,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.4390511512756348,2025-04-29T12:48:28,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,16.392115116119385,2025-05-19T17:30:20,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,3,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.740564346313477,2025-04-29T12:48:31,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,8.231178760528564,2025-05-19T17:30:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,4,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.6965951919555664,2025-04-29T12:48:34,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,9.3533935546875,2025-05-19T17:30:52,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,5,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.882836103439331,2025-04-29T12:48:38,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,9.384752750396729,2025-05-19T17:31:06,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,6,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.10225510597229,2025-04-29T12:48:42,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,14.862191677093506,2025-05-19T17:31:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,7,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,4.77508544921875,2025-04-29T12:48:46,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,8.764367580413818,2025-05-19T17:31:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,8,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.76728630065918,2025-04-29T12:48:49,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,9.83036470413208,2025-05-19T17:31:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,9,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.710254430770874,2025-04-29T12:48:52,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,8.687205791473389,2025-05-19T17:32:07,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,10,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.532714366912842,2025-04-29T12:48:55,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,10.318953037261963,2025-05-19T17:32:22,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,107,0,"SELECT
    object.oid, ndet, firstmjd, lastmjd,
    probability, ss_ztf.candid, ssdistnr,
    ssnamenr, mjd, fid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ss_ztf
    ON object.oid = ss_ztf.oid
    INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ndet > 500
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.5
    AND classifier_version = 'stamp_classifier_1.0.4'
    AND ssdistnr < 2
ORDER BY firstmjd
LIMIT 10
",,,,,"[            oid  ndet      firstmjd       lastmjd  probability  \
0  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
1  ZTF18abbxrwg   963  58287.335428  60814.441667          1.0   
2  ZTF18abctcjx   960  58301.355914  60814.458067          1.0   
3  ZTF18abegdjb   734  58304.357766  60814.398472          1.0   
4  ZTF18abjxzue   696  58332.271759  60811.337674          1.0   
5  ZTF18abnowwc   601  58348.212234  60814.457593          1.0   
6  ZTF18abnugpf   563  58348.353021  60814.419896          1.0   
7  ZTF17aacmuxo   580  58356.512998  60773.163762          1.0   
8  ZTF17aaapcln  1253  58357.495787  60775.153993          1.0   
9  ZTF18abrbhzl   782  58358.463819  60775.153993          1.0   

                candid  ssdistnr ssnamenr           mjd  fid  
0  1497422265615015015    -999.0     null  59251.422269    1  
1  1499564341415015015    -999.0     null  59253.564340    2  
2  1508557300615015050    -999.0     null  59262.557303    2  
3  1508557301515015029    -999.0     null  59262.557303    2  
4  1494508860715015005    -999.0     null  59248.508866    1  
5  1508557771615015008    -999.0     null  59262.557778    2  
6  1515558154415015007    -999.0     null  59269.558160    2  
7  1521247305515015000    -999.0     null  59275.247303    2  
8  1494169106015015027    -999.0     null  59248.169109    2  
9  1521247305415015012    -999.0     null  59275.247303    2  ]",,117.74124050140381,2025-05-19T17:34:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,107,1,"
SELECT 
    o.oid AS ztf_identifier, 
    o.ndet AS number_of_detections, 
    o.firstmjd AS first_detection_date, 
    o.lastmjd AS last_detection_date, 
    p.probability, 
    d.candid AS candidate_identifier, 
    s.ssdistnr AS distance_to_mpc_object, 
    s.ssnamenr AS mpc_name, 
    d.mjd AS detection_date, 
    d.fid AS filter_identifier
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
WHERE 
    o.ndet > 500
    AND p.probability > 0.5
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.classifier_version = 'stamp_classifier_1.0.4'
    AND p.ranking = 1
    AND s.ssdistnr < 2
ORDER BY 
    o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,28.270288228988647,2025-04-29T12:49:23,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   774          58279.169583   
1  ZTF18aakqcul                   774          58279.169583   
2  ZTF18aakqcul                   774          58279.169583   
3  ZTF18aakqcul                   774          58279.169583   
4  ZTF18aakqcul                   774          58279.169583   
5  ZTF18aakqcul                   774          58279.169583   
6  ZTF18aakqcul                   774          58279.169583   
7  ZTF18aakqcul                   774          58279.169583   
8  ZTF18aakqcul                   774          58279.169583   
9  ZTF18aakqcul                   774          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60814.373657          1.0   2240496781515010017   
1         60814.373657          1.0   2267443691515010008   
2         60814.373657          1.0   2267443215615010000   
3         60814.373657          1.0   2278298941515010013   
4         60814.373657          1.0   2278368001515010003   
5         60814.373657          1.0   2292295131515010015   
6         60814.373657          1.0   2290276151515010004   
7         60814.373657          1.0   2296331551515010005   
8         60814.373657          1.0   2296332025615010001   
9         60814.373657          1.0   2292274235615010002   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    59994.496782                  1  
1                  -999.0     null    60021.443692                  2  
2                  -999.0     null    60021.443218                  2  
3                  -999.0     null    60032.298947                  1  
4                  -999.0     null    60032.368009                  2  
5                  -999.0     null    60046.295139                  1  
6                  -999.0     null    60044.276157                  2  
7                  -999.0     null    60050.331551                  2  
8                  -999.0     null    60050.332026                  2  
9                  -999.0     null    60046.274236                  1  ]",,70.69000959396362,2025-05-19T17:35:44,1.0,0.1,0.1,0.1,0.0,0.0
0.16.3,gpt-4o,v1,107,2,"
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability
    FROM object o
    INNER JOIN probability_filtered p ON o.oid = p.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered o ON d.oid = o.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered o ON s.oid = o.oid
    WHERE s.ssdistnr < 2
)
SELECT o.oid AS ztf_identifier, 
       o.ndet AS number_of_detections, 
       o.firstmjd AS first_detection_date, 
       o.lastmjd AS last_detection_date, 
       o.probability, 
       d.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       d.mjd AS detection_date, 
       d.fid AS filter_identifier
FROM object_filtered o
INNER JOIN detection_filtered d ON o.oid = d.oid
INNER JOIN ss_ztf_filtered s ON o.oid = s.oid
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,21.01781916618347,2025-04-29T12:49:44,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   774          58279.169583   
1  ZTF18aakqcul                   774          58279.169583   
2  ZTF18aakqcul                   774          58279.169583   
3  ZTF18aakqcul                   774          58279.169583   
4  ZTF18aakqcul                   774          58279.169583   
5  ZTF18aakqcul                   774          58279.169583   
6  ZTF18aakqcul                   774          58279.169583   
7  ZTF18aakqcul                   774          58279.169583   
8  ZTF18aakqcul                   774          58279.169583   
9  ZTF18aakqcul                   774          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60814.373657          1.0   2705233311515010014   
1         60814.373657          1.0   2683312481515015017   
2         60814.373657          1.0   2703252951515010009   
3         60814.373657          1.0   2703275405615010001   
4         60814.373657          1.0   2705339385615010002   
5         60814.373657          1.0   2680394605615010000   
6         60814.373657          1.0   2697402755615010070   
7         60814.373657          1.0   2701258461515010004   
8         60814.373657          1.0   2703252951515010010   
9         60814.373657          1.0   2684316091515015015   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    60459.233310                  1  
1                  -999.0     null    60437.312488                  1  
2                  -999.0     null    60457.252951                  1  
3                  -999.0     null    60457.275405                  1  
4                  -999.0     null    60459.339387                  2  
5                  -999.0     null    60434.394606                  1  
6                  -999.0     null    60451.402755                  1  
7                  -999.0     null    60455.258461                  1  
8                  -999.0     null    60457.252951                  1  
9                  -999.0     null    60438.316099                  1  ]",,47.49173092842102,2025-05-19T17:36:38,1.0,0.1,0.1,0.1,0.0,0.0
0.16.3,gpt-4o,v1,107,3,"
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability
    FROM object o
    INNER JOIN probability_filtered p ON o.oid = p.oid
    WHERE o.ndet > 500
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    WHERE s.ssdistnr < 2
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
)
SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, o.probability, d.candid, s.ssdistnr, s.ssnamenr, d.mjd, d.fid
FROM object_filtered o
INNER JOIN ss_ztf_filtered s ON o.oid = s.oid
INNER JOIN detection_filtered d ON o.oid = d.oid
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,18.966674089431763,2025-04-29T12:50:03,"[            oid  ndet      firstmjd       lastmjd  probability  \
0  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
1  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
2  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
3  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
4  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
5  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
6  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
7  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
8  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
9  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   

                candid  ssdistnr ssnamenr           mjd  fid  
0  2240496781515010017    -999.0     null  59994.496782    1  
1  2267443691515010008    -999.0     null  60021.443692    2  
2  2267443215615010000    -999.0     null  60021.443218    2  
3  2278298941515010013    -999.0     null  60032.298947    1  
4  2278368001515010003    -999.0     null  60032.368009    2  
5  2292295131515010015    -999.0     null  60046.295139    1  
6  2290276151515010004    -999.0     null  60044.276157    2  
7  2296331551515010005    -999.0     null  60050.331551    2  
8  2296332025615010001    -999.0     null  60050.332026    2  
9  2292274235615010002    -999.0     null  60046.274236    1  ]",,13.931770086288452,2025-05-19T17:36:58,1.0,0.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,107,4,"
-- Subquery to filter probability table for objects classified as 'asteroid' with probability > 0.5
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
)

-- Main query to join tables and apply conditions
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM 
    object o
INNER JOIN 
    filtered_probability p ON o.oid = p.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.ndet > 500
    AND s.ssdistnr < 2
ORDER BY 
    o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,22.416176319122314,2025-04-29T12:50:26,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   774          58279.169583   
1  ZTF18aakqcul                   774          58279.169583   
2  ZTF18aakqcul                   774          58279.169583   
3  ZTF18aakqcul                   774          58279.169583   
4  ZTF18aakqcul                   774          58279.169583   
5  ZTF18aakqcul                   774          58279.169583   
6  ZTF18aakqcul                   774          58279.169583   
7  ZTF18aakqcul                   774          58279.169583   
8  ZTF18aakqcul                   774          58279.169583   
9  ZTF18aakqcul                   774          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60814.373657          1.0   2240496781515010017   
1         60814.373657          1.0   2267443691515010008   
2         60814.373657          1.0   2267443215615010000   
3         60814.373657          1.0   2278298941515010013   
4         60814.373657          1.0   2278368001515010003   
5         60814.373657          1.0   2292295131515010015   
6         60814.373657          1.0   2290276151515010004   
7         60814.373657          1.0   2296331551515010005   
8         60814.373657          1.0   2296332025615010001   
9         60814.373657          1.0   2292274235615010002   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    59994.496782                  1  
1                  -999.0     null    60021.443692                  2  
2                  -999.0     null    60021.443218                  2  
3                  -999.0     null    60032.298947                  1  
4                  -999.0     null    60032.368009                  2  
5                  -999.0     null    60046.295139                  1  
6                  -999.0     null    60044.276157                  2  
7                  -999.0     null    60050.331551                  2  
8                  -999.0     null    60050.332026                  2  
9                  -999.0     null    60046.274236                  1  ]",,15.838969230651855,2025-05-19T17:37:21,1.0,0.1,0.1,0.1,0.0,0.0
0.16.3,gpt-4o,v1,107,5,"
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered of ON d.oid = of.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered of ON s.oid = of.oid
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       p.probability, 
       df.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       df.mjd AS detection_date, 
       df.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability p ON of.oid = p.oid
INNER JOIN detection_filtered df ON of.oid = df.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,22.66591429710388,2025-04-29T12:50:48,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered of ON d.oid = of.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered of ON s.oid = of.oid
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       pf.probability, 
       df.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       df.mjd AS detection_date, 
       df.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability_filtered pf ON of.oid = pf.oid
INNER JOIN detection_filtered df ON of.oid = df.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",146.30725955963135,2025-05-19T17:39:53,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,107,6,"
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered of ON d.oid = of.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered of ON s.oid = of.oid
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       p.probability, 
       df.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       df.mjd AS detection_date, 
       df.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability p ON of.oid = p.oid
INNER JOIN detection_filtered df ON of.oid = df.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,19.982300758361816,2025-04-29T12:51:08,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       pf.probability, 
       d.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       d.mjd AS detection_date, 
       d.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability_filtered pf ON of.oid = pf.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
INNER JOIN detection d ON of.oid = d.oid
ORDER BY of.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",265.3681466579437,2025-05-19T17:44:24,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,107,7,"
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability
    FROM object o
    INNER JOIN probability_filtered p ON o.oid = p.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered o ON d.oid = o.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered o ON s.oid = o.oid
    WHERE s.ssdistnr < 2
)
SELECT o.oid AS ztf_identifier, 
       o.ndet AS number_of_detections, 
       o.firstmjd AS first_detection_date, 
       o.lastmjd AS last_detection_date, 
       o.probability, 
       d.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       d.mjd AS detection_date, 
       d.fid AS filter_identifier
FROM object_filtered o
INNER JOIN detection_filtered d ON o.oid = d.oid
INNER JOIN ss_ztf_filtered s ON o.oid = s.oid
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,21.218486785888672,2025-04-29T12:51:30,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   774          58279.169583   
1  ZTF18aakqcul                   774          58279.169583   
2  ZTF18aakqcul                   774          58279.169583   
3  ZTF18aakqcul                   774          58279.169583   
4  ZTF18aakqcul                   774          58279.169583   
5  ZTF18aakqcul                   774          58279.169583   
6  ZTF18aakqcul                   774          58279.169583   
7  ZTF18aakqcul                   774          58279.169583   
8  ZTF18aakqcul                   774          58279.169583   
9  ZTF18aakqcul                   774          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60814.373657          1.0   2705233311515010014   
1         60814.373657          1.0   2683312481515015017   
2         60814.373657          1.0   2703252951515010009   
3         60814.373657          1.0   2703275405615010001   
4         60814.373657          1.0   2705339385615010002   
5         60814.373657          1.0   2680394605615010000   
6         60814.373657          1.0   2697402755615010070   
7         60814.373657          1.0   2701258461515010004   
8         60814.373657          1.0   2703252951515010010   
9         60814.373657          1.0   2684316091515015015   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    60459.233310                  1  
1                  -999.0     null    60437.312488                  1  
2                  -999.0     null    60457.252951                  1  
3                  -999.0     null    60457.275405                  1  
4                  -999.0     null    60459.339387                  2  
5                  -999.0     null    60434.394606                  1  
6                  -999.0     null    60451.402755                  1  
7                  -999.0     null    60455.258461                  1  
8                  -999.0     null    60457.252951                  1  
9                  -999.0     null    60438.316099                  1  ]",,21.471497297286987,2025-05-19T17:44:51,1.0,0.1,0.1,0.1,0.0,0.0
0.16.3,gpt-4o,v1,107,8,"
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered of ON d.oid = of.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered of ON s.oid = of.oid
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       p.probability, 
       df.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       df.mjd AS detection_date, 
       df.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability p ON of.oid = p.oid
INNER JOIN detection_filtered df ON of.oid = df.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,24.68011832237244,2025-04-29T12:51:54,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   774          58279.169583   
1  ZTF18aakqcul                   774          58279.169583   
2  ZTF18aakqcul                   774          58279.169583   
3  ZTF18aakqcul                   774          58279.169583   
4  ZTF18aakqcul                   774          58279.169583   
5  ZTF18aakqcul                   774          58279.169583   
6  ZTF18aakqcul                   774          58279.169583   
7  ZTF18aakqcul                   774          58279.169583   
8  ZTF18aakqcul                   774          58279.169583   
9  ZTF18aakqcul                   774          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60814.373657          1.0   2292295131515010015   
1         60814.373657          1.0   2296332025615010001   
2         60814.373657          1.0   2267443215615010000   
3         60814.373657          1.0   2278368001515010003   
4         60814.373657          1.0   2290276151515010004   
5         60814.373657          1.0   2296331551515010005   
6         60814.373657          1.0   2240496781515010017   
7         60814.373657          1.0   2267443691515010008   
8         60814.373657          1.0   2278298941515010013   
9         60814.373657          1.0   2292274235615010002   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    60046.295139                  1  
1                  -999.0     null    60050.332026                  2  
2                  -999.0     null    60021.443218                  2  
3                  -999.0     null    60032.368009                  2  
4                  -999.0     null    60044.276157                  2  
5                  -999.0     null    60050.331551                  2  
6                  -999.0     null    59994.496782                  1  
7                  -999.0     null    60021.443692                  2  
8                  -999.0     null    60032.298947                  1  
9                  -999.0     null    60046.274236                  1  ]",,23.533146619796753,2025-05-19T17:45:21,1.0,0.1,0.1,0.1,0.0,0.0
0.16.3,gpt-4o,v1,107,9,"
SELECT 
    o.oid AS ""ZTF identifier"",
    o.ndet AS ""number of detections"",
    o.firstmjd AS ""first detection date"",
    o.lastmjd AS ""last detection date"",
    p.probability AS ""probability"",
    d.candid AS ""candidate identifier"",
    s.ssdistnr AS ""distance between ZTF object and MPC object"",
    s.ssnamenr AS ""MPC name"",
    d.mjd AS ""detection date"",
    d.fid AS ""filter identifier""
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.ndet > 500
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.classifier_version = 'stamp_classifier_1.0.4'
    AND p.probability > 0.5
    AND p.ranking = 1
    AND s.ssdistnr < 2
ORDER BY 
    o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,23.55281114578247,2025-04-29T12:52:18,"[  ZTF identifier  number of detections  first detection date  \
0   ZTF18aakqcul                   774          58279.169583   
1   ZTF18aakqcul                   774          58279.169583   
2   ZTF18aakqcul                   774          58279.169583   
3   ZTF18aakqcul                   774          58279.169583   
4   ZTF18aakqcul                   774          58279.169583   
5   ZTF18aakqcul                   774          58279.169583   
6   ZTF18aakqcul                   774          58279.169583   
7   ZTF18aakqcul                   774          58279.169583   
8   ZTF18aakqcul                   774          58279.169583   
9   ZTF18aakqcul                   774          58279.169583   

   last detection date  probability  candidate identifier  \
0         60814.373657          1.0   2240496781515010017   
1         60814.373657          1.0   2267443691515010008   
2         60814.373657          1.0   2267443215615010000   
3         60814.373657          1.0   2278298941515010013   
4         60814.373657          1.0   2278368001515010003   
5         60814.373657          1.0   2292295131515010015   
6         60814.373657          1.0   2290276151515010004   
7         60814.373657          1.0   2296331551515010005   
8         60814.373657          1.0   2296332025615010001   
9         60814.373657          1.0   2292274235615010002   

   distance between ZTF object and MPC object MPC name  detection date  \
0                                      -999.0     null    59994.496782   
1                                      -999.0     null    60021.443692   
2                                      -999.0     null    60021.443218   
3                                      -999.0     null    60032.298947   
4                                      -999.0     null    60032.368009   
5                                      -999.0     null    60046.295139   
6                                      -999.0     null    60044.276157   
7                                      -999.0     null    60050.331551   
8                                      -999.0     null    60050.332026   
9                                      -999.0     null    60046.274236   

   filter identifier  
0                  1  
1                  2  
2                  2  
3                  1  
4                  2  
5                  1  
6                  2  
7                  2  
8                  2  
9                  1  ]",,13.583157539367676,2025-05-19T17:45:40,1.0,1.0,0.1,0.1,1.0,0.0
0.16.3,gpt-4o,v1,107,10,"
WITH probability_subquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_subquery AS (
    SELECT oid, ndet, firstmjd, lastmjd
    FROM object
    WHERE ndet > 500
),
joined_data AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability, d.candid, d.mjd, d.fid, s.ssdistnr, s.ssnamenr
    FROM object_subquery o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    INNER JOIN detection d ON o.oid = d.oid
    INNER JOIN ss_ztf s ON o.oid = s.oid
    WHERE s.ssdistnr < 2
)
SELECT oid, ndet, firstmjd, lastmjd, probability, candid, ssdistnr, ssnamenr, mjd, fid
FROM joined_data
ORDER BY firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,19.491287231445312,2025-04-29T12:52:38,"[            oid  ndet      firstmjd       lastmjd  probability  \
0  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
1  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
2  ZTF18abbxrwg   963  58287.335428  60814.441667          1.0   
3  ZTF18abbxrwg   963  58287.335428  60814.441667          1.0   
4  ZTF18abbxrwg   963  58287.335428  60814.441667          1.0   
5  ZTF18abctcjx   960  58301.355914  60814.458067          1.0   
6  ZTF18abegdjb   734  58304.357766  60814.398472          1.0   
7  ZTF18abegdjb   734  58304.357766  60814.398472          1.0   
8  ZTF18abjxzue   696  58332.271759  60811.337674          1.0   
9  ZTF18ablpkxa   859  58334.338310  60814.441667          1.0   

                candid  ssdistnr ssnamenr           mjd  fid  
0  3001347831515015008    -999.0     null  60755.347836    1  
1  1497422265615015015    -999.0     null  59251.422269    1  
2  1499564341415015015    -999.0     null  59253.564340    2  
3  2230555240315015030    -999.0     null  59984.555243    2  
4  1676231050315015029    -999.0     null  59430.231053    2  
5  1508557300615015050    -999.0     null  59262.557303    2  
6  1508557301515015029    -999.0     null  59262.557303    2  
7  2239559171515015029    -999.0     null  59993.559178    2  
8  1494508860715015005    -999.0     null  59248.508866    1  
9  2431168696115010027    -999.0     null  60185.168692    1  ]",,38.773277282714844,2025-05-19T17:46:25,0.9,0.5,1.0,1.0,0.0,1.0
0.16.3,,,83,0,"SELECT
    *
FROM
    allwise
WHERE
    oid_catalog in
(
SELECT
    oid_catalog
FROM
    xmatch
WHERE
    oid = 'ZTF21aazqwxv'
)",,,,,"[           oid_catalog          ra       dec  w1mpro  w2mpro  w3mpro  w4mpro  \
0  J131116.64+045854.7  197.819368  4.981863  13.319  13.129   9.839   7.761   

   w1sigmpro  w2sigmpro  w3sigmpro  w4sigmpro  j_m_2mass  h_m_2mass  \
0      0.033      0.037      0.056      0.247     15.331     14.491   

   k_m_2mass  j_msig_2mass  h_msig_2mass  k_msig_2mass  
0     14.027         0.109           0.1           0.1  ]",,3.7195756435394287,2025-05-19T17:46:29,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,83,1,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.843326568603516,2025-04-29T12:52:41,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.81136965751648,2025-05-19T17:48:47,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,2,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.445544004440308,2025-04-29T12:52:43,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.35510158538818,2025-05-19T17:51:05,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,3,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.546348810195923,2025-04-29T12:52:47,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.33250308036804,2025-05-19T17:53:23,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,4,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.7188143730163574,2025-04-29T12:52:50,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",134.0004744529724,2025-05-19T17:55:42,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,5,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.522404193878174,2025-04-29T12:52:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.5507984161377,2025-05-19T17:57:59,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,6,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.340775966644287,2025-04-29T12:52:55,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",134.49157810211182,2025-05-19T18:00:18,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,7,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.4299683570861816,2025-04-29T12:52:57,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",134.39383625984192,2025-05-19T18:02:37,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,8,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.305925369262696,2025-04-29T12:53:00,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",135.91102027893066,2025-05-19T18:04:59,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,9,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.4947166442871094,2025-04-29T12:53:02,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.8249387741089,2025-05-19T18:07:27,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,10,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.138533115386963,2025-04-29T12:53:04,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",181.9355320930481,2025-05-19T18:10:38,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,84,0,"SELECT
    oid, xmatch.oid_catalog, dist,
    w1mpro, w2mpro, w3mpro, w4mpro
FROM
    xmatch INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    xmatch.oid = 'ZTF19aascdol'",,,,,"[            oid          oid_catalog      dist  w1mpro  w2mpro  w3mpro  w4mpro
0  ZTF19aascdol  J154334.93+152539.5  0.000043  15.286  14.354  11.747   8.611]",,3.6472349166870117,2025-05-19T18:10:42,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,84,1,"
SELECT 
    object.oid AS ztf_identifier, 
    xmatch.oid_catalog AS allwise_catalog_identifier, 
    xmatch.dist AS distance_between_counterparts, 
    allwise.w1mpro AS w1_magnitude, 
    allwise.w2mpro AS w2_magnitude, 
    allwise.w3mpro AS w3_magnitude, 
    allwise.w4mpro AS w4_magnitude
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol'
    AND xmatch.catid = 'ALLWISE' -- Assuming 'ALLWISE' is the catalog identifier in xmatch
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.15969729423523,2025-04-29T12:53:20,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,10.033669471740723,2025-05-19T18:10:56,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,2,"
SELECT 
    o.oid AS ztf_identifier, 
    xm.oid_catalog AS allwise_catalog_identifier, 
    xm.dist AS distance_between_counterparts, 
    aw.w1mpro AS w1_magnitude, 
    aw.w2mpro AS w2_magnitude, 
    aw.w3mpro AS w3_magnitude, 
    aw.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch xm ON o.oid = xm.oid
INNER JOIN 
    allwise aw ON xm.oid_catalog = aw.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol' 
    AND xm.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.321882486343384,2025-04-29T12:53:37,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,12.377101182937622,2025-05-19T18:11:13,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,3,"
SELECT 
    o.oid AS ztf_object_id, 
    xm.oid_catalog AS allwise_catalog_id, 
    xm.dist AS distance_between_counterparts, 
    aw.w1mpro AS w1_magnitude, 
    aw.w2mpro AS w2_magnitude, 
    aw.w3mpro AS w3_magnitude, 
    aw.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch xm ON o.oid = xm.oid
INNER JOIN 
    allwise aw ON xm.oid_catalog = aw.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.124496221542358,2025-04-29T12:53:52,"[  ztf_object_id   allwise_catalog_id  distance_between_counterparts  \
0  ZTF19aascdol  J154334.93+152539.5                       0.000043   

   w1_magnitude  w2_magnitude  w3_magnitude  w4_magnitude  
0        15.286        14.354        11.747         8.611  ]",,9.83626937866211,2025-05-19T18:11:26,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,4,"
SELECT 
    object.oid AS ztf_identifier, 
    allwise.oid_catalog AS allwise_catalog_identifier, 
    xmatch.dist AS distance_between_counterparts, 
    allwise.w1mpro AS w1_magnitude, 
    allwise.w2mpro AS w2_magnitude, 
    allwise.w3mpro AS w3_magnitude, 
    allwise.w4mpro AS w4_magnitude
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol' 
    AND xmatch.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.508123397827148,2025-04-29T12:54:08,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,10.847355604171753,2025-05-19T18:11:41,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,5,"
SELECT 
    o.oid AS ztf_identifier, 
    x.oid_catalog AS allwise_catalog_identifier, 
    x.dist AS distance_between_counterparts, 
    a.w1mpro AS w1_magnitude, 
    a.w2mpro AS w2_magnitude, 
    a.w3mpro AS w3_magnitude, 
    a.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch x ON o.oid = x.oid
INNER JOIN 
    allwise a ON x.oid_catalog = a.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol' 
    AND x.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.78112506866455,2025-04-29T12:54:21,"[            oid allwise_catalog_identifier  distance_between_counterparts  \
0  ZTF19aascdol        J154334.93+152539.5                       0.000043   

   w1_magnitude  w2_magnitude  w3_magnitude  w4_magnitude  
0        15.286        14.354        11.747         8.611  ]",,11.695102214813232,2025-05-19T18:11:57,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,84,6,"
SELECT 
    object.oid AS ztf_identifier, 
    xmatch.oid_catalog AS allwise_catalog_identifier, 
    xmatch.dist AS distance_between_counterparts, 
    allwise.w1mpro AS w1_magnitude, 
    allwise.w2mpro AS w2_magnitude, 
    allwise.w3mpro AS w3_magnitude, 
    allwise.w4mpro AS w4_magnitude
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol' 
    AND xmatch.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.648285865783691,2025-04-29T12:54:34,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,9.59087610244751,2025-05-19T18:12:11,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,7,"
SELECT 
    o.oid AS ztf_identifier, 
    xm.oid_catalog AS allwise_catalog_identifier, 
    xm.dist AS distance_between_counterparts, 
    aw.w1mpro AS w1_magnitude, 
    aw.w2mpro AS w2_magnitude, 
    aw.w3mpro AS w3_magnitude, 
    aw.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch xm ON o.oid = xm.oid
INNER JOIN 
    allwise aw ON xm.oid_catalog = aw.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol' 
    AND xm.catid = 'ALLWISE'  -- Assuming 'ALLWISE' is the catalog identifier in xmatch
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.70211148262024,2025-04-29T12:54:47,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,16.088435649871826,2025-05-19T18:12:31,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,8,"
SELECT 
    o.oid AS ztf_identifier, 
    xm.oid_catalog AS allwise_catalog_identifier, 
    xm.dist AS distance_between_counterparts, 
    aw.w1mpro AS w1_magnitude, 
    aw.w2mpro AS w2_magnitude, 
    aw.w3mpro AS w3_magnitude, 
    aw.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch xm ON o.oid = xm.oid
INNER JOIN 
    allwise aw ON xm.oid_catalog = aw.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol' 
    AND xm.catid = 'ALLWISE' -- Assuming 'ALLWISE' is the identifier for the ALLWISE catalog in xmatch
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.13951349258423,2025-04-29T12:55:04,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,10.496622800827026,2025-05-19T18:12:45,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,9,"
SELECT 
    object.oid AS ztf_identifier, 
    xmatch.oid_catalog AS allwise_catalog_identifier, 
    xmatch.dist AS distance_between_counterparts, 
    allwise.w1mpro AS w1_magnitude, 
    allwise.w2mpro AS w2_magnitude, 
    allwise.w3mpro AS w3_magnitude, 
    allwise.w4mpro AS w4_magnitude
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol' 
    AND xmatch.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,14.540286302566528,2025-04-29T12:55:20,"[            oid allwise_catalog_identifier  distance_between_counterparts  \
0  ZTF19aascdol        J154334.93+152539.5                       0.000043   

   w1_magnitude  w2_magnitude  w3_magnitude  w4_magnitude  
0        15.286        14.354        11.747         8.611  ]",,11.459950923919678,2025-05-19T18:13:06,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,84,10,"
SELECT 
    object.oid, 
    xmatch.oid_catalog, 
    xmatch.dist, 
    allwise.w1mpro, 
    allwise.w2mpro, 
    allwise.w3mpro, 
    allwise.w4mpro
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol' 
    AND xmatch.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.595354080200195,2025-04-29T12:55:38,"[            oid          oid_catalog      dist  w1mpro  w2mpro  w3mpro  w4mpro
0  ZTF19aascdol  J154334.93+152539.5  0.000043  15.286  14.354  11.747   8.611]",,8.93796443939209,2025-05-19T18:13:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,96,0,"SELECT
    ss_ztf.*, detection.mjd, detection.fid,
    detection.isdiffpos, detection.ra, detection.dec,
    detection.magpsf, detection.sigmapsf
FROM
    ss_ztf INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ssnamenr IN ('2003FP134','2009UK56')
    AND ssdistnr < 2
ORDER BY ssnamenr, mjd",,,,,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,27.529402494430542,2025-05-19T18:13:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,96,1,"
-- Step 1: Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table to get required detection details
SELECT 
    ss_ztf.*, 
    detection.mjd, 
    detection.fid, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf, 
    detection.sigmapsf
FROM 
    filtered_ss_ztf AS ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid
ORDER BY 
    ss_ztf.ssnamenr, detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,16.867366313934326,2025-04-29T12:55:55,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""ss_ztf""
LINE 12:     ss_ztf.*, 
             ^

[SQL: 
-- Step 1: Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table to get required detection details
SELECT 
    ss_ztf.*, 
    detection.mjd, 
    detection.fid, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf, 
    detection.sigmapsf
FROM 
    filtered_ss_ztf
INNER JOIN 
    detection ON filtered_ss_ztf.oid = detection.oid
ORDER BY 
    filtered_ss_ztf.ssnamenr, detection.mjd
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.187737464904785,2025-05-19T18:14:12,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,96,2,"
-- Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Main query to join filtered ss_ztf with detection table
SELECT 
    ss.*,
    d.mjd AS detection_date,
    d.fid AS filter_identifier,
    d.isdiffpos,
    d.ra,
    d.dec,
    d.magpsf AS difference_magnitude,
    d.sigmapsf AS magnitude_uncertainty
FROM 
    filtered_ss_ztf ss
INNER JOIN 
    detection d ON ss.candid = d.candid
ORDER BY 
    ss.ssnamenr, d.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.1252236366272,2025-04-29T12:56:13,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  magnitude_uncertainty  
0              20.192154               0.178280  
1              18.976067               0.170550  
2              19.098774               0.178708  
3              19.052930               0.091880  
4              18.866552               0.111349  
5              19.000805               0.124175  
6              18.983727               0.160271  
7              19.122366               0.093317  
8              19.243404               0.105018  
9              19.301159               0.215448  
10             19.525230               0.168116  
11             19.692917               0.152464  
12             20.403624               0.171651  
13             20.593506               0.179858  
14             20.169308               0.190793  
15             20.084251               0.143195  
16             20.582052               0.217129  
17             20.017073               0.141530  
18             20.329580               0.195694  
19             20.295746               0.186697  
20             19.843100               0.108691  
21             19.573830               0.144548  
22             19.879513               0.182747  
23             20.331053               0.161874  
24             20.051088               0.208385  
25             19.858680               0.133551  
26             20.297800               0.209505  
27             18.967524               0.107702  ]",,15.651601552963257,2025-05-19T18:14:46,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,gpt-4o,v1,96,3,"
-- Subquery to filter ss_ztf for relevant Solar System objects within 2 arcseconds
WITH relevant_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
    AND ssdistnr <= 2
)

-- Main query to join with detection and retrieve required columns
SELECT 
    ss_ztf.*, 
    detection.mjd AS detection_date, 
    detection.fid AS filter_identifier, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS difference_magnitude_uncertainty
FROM 
    relevant_ss_ztf
INNER JOIN 
    detection ON relevant_ss_ztf.candid = detection.candid
ORDER BY 
    ss_ztf.ssnamenr, detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,15.968383312225342,2025-04-29T12:56:29,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

    difference_magnitude  difference_magnitude_uncertainty  
0              20.192154                          0.178280  
1              18.976067                          0.170550  
2              19.098774                          0.178708  
3              19.052930                          0.091880  
4              18.866552                          0.111349  
5              19.000805                          0.124175  
6              18.983727                          0.160271  
7              19.122366                          0.093317  
8              19.243404                          0.105018  
9              19.301159                          0.215448  
10             19.525230                          0.168116  
11             19.692917                          0.152464  
12             20.403624                          0.171651  
13             20.593506                          0.179858  
14             20.169308                          0.190793  
15             20.084251                          0.143195  
16             20.582052                          0.217129  
17             20.017073                          0.141530  
18             20.329580                          0.195694  
19             20.295746                          0.186697  
20             19.843100                          0.108691  
21             19.573830                          0.144548  
22             19.879513                          0.182747  
23             20.331053                          0.161874  
24             20.051088                          0.208385  
25             19.858680                          0.133551  
26             20.297800                          0.209505  ]",,13.116774320602417,2025-05-19T18:15:05,1.0,1.0,0.6666666666666666,0.6666666666666666,1.0,0.0
0.16.3,gpt-4o,v1,96,4,"
-- Retrieve all detections for ZTF objects within 2 arcseconds of the Solar System identifiers '2003FP134' and '2009UK56'
SELECT 
    ss_ztf.*, 
    detection.mjd AS detection_date, 
    detection.fid AS filter_identifier, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS magnitude_uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')
    AND ss_ztf.ssdistnr <= 2
ORDER BY 
    ss_ztf.ssnamenr, 
    detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,16.48454785346985,2025-04-29T12:56:46,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  magnitude_uncertainty  
0              20.192154               0.178280  
1              18.976067               0.170550  
2              19.098774               0.178708  
3              19.052930               0.091880  
4              18.866552               0.111349  
5              19.000805               0.124175  
6              18.983727               0.160271  
7              19.122366               0.093317  
8              19.243404               0.105018  
9              19.301159               0.215448  
10             19.525230               0.168116  
11             19.692917               0.152464  
12             20.403624               0.171651  
13             20.593506               0.179858  
14             20.169308               0.190793  
15             20.084251               0.143195  
16             20.582052               0.217129  
17             20.017073               0.141530  
18             20.329580               0.195694  
19             20.295746               0.186697  
20             19.843100               0.108691  
21             19.573830               0.144548  
22             19.879513               0.182747  
23             20.331053               0.161874  
24             20.051088               0.208385  
25             19.858680               0.133551  
26             20.297800               0.209505  
27             18.967524               0.107702  ]",,15.46204948425293,2025-05-19T18:15:27,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,gpt-4o,v1,96,5,"
-- Step 1: Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table to get relevant detections
SELECT 
    ss_ztf.*, 
    detection.mjd, 
    detection.fid, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf, 
    detection.sigmapsf
FROM 
    filtered_ss_ztf AS ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid

-- Step 3: Order the results by solar system object name and detection date
ORDER BY 
    ss_ztf.ssnamenr, 
    detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.53211498260498,2025-04-29T12:57:08,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""ss_ztf""
LINE 12:     ss_ztf.*, 
             ^

[SQL: 
-- Step 1: Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table to get relevant detections
SELECT 
    ss_ztf.*, 
    detection.mjd, 
    detection.fid, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf, 
    detection.sigmapsf
FROM 
    filtered_ss_ztf
INNER JOIN 
    detection ON filtered_ss_ztf.oid = detection.oid -- Corrected the join condition to use 'oid' instead of 'candid'

-- Step 3: Order the results by solar system object name and detection date
ORDER BY 
    filtered_ss_ztf.ssnamenr, 
    detection.mjd
]
(Background on this error at: https://sqlalche.me/e/20/f405)",16.541731119155884,2025-05-19T18:15:51,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,96,6,"
-- Step 1: Filter ss_ztf for specific solar system identifiers and distance
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table and select required columns
SELECT 
    ss_ztf.*,
    detection.mjd,
    detection.fid,
    detection.isdiffpos,
    detection.ra,
    detection.dec,
    detection.magpsf,
    detection.sigmapsf
FROM filtered_ss_ztf AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid

-- Step 3: Sort by MPC name and detection date
ORDER BY ss_ztf.ssnamenr, detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,32.24034404754639,2025-04-29T12:57:40,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""ss_ztf""
LINE 12:     ss_ztf.*,
             ^

[SQL: 
-- Step 1: Filter ss_ztf for specific solar system identifiers and distance
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table and select required columns
SELECT 
    ss_ztf.*,
    detection.mjd,
    detection.fid,
    detection.isdiffpos,
    detection.ra,
    detection.dec,
    detection.magpsf,
    detection.sigmapsf
FROM filtered_ss_ztf
INNER JOIN detection ON filtered_ss_ztf.oid = detection.oid -- Corrected join condition to use 'oid' instead of 'candid'

-- Step 3: Sort by MPC name and detection date
ORDER BY filtered_ss_ztf.ssnamenr, detection.mjd
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.607949018478394,2025-05-19T18:16:10,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,96,7,"
-- Step 1: Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table to get the required columns
SELECT 
    ss_ztf.*,
    detection.mjd AS detection_date,
    detection.fid AS filter_identifier,
    detection.isdiffpos,
    detection.ra,
    detection.dec,
    detection.magpsf AS difference_magnitude,
    detection.sigmapsf AS difference_magnitude_uncertainty
FROM 
    filtered_ss_ztf AS ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid
ORDER BY 
    ss_ztf.ssnamenr, detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,22.926388025283813,2025-04-29T12:58:03,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

    difference_magnitude  difference_magnitude_uncertainty  
0              20.192154                          0.178280  
1              18.976067                          0.170550  
2              19.098774                          0.178708  
3              19.052930                          0.091880  
4              18.866552                          0.111349  
5              19.000805                          0.124175  
6              18.983727                          0.160271  
7              19.122366                          0.093317  
8              19.243404                          0.105018  
9              19.301159                          0.215448  
10             19.525230                          0.168116  
11             19.692917                          0.152464  
12             20.403624                          0.171651  
13             20.593506                          0.179858  
14             20.169308                          0.190793  
15             20.084251                          0.143195  
16             20.582052                          0.217129  
17             20.017073                          0.141530  
18             20.329580                          0.195694  
19             20.295746                          0.186697  
20             19.843100                          0.108691  
21             19.573830                          0.144548  
22             19.879513                          0.182747  
23             20.331053                          0.161874  
24             20.051088                          0.208385  
25             19.858680                          0.133551  
26             20.297800                          0.209505  ]",,16.254470348358154,2025-05-19T18:16:36,1.0,1.0,0.6666666666666666,0.6666666666666666,1.0,0.0
0.16.3,gpt-4o,v1,96,8,"
-- Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
    AND ssdistnr <= 2
)

-- Main query to join filtered ss_ztf with detection table
SELECT 
    ss.*,
    d.mjd AS detection_date,
    d.fid AS filter_identifier,
    d.isdiffpos,
    d.ra,
    d.dec,
    d.magpsf AS difference_magnitude,
    d.sigmapsf AS magnitude_uncertainty
FROM 
    filtered_ss_ztf ss
INNER JOIN 
    detection d ON ss.candid = d.candid
ORDER BY 
    ss.ssnamenr, d.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.949874877929688,2025-04-29T12:58:27,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  magnitude_uncertainty  
0              20.192154               0.178280  
1              18.976067               0.170550  
2              19.098774               0.178708  
3              19.052930               0.091880  
4              18.866552               0.111349  
5              19.000805               0.124175  
6              18.983727               0.160271  
7              19.122366               0.093317  
8              19.243404               0.105018  
9              19.301159               0.215448  
10             19.525230               0.168116  
11             19.692917               0.152464  
12             20.403624               0.171651  
13             20.593506               0.179858  
14             20.169308               0.190793  
15             20.084251               0.143195  
16             20.582052               0.217129  
17             20.017073               0.141530  
18             20.329580               0.195694  
19             20.295746               0.186697  
20             19.843100               0.108691  
21             19.573830               0.144548  
22             19.879513               0.182747  
23             20.331053               0.161874  
24             20.051088               0.208385  
25             19.858680               0.133551  
26             20.297800               0.209505  
27             18.967524               0.107702  ]",,15.99779200553894,2025-05-19T18:16:58,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,gpt-4o,v1,96,9,"
-- Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Main query to join with detection and select required columns
SELECT 
    ss.*,
    d.mjd AS detection_date,
    d.fid AS filter_identifier,
    d.isdiffpos,
    d.ra,
    d.dec,
    d.magpsf AS difference_magnitude,
    d.sigmapsf AS difference_magnitude_uncertainty
FROM 
    filtered_ss_ztf ss
INNER JOIN 
    detection d ON ss.candid = d.candid
ORDER BY 
    ss.ssnamenr, d.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.15677261352539,2025-04-29T12:58:46,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  difference_magnitude_uncertainty  
0              20.192154                          0.178280  
1              18.976067                          0.170550  
2              19.098774                          0.178708  
3              19.052930                          0.091880  
4              18.866552                          0.111349  
5              19.000805                          0.124175  
6              18.983727                          0.160271  
7              19.122366                          0.093317  
8              19.243404                          0.105018  
9              19.301159                          0.215448  
10             19.525230                          0.168116  
11             19.692917                          0.152464  
12             20.403624                          0.171651  
13             20.593506                          0.179858  
14             20.169308                          0.190793  
15             20.084251                          0.143195  
16             20.582052                          0.217129  
17             20.017073                          0.141530  
18             20.329580                          0.195694  
19             20.295746                          0.186697  
20             19.843100                          0.108691  
21             19.573830                          0.144548  
22             19.879513                          0.182747  
23             20.331053                          0.161874  
24             20.051088                          0.208385  
25             19.858680                          0.133551  
26             20.297800                          0.209505  
27             18.967524                          0.107702  ]",,16.478474140167236,2025-05-19T18:17:22,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,gpt-4o,v1,96,10,"
-- Retrieve all detections for ZTF objects within 2 arcseconds of the solar system identifiers '2003FP134' and '2009UK56'
SELECT 
    ss_ztf.*, 
    detection.mjd AS detection_date, 
    detection.fid AS filter_identifier, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS difference_magnitude_uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')
    AND ss_ztf.ssdistnr <= 2
ORDER BY 
    ss_ztf.ssnamenr, 
    detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,16.583386659622192,2025-04-29T12:59:03,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  difference_magnitude_uncertainty  
0              20.192154                          0.178280  
1              18.976067                          0.170550  
2              19.098774                          0.178708  
3              19.052930                          0.091880  
4              18.866552                          0.111349  
5              19.000805                          0.124175  
6              18.983727                          0.160271  
7              19.122366                          0.093317  
8              19.243404                          0.105018  
9              19.301159                          0.215448  
10             19.525230                          0.168116  
11             19.692917                          0.152464  
12             20.403624                          0.171651  
13             20.593506                          0.179858  
14             20.169308                          0.190793  
15             20.084251                          0.143195  
16             20.582052                          0.217129  
17             20.017073                          0.141530  
18             20.329580                          0.195694  
19             20.295746                          0.186697  
20             19.843100                          0.108691  
21             19.573830                          0.144548  
22             19.879513                          0.182747  
23             20.331053                          0.161874  
24             20.051088                          0.208385  
25             19.858680                          0.133551  
26             20.297800                          0.209505  
27             18.967524                          0.107702  ]",,16.460275650024414,2025-05-19T18:17:45,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,,,67,0,"SELECT
    *
FROM
    gaia_ztf
WHERE
    oid IN ('ZTF18acxlskz','ZTF22aanppbi','ZTF22abunrft')
    AND neargaia < 1.5",,,,,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,3.5076630115509033,2025-05-19T18:17:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,1,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.134937286376953,2025-04-29T12:59:06,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,9.167330980300903,2025-05-19T18:18:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,2,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,2.610205173492432,2025-04-29T12:59:09,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.285721063613892,2025-05-19T18:18:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,3,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.04867959022522,2025-04-29T12:59:12,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.546963214874268,2025-05-19T18:18:28,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,4,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,4.82270073890686,2025-04-29T12:59:17,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.062504053115845,2025-05-19T18:18:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,5,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
  AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,7.130168437957764,2025-04-29T12:59:25,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.296470642089844,2025-05-19T18:18:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,6,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,5.913736581802368,2025-04-29T12:59:31,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.52741551399231,2025-05-19T18:19:05,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,7,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
  AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.2186646461486816,2025-04-29T12:59:34,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.418900728225708,2025-05-19T18:19:18,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,8,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,7.56520676612854,2025-04-29T12:59:42,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.092171907424927,2025-05-19T18:19:30,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,9,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.32757306098938,2025-04-29T12:59:45,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.431584358215332,2025-05-19T18:19:43,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,10,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.92920446395874,2025-04-29T12:59:50,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.363092422485352,2025-05-19T18:19:56,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,55,0,"SELECT
    *
FROM
    object
WHERE
    oid = 'ZTF20aatxryt'",,,,,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,3.4592113494873047,2025-05-19T18:19:59,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,1,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.765812397003174,2025-04-29T12:59:52,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.420930624008179,2025-05-19T18:20:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,2,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.7249984741210938,2025-04-29T12:59:55,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.95279335975647,2025-05-19T18:20:24,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,3,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.4900877475738525,2025-04-29T12:59:58,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.9827351570129395,2025-05-19T18:20:37,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,4,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.181385040283203,2025-04-29T13:00:01,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.966794013977051,2025-05-19T18:20:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,5,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.690774917602539,2025-04-29T13:00:04,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.382570505142212,2025-05-19T18:21:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,6,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.305471181869507,2025-04-29T13:00:09,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.03781509399414,2025-05-19T18:21:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,7,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.8931353092193604,2025-04-29T13:00:12,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.499419212341309,2025-05-19T18:21:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,8,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.3809313774108887,2025-04-29T13:00:14,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.164209365844727,2025-05-19T18:21:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,9,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.938786506652832,2025-04-29T13:00:17,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.88632869720459,2025-05-19T18:21:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,10,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.011510372161865,2025-04-29T13:00:20,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.262840509414673,2025-05-19T18:22:04,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,47,0,"SELECT
    oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM
    detection
WHERE
    oid IN ('ZTF23aaawbsc','ZTF21abxlmuw')
    AND rb > 0.7
ORDER BY oid, mjd",,,,,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,3.7874937057495117,2025-05-19T18:22:08,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,1,"
SELECT 
    o.oid AS ztf_identifier, 
    d.candid AS candidate_identifier, 
    d.fid AS filter_identifier, 
    d.mjd AS detection_date, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb AS real_bogus_score
FROM 
    detection d
INNER JOIN 
    object o ON d.oid = o.oid
WHERE 
    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
ORDER BY 
    o.oid, d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,14.447340726852415,2025-04-29T13:00:35,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,10.149870872497559,2025-05-19T18:22:33,1.0,1.0,0.5,0.5,1.0,0.0
0.16.3,gpt-4o,v1,47,2,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
INNER JOIN 
    object o ON d.oid = o.oid
WHERE 
    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,15.110684633255005,2025-04-29T13:00:50,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,11.188598394393921,2025-05-19T18:22:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,3,"
SELECT 
    o.oid AS ztf_identifier, 
    d.candid AS candidate_identifier, 
    d.fid AS filter_identifier, 
    d.mjd AS detection_date, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb AS real_bogus_score
FROM 
    detection d
INNER JOIN 
    object o ON d.oid = o.oid
WHERE 
    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
ORDER BY 
    o.oid, d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,15.650835752487184,2025-04-29T13:01:07,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,10.144247770309448,2025-05-19T18:23:04,1.0,1.0,0.5,0.5,1.0,0.0
0.16.3,gpt-4o,v1,47,4,"
SELECT 
    oid, 
    candid, 
    fid, 
    mjd, 
    isdiffpos, 
    ra, 
    dec, 
    magpsf, 
    sigmapsf, 
    rb
FROM 
    detection
WHERE 
    oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND rb > 0.7
ORDER BY 
    oid, 
    mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,18.014184713363647,2025-04-29T13:01:26,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.043133974075317,2025-05-19T18:23:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,5,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.983172178268433,2025-04-29T13:01:39,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.28718376159668,2025-05-19T18:23:33,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,6,"
SELECT 
    object.oid AS ztf_identifier, 
    detection.candid AS candidate_identifier, 
    detection.fid AS filter_identifier, 
    detection.mjd AS detection_date, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS magnitude_uncertainty, 
    detection.rb AS real_bogus_score
FROM 
    object
INNER JOIN 
    detection ON object.oid = detection.oid
WHERE 
    object.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND detection.rb > 0.7
ORDER BY 
    object.oid, detection.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,16.038007020950317,2025-04-29T13:01:55,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec  difference_magnitude  \
0            1   21.323490  22.390380             20.659400   
1            1   21.323480  22.390360             20.626290   
2            1   21.323425  22.390396             20.667300   
3            1   21.323386  22.390342             20.724100   
4            1   21.323460  22.390334             19.865335   
..         ...         ...        ...                   ...   
157          1  265.214006  66.206344             19.306845   
158          1  265.213977  66.206306             19.475810   
159          1  265.213962  66.206365             20.027710   
160          1  265.214055  66.206338             20.245500   
161          1  265.213992  66.206356             19.808226   

     magnitude_uncertainty  real_bogus_score  
0                 0.232067          0.712857  
1                 0.211267          0.822857  
2                 0.234949          0.785714  
3                 0.274779          0.797143  
4                 0.192379          0.715714  
..                     ...               ...  
157               0.090955          0.787143  
158               0.106966          0.860000  
159               0.166629          0.808571  
160               0.207126          0.714286  
161               0.112136          0.790000  

[162 rows x 10 columns]]",,9.275185585021973,2025-05-19T18:23:50,1.0,1.0,0.3,0.3,1.0,0.0
0.16.3,gpt-4o,v1,47,7,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,14.472642660140991,2025-04-29T13:02:10,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.47309398651123,2025-05-19T18:24:04,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,8,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,14.507857322692873,2025-04-29T13:02:24,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.176574945449829,2025-05-19T18:24:18,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,9,"
SELECT 
    d.oid,          -- ZTF identifier
    d.candid,       -- Candidate identifier
    d.fid,          -- Filter identifier
    d.mjd,          -- Detection date
    d.isdiffpos,    -- Isdiffpos flag
    d.ra,           -- Detection RA
    d.dec,          -- Detection Dec
    d.magpsf,       -- Difference magnitude
    d.sigmapsf,     -- Magnitude uncertainty
    d.rb            -- Real/bogus score
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- Filter for specific ZTF identifiers
    AND d.rb > 0.7                             -- Filter for real/bogus score greater than 0.7
ORDER BY 
    d.oid,                                     -- Sort by ZTF identifier
    d.mjd                                     -- Then sort by detection date
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,16.603166341781616,2025-04-29T13:02:41,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,10.642512321472168,2025-05-19T18:24:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,10,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.652994871139526,2025-04-29T13:03:02,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,8.892497777938843,2025-05-19T18:24:47,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,79,0,"SELECT
    catid, oid_catalog, dist
FROM
    xmatch
WHERE
    oid = 'ZTF20achscch'",,,,,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,3.352935552597046,2025-05-19T18:24:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,1,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.922708511352539,2025-04-29T13:03:05,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,8.68885064125061,2025-05-19T18:25:08,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,2,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.8964626789093018,2025-04-29T13:03:08,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.714761018753052,2025-05-19T18:25:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,3,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.0871145725250244,2025-04-29T13:03:11,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,8.157082796096802,2025-05-19T18:25:33,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,4,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.5084266662597656,2025-04-29T13:03:15,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.639120578765869,2025-05-19T18:25:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,5,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.016144037246704,2025-04-29T13:03:18,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,8.287883758544922,2025-05-19T18:26:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,6,"
SELECT 
    catid, 
    oid_catalog, 
    dist 
FROM 
    xmatch 
WHERE 
    oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.826322317123413,2025-04-29T13:03:22,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,8.366184711456299,2025-05-19T18:26:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,7,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.6599602699279785,2025-04-29T13:03:25,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.685711622238159,2025-05-19T18:26:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,8,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,4.643218994140625,2025-04-29T13:03:29,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,8.0240478515625,2025-05-19T18:26:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,9,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.814771890640259,2025-04-29T13:03:32,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,8.110493183135986,2025-05-19T18:26:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,10,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.6497724056243896,2025-04-29T13:03:35,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.857975482940674,2025-05-19T18:27:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,94,0,"SELECT
    *
FROM
    object INNER JOIN
    reference
    ON object.oid = reference.oid
WHERE
    reference_change
LIMIT 50",,,,,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF19aaksakb         3      1580  58539.313727  60667.375521       True   
1   ZTF19aaktaww         3       108  58539.378507  58999.228947       True   
2   ZTF19aaktaww         3       108  58539.378507  58999.228947       True   
3   ZTF19aaktebp         5       815  58539.500000  60080.250000       True   
4   ZTF19aaktebp         5       815  58539.500000  60080.250000       True   
5   ZTF19aaktebp         5       815  58539.500000  60080.250000       True   
6   ZTF19aakszkb         5       370  58539.500000  60080.250000       True   
7   ZTF19aakszkb         5       370  58539.500000  60080.250000       True   
8   ZTF19aaktdbn         5       370  58539.500000  60080.250000       True   
9   ZTF19aaktdbn         5       370  58539.500000  60080.250000       True   
10  ZTF19aaktlbb        10      2032  58539.386100  60486.237257       True   
11  ZTF19aaktlbb        10      2032  58539.386100  60486.237257       True   
12  ZTF19aaktlbb        10      2032  58539.386100  60486.237257       True   
13  ZTF19aaktamq         5       352  58514.459595  59305.314630       True   
14  ZTF19aaktamq         5       352  58514.459595  59305.314630       True   
15  ZTF19aaktjmt         5       617  58539.378507  60710.422060       True   
16  ZTF19aaktjmt         5       617  58539.378507  60710.422060       True   
17  ZTF19aakszbk         6       361  58539.377130  60710.376331       True   
18  ZTF19aakszbk         6       361  58539.377130  60710.376331       True   
19  ZTF19aaljrrj         6       755  58543.232454  60680.339734       True   
20  ZTF19aaljrrj         6       755  58543.232454  60680.339734       True   
21  ZTF19aallfcx         2       138  58543.265451  59220.456076       True   
22  ZTF19aallfcx         2       138  58543.265451  59220.456076       True   
23  ZTF19aallfsu         2        29  58543.265451  58805.538287       True   
24  ZTF19aallfsu         2        29  58543.265451  58805.538287       True   
25  ZTF19aalmeqm        12       500  58199.292187  59641.294676       True   
26  ZTF19aalmeqm        12       500  58199.292187  59641.294676       True   
27  ZTF19aalmeqm        12       500  58199.292187  59641.294676       True   
28  ZTF19aalmeqi        28      1420  58199.292187  60723.342465       True   
29  ZTF19aalmeqi        28      1420  58199.292187  60723.342465       True   
30  ZTF19aalmeqi        28      1420  58199.292187  60723.342465       True   
31  ZTF19aalskwc        11      1605  58512.543681  60666.574352       True   
32  ZTF19aalskwc        11      1605  58512.543681  60666.574352       True   
33  ZTF19aaluhhl        11      1975  58539.459502  60665.557361       True   
34  ZTF19aaluhhl        11      1975  58539.459502  60665.557361       True   
35  ZTF19aaluhhl        11      1975  58539.459502  60665.557361       True   
36  ZTF19aaludao         7      1572  58543.523426  60666.562905       True   
37  ZTF19aamoajf         5       506  58557.209155  59671.195301      False   
38  ZTF19aamoajf         5       506  58557.209155  59671.195301      False   
39  ZTF19aamoesv         7       977  58557.236481  60724.318611       True   
40  ZTF19abbgtai         5      2098  58660.425301  60786.497465       True   
41  ZTF19abbgtai         5      2098  58660.425301  60786.497465       True   
42  ZTF18aceafpd         2       910  58102.250000  59793.500000       True   
43  ZTF18aceafpd         2       910  58102.250000  59793.500000       True   
44  ZTF18aceacmq        11      2065  58380.414456  60340.118600       True   
45  ZTF18aceacmq        11      2065  58380.414456  60340.118600       True   
46  ZTF18aceacmq        11      2065  58380.414456  60340.118600       True   
47  ZTF18achhecx       107      2765  58333.457060  60417.510532       True   
48  ZTF18achhecx       107      2765  58333.457060  60417.510532       True   
49  ZTF18acebzxy        11       951  58428.337789  59137.382407       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0      True     2       NaN           NaN  ...    311  14.643000     0.019   
1      True     3 -0.511181      0.665550  ...    320  14.957000     0.011   
2      True     3 -0.511181      0.665550  ...    320  15.518000     0.010   
3     False     5  2.825248      2.088293  ...    370  17.488000     0.014   
4     False     5  2.825248      2.088293  ...    370  16.031000     0.013   
5     False     5  2.825248      2.088293  ...    320  16.032000     0.015   
6     False     4  2.599183      1.114346  ...    320  15.745000     0.015   
7     False     4  2.599183      1.114346  ...    320  15.094999     0.011   
8     False     4  1.768142      1.107445  ...    320  16.062000     0.011   
9     False     4  1.768142      1.107445  ...    320  15.634999     0.013   
10    False     5 -0.136256      0.865853  ...    863  14.853000     0.012   
11    False     5 -0.136256      0.865853  ...    863  15.240000     0.019   
12    False     5 -0.136256      0.865853  ...    863  14.844000     0.024   
13     True     4       NaN           NaN  ...    319  15.474000     0.009   
14     True     4       NaN           NaN  ...    320  15.480000     0.011   
15     True     2       NaN           NaN  ...    320  16.883000     0.012   
16     True     2       NaN           NaN  ...    320  15.565000     0.015   
17    False     5       NaN           NaN  ...    267  13.484000     0.009   
18    False     5       NaN           NaN  ...    267  13.242000     0.017   
19    False     7       NaN           NaN  ...    261  15.599999     0.007   
20    False     7       NaN           NaN  ...    261  16.731000     0.012   
21     True     2 -1.856694      1.279184  ...    318  12.750000     0.013   
22     True     2 -1.856694      1.279184  ...    318  13.221000     0.009   
23     True     2 -0.512216      0.126490  ...    318  13.188000     0.012   
24     True     2 -0.512216      0.126490  ...    318  12.803000     0.015   
25     True    11 -0.092002      0.661389  ...    318  14.547999     0.014   
26     True    11 -0.092002      0.661389  ...    317  15.014999     0.011   
27     True    11 -0.092002      0.661389  ...    317  14.540000     0.013   
28     True     8 -0.369189      0.234553  ...    318  13.704000     0.012   
29     True     8 -0.369189      0.234553  ...    318  14.182000     0.009   
30     True     8 -0.369189      0.234553  ...    317  14.188000     0.011   
31     True     7       NaN           NaN  ...    482  13.181000     0.013   
32     True     7       NaN           NaN  ...    482  12.690000     0.014   
33     True     7       NaN           NaN  ...    481  14.764999     0.014   
34     True     7       NaN           NaN  ...    481  15.413000     0.017   
35     True     7       NaN           NaN  ...   1527  14.789000     0.014   
36     True     4       NaN           NaN  ...    482  14.589000     0.013   
37    False     2  1.368758           NaN  ...    262  14.811999     0.016   
38    False     2  1.368758           NaN  ...    262  15.228000     0.013   
39     True     2       NaN           NaN  ...    312  14.099000     0.013   
40     True     5       NaN           NaN  ...    693  13.823000     0.019   
41     True     5       NaN           NaN  ...   1734  13.443999     0.017   
42    False     2       NaN           NaN  ...    698  17.455000     0.016   
43    False     2       NaN           NaN  ...    740  17.439000     0.021   
44    False     5 -0.254139      0.001610  ...    250  16.303000     0.010   
45    False     5 -0.254139      0.001610  ...    299  15.934000     0.015   
46    False     5 -0.254139      0.001610  ...    300  16.270000     0.013   
47    False    22  1.412400      1.451979  ...    647  13.962999     0.018   
48    False    22  1.412400      1.451979  ...    647  12.678000     0.025   
49     True     8  0.415232      0.429793  ...    562  15.934000     0.015   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.712   -0.024  125.708478 -20.472902  58439.394039  58494.435648   
1   0.310   -0.006  185.419432 -18.748362  58216.238160  58587.252130   
2   0.375   -0.014  185.419422 -18.748354  58204.299028  58511.440104   
3   0.899   -0.013  183.077571 -13.430493  58203.304201  58482.524155   
4   0.310   -0.009  183.077579 -13.430498  58165.393461  58448.518009   
5   0.910   -0.030  183.077591 -13.430485  58216.250000  58573.250000   
6   1.179   -0.023  184.829621 -19.132576  58204.299028  58511.440104   
7   0.370   -0.022  184.829629 -19.132594  58216.238160  58584.295602   
8   0.515   -0.010  183.146153 -16.676574  58204.299028  58511.440104   
9   0.235   -0.009  183.146149 -16.676577  58216.250000  58573.250000   
10  0.480   -0.031  229.254390  78.142905  58186.413843  58246.267049   
11  0.471   -0.014  229.254376  78.142922  58223.322049  58350.274884   
12  0.441   -0.019  229.254395  78.142899  58321.250000  59725.250000   
13  0.318   -0.008  181.903122 -17.760249  58203.303738  58581.295509   
14  0.661   -0.020  181.903110 -17.760256  58204.299028  58511.440104   
15  0.559    0.003  183.549513 -17.152692  58204.299028  58511.440104   
16  0.770   -0.007  183.549515 -17.152693  58216.250000  58584.250000   
17  0.417   -0.004  165.475211 -21.426232  58204.279607  58509.518982   
18  1.040   -0.020  165.475220 -21.426243  58218.250000  58582.250000   
19  0.660   -0.003  119.996560 -26.760165  58218.197072  58486.415324   
20  0.817   -0.011  119.996552 -26.760180  58427.500000  58543.250000   
21  0.598    0.025  173.252621 -16.037246  58218.217199  58539.298484   
22  0.432    0.000  173.252622 -16.037237  58203.303275  58557.276262   
23  0.430   -0.005  170.390145 -16.225401  58203.303275  58547.315521   
24  0.238    0.015  170.390148 -16.225408  58218.217199  58539.298484   
25  0.739   -0.019  167.714745 -13.941280  58218.217199  58557.252882   
26  0.677   -0.008  167.714737 -13.941275  58204.214560  58487.462199   
27  0.618   -0.002  167.714738 -13.941282  58218.218588  58481.529421   
28  0.624   -0.011  167.865515 -14.022556  58218.217199  58557.252882   
29  0.520   -0.010  167.865511 -14.022551  58203.303275  58487.480938   
30  0.634   -0.011  167.865499 -14.022551  58204.214560  58487.462199   
31  0.380    0.036  244.400789   3.506512  58203.417662  58346.162650   
32  0.396    0.023  244.400780   3.506519  58198.439502  58337.204329   
33  0.397   -0.018  240.930983   4.753061  58186.537338  58254.363750   
34  0.600   -0.046  240.930984   4.753044  58203.376829  58366.208322   
35  0.346   -0.021  240.930984   4.753044  58618.250000  60598.000000   
36  0.369    0.008  244.514197   5.629936  58203.417662  58343.168970   
37  0.335    0.006  129.914216 -24.048582  58472.433657  58493.392882   
38  0.472   -0.009  129.914221 -24.048577  58234.146401  59168.480313   
39  0.720   -0.025  128.725959 -19.070840  58218.195694  58557.236481   
40  1.024   -0.040  355.822831  34.611871  58246.483414  58343.403368   
41  0.324   -0.011  355.822845  34.611858  58326.250000  58744.500000   
42  0.501    0.004   42.031241  44.061701  58303.471736  58362.445035   
43  0.803   -0.002   42.031246  44.061684  58288.500000  58447.500000   
44  0.740   -0.006   40.530286 -20.618731  58348.479722  58434.287187   
45  0.670    0.001   40.530340 -20.618737  58321.484016  58364.516273   
46  0.398   -0.001   40.530277 -20.618752  58338.500000  58364.500000   
47  0.737   -0.043  355.296584  22.860067  58247.484861  58361.404942   
48  1.140    0.074  355.296580  22.860072  58247.471146  58447.321644   
49  0.324    0.044   86.923033  21.046885  58160.161528  58441.422245   

   nframesref  
0          40  
1          15  
2          15  
3          15  
4          18  
5          15  
6          15  
7          15  
8          15  
9          15  
10         15  
11         17  
12        100  
13         15  
14         15  
15         15  
16         15  
17         15  
18         15  
19         40  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         26  
35         15  
36         15  
37         40  
38         15  
39         15  
40         15  
41         40  
42         15  
43         33  
44         20  
45         15  
46         15  
47         15  
48         40  
49         40  

[50 rows x 36 columns]]",,3.4817636013031006,2025-05-19T18:27:06,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,1,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,14.572192907333374,2025-04-29T13:03:50,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abwihjn        10      1569  58370.382674  59542.170509      False   
1   ZTF18abwihby         2        41  58376.374977  58397.406123      False   
2   ZTF18abwihby         2        41  58376.374977  58397.406123      False   
3   ZTF18abwjkvq         8       218  58366.475625  58540.194942      False   
4   ZTF18abwkmly         4      1754  58376.500000  60169.500000       True   
5   ZTF18abwkmly         4      1754  58376.500000  60169.500000       True   
6   ZTF18abwkrhl        10      1574  58376.500000  59983.250000       True   
7   ZTF18abwkrhl        10      1574  58376.500000  59983.250000       True   
8   ZTF18abwkwef         7       217  58352.508264  58376.486539      False   
9   ZTF18abwkyra        12      1196  58376.489849  59196.326019       True   
10  ZTF18abwkyra        12      1196  58376.489849  59196.326019       True   
11  ZTF18abwlhuo        14      1717  58092.567454  60308.142431       True   
12  ZTF18abwlhuo        14      1717  58092.567454  60308.142431       True   
13  ZTF18abwkvyv        24      2143  58097.287060  60319.365405       True   
14  ZTF18abwkvyv        24      2143  58097.287060  60319.365405       True   
15  ZTF18abwkyvw        12      1498  58372.500000  59782.500000       True   
16  ZTF18abwkyvw        12      1498  58372.500000  59782.500000       True   
17  ZTF18abwqqxm        16      1958  58365.450822  60484.473958       True   
18  ZTF18abwqqxm        16      1958  58365.450822  60484.473958       True   
19  ZTF18abwtdzd         5       152  58365.446620  58436.356655       True   
20  ZTF18abwtdzd         5       152  58365.446620  58436.356655       True   
21  ZTF18abwtefk         6      1351  58377.500000  59785.500000       True   
22  ZTF18abwtefk         6      1351  58377.500000  59785.500000       True   
23  ZTF18abwtfdz        13      1774  58368.500000  60042.250000       True   
24  ZTF18abwtfdz        13      1774  58368.500000  60042.250000       True   
25  ZTF18abwwjyr         8      1283  58245.500000  59911.000000       True   
26  ZTF18abwwjyr         8      1283  58245.500000  59911.000000       True   
27  ZTF18abxawsw         8      1514  58364.500000  59823.500000       True   
28  ZTF18abxawsw         8      1514  58364.500000  59823.500000       True   
29  ZTF18abxbgjn        15      1676  58097.250000  60143.500000       True   
30  ZTF18abxbgjn        15      1676  58097.250000  60143.500000       True   
31  ZTF18abxbgnb         8      1713  58378.500000  60148.500000       True   
32  ZTF18abxbgnb         8      1713  58378.500000  60148.500000       True   
33  ZTF18abxbmwy         5      1635  58104.495683  59196.420637       True   
34  ZTF18abxbmwy         5      1635  58104.495683  59196.420637       True   
35  ZTF18abxbfpa         6      1315  58378.487917  59419.491308       True   
36  ZTF18abxbfpa         6      1315  58378.487917  59419.491308       True   
37  ZTF18abxbbwa         8      1793  58346.493727  60639.299479       True   
38  ZTF18abxbbwa         8      1793  58346.493727  60639.299479       True   
39  ZTF18abxfuhi         3        43  58352.416343  58379.391123      False   
40  ZTF18abxikqe         7      1992  58379.473472  60706.217222      False   
41  ZTF18abxikqe         7      1992  58379.473472  60706.217222      False   
42  ZTF18abxihrj         8      2159  58097.299271  59173.411250       True   
43  ZTF18abxihrj         8      2159  58097.299271  59173.411250       True   
44  ZTF18abxihrj         8      2159  58097.299271  59173.411250       True   
45  ZTF18abxihrj         8      2159  58097.299271  59173.411250       True   
46  ZTF18abxijqq         6       805  58379.473009  59097.488762       True   
47  ZTF18abxijqq         6       805  58379.473009  59097.488762       True   
48  ZTF18abxinuw        11       434  58329.493461  58476.303530      False   
49  ZTF18abxinuw        11       434  58329.493461  58476.303530      False   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     5  1.192140           NaN  ...    696  13.947000     0.017   
1     False     2       NaN           NaN  ...    602  20.869000     0.145   
2     False     2       NaN           NaN  ...    603  20.487000     0.127   
3     False     5  0.495998           NaN  ...    778  21.132000     0.134   
4     False     4  2.448876      0.221397  ...    702  15.460999     0.024   
5     False     4  2.448876      0.221397  ...    702  15.054000     0.017   
6     False     8  0.471101      0.756087  ...    776  15.254999     0.015   
7     False     8  0.471101      0.756087  ...    776  15.998000     0.016   
8     False     7  1.185263           NaN  ...    611  12.734000     0.016   
9      True     6  2.266990      1.022893  ...    779  13.459000     0.016   
10     True     6  2.266990      1.022893  ...    779  12.617000     0.018   
11     True     3 -1.613888      0.380934  ...    612  14.123000     0.016   
12     True     3 -1.613888      0.380934  ...    612  13.929000     0.013   
13    False    13  0.509688      0.768195  ...    562  17.135000     0.012   
14    False    13  0.509688      0.768195  ...    562  16.338000     0.018   
15    False     5  0.752197      0.009231  ...    779  15.642000     0.017   
16    False     5  0.752197      0.009231  ...    779  15.434000     0.015   
17     True     5 -0.054033      0.840384  ...    741  16.349000     0.017   
18     True     5 -0.054033      0.840384  ...    741  15.427000     0.014   
19     True     2  1.928421      0.592391  ...    743  14.891000     0.013   
20     True     2  1.928421      0.592391  ...    743  15.360000     0.018   
21    False     3  2.757869      0.531594  ...    743  13.203000     0.014   
22    False     3  2.757869      0.531594  ...    743  12.747999     0.010   
23    False     5  2.229150      0.778899  ...    702  15.596000     0.021   
24    False     5  2.229150      0.778899  ...    702  14.993999     0.015   
25    False     4  3.139355      1.172665  ...    800  14.040000     0.010   
26    False     4  3.139355      1.172665  ...    800  13.183000     0.016   
27    False     6  1.249268      0.941903  ...    777  13.844000     0.020   
28    False     6  1.249268      0.941903  ...    777  14.698999     0.017   
29    False     7  0.240574      0.217808  ...    658  13.236999     0.011   
30    False     7  0.240574      0.217808  ...    658  13.446000     0.013   
31    False     7 -0.021897      0.262327  ...    658  12.812000     0.015   
32    False     7 -0.021897      0.262327  ...    658  12.688000     0.015   
33     True     2 -0.055346      0.781548  ...    566  15.804000     0.012   
34     True     2 -0.055346      0.781548  ...    566  16.500000     0.013   
35     True     3  4.441806      1.585662  ...    658  14.766000     0.019   
36     True     3  4.441806      1.585662  ...    658  14.299999     0.014   
37     True     4       NaN           NaN  ...    778  13.523999     0.016   
38     True     4       NaN           NaN  ...    778  14.690000     0.024   
39    False     2  0.435606           NaN  ...    500  20.671000     0.152   
40    False     2       NaN           NaN  ...    702  13.709000     0.022   
41    False     2       NaN           NaN  ...    702  18.396000     0.025   
42     True     5  0.749712      1.728394  ...    810  16.062000     0.015   
43     True     5  0.749712      1.728394  ...    779  14.462000     0.024   
44     True     5  0.749712      1.728394  ...    778  16.009000     0.022   
45     True     5  0.749712      1.728394  ...    779  16.027000     0.016   
46     True     2  2.547258      0.116399  ...    743  15.240000     0.015   
47     True     2  2.547258      0.116399  ...    743  15.800000     0.016   
48    False     6  0.670000           NaN  ...    703  17.344000     0.015   
49    False     6  0.670000           NaN  ...    703  18.046000     0.024   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.493   -0.038   16.768004  37.477844  58274.476701  58372.338762   
1   3.524    0.388   19.709086  23.534785  58276.463437  58368.333056   
2   4.307    0.168   19.708678  23.534979  58281.465660  58380.310741   
3   2.350    0.377   64.128634  51.203692  58314.444155  58375.491574   
4   1.165   -0.070   69.647076  41.661029  58168.150498  58352.393762   
5   0.840   -0.051   69.647079  41.661015  58160.250000  58432.250000   
6   0.472   -0.015   38.386066  53.708033  58283.471887  58379.425035   
7   0.648   -0.014   38.386054  53.708029  58291.451366  58342.427743   
8   0.579   -0.028   85.411215  24.840789  58168.113576  58374.476470   
9   0.612   -0.010   70.203981  58.095860  58168.106933  58343.448993   
10  0.686    0.032   70.203963  58.095859  58160.239005  58382.497928   
11  0.656   -0.049   90.159675  28.226361  58166.168738  58378.486991   
12  0.738   -0.003   90.159666  28.226375  58154.168056  58223.139016   
13  0.377   -0.018   89.950942  16.298358  58167.121713  58375.476505   
14  0.906   -0.052   89.950950  16.298343  58216.145880  58422.363183   
15  0.470   -0.004   69.167449  57.920074  58168.106933  58343.448993   
16  0.304   -0.027   69.167427  57.920059  58160.250000  58380.500000   
17  0.615   -0.018   53.428607  47.568281  58168.124583  58337.420810   
18  0.505   -0.022   53.428607  47.568271  58313.430845  58422.337778   
19  0.634   -0.011   70.623238  49.932361  58154.185637  58427.444120   
20  0.791   -0.038   70.623243  49.932364  58167.138368  58346.485579   
21  0.452   -0.004   71.772943  49.972238  58168.105313  58349.448507   
22  0.317   -0.001   71.772928  49.972238  58154.190903  58427.444120   
23  1.153   -0.069   72.792905  42.646391  58168.150498  58349.444178   
24  0.502   -0.011   72.792905  42.646374  58160.224236  58422.342974   
25  0.288    0.001  301.975073  52.887957  58228.476157  58305.326759   
26  0.431   -0.005  301.975067  52.887962  58216.500000  58400.250000   
27  1.026   -0.017   52.472671  57.195506  58303.473206  58427.445521   
28  0.725    0.023   52.472702  57.195529  58304.471076  58340.497593   
29  0.215   -0.002   79.426453  34.149402  58160.223704  58427.442685   
30  0.299    0.004   79.426458  34.149427  58168.111863  58371.497998   
31  0.398   -0.006   81.128750  33.640259  58168.111863  58370.449224   
32  0.601   -0.010   81.128737  33.640225  58160.223704  58425.434768   
33  0.531   -0.019  113.083319  16.708979  58154.203345  58190.149005   
34  0.369   -0.019  113.083319  16.708962  58166.286100  58438.442755   
35  0.803   -0.030   80.225076  32.795688  58168.111863  58368.495324   
36  0.656   -0.024   80.225063  32.795665  58160.223704  58380.464375   
37  0.518   -0.023   58.052438  57.001898  58325.486377  58432.335556   
38  1.176   -0.116   58.052456  57.001903  58167.107940  58343.449931   
39  5.587    0.361   10.461402  10.368531  58283.464502  58373.328102   
40  1.088   -0.027   69.457510  43.469948  58168.150498  58350.476458   
41  0.513    0.027   69.455437  43.468269  58160.250000  58380.500000   
42  0.592   -0.012   64.511514  58.381641  58312.482465  58443.213113   
43  1.124   -0.018   64.511524  58.381662  58160.239005  58372.491921   
44  1.284   -0.085   64.511527  58.381670  58307.470093  58343.449931   
45  0.651    0.011   64.511544  58.381653  58168.106933  58346.489468   
46  0.878   -0.039   70.650388  50.544983  58154.185637  58427.444120   
47  0.524   -0.017   70.650396  50.544983  58167.138368  58346.485579   
48  0.609    0.023   76.080593  36.752564  58154.117303  58182.165197   
49  1.258    0.064   76.080592  36.752584  58166.170324  58371.497535   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         16  
17         15  
18         15  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         16  
35         15  
36         15  
37         15  
38         15  
39         16  
40         15  
41         16  
42         37  
43         15  
44         15  
45         15  
46         15  
47         15  
48         17  
49         15  

[50 rows x 36 columns]]",,8.326701164245605,2025-05-19T18:27:19,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,94,2,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,14.036941289901732,2025-04-29T13:04:04,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
1   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
2   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
3   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
4   ZTF18abykatf         7       126  58361.516065  58383.498125      False   
5   ZTF18abykbnt         3        98  58375.518414  58383.498576      False   
6   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
7   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
8   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
9   ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
10  ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
11  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
12  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
13  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
14  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
15  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
16  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
17  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
18  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
19  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
20  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
21  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
22  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
23  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
24  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
25  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
26  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
27  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
28  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
29  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
30  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
31  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
32  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
33  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
34  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
35  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
36  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
37  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
38  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
39  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
40  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
41  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
42  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
43  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
44  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
45  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
46  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
47  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
48  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   
49  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.147024      1.463008  ...    779  17.409000     0.016   
1     False     3  2.147024      1.463008  ...    779  15.785000     0.013   
2     False     3 -0.342617      0.979578  ...    742  15.993000     0.019   
3     False     3 -0.342617      0.979578  ...    742  15.179999     0.019   
4     False     7  1.688374           NaN  ...    563  22.446000     0.233   
5     False     3  0.538012           NaN  ...    513  21.828000     0.157   
6      True     4  1.982752      1.239292  ...    610  17.342001     0.015   
7      True     4  1.982752      1.239292  ...    611  15.861000     0.018   
8      True     4  1.982752      1.239292  ...    611  17.337000     0.016   
9     False     9       NaN           NaN  ...    696  13.460999     0.016   
10    False     9       NaN           NaN  ...    696  12.660999     0.013   
11    False     6  0.726899      1.233409  ...    773  14.553000     0.019   
12    False     6  0.726899      1.233409  ...    773  13.186000     0.020   
13    False     6  0.726899      1.233409  ...    774  14.539000     0.019   
14    False     6  0.726899      1.233409  ...    774  13.171000     0.030   
15    False    11 -0.389654      0.450098  ...    696  16.143000     0.018   
16    False    11 -0.389654      0.450098  ...    696  15.552000     0.016   
17     True     4  0.606174      0.368602  ...    606  14.516000     0.017   
18     True     4  0.606174      0.368602  ...    606  13.631000     0.015   
19     True     2 -0.229809      0.797697  ...    654  14.695000     0.020   
20     True     2 -0.229809      0.797697  ...    654  14.111000     0.022   
21     True     3       NaN           NaN  ...    654  14.832000     0.019   
22     True     3       NaN           NaN  ...    654  14.118000     0.016   
23     True     2  0.964619      1.202172  ...    700  16.855000     0.019   
24     True     2  0.964619      1.202172  ...    700  16.118000     0.020   
25     True     3 -1.344518      1.024005  ...    701  16.089000     0.018   
26     True     3 -1.344518      1.024005  ...    700  16.118000     0.022   
27     True     3 -1.344518      1.024005  ...    701  15.070000     0.016   
28    False     8  1.193201      0.907338  ...    654  15.616000     0.022   
29    False     8  1.193201      0.907338  ...    654  14.681000     0.012   
30    False    14  0.268562      0.557169  ...    556  13.573000     0.013   
31    False    14  0.268562      0.557169  ...    556  14.526000     0.017   
32     True     2  0.224375      0.737887  ...    700  16.295000     0.016   
33     True     2  0.224375      0.737887  ...    700  15.691999     0.025   
34     True     2  0.740379      0.959051  ...    700  16.364000     0.016   
35     True     2  0.740379      0.959051  ...    700  15.854000     0.021   
36    False     7       NaN           NaN  ...    835  15.562000     0.020   
37    False     7       NaN           NaN  ...    835  14.453000     0.017   
38    False     2 -0.311003      1.122585  ...    700  15.210999     0.019   
39    False     2 -0.311003      1.122585  ...    700  14.290999     0.016   
40    False     2 -2.261614      0.652495  ...    700  14.809000     0.021   
41    False     2 -2.261614      0.652495  ...    701  14.591000     0.019   
42    False     3 -1.374786      0.792397  ...    654  15.231999     0.026   
43    False     3 -1.374786      0.792397  ...    654  15.948000     0.022   
44     True     2 -0.462552      1.135884  ...    654  15.047000     0.013   
45     True     2 -0.462552      1.135884  ...    654  14.344999     0.013   
46    False     4  0.189377      0.605983  ...    700  16.913000     0.025   
47    False     4  0.189377      0.605983  ...    700  16.453001     0.022   
48    False    13  2.174602      0.965611  ...    811  13.656000     0.017   
49    False    13  2.174602      0.965611  ...    810  13.629000     0.020   

    chinr  sharpnr       ranr      decnr   mjdstartref     mjdendref  \
0   0.559   -0.063  67.520419  55.336962  58168.106933  58371.491759   
1   0.361   -0.019  67.520401  55.336957  58160.239005  58432.335081   
2   0.790   -0.056  57.608612  48.024367  58168.125139  58374.455694   
3   0.933   -0.070  57.608609  48.024352  58160.238461  58397.424849   
4   1.017   -0.088  96.278021  20.181603  58167.122813  58378.486539   
5   1.424    0.078  97.183512   9.555673  58168.115185  58382.477211   
6   0.663   -0.015  79.901788  23.968562  58167.144433  58443.316076   
7   0.828   -0.007  79.901762  23.968554  58160.222651  58352.508264   
8   0.658    0.010  79.901761  23.968553  58168.113576  58374.476470   
9   0.929   -0.056  22.744408  43.494774  58274.450683  58349.407141   
10  0.328    0.018  22.744403  43.494768  58280.474873  58380.303831   
11  0.997   -0.049  11.326809  56.112790  58274.447905  58346.365382   
12  0.913   -0.055  11.326817  56.112781  58257.468472  58424.244664   
13  0.881   -0.043  11.326826  56.112774  58274.449757  58361.440521   
14  1.496   -0.011  11.326831  56.112770  58283.500000  58382.250000   
15  0.944    0.026  22.824088  43.143741  58274.450683  58340.466910   
16  0.543    0.017  22.824081  43.143720  58274.476701  58447.326817   
17  0.518    0.002  47.895942  27.767043  58167.113518  58370.450243   
18  0.360   -0.011  47.895932  27.767012  58310.451435  58447.350069   
19  0.776   -0.040  47.013507  36.276590  58168.122917  58346.495602   
20  0.797   -0.043  47.013508  36.276576  58316.469063  58447.358900   
21  0.767   -0.047  47.039568  36.734705  58168.122917  58346.495602   
22  0.393   -0.042  47.039558  36.734688  58316.500000  58447.250000   
23  0.732   -0.031  56.180351  41.423591  58168.123461  58364.472315   
24  0.758   -0.055  56.180344  41.423569  58312.447812  58447.381389   
25  0.583   -0.055  59.461340  42.844173  58168.124016  58443.218924   
26  1.058   -0.074  59.461331  42.844212  58168.123461  58349.451875   
27  0.282    0.001  59.461339  42.844175  58160.237940  58447.402361   
28  0.855   -0.041  44.904377  34.456437  58168.122917  58349.426400   
29  0.312   -0.010  44.904363  34.456441  58316.469063  58431.284282   
30  0.373    0.007  47.036942  21.745013  58312.446817  58437.310671   
31  0.549   -0.038  47.036947  21.745017  58315.447662  58373.423252   
32  0.489    0.003  52.423046  43.303761  58167.109595  58376.468403   
33  1.035   -0.066  52.423043  43.303759  58330.422465  58447.381389   
34  0.506   -0.023  50.535141  43.114002  58167.109595  58382.455833   
35  0.671   -0.053  50.535148  43.113997  58330.422465  58447.381389   
36  0.868   -0.044  46.021004  69.554977  58319.427928  58382.400058   
37  0.604   -0.024  46.020974  69.554956  58287.475660  58447.385243   
38  0.817   -0.042  57.713702  43.293955  58168.123461  58352.423889   
39  0.396   -0.011  57.713703  43.293938  58312.500000  58447.500000   
40  1.025   -0.001  58.819865  43.767390  58168.123461  58349.451875   
41  0.683    0.007  58.819885  43.767357  58160.250000  58425.250000   
42  1.171   -0.063  46.893585  36.339538  58316.469063  58447.358900   
43  1.215   -0.082  46.893588  36.339545  58168.122917  58346.495602   
44  0.305    0.000  48.271271  32.892185  58168.122917  58349.426400   
45  0.456   -0.004  48.271273  32.892184  58313.428507  58422.373044   
46  1.263   -0.087  52.198132  43.219810  58167.109595  58376.468403   
47  0.658   -0.050  52.198147  43.219807  58330.500000  58447.500000   
48  0.600   -0.008  67.985119  63.155750  58210.206910  58443.251262   
49  0.716   -0.032  67.985147  63.155787  58315.450012  58379.468785   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          37  
7          21  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         34  
17         15  
18         31  
19         15  
20         30  
21         15  
22         30  
23         15  
24         29  
25         30  
26         15  
27         31  
28         15  
29         15  
30         15  
31         15  
32         15  
33         27  
34         15  
35         32  
36         15  
37         26  
38         15  
39         29  
40         15  
41         15  
42         30  
43         15  
44         15  
45         15  
46         15  
47         27  
48         32  
49         15  

[50 rows x 36 columns]]",,8.349469423294067,2025-05-19T18:27:31,0.18,0.14,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,94,3,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,14.533109188079834,2025-04-29T13:04:19,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
1   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
2   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
3   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
4   ZTF18abykatf         7       126  58361.516065  58383.498125      False   
5   ZTF18abykbnt         3        98  58375.518414  58383.498576      False   
6   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
7   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
8   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
9   ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
10  ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
11  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
12  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
13  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
14  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
15  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
16  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
17  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
18  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
19  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
20  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
21  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
22  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
23  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
24  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
25  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
26  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
27  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
28  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
29  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
30  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
31  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
32  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
33  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
34  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
35  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
36  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
37  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
38  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
39  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
40  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
41  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
42  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
43  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
44  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
45  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
46  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
47  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
48  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   
49  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.147024      1.463008  ...    779  17.409000     0.016   
1     False     3  2.147024      1.463008  ...    779  15.785000     0.013   
2     False     3 -0.342617      0.979578  ...    742  15.993000     0.019   
3     False     3 -0.342617      0.979578  ...    742  15.179999     0.019   
4     False     7  1.688374           NaN  ...    563  22.446000     0.233   
5     False     3  0.538012           NaN  ...    513  21.828000     0.157   
6      True     4  1.982752      1.239292  ...    610  17.342001     0.015   
7      True     4  1.982752      1.239292  ...    611  15.861000     0.018   
8      True     4  1.982752      1.239292  ...    611  17.337000     0.016   
9     False     9       NaN           NaN  ...    696  13.460999     0.016   
10    False     9       NaN           NaN  ...    696  12.660999     0.013   
11    False     6  0.726899      1.233409  ...    773  14.553000     0.019   
12    False     6  0.726899      1.233409  ...    773  13.186000     0.020   
13    False     6  0.726899      1.233409  ...    774  14.539000     0.019   
14    False     6  0.726899      1.233409  ...    774  13.171000     0.030   
15    False    11 -0.389654      0.450098  ...    696  16.143000     0.018   
16    False    11 -0.389654      0.450098  ...    696  15.552000     0.016   
17     True     4  0.606174      0.368602  ...    606  14.516000     0.017   
18     True     4  0.606174      0.368602  ...    606  13.631000     0.015   
19     True     2 -0.229809      0.797697  ...    654  14.695000     0.020   
20     True     2 -0.229809      0.797697  ...    654  14.111000     0.022   
21     True     3       NaN           NaN  ...    654  14.832000     0.019   
22     True     3       NaN           NaN  ...    654  14.118000     0.016   
23     True     2  0.964619      1.202172  ...    700  16.855000     0.019   
24     True     2  0.964619      1.202172  ...    700  16.118000     0.020   
25     True     3 -1.344518      1.024005  ...    701  16.089000     0.018   
26     True     3 -1.344518      1.024005  ...    700  16.118000     0.022   
27     True     3 -1.344518      1.024005  ...    701  15.070000     0.016   
28    False     8  1.193201      0.907338  ...    654  15.616000     0.022   
29    False     8  1.193201      0.907338  ...    654  14.681000     0.012   
30    False    14  0.268562      0.557169  ...    556  13.573000     0.013   
31    False    14  0.268562      0.557169  ...    556  14.526000     0.017   
32     True     2  0.224375      0.737887  ...    700  16.295000     0.016   
33     True     2  0.224375      0.737887  ...    700  15.691999     0.025   
34     True     2  0.740379      0.959051  ...    700  16.364000     0.016   
35     True     2  0.740379      0.959051  ...    700  15.854000     0.021   
36    False     7       NaN           NaN  ...    835  15.562000     0.020   
37    False     7       NaN           NaN  ...    835  14.453000     0.017   
38    False     2 -0.311003      1.122585  ...    700  15.210999     0.019   
39    False     2 -0.311003      1.122585  ...    700  14.290999     0.016   
40    False     2 -2.261614      0.652495  ...    700  14.809000     0.021   
41    False     2 -2.261614      0.652495  ...    701  14.591000     0.019   
42    False     3 -1.374786      0.792397  ...    654  15.231999     0.026   
43    False     3 -1.374786      0.792397  ...    654  15.948000     0.022   
44     True     2 -0.462552      1.135884  ...    654  15.047000     0.013   
45     True     2 -0.462552      1.135884  ...    654  14.344999     0.013   
46    False     4  0.189377      0.605983  ...    700  16.913000     0.025   
47    False     4  0.189377      0.605983  ...    700  16.453001     0.022   
48    False    13  2.174602      0.965611  ...    811  13.656000     0.017   
49    False    13  2.174602      0.965611  ...    810  13.629000     0.020   

    chinr  sharpnr       ranr      decnr   mjdstartref     mjdendref  \
0   0.559   -0.063  67.520419  55.336962  58168.106933  58371.491759   
1   0.361   -0.019  67.520401  55.336957  58160.239005  58432.335081   
2   0.790   -0.056  57.608612  48.024367  58168.125139  58374.455694   
3   0.933   -0.070  57.608609  48.024352  58160.238461  58397.424849   
4   1.017   -0.088  96.278021  20.181603  58167.122813  58378.486539   
5   1.424    0.078  97.183512   9.555673  58168.115185  58382.477211   
6   0.663   -0.015  79.901788  23.968562  58167.144433  58443.316076   
7   0.828   -0.007  79.901762  23.968554  58160.222651  58352.508264   
8   0.658    0.010  79.901761  23.968553  58168.113576  58374.476470   
9   0.929   -0.056  22.744408  43.494774  58274.450683  58349.407141   
10  0.328    0.018  22.744403  43.494768  58280.474873  58380.303831   
11  0.997   -0.049  11.326809  56.112790  58274.447905  58346.365382   
12  0.913   -0.055  11.326817  56.112781  58257.468472  58424.244664   
13  0.881   -0.043  11.326826  56.112774  58274.449757  58361.440521   
14  1.496   -0.011  11.326831  56.112770  58283.500000  58382.250000   
15  0.944    0.026  22.824088  43.143741  58274.450683  58340.466910   
16  0.543    0.017  22.824081  43.143720  58274.476701  58447.326817   
17  0.518    0.002  47.895942  27.767043  58167.113518  58370.450243   
18  0.360   -0.011  47.895932  27.767012  58310.451435  58447.350069   
19  0.776   -0.040  47.013507  36.276590  58168.122917  58346.495602   
20  0.797   -0.043  47.013508  36.276576  58316.469063  58447.358900   
21  0.767   -0.047  47.039568  36.734705  58168.122917  58346.495602   
22  0.393   -0.042  47.039558  36.734688  58316.500000  58447.250000   
23  0.732   -0.031  56.180351  41.423591  58168.123461  58364.472315   
24  0.758   -0.055  56.180344  41.423569  58312.447812  58447.381389   
25  0.583   -0.055  59.461340  42.844173  58168.124016  58443.218924   
26  1.058   -0.074  59.461331  42.844212  58168.123461  58349.451875   
27  0.282    0.001  59.461339  42.844175  58160.237940  58447.402361   
28  0.855   -0.041  44.904377  34.456437  58168.122917  58349.426400   
29  0.312   -0.010  44.904363  34.456441  58316.469063  58431.284282   
30  0.373    0.007  47.036942  21.745013  58312.446817  58437.310671   
31  0.549   -0.038  47.036947  21.745017  58315.447662  58373.423252   
32  0.489    0.003  52.423046  43.303761  58167.109595  58376.468403   
33  1.035   -0.066  52.423043  43.303759  58330.422465  58447.381389   
34  0.506   -0.023  50.535141  43.114002  58167.109595  58382.455833   
35  0.671   -0.053  50.535148  43.113997  58330.422465  58447.381389   
36  0.868   -0.044  46.021004  69.554977  58319.427928  58382.400058   
37  0.604   -0.024  46.020974  69.554956  58287.475660  58447.385243   
38  0.817   -0.042  57.713702  43.293955  58168.123461  58352.423889   
39  0.396   -0.011  57.713703  43.293938  58312.500000  58447.500000   
40  1.025   -0.001  58.819865  43.767390  58168.123461  58349.451875   
41  0.683    0.007  58.819885  43.767357  58160.250000  58425.250000   
42  1.171   -0.063  46.893585  36.339538  58316.469063  58447.358900   
43  1.215   -0.082  46.893588  36.339545  58168.122917  58346.495602   
44  0.305    0.000  48.271271  32.892185  58168.122917  58349.426400   
45  0.456   -0.004  48.271273  32.892184  58313.428507  58422.373044   
46  1.263   -0.087  52.198132  43.219810  58167.109595  58376.468403   
47  0.658   -0.050  52.198147  43.219807  58330.500000  58447.500000   
48  0.600   -0.008  67.985119  63.155750  58210.206910  58443.251262   
49  0.716   -0.032  67.985147  63.155787  58315.450012  58379.468785   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          37  
7          21  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         34  
17         15  
18         31  
19         15  
20         30  
21         15  
22         30  
23         15  
24         29  
25         30  
26         15  
27         31  
28         15  
29         15  
30         15  
31         15  
32         15  
33         27  
34         15  
35         32  
36         15  
37         26  
38         15  
39         29  
40         15  
41         15  
42         30  
43         15  
44         15  
45         15  
46         15  
47         27  
48         32  
49         15  

[50 rows x 36 columns]]",,8.701313495635986,2025-05-19T18:27:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,4,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,17.847935676574707,2025-04-29T13:04:36,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
1   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
2   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
3   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
4   ZTF18abykatf         7       126  58361.516065  58383.498125      False   
5   ZTF18abykbnt         3        98  58375.518414  58383.498576      False   
6   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
7   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
8   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
9   ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
10  ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
11  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
12  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
13  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
14  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
15  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
16  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
17  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
18  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
19  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
20  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
21  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
22  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
23  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
24  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
25  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
26  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
27  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
28  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
29  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
30  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
31  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
32  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
33  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
34  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
35  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
36  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
37  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
38  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
39  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
40  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
41  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
42  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
43  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
44  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
45  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
46  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
47  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
48  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   
49  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.147024      1.463008  ...    779  17.409000     0.016   
1     False     3  2.147024      1.463008  ...    779  15.785000     0.013   
2     False     3 -0.342617      0.979578  ...    742  15.993000     0.019   
3     False     3 -0.342617      0.979578  ...    742  15.179999     0.019   
4     False     7  1.688374           NaN  ...    563  22.446000     0.233   
5     False     3  0.538012           NaN  ...    513  21.828000     0.157   
6      True     4  1.982752      1.239292  ...    610  17.342001     0.015   
7      True     4  1.982752      1.239292  ...    611  15.861000     0.018   
8      True     4  1.982752      1.239292  ...    611  17.337000     0.016   
9     False     9       NaN           NaN  ...    696  13.460999     0.016   
10    False     9       NaN           NaN  ...    696  12.660999     0.013   
11    False     6  0.726899      1.233409  ...    773  14.553000     0.019   
12    False     6  0.726899      1.233409  ...    773  13.186000     0.020   
13    False     6  0.726899      1.233409  ...    774  14.539000     0.019   
14    False     6  0.726899      1.233409  ...    774  13.171000     0.030   
15    False    11 -0.389654      0.450098  ...    696  16.143000     0.018   
16    False    11 -0.389654      0.450098  ...    696  15.552000     0.016   
17     True     4  0.606174      0.368602  ...    606  14.516000     0.017   
18     True     4  0.606174      0.368602  ...    606  13.631000     0.015   
19     True     2 -0.229809      0.797697  ...    654  14.695000     0.020   
20     True     2 -0.229809      0.797697  ...    654  14.111000     0.022   
21     True     3       NaN           NaN  ...    654  14.832000     0.019   
22     True     3       NaN           NaN  ...    654  14.118000     0.016   
23     True     2  0.964619      1.202172  ...    700  16.855000     0.019   
24     True     2  0.964619      1.202172  ...    700  16.118000     0.020   
25     True     3 -1.344518      1.024005  ...    701  16.089000     0.018   
26     True     3 -1.344518      1.024005  ...    700  16.118000     0.022   
27     True     3 -1.344518      1.024005  ...    701  15.070000     0.016   
28    False     8  1.193201      0.907338  ...    654  15.616000     0.022   
29    False     8  1.193201      0.907338  ...    654  14.681000     0.012   
30    False    14  0.268562      0.557169  ...    556  13.573000     0.013   
31    False    14  0.268562      0.557169  ...    556  14.526000     0.017   
32     True     2  0.224375      0.737887  ...    700  16.295000     0.016   
33     True     2  0.224375      0.737887  ...    700  15.691999     0.025   
34     True     2  0.740379      0.959051  ...    700  16.364000     0.016   
35     True     2  0.740379      0.959051  ...    700  15.854000     0.021   
36    False     7       NaN           NaN  ...    835  15.562000     0.020   
37    False     7       NaN           NaN  ...    835  14.453000     0.017   
38    False     2 -0.311003      1.122585  ...    700  15.210999     0.019   
39    False     2 -0.311003      1.122585  ...    700  14.290999     0.016   
40    False     2 -2.261614      0.652495  ...    700  14.809000     0.021   
41    False     2 -2.261614      0.652495  ...    701  14.591000     0.019   
42    False     3 -1.374786      0.792397  ...    654  15.231999     0.026   
43    False     3 -1.374786      0.792397  ...    654  15.948000     0.022   
44     True     2 -0.462552      1.135884  ...    654  15.047000     0.013   
45     True     2 -0.462552      1.135884  ...    654  14.344999     0.013   
46    False     4  0.189377      0.605983  ...    700  16.913000     0.025   
47    False     4  0.189377      0.605983  ...    700  16.453001     0.022   
48    False    13  2.174602      0.965611  ...    811  13.656000     0.017   
49    False    13  2.174602      0.965611  ...    810  13.629000     0.020   

    chinr  sharpnr       ranr      decnr   mjdstartref     mjdendref  \
0   0.559   -0.063  67.520419  55.336962  58168.106933  58371.491759   
1   0.361   -0.019  67.520401  55.336957  58160.239005  58432.335081   
2   0.790   -0.056  57.608612  48.024367  58168.125139  58374.455694   
3   0.933   -0.070  57.608609  48.024352  58160.238461  58397.424849   
4   1.017   -0.088  96.278021  20.181603  58167.122813  58378.486539   
5   1.424    0.078  97.183512   9.555673  58168.115185  58382.477211   
6   0.663   -0.015  79.901788  23.968562  58167.144433  58443.316076   
7   0.828   -0.007  79.901762  23.968554  58160.222651  58352.508264   
8   0.658    0.010  79.901761  23.968553  58168.113576  58374.476470   
9   0.929   -0.056  22.744408  43.494774  58274.450683  58349.407141   
10  0.328    0.018  22.744403  43.494768  58280.474873  58380.303831   
11  0.997   -0.049  11.326809  56.112790  58274.447905  58346.365382   
12  0.913   -0.055  11.326817  56.112781  58257.468472  58424.244664   
13  0.881   -0.043  11.326826  56.112774  58274.449757  58361.440521   
14  1.496   -0.011  11.326831  56.112770  58283.500000  58382.250000   
15  0.944    0.026  22.824088  43.143741  58274.450683  58340.466910   
16  0.543    0.017  22.824081  43.143720  58274.476701  58447.326817   
17  0.518    0.002  47.895942  27.767043  58167.113518  58370.450243   
18  0.360   -0.011  47.895932  27.767012  58310.451435  58447.350069   
19  0.776   -0.040  47.013507  36.276590  58168.122917  58346.495602   
20  0.797   -0.043  47.013508  36.276576  58316.469063  58447.358900   
21  0.767   -0.047  47.039568  36.734705  58168.122917  58346.495602   
22  0.393   -0.042  47.039558  36.734688  58316.500000  58447.250000   
23  0.732   -0.031  56.180351  41.423591  58168.123461  58364.472315   
24  0.758   -0.055  56.180344  41.423569  58312.447812  58447.381389   
25  0.583   -0.055  59.461340  42.844173  58168.124016  58443.218924   
26  1.058   -0.074  59.461331  42.844212  58168.123461  58349.451875   
27  0.282    0.001  59.461339  42.844175  58160.237940  58447.402361   
28  0.855   -0.041  44.904377  34.456437  58168.122917  58349.426400   
29  0.312   -0.010  44.904363  34.456441  58316.469063  58431.284282   
30  0.373    0.007  47.036942  21.745013  58312.446817  58437.310671   
31  0.549   -0.038  47.036947  21.745017  58315.447662  58373.423252   
32  0.489    0.003  52.423046  43.303761  58167.109595  58376.468403   
33  1.035   -0.066  52.423043  43.303759  58330.422465  58447.381389   
34  0.506   -0.023  50.535141  43.114002  58167.109595  58382.455833   
35  0.671   -0.053  50.535148  43.113997  58330.422465  58447.381389   
36  0.868   -0.044  46.021004  69.554977  58319.427928  58382.400058   
37  0.604   -0.024  46.020974  69.554956  58287.475660  58447.385243   
38  0.817   -0.042  57.713702  43.293955  58168.123461  58352.423889   
39  0.396   -0.011  57.713703  43.293938  58312.500000  58447.500000   
40  1.025   -0.001  58.819865  43.767390  58168.123461  58349.451875   
41  0.683    0.007  58.819885  43.767357  58160.250000  58425.250000   
42  1.171   -0.063  46.893585  36.339538  58316.469063  58447.358900   
43  1.215   -0.082  46.893588  36.339545  58168.122917  58346.495602   
44  0.305    0.000  48.271271  32.892185  58168.122917  58349.426400   
45  0.456   -0.004  48.271273  32.892184  58313.428507  58422.373044   
46  1.263   -0.087  52.198132  43.219810  58167.109595  58376.468403   
47  0.658   -0.050  52.198147  43.219807  58330.500000  58447.500000   
48  0.600   -0.008  67.985119  63.155750  58210.206910  58443.251262   
49  0.716   -0.032  67.985147  63.155787  58315.450012  58379.468785   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          37  
7          21  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         34  
17         15  
18         31  
19         15  
20         30  
21         15  
22         30  
23         15  
24         29  
25         30  
26         15  
27         31  
28         15  
29         15  
30         15  
31         15  
32         15  
33         27  
34         15  
35         32  
36         15  
37         26  
38         15  
39         29  
40         15  
41         15  
42         30  
43         15  
44         15  
45         15  
46         15  
47         27  
48         32  
49         15  

[50 rows x 36 columns]]",,8.57015609741211,2025-05-19T18:27:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,5,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,15.58079957962036,2025-04-29T13:04:52,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
1   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
2   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
3   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
4   ZTF18abykatf         7       126  58361.516065  58383.498125      False   
5   ZTF18abykbnt         3        98  58375.518414  58383.498576      False   
6   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
7   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
8   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
9   ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
10  ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
11  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
12  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
13  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
14  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
15  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
16  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
17  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
18  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
19  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
20  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
21  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
22  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
23  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
24  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
25  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
26  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
27  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
28  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
29  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
30  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
31  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
32  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
33  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
34  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
35  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
36  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
37  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
38  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
39  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
40  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
41  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
42  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
43  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
44  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
45  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
46  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
47  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
48  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   
49  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.147024      1.463008  ...    779  17.409000     0.016   
1     False     3  2.147024      1.463008  ...    779  15.785000     0.013   
2     False     3 -0.342617      0.979578  ...    742  15.993000     0.019   
3     False     3 -0.342617      0.979578  ...    742  15.179999     0.019   
4     False     7  1.688374           NaN  ...    563  22.446000     0.233   
5     False     3  0.538012           NaN  ...    513  21.828000     0.157   
6      True     4  1.982752      1.239292  ...    610  17.342001     0.015   
7      True     4  1.982752      1.239292  ...    611  15.861000     0.018   
8      True     4  1.982752      1.239292  ...    611  17.337000     0.016   
9     False     9       NaN           NaN  ...    696  13.460999     0.016   
10    False     9       NaN           NaN  ...    696  12.660999     0.013   
11    False     6  0.726899      1.233409  ...    773  14.553000     0.019   
12    False     6  0.726899      1.233409  ...    773  13.186000     0.020   
13    False     6  0.726899      1.233409  ...    774  14.539000     0.019   
14    False     6  0.726899      1.233409  ...    774  13.171000     0.030   
15    False    11 -0.389654      0.450098  ...    696  16.143000     0.018   
16    False    11 -0.389654      0.450098  ...    696  15.552000     0.016   
17     True     4  0.606174      0.368602  ...    606  14.516000     0.017   
18     True     4  0.606174      0.368602  ...    606  13.631000     0.015   
19     True     2 -0.229809      0.797697  ...    654  14.695000     0.020   
20     True     2 -0.229809      0.797697  ...    654  14.111000     0.022   
21     True     3       NaN           NaN  ...    654  14.832000     0.019   
22     True     3       NaN           NaN  ...    654  14.118000     0.016   
23     True     2  0.964619      1.202172  ...    700  16.855000     0.019   
24     True     2  0.964619      1.202172  ...    700  16.118000     0.020   
25     True     3 -1.344518      1.024005  ...    701  16.089000     0.018   
26     True     3 -1.344518      1.024005  ...    700  16.118000     0.022   
27     True     3 -1.344518      1.024005  ...    701  15.070000     0.016   
28    False     8  1.193201      0.907338  ...    654  15.616000     0.022   
29    False     8  1.193201      0.907338  ...    654  14.681000     0.012   
30    False    14  0.268562      0.557169  ...    556  13.573000     0.013   
31    False    14  0.268562      0.557169  ...    556  14.526000     0.017   
32     True     2  0.224375      0.737887  ...    700  16.295000     0.016   
33     True     2  0.224375      0.737887  ...    700  15.691999     0.025   
34     True     2  0.740379      0.959051  ...    700  16.364000     0.016   
35     True     2  0.740379      0.959051  ...    700  15.854000     0.021   
36    False     7       NaN           NaN  ...    835  15.562000     0.020   
37    False     7       NaN           NaN  ...    835  14.453000     0.017   
38    False     2 -0.311003      1.122585  ...    700  15.210999     0.019   
39    False     2 -0.311003      1.122585  ...    700  14.290999     0.016   
40    False     2 -2.261614      0.652495  ...    700  14.809000     0.021   
41    False     2 -2.261614      0.652495  ...    701  14.591000     0.019   
42    False     3 -1.374786      0.792397  ...    654  15.231999     0.026   
43    False     3 -1.374786      0.792397  ...    654  15.948000     0.022   
44     True     2 -0.462552      1.135884  ...    654  15.047000     0.013   
45     True     2 -0.462552      1.135884  ...    654  14.344999     0.013   
46    False     4  0.189377      0.605983  ...    700  16.913000     0.025   
47    False     4  0.189377      0.605983  ...    700  16.453001     0.022   
48    False    13  2.174602      0.965611  ...    811  13.656000     0.017   
49    False    13  2.174602      0.965611  ...    810  13.629000     0.020   

    chinr  sharpnr       ranr      decnr   mjdstartref     mjdendref  \
0   0.559   -0.063  67.520419  55.336962  58168.106933  58371.491759   
1   0.361   -0.019  67.520401  55.336957  58160.239005  58432.335081   
2   0.790   -0.056  57.608612  48.024367  58168.125139  58374.455694   
3   0.933   -0.070  57.608609  48.024352  58160.238461  58397.424849   
4   1.017   -0.088  96.278021  20.181603  58167.122813  58378.486539   
5   1.424    0.078  97.183512   9.555673  58168.115185  58382.477211   
6   0.663   -0.015  79.901788  23.968562  58167.144433  58443.316076   
7   0.828   -0.007  79.901762  23.968554  58160.222651  58352.508264   
8   0.658    0.010  79.901761  23.968553  58168.113576  58374.476470   
9   0.929   -0.056  22.744408  43.494774  58274.450683  58349.407141   
10  0.328    0.018  22.744403  43.494768  58280.474873  58380.303831   
11  0.997   -0.049  11.326809  56.112790  58274.447905  58346.365382   
12  0.913   -0.055  11.326817  56.112781  58257.468472  58424.244664   
13  0.881   -0.043  11.326826  56.112774  58274.449757  58361.440521   
14  1.496   -0.011  11.326831  56.112770  58283.500000  58382.250000   
15  0.944    0.026  22.824088  43.143741  58274.450683  58340.466910   
16  0.543    0.017  22.824081  43.143720  58274.476701  58447.326817   
17  0.518    0.002  47.895942  27.767043  58167.113518  58370.450243   
18  0.360   -0.011  47.895932  27.767012  58310.451435  58447.350069   
19  0.776   -0.040  47.013507  36.276590  58168.122917  58346.495602   
20  0.797   -0.043  47.013508  36.276576  58316.469063  58447.358900   
21  0.767   -0.047  47.039568  36.734705  58168.122917  58346.495602   
22  0.393   -0.042  47.039558  36.734688  58316.500000  58447.250000   
23  0.732   -0.031  56.180351  41.423591  58168.123461  58364.472315   
24  0.758   -0.055  56.180344  41.423569  58312.447812  58447.381389   
25  0.583   -0.055  59.461340  42.844173  58168.124016  58443.218924   
26  1.058   -0.074  59.461331  42.844212  58168.123461  58349.451875   
27  0.282    0.001  59.461339  42.844175  58160.237940  58447.402361   
28  0.855   -0.041  44.904377  34.456437  58168.122917  58349.426400   
29  0.312   -0.010  44.904363  34.456441  58316.469063  58431.284282   
30  0.373    0.007  47.036942  21.745013  58312.446817  58437.310671   
31  0.549   -0.038  47.036947  21.745017  58315.447662  58373.423252   
32  0.489    0.003  52.423046  43.303761  58167.109595  58376.468403   
33  1.035   -0.066  52.423043  43.303759  58330.422465  58447.381389   
34  0.506   -0.023  50.535141  43.114002  58167.109595  58382.455833   
35  0.671   -0.053  50.535148  43.113997  58330.422465  58447.381389   
36  0.868   -0.044  46.021004  69.554977  58319.427928  58382.400058   
37  0.604   -0.024  46.020974  69.554956  58287.475660  58447.385243   
38  0.817   -0.042  57.713702  43.293955  58168.123461  58352.423889   
39  0.396   -0.011  57.713703  43.293938  58312.500000  58447.500000   
40  1.025   -0.001  58.819865  43.767390  58168.123461  58349.451875   
41  0.683    0.007  58.819885  43.767357  58160.250000  58425.250000   
42  1.171   -0.063  46.893585  36.339538  58316.469063  58447.358900   
43  1.215   -0.082  46.893588  36.339545  58168.122917  58346.495602   
44  0.305    0.000  48.271271  32.892185  58168.122917  58349.426400   
45  0.456   -0.004  48.271273  32.892184  58313.428507  58422.373044   
46  1.263   -0.087  52.198132  43.219810  58167.109595  58376.468403   
47  0.658   -0.050  52.198147  43.219807  58330.500000  58447.500000   
48  0.600   -0.008  67.985119  63.155750  58210.206910  58443.251262   
49  0.716   -0.032  67.985147  63.155787  58315.450012  58379.468785   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          37  
7          21  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         34  
17         15  
18         31  
19         15  
20         30  
21         15  
22         30  
23         15  
24         29  
25         30  
26         15  
27         31  
28         15  
29         15  
30         15  
31         15  
32         15  
33         27  
34         15  
35         32  
36         15  
37         26  
38         15  
39         29  
40         15  
41         15  
42         30  
43         15  
44         15  
45         15  
46         15  
47         27  
48         32  
49         15  

[50 rows x 36 columns]]",,8.605110883712769,2025-05-19T18:28:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,6,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,14.970457315444946,2025-04-29T13:05:07,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
1   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
2   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
3   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
4   ZTF18abykatf         7       126  58361.516065  58383.498125      False   
5   ZTF18abykbnt         3        98  58375.518414  58383.498576      False   
6   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
7   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
8   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
9   ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
10  ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
11  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
12  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
13  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
14  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
15  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
16  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
17  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
18  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
19  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
20  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
21  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
22  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
23  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
24  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
25  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
26  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
27  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
28  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
29  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
30  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
31  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
32  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
33  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
34  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
35  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
36  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
37  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
38  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
39  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
40  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
41  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
42  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
43  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
44  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
45  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
46  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
47  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
48  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   
49  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.147024      1.463008  ...    779  17.409000     0.016   
1     False     3  2.147024      1.463008  ...    779  15.785000     0.013   
2     False     3 -0.342617      0.979578  ...    742  15.993000     0.019   
3     False     3 -0.342617      0.979578  ...    742  15.179999     0.019   
4     False     7  1.688374           NaN  ...    563  22.446000     0.233   
5     False     3  0.538012           NaN  ...    513  21.828000     0.157   
6      True     4  1.982752      1.239292  ...    610  17.342001     0.015   
7      True     4  1.982752      1.239292  ...    611  15.861000     0.018   
8      True     4  1.982752      1.239292  ...    611  17.337000     0.016   
9     False     9       NaN           NaN  ...    696  13.460999     0.016   
10    False     9       NaN           NaN  ...    696  12.660999     0.013   
11    False     6  0.726899      1.233409  ...    773  14.553000     0.019   
12    False     6  0.726899      1.233409  ...    773  13.186000     0.020   
13    False     6  0.726899      1.233409  ...    774  14.539000     0.019   
14    False     6  0.726899      1.233409  ...    774  13.171000     0.030   
15    False    11 -0.389654      0.450098  ...    696  16.143000     0.018   
16    False    11 -0.389654      0.450098  ...    696  15.552000     0.016   
17     True     4  0.606174      0.368602  ...    606  14.516000     0.017   
18     True     4  0.606174      0.368602  ...    606  13.631000     0.015   
19     True     2 -0.229809      0.797697  ...    654  14.695000     0.020   
20     True     2 -0.229809      0.797697  ...    654  14.111000     0.022   
21     True     3       NaN           NaN  ...    654  14.832000     0.019   
22     True     3       NaN           NaN  ...    654  14.118000     0.016   
23     True     2  0.964619      1.202172  ...    700  16.855000     0.019   
24     True     2  0.964619      1.202172  ...    700  16.118000     0.020   
25     True     3 -1.344518      1.024005  ...    701  16.089000     0.018   
26     True     3 -1.344518      1.024005  ...    700  16.118000     0.022   
27     True     3 -1.344518      1.024005  ...    701  15.070000     0.016   
28    False     8  1.193201      0.907338  ...    654  15.616000     0.022   
29    False     8  1.193201      0.907338  ...    654  14.681000     0.012   
30    False    14  0.268562      0.557169  ...    556  13.573000     0.013   
31    False    14  0.268562      0.557169  ...    556  14.526000     0.017   
32     True     2  0.224375      0.737887  ...    700  16.295000     0.016   
33     True     2  0.224375      0.737887  ...    700  15.691999     0.025   
34     True     2  0.740379      0.959051  ...    700  16.364000     0.016   
35     True     2  0.740379      0.959051  ...    700  15.854000     0.021   
36    False     7       NaN           NaN  ...    835  15.562000     0.020   
37    False     7       NaN           NaN  ...    835  14.453000     0.017   
38    False     2 -0.311003      1.122585  ...    700  15.210999     0.019   
39    False     2 -0.311003      1.122585  ...    700  14.290999     0.016   
40    False     2 -2.261614      0.652495  ...    700  14.809000     0.021   
41    False     2 -2.261614      0.652495  ...    701  14.591000     0.019   
42    False     3 -1.374786      0.792397  ...    654  15.231999     0.026   
43    False     3 -1.374786      0.792397  ...    654  15.948000     0.022   
44     True     2 -0.462552      1.135884  ...    654  15.047000     0.013   
45     True     2 -0.462552      1.135884  ...    654  14.344999     0.013   
46    False     4  0.189377      0.605983  ...    700  16.913000     0.025   
47    False     4  0.189377      0.605983  ...    700  16.453001     0.022   
48    False    13  2.174602      0.965611  ...    811  13.656000     0.017   
49    False    13  2.174602      0.965611  ...    810  13.629000     0.020   

    chinr  sharpnr       ranr      decnr   mjdstartref     mjdendref  \
0   0.559   -0.063  67.520419  55.336962  58168.106933  58371.491759   
1   0.361   -0.019  67.520401  55.336957  58160.239005  58432.335081   
2   0.790   -0.056  57.608612  48.024367  58168.125139  58374.455694   
3   0.933   -0.070  57.608609  48.024352  58160.238461  58397.424849   
4   1.017   -0.088  96.278021  20.181603  58167.122813  58378.486539   
5   1.424    0.078  97.183512   9.555673  58168.115185  58382.477211   
6   0.663   -0.015  79.901788  23.968562  58167.144433  58443.316076   
7   0.828   -0.007  79.901762  23.968554  58160.222651  58352.508264   
8   0.658    0.010  79.901761  23.968553  58168.113576  58374.476470   
9   0.929   -0.056  22.744408  43.494774  58274.450683  58349.407141   
10  0.328    0.018  22.744403  43.494768  58280.474873  58380.303831   
11  0.997   -0.049  11.326809  56.112790  58274.447905  58346.365382   
12  0.913   -0.055  11.326817  56.112781  58257.468472  58424.244664   
13  0.881   -0.043  11.326826  56.112774  58274.449757  58361.440521   
14  1.496   -0.011  11.326831  56.112770  58283.500000  58382.250000   
15  0.944    0.026  22.824088  43.143741  58274.450683  58340.466910   
16  0.543    0.017  22.824081  43.143720  58274.476701  58447.326817   
17  0.518    0.002  47.895942  27.767043  58167.113518  58370.450243   
18  0.360   -0.011  47.895932  27.767012  58310.451435  58447.350069   
19  0.776   -0.040  47.013507  36.276590  58168.122917  58346.495602   
20  0.797   -0.043  47.013508  36.276576  58316.469063  58447.358900   
21  0.767   -0.047  47.039568  36.734705  58168.122917  58346.495602   
22  0.393   -0.042  47.039558  36.734688  58316.500000  58447.250000   
23  0.732   -0.031  56.180351  41.423591  58168.123461  58364.472315   
24  0.758   -0.055  56.180344  41.423569  58312.447812  58447.381389   
25  0.583   -0.055  59.461340  42.844173  58168.124016  58443.218924   
26  1.058   -0.074  59.461331  42.844212  58168.123461  58349.451875   
27  0.282    0.001  59.461339  42.844175  58160.237940  58447.402361   
28  0.855   -0.041  44.904377  34.456437  58168.122917  58349.426400   
29  0.312   -0.010  44.904363  34.456441  58316.469063  58431.284282   
30  0.373    0.007  47.036942  21.745013  58312.446817  58437.310671   
31  0.549   -0.038  47.036947  21.745017  58315.447662  58373.423252   
32  0.489    0.003  52.423046  43.303761  58167.109595  58376.468403   
33  1.035   -0.066  52.423043  43.303759  58330.422465  58447.381389   
34  0.506   -0.023  50.535141  43.114002  58167.109595  58382.455833   
35  0.671   -0.053  50.535148  43.113997  58330.422465  58447.381389   
36  0.868   -0.044  46.021004  69.554977  58319.427928  58382.400058   
37  0.604   -0.024  46.020974  69.554956  58287.475660  58447.385243   
38  0.817   -0.042  57.713702  43.293955  58168.123461  58352.423889   
39  0.396   -0.011  57.713703  43.293938  58312.500000  58447.500000   
40  1.025   -0.001  58.819865  43.767390  58168.123461  58349.451875   
41  0.683    0.007  58.819885  43.767357  58160.250000  58425.250000   
42  1.171   -0.063  46.893585  36.339538  58316.469063  58447.358900   
43  1.215   -0.082  46.893588  36.339545  58168.122917  58346.495602   
44  0.305    0.000  48.271271  32.892185  58168.122917  58349.426400   
45  0.456   -0.004  48.271273  32.892184  58313.428507  58422.373044   
46  1.263   -0.087  52.198132  43.219810  58167.109595  58376.468403   
47  0.658   -0.050  52.198147  43.219807  58330.500000  58447.500000   
48  0.600   -0.008  67.985119  63.155750  58210.206910  58443.251262   
49  0.716   -0.032  67.985147  63.155787  58315.450012  58379.468785   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          37  
7          21  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         34  
17         15  
18         31  
19         15  
20         30  
21         15  
22         30  
23         15  
24         29  
25         30  
26         15  
27         31  
28         15  
29         15  
30         15  
31         15  
32         15  
33         27  
34         15  
35         32  
36         15  
37         26  
38         15  
39         29  
40         15  
41         15  
42         30  
43         15  
44         15  
45         15  
46         15  
47         27  
48         32  
49         15  

[50 rows x 36 columns]]",,8.60148000717163,2025-05-19T18:28:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,7,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,13.717798233032228,2025-04-29T13:05:21,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
1   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
2   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
3   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
4   ZTF18abykatf         7       126  58361.516065  58383.498125      False   
5   ZTF18abykbnt         3        98  58375.518414  58383.498576      False   
6   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
7   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
8   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
9   ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
10  ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
11  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
12  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
13  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
14  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
15  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
16  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
17  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
18  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
19  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
20  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
21  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
22  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
23  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
24  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
25  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
26  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
27  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
28  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
29  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
30  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
31  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
32  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
33  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
34  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
35  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
36  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
37  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
38  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
39  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
40  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
41  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
42  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
43  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
44  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
45  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
46  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
47  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
48  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   
49  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.147024      1.463008  ...    779  17.409000     0.016   
1     False     3  2.147024      1.463008  ...    779  15.785000     0.013   
2     False     3 -0.342617      0.979578  ...    742  15.993000     0.019   
3     False     3 -0.342617      0.979578  ...    742  15.179999     0.019   
4     False     7  1.688374           NaN  ...    563  22.446000     0.233   
5     False     3  0.538012           NaN  ...    513  21.828000     0.157   
6      True     4  1.982752      1.239292  ...    610  17.342001     0.015   
7      True     4  1.982752      1.239292  ...    611  15.861000     0.018   
8      True     4  1.982752      1.239292  ...    611  17.337000     0.016   
9     False     9       NaN           NaN  ...    696  13.460999     0.016   
10    False     9       NaN           NaN  ...    696  12.660999     0.013   
11    False     6  0.726899      1.233409  ...    773  14.553000     0.019   
12    False     6  0.726899      1.233409  ...    773  13.186000     0.020   
13    False     6  0.726899      1.233409  ...    774  14.539000     0.019   
14    False     6  0.726899      1.233409  ...    774  13.171000     0.030   
15    False    11 -0.389654      0.450098  ...    696  16.143000     0.018   
16    False    11 -0.389654      0.450098  ...    696  15.552000     0.016   
17     True     4  0.606174      0.368602  ...    606  14.516000     0.017   
18     True     4  0.606174      0.368602  ...    606  13.631000     0.015   
19     True     2 -0.229809      0.797697  ...    654  14.695000     0.020   
20     True     2 -0.229809      0.797697  ...    654  14.111000     0.022   
21     True     3       NaN           NaN  ...    654  14.832000     0.019   
22     True     3       NaN           NaN  ...    654  14.118000     0.016   
23     True     2  0.964619      1.202172  ...    700  16.855000     0.019   
24     True     2  0.964619      1.202172  ...    700  16.118000     0.020   
25     True     3 -1.344518      1.024005  ...    701  16.089000     0.018   
26     True     3 -1.344518      1.024005  ...    700  16.118000     0.022   
27     True     3 -1.344518      1.024005  ...    701  15.070000     0.016   
28    False     8  1.193201      0.907338  ...    654  15.616000     0.022   
29    False     8  1.193201      0.907338  ...    654  14.681000     0.012   
30    False    14  0.268562      0.557169  ...    556  13.573000     0.013   
31    False    14  0.268562      0.557169  ...    556  14.526000     0.017   
32     True     2  0.224375      0.737887  ...    700  16.295000     0.016   
33     True     2  0.224375      0.737887  ...    700  15.691999     0.025   
34     True     2  0.740379      0.959051  ...    700  16.364000     0.016   
35     True     2  0.740379      0.959051  ...    700  15.854000     0.021   
36    False     7       NaN           NaN  ...    835  15.562000     0.020   
37    False     7       NaN           NaN  ...    835  14.453000     0.017   
38    False     2 -0.311003      1.122585  ...    700  15.210999     0.019   
39    False     2 -0.311003      1.122585  ...    700  14.290999     0.016   
40    False     2 -2.261614      0.652495  ...    700  14.809000     0.021   
41    False     2 -2.261614      0.652495  ...    701  14.591000     0.019   
42    False     3 -1.374786      0.792397  ...    654  15.231999     0.026   
43    False     3 -1.374786      0.792397  ...    654  15.948000     0.022   
44     True     2 -0.462552      1.135884  ...    654  15.047000     0.013   
45     True     2 -0.462552      1.135884  ...    654  14.344999     0.013   
46    False     4  0.189377      0.605983  ...    700  16.913000     0.025   
47    False     4  0.189377      0.605983  ...    700  16.453001     0.022   
48    False    13  2.174602      0.965611  ...    811  13.656000     0.017   
49    False    13  2.174602      0.965611  ...    810  13.629000     0.020   

    chinr  sharpnr       ranr      decnr   mjdstartref     mjdendref  \
0   0.559   -0.063  67.520419  55.336962  58168.106933  58371.491759   
1   0.361   -0.019  67.520401  55.336957  58160.239005  58432.335081   
2   0.790   -0.056  57.608612  48.024367  58168.125139  58374.455694   
3   0.933   -0.070  57.608609  48.024352  58160.238461  58397.424849   
4   1.017   -0.088  96.278021  20.181603  58167.122813  58378.486539   
5   1.424    0.078  97.183512   9.555673  58168.115185  58382.477211   
6   0.663   -0.015  79.901788  23.968562  58167.144433  58443.316076   
7   0.828   -0.007  79.901762  23.968554  58160.222651  58352.508264   
8   0.658    0.010  79.901761  23.968553  58168.113576  58374.476470   
9   0.929   -0.056  22.744408  43.494774  58274.450683  58349.407141   
10  0.328    0.018  22.744403  43.494768  58280.474873  58380.303831   
11  0.997   -0.049  11.326809  56.112790  58274.447905  58346.365382   
12  0.913   -0.055  11.326817  56.112781  58257.468472  58424.244664   
13  0.881   -0.043  11.326826  56.112774  58274.449757  58361.440521   
14  1.496   -0.011  11.326831  56.112770  58283.500000  58382.250000   
15  0.944    0.026  22.824088  43.143741  58274.450683  58340.466910   
16  0.543    0.017  22.824081  43.143720  58274.476701  58447.326817   
17  0.518    0.002  47.895942  27.767043  58167.113518  58370.450243   
18  0.360   -0.011  47.895932  27.767012  58310.451435  58447.350069   
19  0.776   -0.040  47.013507  36.276590  58168.122917  58346.495602   
20  0.797   -0.043  47.013508  36.276576  58316.469063  58447.358900   
21  0.767   -0.047  47.039568  36.734705  58168.122917  58346.495602   
22  0.393   -0.042  47.039558  36.734688  58316.500000  58447.250000   
23  0.732   -0.031  56.180351  41.423591  58168.123461  58364.472315   
24  0.758   -0.055  56.180344  41.423569  58312.447812  58447.381389   
25  0.583   -0.055  59.461340  42.844173  58168.124016  58443.218924   
26  1.058   -0.074  59.461331  42.844212  58168.123461  58349.451875   
27  0.282    0.001  59.461339  42.844175  58160.237940  58447.402361   
28  0.855   -0.041  44.904377  34.456437  58168.122917  58349.426400   
29  0.312   -0.010  44.904363  34.456441  58316.469063  58431.284282   
30  0.373    0.007  47.036942  21.745013  58312.446817  58437.310671   
31  0.549   -0.038  47.036947  21.745017  58315.447662  58373.423252   
32  0.489    0.003  52.423046  43.303761  58167.109595  58376.468403   
33  1.035   -0.066  52.423043  43.303759  58330.422465  58447.381389   
34  0.506   -0.023  50.535141  43.114002  58167.109595  58382.455833   
35  0.671   -0.053  50.535148  43.113997  58330.422465  58447.381389   
36  0.868   -0.044  46.021004  69.554977  58319.427928  58382.400058   
37  0.604   -0.024  46.020974  69.554956  58287.475660  58447.385243   
38  0.817   -0.042  57.713702  43.293955  58168.123461  58352.423889   
39  0.396   -0.011  57.713703  43.293938  58312.500000  58447.500000   
40  1.025   -0.001  58.819865  43.767390  58168.123461  58349.451875   
41  0.683    0.007  58.819885  43.767357  58160.250000  58425.250000   
42  1.171   -0.063  46.893585  36.339538  58316.469063  58447.358900   
43  1.215   -0.082  46.893588  36.339545  58168.122917  58346.495602   
44  0.305    0.000  48.271271  32.892185  58168.122917  58349.426400   
45  0.456   -0.004  48.271273  32.892184  58313.428507  58422.373044   
46  1.263   -0.087  52.198132  43.219810  58167.109595  58376.468403   
47  0.658   -0.050  52.198147  43.219807  58330.500000  58447.500000   
48  0.600   -0.008  67.985119  63.155750  58210.206910  58443.251262   
49  0.716   -0.032  67.985147  63.155787  58315.450012  58379.468785   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          37  
7          21  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         34  
17         15  
18         31  
19         15  
20         30  
21         15  
22         30  
23         15  
24         29  
25         30  
26         15  
27         31  
28         15  
29         15  
30         15  
31         15  
32         15  
33         27  
34         15  
35         32  
36         15  
37         26  
38         15  
39         29  
40         15  
41         15  
42         30  
43         15  
44         15  
45         15  
46         15  
47         27  
48         32  
49         15  

[50 rows x 36 columns]]",,8.117960929870605,2025-05-19T18:28:35,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,8,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,16.742866039276123,2025-04-29T13:05:38,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
1   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
2   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
3   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
4   ZTF18abykatf         7       126  58361.516065  58383.498125      False   
5   ZTF18abykbnt         3        98  58375.518414  58383.498576      False   
6   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
7   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
8   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
9   ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
10  ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
11  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
12  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
13  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
14  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
15  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
16  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
17  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
18  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
19  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
20  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
21  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
22  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
23  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
24  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
25  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
26  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
27  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
28  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
29  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
30  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
31  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
32  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
33  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
34  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
35  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
36  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
37  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
38  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
39  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
40  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
41  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
42  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
43  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
44  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
45  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
46  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
47  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
48  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   
49  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.147024      1.463008  ...    779  17.409000     0.016   
1     False     3  2.147024      1.463008  ...    779  15.785000     0.013   
2     False     3 -0.342617      0.979578  ...    742  15.993000     0.019   
3     False     3 -0.342617      0.979578  ...    742  15.179999     0.019   
4     False     7  1.688374           NaN  ...    563  22.446000     0.233   
5     False     3  0.538012           NaN  ...    513  21.828000     0.157   
6      True     4  1.982752      1.239292  ...    610  17.342001     0.015   
7      True     4  1.982752      1.239292  ...    611  15.861000     0.018   
8      True     4  1.982752      1.239292  ...    611  17.337000     0.016   
9     False     9       NaN           NaN  ...    696  13.460999     0.016   
10    False     9       NaN           NaN  ...    696  12.660999     0.013   
11    False     6  0.726899      1.233409  ...    773  14.553000     0.019   
12    False     6  0.726899      1.233409  ...    773  13.186000     0.020   
13    False     6  0.726899      1.233409  ...    774  14.539000     0.019   
14    False     6  0.726899      1.233409  ...    774  13.171000     0.030   
15    False    11 -0.389654      0.450098  ...    696  16.143000     0.018   
16    False    11 -0.389654      0.450098  ...    696  15.552000     0.016   
17     True     4  0.606174      0.368602  ...    606  14.516000     0.017   
18     True     4  0.606174      0.368602  ...    606  13.631000     0.015   
19     True     2 -0.229809      0.797697  ...    654  14.695000     0.020   
20     True     2 -0.229809      0.797697  ...    654  14.111000     0.022   
21     True     3       NaN           NaN  ...    654  14.832000     0.019   
22     True     3       NaN           NaN  ...    654  14.118000     0.016   
23     True     2  0.964619      1.202172  ...    700  16.855000     0.019   
24     True     2  0.964619      1.202172  ...    700  16.118000     0.020   
25     True     3 -1.344518      1.024005  ...    701  16.089000     0.018   
26     True     3 -1.344518      1.024005  ...    700  16.118000     0.022   
27     True     3 -1.344518      1.024005  ...    701  15.070000     0.016   
28    False     8  1.193201      0.907338  ...    654  15.616000     0.022   
29    False     8  1.193201      0.907338  ...    654  14.681000     0.012   
30    False    14  0.268562      0.557169  ...    556  13.573000     0.013   
31    False    14  0.268562      0.557169  ...    556  14.526000     0.017   
32     True     2  0.224375      0.737887  ...    700  16.295000     0.016   
33     True     2  0.224375      0.737887  ...    700  15.691999     0.025   
34     True     2  0.740379      0.959051  ...    700  16.364000     0.016   
35     True     2  0.740379      0.959051  ...    700  15.854000     0.021   
36    False     7       NaN           NaN  ...    835  15.562000     0.020   
37    False     7       NaN           NaN  ...    835  14.453000     0.017   
38    False     2 -0.311003      1.122585  ...    700  15.210999     0.019   
39    False     2 -0.311003      1.122585  ...    700  14.290999     0.016   
40    False     2 -2.261614      0.652495  ...    700  14.809000     0.021   
41    False     2 -2.261614      0.652495  ...    701  14.591000     0.019   
42    False     3 -1.374786      0.792397  ...    654  15.231999     0.026   
43    False     3 -1.374786      0.792397  ...    654  15.948000     0.022   
44     True     2 -0.462552      1.135884  ...    654  15.047000     0.013   
45     True     2 -0.462552      1.135884  ...    654  14.344999     0.013   
46    False     4  0.189377      0.605983  ...    700  16.913000     0.025   
47    False     4  0.189377      0.605983  ...    700  16.453001     0.022   
48    False    13  2.174602      0.965611  ...    811  13.656000     0.017   
49    False    13  2.174602      0.965611  ...    810  13.629000     0.020   

    chinr  sharpnr       ranr      decnr   mjdstartref     mjdendref  \
0   0.559   -0.063  67.520419  55.336962  58168.106933  58371.491759   
1   0.361   -0.019  67.520401  55.336957  58160.239005  58432.335081   
2   0.790   -0.056  57.608612  48.024367  58168.125139  58374.455694   
3   0.933   -0.070  57.608609  48.024352  58160.238461  58397.424849   
4   1.017   -0.088  96.278021  20.181603  58167.122813  58378.486539   
5   1.424    0.078  97.183512   9.555673  58168.115185  58382.477211   
6   0.663   -0.015  79.901788  23.968562  58167.144433  58443.316076   
7   0.828   -0.007  79.901762  23.968554  58160.222651  58352.508264   
8   0.658    0.010  79.901761  23.968553  58168.113576  58374.476470   
9   0.929   -0.056  22.744408  43.494774  58274.450683  58349.407141   
10  0.328    0.018  22.744403  43.494768  58280.474873  58380.303831   
11  0.997   -0.049  11.326809  56.112790  58274.447905  58346.365382   
12  0.913   -0.055  11.326817  56.112781  58257.468472  58424.244664   
13  0.881   -0.043  11.326826  56.112774  58274.449757  58361.440521   
14  1.496   -0.011  11.326831  56.112770  58283.500000  58382.250000   
15  0.944    0.026  22.824088  43.143741  58274.450683  58340.466910   
16  0.543    0.017  22.824081  43.143720  58274.476701  58447.326817   
17  0.518    0.002  47.895942  27.767043  58167.113518  58370.450243   
18  0.360   -0.011  47.895932  27.767012  58310.451435  58447.350069   
19  0.776   -0.040  47.013507  36.276590  58168.122917  58346.495602   
20  0.797   -0.043  47.013508  36.276576  58316.469063  58447.358900   
21  0.767   -0.047  47.039568  36.734705  58168.122917  58346.495602   
22  0.393   -0.042  47.039558  36.734688  58316.500000  58447.250000   
23  0.732   -0.031  56.180351  41.423591  58168.123461  58364.472315   
24  0.758   -0.055  56.180344  41.423569  58312.447812  58447.381389   
25  0.583   -0.055  59.461340  42.844173  58168.124016  58443.218924   
26  1.058   -0.074  59.461331  42.844212  58168.123461  58349.451875   
27  0.282    0.001  59.461339  42.844175  58160.237940  58447.402361   
28  0.855   -0.041  44.904377  34.456437  58168.122917  58349.426400   
29  0.312   -0.010  44.904363  34.456441  58316.469063  58431.284282   
30  0.373    0.007  47.036942  21.745013  58312.446817  58437.310671   
31  0.549   -0.038  47.036947  21.745017  58315.447662  58373.423252   
32  0.489    0.003  52.423046  43.303761  58167.109595  58376.468403   
33  1.035   -0.066  52.423043  43.303759  58330.422465  58447.381389   
34  0.506   -0.023  50.535141  43.114002  58167.109595  58382.455833   
35  0.671   -0.053  50.535148  43.113997  58330.422465  58447.381389   
36  0.868   -0.044  46.021004  69.554977  58319.427928  58382.400058   
37  0.604   -0.024  46.020974  69.554956  58287.475660  58447.385243   
38  0.817   -0.042  57.713702  43.293955  58168.123461  58352.423889   
39  0.396   -0.011  57.713703  43.293938  58312.500000  58447.500000   
40  1.025   -0.001  58.819865  43.767390  58168.123461  58349.451875   
41  0.683    0.007  58.819885  43.767357  58160.250000  58425.250000   
42  1.171   -0.063  46.893585  36.339538  58316.469063  58447.358900   
43  1.215   -0.082  46.893588  36.339545  58168.122917  58346.495602   
44  0.305    0.000  48.271271  32.892185  58168.122917  58349.426400   
45  0.456   -0.004  48.271273  32.892184  58313.428507  58422.373044   
46  1.263   -0.087  52.198132  43.219810  58167.109595  58376.468403   
47  0.658   -0.050  52.198147  43.219807  58330.500000  58447.500000   
48  0.600   -0.008  67.985119  63.155750  58210.206910  58443.251262   
49  0.716   -0.032  67.985147  63.155787  58315.450012  58379.468785   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          37  
7          21  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         34  
17         15  
18         31  
19         15  
20         30  
21         15  
22         30  
23         15  
24         29  
25         30  
26         15  
27         31  
28         15  
29         15  
30         15  
31         15  
32         15  
33         27  
34         15  
35         32  
36         15  
37         26  
38         15  
39         29  
40         15  
41         15  
42         30  
43         15  
44         15  
45         15  
46         15  
47         27  
48         32  
49         15  

[50 rows x 36 columns]]",,8.531469345092773,2025-05-19T18:28:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,9,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,13.736756086349487,2025-04-29T13:05:52,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
1   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
2   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
3   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
4   ZTF18abykatf         7       126  58361.516065  58383.498125      False   
5   ZTF18abykbnt         3        98  58375.518414  58383.498576      False   
6   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
7   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
8   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
9   ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
10  ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
11  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
12  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
13  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
14  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
15  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
16  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
17  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
18  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
19  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
20  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
21  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
22  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
23  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
24  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
25  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
26  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
27  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
28  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
29  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
30  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
31  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
32  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
33  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
34  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
35  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
36  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
37  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
38  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
39  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
40  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
41  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
42  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
43  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
44  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
45  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
46  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
47  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
48  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   
49  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.147024      1.463008  ...    779  17.409000     0.016   
1     False     3  2.147024      1.463008  ...    779  15.785000     0.013   
2     False     3 -0.342617      0.979578  ...    742  15.993000     0.019   
3     False     3 -0.342617      0.979578  ...    742  15.179999     0.019   
4     False     7  1.688374           NaN  ...    563  22.446000     0.233   
5     False     3  0.538012           NaN  ...    513  21.828000     0.157   
6      True     4  1.982752      1.239292  ...    610  17.342001     0.015   
7      True     4  1.982752      1.239292  ...    611  15.861000     0.018   
8      True     4  1.982752      1.239292  ...    611  17.337000     0.016   
9     False     9       NaN           NaN  ...    696  13.460999     0.016   
10    False     9       NaN           NaN  ...    696  12.660999     0.013   
11    False     6  0.726899      1.233409  ...    773  14.553000     0.019   
12    False     6  0.726899      1.233409  ...    773  13.186000     0.020   
13    False     6  0.726899      1.233409  ...    774  14.539000     0.019   
14    False     6  0.726899      1.233409  ...    774  13.171000     0.030   
15    False    11 -0.389654      0.450098  ...    696  16.143000     0.018   
16    False    11 -0.389654      0.450098  ...    696  15.552000     0.016   
17     True     4  0.606174      0.368602  ...    606  14.516000     0.017   
18     True     4  0.606174      0.368602  ...    606  13.631000     0.015   
19     True     2 -0.229809      0.797697  ...    654  14.695000     0.020   
20     True     2 -0.229809      0.797697  ...    654  14.111000     0.022   
21     True     3       NaN           NaN  ...    654  14.832000     0.019   
22     True     3       NaN           NaN  ...    654  14.118000     0.016   
23     True     2  0.964619      1.202172  ...    700  16.855000     0.019   
24     True     2  0.964619      1.202172  ...    700  16.118000     0.020   
25     True     3 -1.344518      1.024005  ...    701  16.089000     0.018   
26     True     3 -1.344518      1.024005  ...    700  16.118000     0.022   
27     True     3 -1.344518      1.024005  ...    701  15.070000     0.016   
28    False     8  1.193201      0.907338  ...    654  15.616000     0.022   
29    False     8  1.193201      0.907338  ...    654  14.681000     0.012   
30    False    14  0.268562      0.557169  ...    556  13.573000     0.013   
31    False    14  0.268562      0.557169  ...    556  14.526000     0.017   
32     True     2  0.224375      0.737887  ...    700  16.295000     0.016   
33     True     2  0.224375      0.737887  ...    700  15.691999     0.025   
34     True     2  0.740379      0.959051  ...    700  16.364000     0.016   
35     True     2  0.740379      0.959051  ...    700  15.854000     0.021   
36    False     7       NaN           NaN  ...    835  15.562000     0.020   
37    False     7       NaN           NaN  ...    835  14.453000     0.017   
38    False     2 -0.311003      1.122585  ...    700  15.210999     0.019   
39    False     2 -0.311003      1.122585  ...    700  14.290999     0.016   
40    False     2 -2.261614      0.652495  ...    700  14.809000     0.021   
41    False     2 -2.261614      0.652495  ...    701  14.591000     0.019   
42    False     3 -1.374786      0.792397  ...    654  15.231999     0.026   
43    False     3 -1.374786      0.792397  ...    654  15.948000     0.022   
44     True     2 -0.462552      1.135884  ...    654  15.047000     0.013   
45     True     2 -0.462552      1.135884  ...    654  14.344999     0.013   
46    False     4  0.189377      0.605983  ...    700  16.913000     0.025   
47    False     4  0.189377      0.605983  ...    700  16.453001     0.022   
48    False    13  2.174602      0.965611  ...    811  13.656000     0.017   
49    False    13  2.174602      0.965611  ...    810  13.629000     0.020   

    chinr  sharpnr       ranr      decnr   mjdstartref     mjdendref  \
0   0.559   -0.063  67.520419  55.336962  58168.106933  58371.491759   
1   0.361   -0.019  67.520401  55.336957  58160.239005  58432.335081   
2   0.790   -0.056  57.608612  48.024367  58168.125139  58374.455694   
3   0.933   -0.070  57.608609  48.024352  58160.238461  58397.424849   
4   1.017   -0.088  96.278021  20.181603  58167.122813  58378.486539   
5   1.424    0.078  97.183512   9.555673  58168.115185  58382.477211   
6   0.663   -0.015  79.901788  23.968562  58167.144433  58443.316076   
7   0.828   -0.007  79.901762  23.968554  58160.222651  58352.508264   
8   0.658    0.010  79.901761  23.968553  58168.113576  58374.476470   
9   0.929   -0.056  22.744408  43.494774  58274.450683  58349.407141   
10  0.328    0.018  22.744403  43.494768  58280.474873  58380.303831   
11  0.997   -0.049  11.326809  56.112790  58274.447905  58346.365382   
12  0.913   -0.055  11.326817  56.112781  58257.468472  58424.244664   
13  0.881   -0.043  11.326826  56.112774  58274.449757  58361.440521   
14  1.496   -0.011  11.326831  56.112770  58283.500000  58382.250000   
15  0.944    0.026  22.824088  43.143741  58274.450683  58340.466910   
16  0.543    0.017  22.824081  43.143720  58274.476701  58447.326817   
17  0.518    0.002  47.895942  27.767043  58167.113518  58370.450243   
18  0.360   -0.011  47.895932  27.767012  58310.451435  58447.350069   
19  0.776   -0.040  47.013507  36.276590  58168.122917  58346.495602   
20  0.797   -0.043  47.013508  36.276576  58316.469063  58447.358900   
21  0.767   -0.047  47.039568  36.734705  58168.122917  58346.495602   
22  0.393   -0.042  47.039558  36.734688  58316.500000  58447.250000   
23  0.732   -0.031  56.180351  41.423591  58168.123461  58364.472315   
24  0.758   -0.055  56.180344  41.423569  58312.447812  58447.381389   
25  0.583   -0.055  59.461340  42.844173  58168.124016  58443.218924   
26  1.058   -0.074  59.461331  42.844212  58168.123461  58349.451875   
27  0.282    0.001  59.461339  42.844175  58160.237940  58447.402361   
28  0.855   -0.041  44.904377  34.456437  58168.122917  58349.426400   
29  0.312   -0.010  44.904363  34.456441  58316.469063  58431.284282   
30  0.373    0.007  47.036942  21.745013  58312.446817  58437.310671   
31  0.549   -0.038  47.036947  21.745017  58315.447662  58373.423252   
32  0.489    0.003  52.423046  43.303761  58167.109595  58376.468403   
33  1.035   -0.066  52.423043  43.303759  58330.422465  58447.381389   
34  0.506   -0.023  50.535141  43.114002  58167.109595  58382.455833   
35  0.671   -0.053  50.535148  43.113997  58330.422465  58447.381389   
36  0.868   -0.044  46.021004  69.554977  58319.427928  58382.400058   
37  0.604   -0.024  46.020974  69.554956  58287.475660  58447.385243   
38  0.817   -0.042  57.713702  43.293955  58168.123461  58352.423889   
39  0.396   -0.011  57.713703  43.293938  58312.500000  58447.500000   
40  1.025   -0.001  58.819865  43.767390  58168.123461  58349.451875   
41  0.683    0.007  58.819885  43.767357  58160.250000  58425.250000   
42  1.171   -0.063  46.893585  36.339538  58316.469063  58447.358900   
43  1.215   -0.082  46.893588  36.339545  58168.122917  58346.495602   
44  0.305    0.000  48.271271  32.892185  58168.122917  58349.426400   
45  0.456   -0.004  48.271273  32.892184  58313.428507  58422.373044   
46  1.263   -0.087  52.198132  43.219810  58167.109595  58376.468403   
47  0.658   -0.050  52.198147  43.219807  58330.500000  58447.500000   
48  0.600   -0.008  67.985119  63.155750  58210.206910  58443.251262   
49  0.716   -0.032  67.985147  63.155787  58315.450012  58379.468785   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          37  
7          21  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         34  
17         15  
18         31  
19         15  
20         30  
21         15  
22         30  
23         15  
24         29  
25         30  
26         15  
27         31  
28         15  
29         15  
30         15  
31         15  
32         15  
33         27  
34         15  
35         32  
36         15  
37         26  
38         15  
39         29  
40         15  
41         15  
42         30  
43         15  
44         15  
45         15  
46         15  
47         27  
48         32  
49         15  

[50 rows x 36 columns]]",,8.206814050674438,2025-05-19T18:29:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,10,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,13.115389108657835,2025-04-29T13:06:05,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
1   ZTF18abyjgqf         5      1493  58383.500000  59782.500000       True   
2   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
3   ZTF18abyjjhj         4      1205  58383.472836  58854.144074      False   
4   ZTF18abykatf         7       126  58361.516065  58383.498125      False   
5   ZTF18abykbnt         3        98  58375.518414  58383.498576      False   
6   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
7   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
8   ZTF18abylcjq         6      1567  58383.503877  59141.409931       True   
9   ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
10  ZTF18abyngna        26      2276  58367.412824  60639.282488       True   
11  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
12  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
13  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
14  ZTF18abynkek        10      2796  58384.250000  60102.500000       True   
15  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
16  ZTF18abynifm        21      2018  58297.465278  60449.482211       True   
17  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
18  ZTF18abynrem         5       658  58384.340116  59190.312940       True   
19  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
20  ZTF18abyntla         3       200  58384.341030  58828.217118       True   
21  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
22  ZTF18abyntlf         6      1766  58384.341030  60735.174201       True   
23  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
24  ZTF18abynwfe         2       735  58384.341956  59166.297928       True   
25  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
26  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
27  ZTF18abyofln         2      1156  59192.429664  59672.175081       True   
28  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
29  ZTF18abyoabz        12       924  58384.250000  59873.250000       True   
30  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
31  ZTF18abyntwx        10      1213  58384.339201  60358.250278       True   
32  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
33  ZTF18abyogdp         3       734  58384.341956  59166.297928       True   
34  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
35  ZTF18abyojin         2       228  58384.341956  58721.488194       True   
36  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
37  ZTF18abyokgm         9      1392  58384.345683  60620.327026       True   
38  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
39  ZTF18abyoetr         8      1545  58384.250000  60138.500000       True   
40  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
41  ZTF18abyoccg         3      2869  58384.250000  60147.500000       True   
42  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
43  ZTF18abyntmx         3      1312  58384.250000  60170.500000       True   
44  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
45  ZTF18abynxza         3       899  58384.341030  59511.282477       True   
46  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
47  ZTF18abyogha         5      1099  58384.250000  59758.500000       True   
48  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   
49  ZTF18abyofry        17      2088  58384.250000  60171.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.147024      1.463008  ...    779  17.409000     0.016   
1     False     3  2.147024      1.463008  ...    779  15.785000     0.013   
2     False     3 -0.342617      0.979578  ...    742  15.993000     0.019   
3     False     3 -0.342617      0.979578  ...    742  15.179999     0.019   
4     False     7  1.688374           NaN  ...    563  22.446000     0.233   
5     False     3  0.538012           NaN  ...    513  21.828000     0.157   
6      True     4  1.982752      1.239292  ...    610  17.342001     0.015   
7      True     4  1.982752      1.239292  ...    611  15.861000     0.018   
8      True     4  1.982752      1.239292  ...    611  17.337000     0.016   
9     False     9       NaN           NaN  ...    696  13.460999     0.016   
10    False     9       NaN           NaN  ...    696  12.660999     0.013   
11    False     6  0.726899      1.233409  ...    773  14.553000     0.019   
12    False     6  0.726899      1.233409  ...    773  13.186000     0.020   
13    False     6  0.726899      1.233409  ...    774  14.539000     0.019   
14    False     6  0.726899      1.233409  ...    774  13.171000     0.030   
15    False    11 -0.389654      0.450098  ...    696  16.143000     0.018   
16    False    11 -0.389654      0.450098  ...    696  15.552000     0.016   
17     True     4  0.606174      0.368602  ...    606  14.516000     0.017   
18     True     4  0.606174      0.368602  ...    606  13.631000     0.015   
19     True     2 -0.229809      0.797697  ...    654  14.695000     0.020   
20     True     2 -0.229809      0.797697  ...    654  14.111000     0.022   
21     True     3       NaN           NaN  ...    654  14.832000     0.019   
22     True     3       NaN           NaN  ...    654  14.118000     0.016   
23     True     2  0.964619      1.202172  ...    700  16.855000     0.019   
24     True     2  0.964619      1.202172  ...    700  16.118000     0.020   
25     True     3 -1.344518      1.024005  ...    701  16.089000     0.018   
26     True     3 -1.344518      1.024005  ...    700  16.118000     0.022   
27     True     3 -1.344518      1.024005  ...    701  15.070000     0.016   
28    False     8  1.193201      0.907338  ...    654  15.616000     0.022   
29    False     8  1.193201      0.907338  ...    654  14.681000     0.012   
30    False    14  0.268562      0.557169  ...    556  13.573000     0.013   
31    False    14  0.268562      0.557169  ...    556  14.526000     0.017   
32     True     2  0.224375      0.737887  ...    700  16.295000     0.016   
33     True     2  0.224375      0.737887  ...    700  15.691999     0.025   
34     True     2  0.740379      0.959051  ...    700  16.364000     0.016   
35     True     2  0.740379      0.959051  ...    700  15.854000     0.021   
36    False     7       NaN           NaN  ...    835  15.562000     0.020   
37    False     7       NaN           NaN  ...    835  14.453000     0.017   
38    False     2 -0.311003      1.122585  ...    700  15.210999     0.019   
39    False     2 -0.311003      1.122585  ...    700  14.290999     0.016   
40    False     2 -2.261614      0.652495  ...    700  14.809000     0.021   
41    False     2 -2.261614      0.652495  ...    701  14.591000     0.019   
42    False     3 -1.374786      0.792397  ...    654  15.231999     0.026   
43    False     3 -1.374786      0.792397  ...    654  15.948000     0.022   
44     True     2 -0.462552      1.135884  ...    654  15.047000     0.013   
45     True     2 -0.462552      1.135884  ...    654  14.344999     0.013   
46    False     4  0.189377      0.605983  ...    700  16.913000     0.025   
47    False     4  0.189377      0.605983  ...    700  16.453001     0.022   
48    False    13  2.174602      0.965611  ...    811  13.656000     0.017   
49    False    13  2.174602      0.965611  ...    810  13.629000     0.020   

    chinr  sharpnr       ranr      decnr   mjdstartref     mjdendref  \
0   0.559   -0.063  67.520419  55.336962  58168.106933  58371.491759   
1   0.361   -0.019  67.520401  55.336957  58160.239005  58432.335081   
2   0.790   -0.056  57.608612  48.024367  58168.125139  58374.455694   
3   0.933   -0.070  57.608609  48.024352  58160.238461  58397.424849   
4   1.017   -0.088  96.278021  20.181603  58167.122813  58378.486539   
5   1.424    0.078  97.183512   9.555673  58168.115185  58382.477211   
6   0.663   -0.015  79.901788  23.968562  58167.144433  58443.316076   
7   0.828   -0.007  79.901762  23.968554  58160.222651  58352.508264   
8   0.658    0.010  79.901761  23.968553  58168.113576  58374.476470   
9   0.929   -0.056  22.744408  43.494774  58274.450683  58349.407141   
10  0.328    0.018  22.744403  43.494768  58280.474873  58380.303831   
11  0.997   -0.049  11.326809  56.112790  58274.447905  58346.365382   
12  0.913   -0.055  11.326817  56.112781  58257.468472  58424.244664   
13  0.881   -0.043  11.326826  56.112774  58274.449757  58361.440521   
14  1.496   -0.011  11.326831  56.112770  58283.500000  58382.250000   
15  0.944    0.026  22.824088  43.143741  58274.450683  58340.466910   
16  0.543    0.017  22.824081  43.143720  58274.476701  58447.326817   
17  0.518    0.002  47.895942  27.767043  58167.113518  58370.450243   
18  0.360   -0.011  47.895932  27.767012  58310.451435  58447.350069   
19  0.776   -0.040  47.013507  36.276590  58168.122917  58346.495602   
20  0.797   -0.043  47.013508  36.276576  58316.469063  58447.358900   
21  0.767   -0.047  47.039568  36.734705  58168.122917  58346.495602   
22  0.393   -0.042  47.039558  36.734688  58316.500000  58447.250000   
23  0.732   -0.031  56.180351  41.423591  58168.123461  58364.472315   
24  0.758   -0.055  56.180344  41.423569  58312.447812  58447.381389   
25  0.583   -0.055  59.461340  42.844173  58168.124016  58443.218924   
26  1.058   -0.074  59.461331  42.844212  58168.123461  58349.451875   
27  0.282    0.001  59.461339  42.844175  58160.237940  58447.402361   
28  0.855   -0.041  44.904377  34.456437  58168.122917  58349.426400   
29  0.312   -0.010  44.904363  34.456441  58316.469063  58431.284282   
30  0.373    0.007  47.036942  21.745013  58312.446817  58437.310671   
31  0.549   -0.038  47.036947  21.745017  58315.447662  58373.423252   
32  0.489    0.003  52.423046  43.303761  58167.109595  58376.468403   
33  1.035   -0.066  52.423043  43.303759  58330.422465  58447.381389   
34  0.506   -0.023  50.535141  43.114002  58167.109595  58382.455833   
35  0.671   -0.053  50.535148  43.113997  58330.422465  58447.381389   
36  0.868   -0.044  46.021004  69.554977  58319.427928  58382.400058   
37  0.604   -0.024  46.020974  69.554956  58287.475660  58447.385243   
38  0.817   -0.042  57.713702  43.293955  58168.123461  58352.423889   
39  0.396   -0.011  57.713703  43.293938  58312.500000  58447.500000   
40  1.025   -0.001  58.819865  43.767390  58168.123461  58349.451875   
41  0.683    0.007  58.819885  43.767357  58160.250000  58425.250000   
42  1.171   -0.063  46.893585  36.339538  58316.469063  58447.358900   
43  1.215   -0.082  46.893588  36.339545  58168.122917  58346.495602   
44  0.305    0.000  48.271271  32.892185  58168.122917  58349.426400   
45  0.456   -0.004  48.271273  32.892184  58313.428507  58422.373044   
46  1.263   -0.087  52.198132  43.219810  58167.109595  58376.468403   
47  0.658   -0.050  52.198147  43.219807  58330.500000  58447.500000   
48  0.600   -0.008  67.985119  63.155750  58210.206910  58443.251262   
49  0.716   -0.032  67.985147  63.155787  58315.450012  58379.468785   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          37  
7          21  
8          15  
9          15  
10         15  
11         15  
12         15  
13         15  
14         15  
15         15  
16         34  
17         15  
18         31  
19         15  
20         30  
21         15  
22         30  
23         15  
24         29  
25         30  
26         15  
27         31  
28         15  
29         15  
30         15  
31         15  
32         15  
33         27  
34         15  
35         32  
36         15  
37         26  
38         15  
39         29  
40         15  
41         15  
42         30  
43         15  
44         15  
45         15  
46         15  
47         27  
48         32  
49         15  

[50 rows x 36 columns]]",,9.163345575332642,2025-05-19T18:29:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,90,0,"SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking <= 2
    AND oid in
(
SELECT
    oid
FROM
    feature
WHERE
    name = 'Multiband_period'
    AND version = 'lc_classifier_1.2.1-P'
    AND value < 5
LIMIT 100
)",,,,,"[              oid classifier_name     classifier_version class_name  \
0    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        CEP   
1    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0       DSCT   
2    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        RRL   
3    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0        RRL   
4    ZTF18abadjvy   lc_classifier  hierarchical_rf_1.1.0          E   
..            ...             ...                    ...        ...   
321  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0          E   
322  ZTF18abasovn   lc_classifier   lc_classifier_1.1.13          E   
323  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0        RRL   
324  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0     Blazar   
325  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0        QSO   

     probability  ranking  
0       0.155364        2  
1       0.283360        1  
2       0.190032        1  
3       0.227040        2  
4       0.093744        2  
..           ...      ...  
321     0.424664        1  
322     0.288000        1  
323     0.188956        2  
324     0.205800        2  
325     0.678160        1  

[326 rows x 6 columns]]",,3.8337912559509277,2025-05-19T18:29:18,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,90,1,"
-- Sub-query to filter probability table for the desired classifier and rankings
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter feature table for multiband period less than 5 days
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from probability table for the filtered oids
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM filtered_probability
    INTERSECT
    SELECT oid
    FROM filtered_feature
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,18.347277402877808,2025-04-29T13:06:23,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,43.335957527160645,2025-05-19T18:30:06,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,2,"
-- Sub-query to filter objects based on the 'multiband_period' feature
WITH filtered_features AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),

-- Sub-query to filter probabilities for the light curve classifier with rankings 1 or 2
filtered_probabilities AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
)

-- Final query to retrieve all columns from the 'probability' table for the filtered objects
SELECT p.*
FROM filtered_probabilities p
INNER JOIN filtered_features f ON p.oid = f.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,21.135013580322266,2025-04-29T13:06:45,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.332488059997559,2025-05-19T18:30:21,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,3,"
-- Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter the feature table for objects with a multiband period lower than 5 days
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from the probability table for the filtered objects
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM filtered_probability
    INTERSECT
    SELECT oid
    FROM filtered_feature
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,18.51284766197205,2025-04-29T13:07:03,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter the feature table for objects with a multiband period lower than 5 days
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'Multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from the probability table for the filtered objects
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM filtered_probability
    INTERSECT
    SELECT oid
    FROM filtered_feature
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",136.39690685272217,2025-05-19T18:32:41,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,90,4,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),
feature_subquery AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
      AND oid IN (SELECT oid FROM probability_subquery)
)
SELECT p.*
FROM probability p
INNER JOIN feature_subquery f ON p.oid = f.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,20.217642068862915,2025-04-29T13:07:23,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.720109701156616,2025-05-19T18:32:55,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,5,"
-- Sub-query to filter objects with a multiband period lower than 5 days in the specified feature version
WITH filtered_features AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),

-- Sub-query to filter probability table for the light curve classifier with rankings 1 or 2
filtered_probabilities AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
)

-- Final query to join the filtered results and limit to 100 objects
SELECT p.*
FROM filtered_probabilities p
INNER JOIN filtered_features f ON p.oid = f.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,20.430039644241333,2025-04-29T13:07:44,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.511230707168579,2025-05-19T18:33:09,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,6,"
-- Sub-query to filter objects with multiband period lower than 5 days in the specified feature version
WITH filtered_features AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),

-- Sub-query to filter probabilities for the light curve classifier with rankings 1 or 2
filtered_probabilities AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
)

-- Final query to select all columns from the probability table for the filtered objects
SELECT p.*
FROM filtered_probabilities p
INNER JOIN filtered_features f ON p.oid = f.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,18.98034143447876,2025-04-29T13:08:03,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.173635959625244,2025-05-19T18:33:22,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,7,"
-- Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter the feature table for multiband period lower than 5 days in the specified version
feature_filtered AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from the probability table for the filtered objects
SELECT p.*
FROM probability p
INNER JOIN probability_filtered pf ON p.oid = pf.oid
INNER JOIN feature_filtered ff ON p.oid = ff.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,19.794219255447388,2025-04-29T13:08:23,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,10.260151863098145,2025-05-19T18:33:37,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,8,"
-- Sub-query to filter the probability table for the desired classifier and rankings
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter the feature table for multiband period less than 5 days
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from the probability table for the filtered oids
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM filtered_probability
    INTERSECT
    SELECT oid
    FROM filtered_feature
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,24.415197372436523,2025-04-29T13:08:47,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter the probability table for the desired classifier and rankings
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter the feature table for multiband period less than 5 days
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'Multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from the probability table for the filtered oids
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM filtered_probability
    INTERSECT
    SELECT oid
    FROM filtered_feature
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",136.90542149543762,2025-05-19T18:35:59,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,90,9,"
WITH probability_filtered AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),
feature_filtered AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),
filtered_objects AS (
    SELECT oid
    FROM feature_filtered
    INTERSECT
    SELECT oid
    FROM probability_filtered
)
SELECT p.*
FROM probability p
INNER JOIN filtered_objects fo ON p.oid = fo.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,24.120354175567627,2025-04-29T13:09:12,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,27.126880884170532,2025-05-19T18:36:38,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,10,"
WITH filtered_probability AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)
SELECT p.*
FROM filtered_probability p
INNER JOIN filtered_feature f ON p.oid = f.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,18.95785880088806,2025-04-29T13:09:31,"[             oid classifier_name     classifier_version      class_name  \
0   ZTF18abscvmd   lc_classifier  hierarchical_rf_1.1.0             RRL   
1   ZTF18abscvmd   lc_classifier   lc_classifier_1.1.13             RRL   
2   ZTF18abscvmd   lc_classifier   lc_classifier_1.1.13         CV/Nova   
3   ZTF18abscvmd   lc_classifier  hierarchical_rf_1.1.0               E   
4   ZTF20ablxsbu   lc_classifier   lc_classifier_1.1.13  Periodic-Other   
..           ...             ...                    ...             ...   
95  ZTF18abkjhnt   lc_classifier   lc_classifier_1.1.13             YSO   
96  ZTF18adaqdfq   lc_classifier  hierarchical_rf_1.1.0  Periodic-Other   
97  ZTF18adaqdfq   lc_classifier  hierarchical_rf_1.1.0               E   
98  ZTF18acuwvpr   lc_classifier  hierarchical_rf_1.1.0  Periodic-Other   
99  ZTF18acuwvpr   lc_classifier   lc_classifier_1.1.13  Periodic-Other   

    probability  ranking  
0      0.357520        1  
1      0.380516        1  
2      0.150136        2  
3      0.214512        2  
4      0.536760        1  
..          ...      ...  
95     0.203904        2  
96     0.406080        1  
97     0.178560        2  
98     0.397536        1  
99     0.226044        1  

[100 rows x 6 columns]]",,9.67994236946106,2025-05-19T18:37:00,0.3067484662576687,1.02,1.0,1.0,0.0,1.0
0.16.3,,,51,0,"SELECT
    oid, mjd, fid, mag, e_mag, mag_corr, e_mag_corr_ext, isdiffpos
FROM
    forced_photometry
WHERE
    oid = 'ZTF24aaiutyh'
ORDER BY mjd",,,,,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr_ext  isdiffpos  
0         0.397760         -1  
1         0.385556          1  
2         0.198804          1  
3         0.396211          1  
4         0.359854          1  
..             ...        ...  
60        0.052439          1  
61        0.056607          1  
62        0.044895          1  
63        0.116776          1  
64        0.086913          1  

[65 rows x 8 columns]]",,3.6353654861450195,2025-05-19T18:37:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,51,1,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.6832337379455566,2025-04-29T13:09:33,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,8.739490270614624,2025-05-19T18:37:40,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,2,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.599193334579468,2025-04-29T13:09:36,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,8.654510021209717,2025-05-19T18:38:00,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,3,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.555564641952514,2025-04-29T13:09:39,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,12.2352774143219,2025-05-19T18:38:21,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,4,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.59299898147583,2025-04-29T13:09:41,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,9.388381719589233,2025-05-19T18:38:43,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,5,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.731010675430298,2025-04-29T13:09:44,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,9.045828580856323,2025-05-19T18:39:03,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,6,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.837931871414185,2025-04-29T13:09:47,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,9.24545669555664,2025-05-19T18:39:25,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,7,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.8476152420043945,2025-04-29T13:09:50,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,9.331382274627686,2025-05-19T18:39:46,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,8,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.7136693000793457,2025-04-29T13:09:53,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,8.960647583007812,2025-05-19T18:40:09,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,9,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,3.443778276443481,2025-04-29T13:09:56,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,11.111188411712646,2025-05-19T18:40:29,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,10,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.647568464279175,2025-04-29T13:09:59,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,9.78165054321289,2025-05-19T18:40:56,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,,,59,0,"
SELECT
    oid, fid, ndet, magmean
FROM
    magstat
WHERE
    oid = 'ZTF18acsvogv'
",,,,,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,3.5317018032073975,2025-05-19T18:41:08,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,1,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.773027896881104,2025-04-29T13:10:03,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,8.59086537361145,2025-05-19T18:41:35,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,2,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.8537983894348145,2025-04-29T13:10:06,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,9.341130018234253,2025-05-19T18:41:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,3,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.9110677242279053,2025-04-29T13:10:09,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,8.665127992630005,2025-05-19T18:42:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,4,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.493648290634156,2025-04-29T13:10:11,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,8.197254657745361,2025-05-19T18:42:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,5,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.66359281539917,2025-04-29T13:10:14,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,8.831398725509644,2025-05-19T18:42:58,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,6,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.3269176483154297,2025-04-29T13:10:17,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,8.546861410140991,2025-05-19T18:43:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,7,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.81549072265625,2025-04-29T13:10:21,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,39.18013834953308,2025-05-19T18:44:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,8,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.627715587615967,2025-04-29T13:10:23,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,9.226241827011108,2025-05-19T18:44:16,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,9,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.5417635440826416,2025-04-29T13:10:26,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.929984092712402,2025-05-19T18:44:36,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,10,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.4931769371032715,2025-04-29T13:10:29,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,8.667789697647095,2025-05-19T18:45:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,100,0,"
SELECT
    oid, mjd, fid, isdiffpos,
    magpsf, sigmapsf, NULL as diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'detection' as table
FROM
    detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, NULL as isdiffpos,
    NULL as magpsf, NULL as sigmapsf, diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'non_detection' as table
FROM
    non_detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, isdiffpos,
    NULL as magpsf, NULL as sigmapsf,
    NULL as diffmaglim,
    mag, e_mag,
    'forced_photometry' as table
FROM
    forced_photometry
WHERE
    oid = 'ZTF24aamtvxb'
",,,,,"[              oid           mjd  fid  isdiffpos     magpsf  sigmapsf  \
0    ZTF24aamtvxb  60440.276505    1        1.0  18.307241  0.082498   
1    ZTF24aamtvxb  60442.171227    1        1.0  15.560810  0.033140   
2    ZTF24aamtvxb  60444.229016    1        1.0  14.585193  0.024982   
3    ZTF24aamtvxb  60449.220266    1        1.0  13.173624  0.018505   
4    ZTF24aamtvxb  60449.310336    2        1.0  13.359071  0.016791   
..            ...           ...  ...        ...        ...       ...   
244  ZTF24aamtvxb  60592.533183    2        1.0        NaN       NaN   
245  ZTF24aamtvxb  60600.525556    2        1.0        NaN       NaN   
246  ZTF24aamtvxb  60599.535475    2        1.0        NaN       NaN   
247  ZTF24aamtvxb  60595.530752    2        1.0        NaN       NaN   
248  ZTF24aamtvxb  60594.531447    2        1.0        NaN       NaN   

     diffmaglim        mag     e_mag              table  
0           NaN        NaN       NaN          detection  
1           NaN        NaN       NaN          detection  
2           NaN        NaN       NaN          detection  
3           NaN        NaN       NaN          detection  
4           NaN        NaN       NaN          detection  
..          ...        ...       ...                ...  
244         NaN  17.383959  0.047817  forced_photometry  
245         NaN  17.480049  0.060428  forced_photometry  
246         NaN  17.442333  0.028261  forced_photometry  
247         NaN  17.347569  0.024500  forced_photometry  
248         NaN  17.469713  0.041608  forced_photometry  

[249 rows x 10 columns]]",,3.5998644828796387,2025-05-19T18:45:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,100,1,"
-- Subquery for detections
SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    magpsf AS detection_magnitude, 
    sigmapsf AS detection_magnitude_uncertainty, 
    diffmaglim, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid, 
    mjd, 
    fid, 
    NULL AS isdiffpos, 
    NULL AS detection_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    mag AS forced_photometry_magnitude, 
    e_mag AS forced_photometry_magnitude_uncertainty, 
    NULL AS diffmaglim, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

-- Optionally order by mjd for chronological sequence
ORDER BY 
    mjd
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,27.01679968833924,2025-04-29T13:10:56,"[              oid           mjd  fid  isdiffpos  detection_magnitude  \
0    ZTF24aamtvxb  60412.344618    1        NaN                  NaN   
1    ZTF24aamtvxb  60412.344618    1       -1.0            22.838831   
2    ZTF24aamtvxb  60416.226053    2       -1.0            22.079575   
3    ZTF24aamtvxb  60416.226053    2        NaN                  NaN   
4    ZTF24aamtvxb  60421.255810    1       -1.0            21.285730   
..            ...           ...  ...        ...                  ...   
244  ZTF24aamtvxb  60761.264560    2        1.0            20.694778   
245  ZTF24aamtvxb  60761.264560    2        NaN                  NaN   
246  ZTF24aamtvxb  60761.276516    1        NaN                  NaN   
247  ZTF24aamtvxb  60761.276516    1        1.0            19.239580   
248  ZTF24aamtvxb  60772.266632    1        1.0            19.171974   

     detection_magnitude_uncertainty  diffmaglim              table  
0                                NaN   20.591200      non_detection  
1                           1.274691         NaN  forced_photometry  
2                           0.798127         NaN  forced_photometry  
3                                NaN   20.167600      non_detection  
4                           1.062008         NaN  forced_photometry  
..                               ...         ...                ...  
244                         0.160550         NaN  forced_photometry  
245                              NaN   20.848500      non_detection  
246                              NaN   20.818400      non_detection  
247                         0.046392         NaN  forced_photometry  
248                         0.164153   19.667288          detection  

[249 rows x 8 columns]]",,11.657142639160156,2025-05-19T18:45:33,1.0,1.0,0.6,0.75,1.0,0.0
0.16.3,gpt-4o,v1,100,2,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    NULL AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,31.654680967330933,2025-04-29T13:11:28,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  five_sigma_mag_limit  \
0             18.307241                        0.082498             20.226849   
1             15.560810                        0.033140             20.494621   
2             14.585193                        0.024982             20.100885   
3             13.173624                        0.018505             19.400555   
4             13.359071                        0.016791             19.018711   
..                  ...                             ...                   ...   
244                 NaN                             NaN                   NaN   
245                 NaN                             NaN                   NaN   
246                 NaN                             NaN                   NaN   
247                 NaN                             NaN                   NaN   
248                 NaN                             NaN                   NaN   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN          detection  
1                NaN                          NaN          detection  
2                NaN                          NaN          detection  
3                NaN                          NaN          detection  
4                NaN                          NaN          detection  
..               ...                          ...                ...  
244        17.383959                     0.047817  forced_photometry  
245        17.480049                     0.060428  forced_photometry  
246        17.442333                     0.028261  forced_photometry  
247        17.347569                     0.024500  forced_photometry  
248        17.469713                     0.041608  forced_photometry  

[249 rows x 10 columns]]",,12.042955875396729,2025-05-19T18:45:51,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,3,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_difference_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,24.87683629989624,2025-04-29T13:11:53,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_difference_magnitude  \
0                         18.307241   
1                         15.560810   
2                         14.585193   
3                         13.173624   
4                         13.359071   
..                              ...   
244                             NaN   
245                             NaN   
246                             NaN   
247                             NaN   
248                             NaN   

     detection_difference_magnitude_uncertainty  five_sigma_magnitude_limit  \
0                                      0.082498                   20.226849   
1                                      0.033140                   20.494621   
2                                      0.024982                   20.100885   
3                                      0.018505                   19.400555   
4                                      0.016791                   19.018711   
..                                          ...                         ...   
244                                         NaN                   18.515301   
245                                         NaN                   18.378099   
246                                         NaN                   19.415501   
247                                         NaN                   19.275900   
248                                         NaN                   18.762501   

     forced_difference_magnitude  forced_difference_magnitude_uncertainty  \
0                            NaN                                      NaN   
1                            NaN                                      NaN   
2                            NaN                                      NaN   
3                            NaN                                      NaN   
4                            NaN                                      NaN   
..                           ...                                      ...   
244                    17.383959                                 0.047817   
245                    17.480049                                 0.060428   
246                    17.442333                                 0.028261   
247                    17.347569                                 0.024500   
248                    17.469713                                 0.041608   

                 table  
0            detection  
1            detection  
2            detection  
3            detection  
4            detection  
..                 ...  
244  forced_photometry  
245  forced_photometry  
246  forced_photometry  
247  forced_photometry  
248  forced_photometry  

[249 rows x 10 columns]]",,15.193850040435791,2025-05-19T18:46:12,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,4,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    isdiffpos,
    magpsf AS detection_diff_mag,
    sigmapsf AS detection_diff_mag_uncertainty,
    diffmaglim AS five_sigma_mag_limit,
    NULL AS forced_diff_mag,
    NULL AS forced_diff_mag_uncertainty,
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    NULL AS isdiffpos,
    NULL AS detection_diff_mag,
    NULL AS detection_diff_mag_uncertainty,
    diffmaglim AS five_sigma_mag_limit,
    NULL AS forced_diff_mag,
    NULL AS forced_diff_mag_uncertainty,
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    isdiffpos,
    NULL AS detection_diff_mag,
    NULL AS detection_diff_mag_uncertainty,
    NULL AS five_sigma_mag_limit,
    mag AS forced_diff_mag,
    e_mag AS forced_diff_mag_uncertainty,
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,22.28162670135498,2025-04-29T13:12:15,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  five_sigma_mag_limit  \
0             18.307241                        0.082498             20.226849   
1             15.560810                        0.033140             20.494621   
2             14.585193                        0.024982             20.100885   
3             13.173624                        0.018505             19.400555   
4             13.359071                        0.016791             19.018711   
..                  ...                             ...                   ...   
244                 NaN                             NaN                   NaN   
245                 NaN                             NaN                   NaN   
246                 NaN                             NaN                   NaN   
247                 NaN                             NaN                   NaN   
248                 NaN                             NaN                   NaN   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN          detection  
1                NaN                          NaN          detection  
2                NaN                          NaN          detection  
3                NaN                          NaN          detection  
4                NaN                          NaN          detection  
..               ...                          ...                ...  
244        17.383959                     0.047817  forced_photometry  
245        17.480049                     0.060428  forced_photometry  
246        17.442333                     0.028261  forced_photometry  
247        17.347569                     0.024500  forced_photometry  
248        17.469713                     0.041608  forced_photometry  

[249 rows x 10 columns]]",,13.905259370803833,2025-05-19T18:46:32,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,5,"
-- Subquery for Detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for Non-Detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for Forced Photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_difference_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,50.93239974975586,2025-04-29T13:13:07,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_difference_magnitude  \
0                         18.307241   
1                         15.560810   
2                         14.585193   
3                         13.173624   
4                         13.359071   
..                              ...   
244                             NaN   
245                             NaN   
246                             NaN   
247                             NaN   
248                             NaN   

     detection_difference_magnitude_uncertainty  five_sigma_magnitude_limit  \
0                                      0.082498                   20.226849   
1                                      0.033140                   20.494621   
2                                      0.024982                   20.100885   
3                                      0.018505                   19.400555   
4                                      0.016791                   19.018711   
..                                          ...                         ...   
244                                         NaN                   18.515301   
245                                         NaN                   18.378099   
246                                         NaN                   19.415501   
247                                         NaN                   19.275900   
248                                         NaN                   18.762501   

     forced_difference_magnitude  forced_difference_magnitude_uncertainty  \
0                            NaN                                      NaN   
1                            NaN                                      NaN   
2                            NaN                                      NaN   
3                            NaN                                      NaN   
4                            NaN                                      NaN   
..                           ...                                      ...   
244                    17.383959                                 0.047817   
245                    17.480049                                 0.060428   
246                    17.442333                                 0.028261   
247                    17.347569                                 0.024500   
248                    17.469713                                 0.041608   

                 table  
0            detection  
1            detection  
2            detection  
3            detection  
4            detection  
..                 ...  
244  forced_photometry  
245  forced_photometry  
246  forced_photometry  
247  forced_photometry  
248  forced_photometry  

[249 rows x 10 columns]]",,13.224406242370605,2025-05-19T18:46:50,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,6,"
-- Subquery for Detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for Non-Detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for Forced Photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_difference_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

-- Order the combined results by epoch date
ORDER BY 
    epoch_date
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,23.37844204902649,2025-04-29T13:13:31,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60412.344618                  1        NaN   
1    ZTF24aamtvxb  60412.344618                  1       -1.0   
2    ZTF24aamtvxb  60416.226053                  2       -1.0   
3    ZTF24aamtvxb  60416.226053                  2        NaN   
4    ZTF24aamtvxb  60421.255810                  1       -1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60761.264560                  2        1.0   
245  ZTF24aamtvxb  60761.264560                  2        NaN   
246  ZTF24aamtvxb  60761.276516                  1        NaN   
247  ZTF24aamtvxb  60761.276516                  1        1.0   
248  ZTF24aamtvxb  60772.266632                  1        1.0   

     detection_difference_magnitude  \
0                               NaN   
1                               NaN   
2                               NaN   
3                               NaN   
4                               NaN   
..                              ...   
244                             NaN   
245                             NaN   
246                             NaN   
247                             NaN   
248                       19.171974   

     detection_difference_magnitude_uncertainty  five_sigma_magnitude_limit  \
0                                           NaN                   20.591200   
1                                           NaN                   20.591200   
2                                           NaN                   20.167601   
3                                           NaN                   20.167601   
4                                           NaN                   19.095301   
..                                          ...                         ...   
244                                         NaN                   20.848499   
245                                         NaN                   20.848499   
246                                         NaN                   20.818399   
247                                         NaN                   20.818399   
248                                    0.164153                   19.667288   

     forced_difference_magnitude  forced_difference_magnitude_uncertainty  \
0                            NaN                                      NaN   
1                      22.838831                                 1.274691   
2                      22.079575                                 0.798127   
3                            NaN                                      NaN   
4                      21.285730                                 1.062008   
..                           ...                                      ...   
244                    20.694778                                 0.160550   
245                          NaN                                      NaN   
246                          NaN                                      NaN   
247                    19.239580                                 0.046392   
248                          NaN                                      NaN   

                 table  
0        non_detection  
1    forced_photometry  
2    forced_photometry  
3        non_detection  
4    forced_photometry  
..                 ...  
244  forced_photometry  
245      non_detection  
246      non_detection  
247  forced_photometry  
248          detection  

[249 rows x 10 columns]]",,12.768417596817017,2025-05-19T18:47:08,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,7,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
ORDER BY 
    epoch_date
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,28.67788600921631,2025-04-29T13:14:00,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60412.344618                  1        NaN   
1    ZTF24aamtvxb  60412.344618                  1       -1.0   
2    ZTF24aamtvxb  60416.226053                  2       -1.0   
3    ZTF24aamtvxb  60416.226053                  2        NaN   
4    ZTF24aamtvxb  60421.255810                  1        NaN   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60761.264560                  2        NaN   
245  ZTF24aamtvxb  60761.264560                  2        1.0   
246  ZTF24aamtvxb  60761.276516                  1        1.0   
247  ZTF24aamtvxb  60761.276516                  1        NaN   
248  ZTF24aamtvxb  60772.266632                  1        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  five_sigma_mag_limit  \
0                   NaN                             NaN             20.591200   
1                   NaN                             NaN             20.591200   
2                   NaN                             NaN             20.167601   
3                   NaN                             NaN             20.167601   
4                   NaN                             NaN             19.095301   
..                  ...                             ...                   ...   
244                 NaN                             NaN             20.848499   
245                 NaN                             NaN             20.848499   
246                 NaN                             NaN             20.818399   
247                 NaN                             NaN             20.818399   
248           19.171974                        0.164153             19.667288   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN      non_detection  
1          22.838831                     1.274691  forced_photometry  
2          22.079575                     0.798127  forced_photometry  
3                NaN                          NaN      non_detection  
4                NaN                          NaN      non_detection  
..               ...                          ...                ...  
244              NaN                          NaN      non_detection  
245        20.694778                     0.160550  forced_photometry  
246        19.239580                     0.046392  forced_photometry  
247              NaN                          NaN      non_detection  
248              NaN                          NaN          detection  

[249 rows x 10 columns]]",,12.453001976013184,2025-05-19T18:47:26,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,8,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,25.354485034942627,2025-04-29T13:14:26,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  diffmaglim  \
0             18.307241                        0.082498   20.226849   
1             15.560810                        0.033140   20.494621   
2             14.585193                        0.024982   20.100885   
3             13.173624                        0.018505   19.400555   
4             13.359071                        0.016791   19.018711   
..                  ...                             ...         ...   
244                 NaN                             NaN   18.515301   
245                 NaN                             NaN   18.378099   
246                 NaN                             NaN   19.415501   
247                 NaN                             NaN   19.275900   
248                 NaN                             NaN   18.762501   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN          detection  
1                NaN                          NaN          detection  
2                NaN                          NaN          detection  
3                NaN                          NaN          detection  
4                NaN                          NaN          detection  
..               ...                          ...                ...  
244        17.383959                     0.047817  forced_photometry  
245        17.480049                     0.060428  forced_photometry  
246        17.442333                     0.028261  forced_photometry  
247        17.347569                     0.024500  forced_photometry  
248        17.469713                     0.041608  forced_photometry  

[249 rows x 10 columns]]",,45.212889671325684,2025-05-19T18:48:17,1.0,1.0,0.3,0.3,1.0,0.0
0.16.3,gpt-4o,v1,100,9,"
-- Subquery for detections
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    magpsf AS ""detection difference magnitude"", 
    sigmapsf AS ""detection magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    'detection' AS ""table""
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for non-detections
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    NULL AS ""isdiffpos flag"", 
    NULL AS ""detection difference magnitude"", 
    NULL AS ""detection magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    'non_detection' AS ""table""
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for forced photometry
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    mag AS ""forced difference magnitude"", 
    e_mag AS ""forced magnitude uncertainty"", 
    NULL AS ""5-sigma magnitude limit"", 
    'forced_photometry' AS ""table""
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,18.96828842163086,2025-04-29T13:14:45,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 49:     mag AS ""forced difference magnitude"", 
             ^

[SQL: 
-- Subquery for detections
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    magpsf AS ""detection difference magnitude"", 
    sigmapsf AS ""detection magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    NULL AS ""forced difference magnitude"", 
    NULL AS ""forced magnitude uncertainty"", 
    'detection' AS ""table""
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for non-detections
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    NULL AS ""isdiffpos flag"", 
    NULL AS ""detection difference magnitude"", 
    NULL AS ""detection magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    NULL AS ""forced difference magnitude"", 
    NULL AS ""forced magnitude uncertainty"", 
    'non_detection' AS ""table""
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for forced photometry
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    NULL AS ""detection difference magnitude"", 
    NULL AS ""detection magnitude uncertainty"", 
    NULL AS ""5-sigma magnitude limit"", 
    mag AS ""forced difference magnitude"", 
    e_mag AS ""forced magnitude uncertainty"", 
    'forced_photometry' AS ""table""
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.113633155822754,2025-05-19T18:48:36,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,100,10,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,20.6225802898407,2025-04-29T13:15:06,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  diffmaglim  \
0             18.307241                        0.082498   20.226849   
1             15.560810                        0.033140   20.494621   
2             14.585193                        0.024982   20.100885   
3             13.173624                        0.018505   19.400555   
4             13.359071                        0.016791   19.018711   
..                  ...                             ...         ...   
244                 NaN                             NaN   18.515301   
245                 NaN                             NaN   18.378099   
246                 NaN                             NaN   19.415501   
247                 NaN                             NaN   19.275900   
248                 NaN                             NaN   18.762501   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN          detection  
1                NaN                          NaN          detection  
2                NaN                          NaN          detection  
3                NaN                          NaN          detection  
4                NaN                          NaN          detection  
..               ...                          ...                ...  
244        17.383959                     0.047817  forced_photometry  
245        17.480049                     0.060428  forced_photometry  
246        17.442333                     0.028261  forced_photometry  
247        17.347569                     0.024500  forced_photometry  
248        17.469713                     0.041608  forced_photometry  

[249 rows x 10 columns]]",,14.457922220230103,2025-05-19T18:48:56,1.0,1.0,0.3,0.3,1.0,0.0
0.16.3,,,106,0,"
SELECT
    sq1.oid, sq1.ndet, sq1.firstmjd,
    sq1.probability as prob_stamp_bogus,
    sq2.probability as prob_lc_transient
FROM
(
SELECT
    object.oid, object.ndet, object.firstmjd,
    probability.class_name,
    probability.probability
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    ndet > 10
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'bogus'
    AND probability > 0.7
    AND classifier_version = 'stamp_classifier_1.0.4'
) AS sq1
INNER JOIN
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier_top'
    AND class_name = 'Transient'
    AND probability > 0.9
) AS sq2
ON sq1.oid = sq2.oid
ORDER BY sq1.oid
LIMIT 30
",,,,,"[             oid  ndet      firstmjd  prob_stamp_bogus  prob_lc_transient
0   ZTF17aaahhwn    16  60168.430151          0.771008              1.000
1   ZTF18aajkcdn    11  59904.431377          0.767230              0.954
2   ZTF18abjrfqx    56  58325.466678          0.745006              1.000
3   ZTF18ablowct    25  58334.328206          0.700790              1.000
4   ZTF18abmwnov    57  58346.359896          0.715889              1.000
5   ZTF18absdojk   368  58362.167813          0.705910              0.952
6   ZTF18abuicad    67  58371.378785          0.835837              0.956
7   ZTF18abzbkby    37  58385.452824          0.864839              0.994
8   ZTF18acbwxcc    23  58423.140255          0.777057              0.970
9   ZTF18acszayr    30  58456.220949          0.767309              0.938
10  ZTF19aaoyjoz    17  58580.254491          0.761249              0.982
11  ZTF19aauoiow   117  58636.423935          0.773761              1.000
12  ZTF19aavjzrz    94  58643.455984          0.794810              1.000
13  ZTF19aawsdlq    34  58636.421644          0.792299              1.000
14  ZTF19aazfvhh    63  58646.469097          0.722329              0.996
15  ZTF19abwsecm    26  58725.461806          0.808821              1.000
16  ZTF19abxjimu   127  58732.422708          0.721538              0.998
17  ZTF19abzqwpr    37  58746.390891          0.713936              0.998
18  ZTF19abzsnqm    20  58746.390394          0.788473              0.988
19  ZTF19acbkczc    25  58754.207940          0.911203              0.936
20  ZTF19aczmkbo    19  58836.133241          0.822191              1.000
21  ZTF20aafpojg    23  58863.214120          0.729397              0.964
22  ZTF20abjsyqn    21  59036.374190          0.710259              0.922
23  ZTF20abylbuf    90  59096.384016          0.724529              1.000
24  ZTF20acjbhhp    60  59136.325822          0.703471              1.000
25  ZTF20acoyvdg    23  59157.236493          0.705165              0.996
26  ZTF20acpmgdz    64  59165.336678          0.724588              1.000
27  ZTF20acqzjqz   107  59169.318993          0.752268              1.000
28  ZTF20acwgxhk    48  59193.197292          0.739050              0.976
29  ZTF20acxdawc    17  59193.198241          0.861717              0.968]",,42.88953518867493,2025-05-19T18:49:45,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,106,1,"
WITH bogus_prob AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
),
transient_prob AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
)
SELECT o.oid, o.ndet, o.firstmjd, bp.prob_stamp_bogus, tp.prob_lc_transient
FROM object o
INNER JOIN bogus_prob bp ON o.oid = bp.oid
INNER JOIN transient_prob tp ON o.oid = tp.oid
WHERE o.ndet > 10
ORDER BY bp.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.70303010940552,2025-04-29T13:15:26,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.420499086380005,2025-05-19T18:50:43,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,2,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.521501779556274,2025-04-29T13:15:45,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,12.211292028427124,2025-05-19T18:51:14,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,3,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,17.347552061080933,2025-04-29T13:16:03,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,10.894814729690552,2025-05-19T18:51:42,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,4,"
-- Subquery for Stamp Classifier
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),

-- Subquery for Light Curve Classifier Top Level
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)

-- Main Query
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,17.353618621826172,2025-04-29T13:16:20,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.164681434631348,2025-05-19T18:52:06,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,5,"
WITH prob_stamp_bogus AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),
prob_lc_transient AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)
SELECT o.oid, o.ndet, o.firstmjd, psb.prob_stamp_bogus, plt.prob_lc_transient
FROM object o
INNER JOIN prob_stamp_bogus psb ON o.oid = psb.oid
INNER JOIN prob_lc_transient plt ON o.oid = plt.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,31.18118119239807,2025-04-29T13:16:53,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,10.986023187637329,2025-05-19T18:52:25,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,6,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.39007806777954,2025-04-29T13:17:12,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,10.902894496917725,2025-05-19T18:52:43,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,7,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.270039796829224,2025-04-29T13:17:39,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.257184743881226,2025-05-19T18:53:00,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,8,"
WITH bogus_prob AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
),
transient_prob AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
)
SELECT o.oid, o.ndet, o.firstmjd, bp.prob_stamp_bogus, tp.prob_lc_transient
FROM object o
INNER JOIN bogus_prob bp ON o.oid = bp.oid
INNER JOIN transient_prob tp ON o.oid = tp.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.22704601287841,2025-04-29T13:18:05,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.135816812515259,2025-05-19T18:53:18,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,9,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,22.739304065704346,2025-04-29T13:18:28,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,10.690096378326416,2025-05-19T18:53:35,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,10,"
-- Subquery for Stamp Classifier
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),

-- Subquery for Light Curve Classifier Top Level
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)

-- Main Query
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,20.05484414100647,2025-04-29T13:18:49,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,14.70149302482605,2025-05-19T18:53:56,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,56,0,"SELECT
    oid, ndet, meanra, meandec,
    firstmjd, lastmjd,
    g_r_mean, g_r_mean_corr
FROM
    object
WHERE
    oid IN ('ZTF20abywydb','ZTF20abzpxxu','ZTF20acduffd')
    AND not corrected
ORDER BY firstmjd",,,,,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,3.40189266204834,2025-05-19T18:54:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,1,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.596601247787476,2025-04-29T13:18:53,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,9.355589151382446,2025-05-19T18:54:18,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,2,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.09083890914917,2025-04-29T13:18:58,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,10.661839962005615,2025-05-19T18:54:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,3,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.807854413986206,2025-04-29T13:19:03,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,10.160910844802856,2025-05-19T18:54:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,4,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,7.341605186462402,2025-04-29T13:19:12,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,9.730818271636963,2025-05-19T18:55:09,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,5,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.350906610488892,2025-04-29T13:19:17,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,10.08036732673645,2025-05-19T18:55:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,6,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,5.907216548919678,2025-04-29T13:19:24,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,9.905005931854248,2025-05-19T18:55:41,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,7,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.192013025283813,2025-04-29T13:19:28,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,10.424169778823853,2025-05-19T18:55:56,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,8,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.224541902542114,2025-04-29T13:19:33,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,10.690561294555664,2025-05-19T18:56:11,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,9,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.9458179473876953,2025-04-29T13:19:38,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,9.64925241470337,2025-05-19T18:56:25,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,10,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.837574005126953,2025-04-29T13:19:44,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    81  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    15  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,9.260273456573486,2025-05-19T18:56:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,48,0,"SELECT
    oid, name, value, fid, version
FROM
    feature
WHERE
    oid = 'ZTF18abqyaix'
ORDER BY name, fid, version
",,,,,"[              oid             name     value  fid                version
0    ZTF18abqyaix        Amplitude  0.269018    1  lc_classifier_1.2.1-P
1    ZTF18abqyaix        Amplitude  0.599888    2  lc_classifier_1.2.1-P
2    ZTF18abqyaix  AndersonDarling  0.249661    1  lc_classifier_1.2.1-P
3    ZTF18abqyaix  AndersonDarling  0.994609    2  lc_classifier_1.2.1-P
4    ZTF18abqyaix   Autocor_length  5.000000    1  lc_classifier_1.2.1-P
..            ...              ...       ...  ...                    ...
173  ZTF18abqyaix              Std  0.360955    2  lc_classifier_1.2.1-P
174  ZTF18abqyaix         StetsonK  0.869824    1  lc_classifier_1.2.1-P
175  ZTF18abqyaix         StetsonK  0.941219    2  lc_classifier_1.2.1-P
176  ZTF18abqyaix            W1-W2       NaN    0  lc_classifier_1.2.1-P
177  ZTF18abqyaix            W2-W3       NaN    0  lc_classifier_1.2.1-P

[178 rows x 5 columns]]",,3.6411499977111816,2025-05-19T18:56:46,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,48,1,"
SELECT 
    feature.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""feature value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,21.570751667022705,2025-04-29T13:20:07,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.140676021575928,2025-05-19T18:57:03,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,2,"
SELECT 
    oid AS ""ZTF identifier"", 
    name AS ""feature name"", 
    value AS ""feature value"", 
    fid AS ""filter identifier"", 
    version AS ""feature version""
FROM 
    feature
WHERE 
    oid = 'ZTF18abqyaix'
ORDER BY 
    oid, fid, version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,33.88337779045105,2025-04-29T13:20:45,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.669239282608032,2025-05-19T18:57:25,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,3,"
SELECT 
    f.oid AS ""ZTF identifier"", 
    f.name AS ""feature name"", 
    f.value AS ""feature value"", 
    f.fid AS ""filter identifier"", 
    f.version AS ""feature version""
FROM 
    feature f
INNER JOIN 
    object o ON f.oid = o.oid
WHERE 
    o.oid = 'ZTF18abqyaix'
ORDER BY 
    f.oid, f.fid, f.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,22.0603575706482,2025-04-29T13:21:09,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.246123313903809,2025-05-19T18:57:40,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,4,"
SELECT 
    object.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    object.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,33.09180450439453,2025-04-29T13:21:45,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.09358549118042,2025-05-19T18:57:55,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,48,5,"
SELECT 
    object.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""feature value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    object.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,14.037034273147585,2025-04-29T13:22:00,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.219586849212646,2025-05-19T18:58:09,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,6,"
SELECT 
    f.oid AS ""ZTF identifier"", 
    f.name AS ""feature name"", 
    f.value AS ""feature value"", 
    f.fid AS ""filter identifier"", 
    f.version AS ""feature version""
FROM 
    feature f
INNER JOIN 
    object o ON f.oid = o.oid
WHERE 
    o.oid = 'ZTF18abqyaix'
ORDER BY 
    f.oid, f.fid, f.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,32.42563319206238,2025-04-29T13:22:34,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.735838174819946,2025-05-19T18:58:28,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,7,"
SELECT 
    object.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    object.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,20.89116644859314,2025-04-29T13:22:55,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.292409896850586,2025-05-19T18:58:43,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,48,8,"
-- Retrieve all features for the ZTF object 'ZTF18abqyaix'
SELECT 
    feature.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,20.94590830802917,2025-04-29T13:23:17,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.1699960231781,2025-05-19T18:58:57,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,48,9,"
SELECT 
    feature.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,32.70031714439392,2025-04-29T13:23:51,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.192401647567749,2025-05-19T18:59:11,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,48,10,"
SELECT 
    f.oid AS ""ZTF identifier"", 
    f.name AS ""feature name"", 
    f.value AS ""feature value"", 
    f.fid AS ""filter identifier"", 
    f.version AS ""feature version""
FROM 
    feature f
INNER JOIN 
    object o ON f.oid = o.oid
WHERE 
    f.oid = 'ZTF18abqyaix'
ORDER BY 
    f.oid, f.fid, f.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,26.456074237823486,2025-04-29T13:24:18,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.617011070251465,2025-05-19T18:59:26,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,,,58,0,"SELECT
    *
FROM
    object
WHERE
    ndet >= 30
    AND g_r_max_corr > 3.5
    AND deltajd > 10
LIMIT 20",,,,,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF19aawpuaj       239      1302  58606.331157  60463.378322      False   
10  ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
11  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
12  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
13  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
14  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
15  ZTF22aaxzsia       278      2006  58283.355718  60514.298148       True   
16  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
17  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
18  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
19  ZTF20acuvief       344       797  58092.250000  59899.250000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30  0.307500     78.849300  ...  264.125360  -3.569033   
10    False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
11    False    30  3.383300      3.520334  ...  310.549843  35.871089   
12     True    30  3.475138      3.820012  ...  301.753875  29.373305   
13    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
14    False    30  3.680100      4.137546  ...  290.258009  10.990085   
15    False    30  2.442265      3.501978  ...  276.329768  -1.413535   
16    False    30  2.575001      3.506628  ...  282.768116   8.093893   
17    False    30  3.118599      3.936478  ...  301.286563  32.979345   
18    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
19    False    30  3.220251      3.507006  ...   86.453306  -0.210206   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.032189  0.032127  1857.047164  58606.331157  60463.378322   
10  0.000179  0.000103   831.860810  59140.373819  59972.234630   
11  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
12  0.000080  0.000054   801.834838  58616.422049  59418.256887   
13  0.032683  0.030612   422.832072  59904.414514  60327.246586   
14  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
15  0.049090  0.049075   741.899722  59772.398426  60514.298148   
16  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
17  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
18  0.000097  0.000124   383.936829  59139.397928  59523.334757   
19  0.000086  0.000120   632.193252  59267.152049  59899.345301   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9             24.5.1    False            False  
10             1.1.6    False            False  
11  correction_1.0.6    False            False  
12  correction_1.0.6    False            False  
13   corr_bulk_0.0.1    False            False  
14            24.5.1    False            False  
15          24.5.2a6    False            False  
16            24.5.1    False            False  
17             1.2.1    False            False  
18  correction_1.0.6    False            False  
19             1.1.6    False            False  

[20 rows x 22 columns]]",,8.895836353302002,2025-05-19T18:59:37,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,58,1,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.340736627578736,2025-04-29T13:24:21,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF19abayils        38      2144  58660.294965  60438.454132       True   
1   ZTF19abzrqko        90      2857  58337.373056  59341.475139      False   
2   ZTF18acgbnys        48      2142  58104.500000  60021.250000       True   
3   ZTF19acaxece        44      1095  58605.500000  59729.500000       True   
4   ZTF19actshwz        34      1166  58105.211331  59380.460880       True   
5   ZTF19abdrxnj       121      8118  58316.500000  60230.250000       True   
6   ZTF19abncrzk        33      1342  58359.357407  60316.119005       True   
7   ZTF20actlyod       311      2159  58705.476609  60353.143866       True   
8   ZTF20aajwatv       342      3662  58328.250000  59769.250000       True   
9   ZTF18adqbtjj        31      3754  58311.250000  59729.500000       True   
10  ZTF20acxvkci       465      2559  58382.500000  59969.250000      False   
11  ZTF18aaadqsd        56       464  58129.509873  58272.225312       True   
12  ZTF19aadufzf       163      1799  58503.559595  60398.503380       True   
13  ZTF20ablxkpo        44       347  58582.505741  59057.391863       True   
14  ZTF18aayhmdc        42      2822  58275.401493  60505.337130       True   
15  ZTF18abedarp       146      2749  58232.500000  60162.250000      False   
16  ZTF19abjarfm       208       920  58642.422072  59172.213970       True   
17  ZTF18abukwfs        55      3605  58370.249120  60528.274792       True   
18  ZTF19aczlfho        68       782  58658.410278  59090.442269      False   
19  ZTF21abbsymk        34      2011  58280.500000  60051.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    17  0.059539      0.937345  ...  263.113339 -11.994987   
1     False    14  0.452540     -0.513658  ...  304.476922  26.998009   
2     False    37  1.407939      0.601376  ...   66.701374  29.589059   
3     False    16  0.375600      0.557628  ...  256.958179   8.208859   
4      True     4  3.100337      0.719470  ...   36.941007  60.350391   
5     False    62  1.264016      0.890931  ...  334.443469  29.784558   
6      True    15  1.894310      0.745290  ...  342.230692   1.837645   
7     False    43  0.716301     -0.295021  ...   61.824877  -6.176918   
8     False    17  0.101330     78.367250  ...  241.593372  15.245473   
9     False     8  0.398148      0.605114  ...  230.774535  58.526923   
10    False    17  0.612965     78.181610  ...   34.897817  23.858153   
11    False     9  1.691471     78.823910  ...  190.660548  51.341177   
12    False    37  0.457286      1.386310  ...  264.908936  -1.868524   
13    False    13  0.018200     77.475280  ...  328.648898   9.675628   
14    False    13  1.378930      1.731016  ...  300.628461  23.461867   
15    False     8  1.582096     -3.924965  ...  296.872198  45.088905   
16     True    64  0.164200      0.035584  ...    7.265852  23.549886   
17    False    20  0.511390      0.358778  ...  307.099416  17.255509   
18    False    12  0.420721     -1.889055  ...   14.150696  31.077636   
19    False    20 -0.235720      0.414877  ...  268.135959  18.382669   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.052786  0.051633  1466.054861  58972.399271  60438.454132   
1   0.000198  0.000142   621.210579  58720.264560  59341.475139   
2   0.000121  0.000106  1589.929387  58431.277755  60021.207141   
3   0.000107  0.000146   978.196759  58751.206065  59729.402824   
4   0.000080  0.000015   501.339386  58879.121493  59380.460880   
5   0.000069  0.000079  1586.758044  58643.444433  60230.202477   
6   0.060135  0.060104  1616.698125  58699.420880  60316.119005   
7   0.060455  0.060104  1203.764930  59149.378935  60353.143866   
8   0.000116  0.000138   895.768275  58873.549607  59769.317882   
9   0.000122  0.000064    35.000602  59694.389618  59729.390220   
10  0.000130  0.000110   799.850741  59169.283484  59969.134225   
11  0.000147  0.000065    29.958090  58242.267222  58272.225312   
12  0.027709  0.027694  1166.939352  59231.564028  60398.503380   
13  0.000145  0.000072    38.051574  59019.340289  59057.391863   
14  0.070858  0.065000  2229.935636  58275.401493  60505.337130   
15  0.000538  0.000218  1871.932917  58290.389005  60162.321921   
16  0.000056  0.000054   497.759780  58674.454190  59172.213970   
17  0.089006  0.085000  2158.025671  58370.249120  60528.274792   
18  0.000176  0.000144   257.339734  58833.102535  59090.442269   
19  0.000034  0.000045   729.030556  59322.436146  60051.466701   

        step_id_corr  diffpos reference_change  
0             24.4.1     True            False  
1   correction_0.0.1    False            False  
2              1.1.6    False             True  
3              1.1.2    False            False  
4   correction_0.0.1    False            False  
5              1.2.1    False            False  
6   correction_1.0.6    False            False  
7              1.2.1    False            False  
8                dev    False            False  
9              1.1.2    False            False  
10             1.1.6    False            False  
11   corr_bulk_0.0.1    False             True  
12             1.2.1    False            False  
13   corr_bulk_0.0.1    False            False  
14          24.5.2a6    False            False  
15             1.2.0    False            False  
16   corr_bulk_0.0.1    False            False  
17          24.5.2a6    False            False  
18   corr_bulk_0.0.1    False            False  
19             1.1.6    False            False  

[20 rows x 22 columns]]",,10.8401939868927,2025-05-19T18:59:53,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,2,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.6825480461120605,2025-04-29T13:24:24,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF21abbsymk        34      2011  58280.500000  60051.500000       True   
1   ZTF21aafeydh        34      2034  58355.250000  59790.500000       True   
2   ZTF20acwvodj        62       320  58197.141921  59194.358426       True   
3   ZTF19aawbzwg        72      1134  58580.416389  58660.247940       True   
4   ZTF18aanksnk        49      6933  58230.500000  59805.250000       True   
5   ZTF18acszayr       117      1128  58456.250000  59844.500000       True   
6   ZTF18abdguwl        49      2578  58198.381887  60449.281447       True   
7   ZTF20abwogqo       118       776  58350.436250  59086.379039       True   
8   ZTF18abiebsl        58      3840  58230.250000  60105.500000       True   
9   ZTF18aaaepiv       791      3153  58131.250000  60214.500000       True   
10  ZTF22aaflxye       102      1279  58940.500000  60206.250000       True   
11  ZTF18adaahag       151      2147  58336.327222  60358.205683       True   
12  ZTF19acxsitl        38      3310  58669.500000  60097.500000       True   
13  ZTF19abuzodx       183      1709  58476.250000  59840.500000       True   
14  ZTF19aazprul       134      1902  58648.474514  60802.451817      False   
15  ZTF18abwbokd        80       306  58132.175891  59265.227824       True   
16  ZTF20aafzpej       126      1066  58581.199861  59319.206377       True   
17  ZTF19aapwyrs       264      1331  58585.148461  60374.251979       True   
18  ZTF18aajgxgt        35      4042  58173.250000  60263.500000       True   
19  ZTF22aajujpa       361      3484  58430.256539  60445.484456       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    20 -0.235720      0.414877  ...  268.135959  18.382669   
1     False     4  3.647000      0.667398  ...    4.713160  22.326154   
2     False     8  0.181711     75.954360  ...   86.247999   1.286262   
3      True     8  1.092201     -0.064029  ...  251.808678  31.096111   
4     False    10  1.657614      0.400761  ...  259.215043  50.675976   
5     False    30 -0.170967     -0.151461  ...   35.290823  -4.073259   
6     False    11  1.635027      0.389000  ...  206.716105  48.782776   
7     False    23  0.409399     77.873215  ...    2.084461  29.753393   
8     False    24  1.501381      1.013175  ...  265.461935  79.309142   
9     False   205  0.262200      0.217979  ...   17.005786  36.889158   
10    False    15  0.408000      0.427299  ...  270.402037  81.474921   
11    False    71  0.601494      1.088302  ...   17.704598  64.538171   
12    False    11  3.278239      1.122836  ...    8.833181  44.078993   
13    False    15 -0.061553     -0.494674  ...   83.157856 -20.678665   
14    False    47  2.220338      1.685870  ...  291.340716   0.556162   
15     True    22 -0.065558      0.206303  ...   81.949315  51.043655   
16    False    22  0.274275     77.332480  ...  126.830424  53.197238   
17    False    35  0.330499     77.696556  ...  125.202104 -19.755026   
18    False     9  1.783101      0.971267  ...  170.363794  43.875454   
19    False    58  0.418700      0.618652  ...   11.230420  51.180805   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000034  0.000045   729.030556  59322.436146  60051.466701   
1   0.000057  0.000143   564.204271  59226.199028  59790.403299   
2   0.000186  0.000055    29.017072  59165.341354  59194.358426   
3   0.000091  0.000058    43.796018  58616.451921  58660.247940   
4   0.000144  0.000123  1549.902743  58255.320961  59805.223704   
5   0.000021  0.000035  1388.179988  58456.220949  59844.400937   
6   0.098647  0.065000  2146.075671  58303.205775  60449.281447   
7   0.000183  0.000088    26.935463  59059.443576  59086.379039   
8   0.000406  0.000155  1670.279178  58435.102824  60105.382002   
9   0.000139  0.000106  1847.060324  58367.407616  60214.467940   
10  0.000350  0.000069   496.785405  59709.414699  60206.200104   
11  0.106911  0.045962  2009.707095  58354.429421  60364.136516   
12  0.000210  0.000163  1269.265382  58828.205255  60097.470637   
13  0.000170  0.000109  1116.987072  58723.480787  59840.467859   
14  0.010506  0.010506  2153.977303  58648.474514  60802.451817   
15  0.000081  0.000054   889.753634  58375.474190  59265.227824   
16  0.000147  0.000048   466.780081  58852.426296  59319.206377   
17  0.045158  0.042500  1789.103519  58585.148461  60374.251979   
18  0.000068  0.000079  1701.094757  58562.374340  60263.469097   
19  0.055357  0.034701   737.000162  59708.484294  60445.484456   

        step_id_corr  diffpos reference_change  
0              1.1.6    False            False  
1                dev    False            False  
2    corr_bulk_0.0.1    False            False  
3    corr_bulk_0.0.1    False            False  
4                dev    False            False  
5                dev    False            False  
6             24.4.1    False            False  
7    corr_bulk_0.0.1    False            False  
8              1.2.0    False            False  
9              1.2.1    False             True  
10             1.2.1    False            False  
11             1.2.0    False            False  
12             1.2.0    False            False  
13               dev    False            False  
14            27.5.6     True            False  
15  correction_0.0.1    False             True  
16  correction_0.0.1    False            False  
17             1.1.6    False            False  
18             1.2.1    False            False  
19            24.4.1    False            False  

[20 rows x 22 columns]]",,10.323090553283691,2025-05-19T19:00:15,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,3,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,6.398391962051392,2025-04-29T13:24:31,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF22aajujpa       361      3484  58430.256539  60445.484456       True   
1   ZTF19acmbcgx        81      1150  58737.500000  59934.500000       True   
2   ZTF18acefwkh       297      1100  58425.498576  59640.254954       True   
3   ZTF20aarbmlm        77      1502  58427.000000  60134.500000       True   
4   ZTF18aaxzepi        51      1359  58274.250000  59888.500000       True   
5   ZTF19aayaopt        62      1585  58641.250000  60233.250000       True   
6   ZTF18abewcqj        60      2199  58306.250000  60133.250000       True   
7   ZTF19aapgctb        59       561  58581.250000  60118.250000       True   
8   ZTF21aagtxlq        53      1381  59248.549676  60472.335220       True   
9   ZTF20acqobrz       435      1516  58317.250000  60253.000000       True   
10  ZTF18adbpcse        35      1861  58436.250000  59888.500000       True   
11  ZTF18abblrzr        48      3610  58285.396088  60510.283021       True   
12  ZTF19acecxgp       121      3831  58104.250000  59994.250000      False   
13  ZTF18ablrope       318      1722  58285.250000  60260.000000       True   
14  ZTF18acawjng       553      1455  58262.334329  60477.354942       True   
15  ZTF18abwtecp        32      1714  58377.491933  60327.123785       True   
16  ZTF21aagtyzx        74      2339  58667.230313  60501.271991       True   
17  ZTF18acjrmsw        53      1563  58316.500000  60102.500000       True   
18  ZTF18ablwqer       505      1258  58262.250000  59804.250000       True   
19  ZTF20ableiki       172      1539  58316.466701  60450.479653       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    58  0.418700      0.618652  ...   11.230420  51.180805   
1     False    15 -0.208979     77.727745  ...  108.946478  -5.274028   
2     False    84  1.229800      0.619238  ...  136.894684  16.105116   
3     False    47  1.208166      1.427671  ...  271.291461  26.994120   
4     False    22  3.305486      0.583720  ...  194.360219  18.364016   
5     False    25  1.089740      0.932570  ...  267.955166   0.692657   
6     False    23  1.109010      1.224368  ...  259.141419 -14.221421   
7     False    36 -0.824274      0.321208  ...  206.229505 -19.557188   
8     False    13  1.720462      2.146849  ...  262.326854 -20.241017   
9     False    39  0.298000      0.264553  ...  271.787220   1.498734   
10    False     5  2.617142      0.552524  ...  114.388443   8.053682   
11    False    15 -0.994886      0.200681  ...  277.596055   7.011013   
12    False    46  1.443400      0.523915  ...   15.727227  41.129540   
13    False   197  0.743700      1.136454  ...  279.046897  12.314341   
14    False    24  0.207300      0.813019  ...  261.935738 -15.543900   
15    False    19  2.643218      0.675603  ...   72.126413  49.312345   
16    False    26  1.559071      2.051414  ...  263.065644  -8.725485   
17    False    22 -0.451294      0.449581  ...   16.049766  33.029649   
18    False    96  2.404054      2.198671  ...  263.389452 -16.713573   
19    False    97 -0.311800     -0.034497  ...   19.206244  35.058884   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.055357  0.034701   737.000162  59708.484294  60445.484456   
1   0.000137  0.000092  1174.922222  58759.478310  59934.400532   
2   0.000056  0.000049  1214.756377  58425.498576  59640.254954   
3   0.000094  0.000070  1229.902593  58904.534942  60134.437535   
4   0.000062  0.000066  1614.356389  58274.194271  59888.550660   
5   0.000075  0.000096  1292.646308  58940.482176  60233.128484   
6   0.000070  0.000126  1486.917211  58646.272535  60133.189745   
7   0.000155  0.000133  1536.858160  58581.361204  60118.219363   
8   0.090595  0.085000  1223.785544  59248.549676  60472.335220   
9   0.000138  0.000072  1001.565509  59251.548796  60253.114306   
10  0.000100  0.000060  1345.205174  58543.235278  59888.440451   
11  0.085640  0.085000  2224.886933  58285.396088  60510.283021   
12  0.000125  0.000122  1243.775093  58750.368391  59994.143484   
13  0.000070  0.000050  1923.863889  58336.248982  60260.112870   
14  0.041965  0.040430  1509.937986  58967.416956  60477.354942   
15  0.079200  0.051633  1949.631852  58377.491933  60327.123785   
16  0.052238  0.051633  1252.721852  59248.550139  60501.271991   
17  0.000157  0.000086  1667.234479  58435.227222  60102.461701   
18  0.000061  0.000056  1466.013600  58338.169630  59804.183229   
19  0.031309  0.025628  1426.094850  59024.384803  60450.479653   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1              1.1.6    False            False  
2   correction_1.0.6    False            False  
3              1.2.0    False            False  
4              1.1.6    False            False  
5              1.2.1    False            False  
6              1.2.0    False            False  
7              1.2.0     True            False  
8             24.5.1    False            False  
9              1.2.1    False            False  
10             1.1.6    False            False  
11          24.5.2a6    False            False  
12             1.1.6    False            False  
13             1.2.1    False            False  
14            24.5.1    False            False  
15             1.2.0    False            False  
16          24.5.2a6    False            False  
17             1.2.0    False            False  
18               dev    False            False  
19            24.4.1    False            False  

[20 rows x 22 columns]]",,11.345808029174805,2025-05-19T19:00:35,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,4,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.61173152923584,2025-04-29T13:24:35,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20ableiki       172      1539  58316.466701  60450.479653       True   
1   ZTF19aavkbvf       155      1250  58457.250000  59982.250000       True   
2   ZTF19aaxabzt       506      2483  58305.289051  60489.333947       True   
3   ZTF18adbccia       469      2037  58101.250000  59957.250000       True   
4   ZTF18acmfwdh        36       784  58436.226401  59278.140197      False   
5   ZTF19aaxmhby       111      1039  58639.250000  60078.500000       True   
6   ZTF21aallixp      1287      2177  58305.428113  60351.132465       True   
7   ZTF18abnouva        64      1398  58348.197581  60477.354942       True   
8   ZTF18abvoogq        65      3338  58315.375058  60537.269583       True   
9   ZTF18acavimk       655      1415  58292.293472  60468.395949       True   
10  ZTF18acaxmln       392      1463  58286.313924  60489.334421       True   
11  ZTF18acosffu        78      1855  58461.000000  60238.250000       True   
12  ZTF19aaqkvbz        30      1891  58294.333785  60408.450532       True   
13  ZTF18abtceon        66      4245  58078.000000  60125.500000       True   
14  ZTF18abcgqep        51      2023  58288.500000  60258.250000       True   
15  ZTF18adbpzgo        93      1997  58102.500000  60043.250000       True   
16  ZTF18abyqjux        37      2713  58221.198148  60340.284306       True   
17  ZTF21aaguwxb        76       622  58694.487442  59249.202164       True   
18  ZTF20acwriph       297      1984  58262.500000  60213.250000       True   
19  ZTF18aafsato        40      1473  58428.520567  60433.197373       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    97 -0.311800     -0.034497  ...   19.206244  35.058884   
1     False    89  1.018800      1.179106  ...   14.232525  51.303935   
2     False    62  2.152600      1.903691  ...  266.179107 -16.028483   
3     False    31  0.699800      0.754663  ...   13.331645  61.292394   
4     False    20  4.069494      0.864146  ...   65.251799  31.814934   
5     False    26  1.549129      2.589582  ...  267.255095 -10.427934   
6     False   686  1.673800      2.537091  ...   23.264771  60.032629   
7     False    22  2.329411      2.196528  ...  262.044402 -20.169794   
8     False    28  1.254308      1.577215  ...  290.722982  22.408873   
9     False    77 -0.222100      0.466880  ...  261.783349 -18.317395   
10    False    52  0.390794      0.895864  ...  262.694268 -15.877352   
11    False    52  0.214960      0.611886  ...  331.727733  50.988168   
12    False    12  2.282685      1.770202  ...  295.821499  16.140070   
13    False    29  0.478497      0.894048  ...  326.407620  50.807401   
14    False    31  1.285670      0.630700  ...  280.319809   7.496416   
15    False     8  1.602573      0.430442  ...  114.366016   8.164624   
16    False    16  2.083524      0.702302  ...  104.467190  72.019214   
17    False     4  1.088413     76.235344  ...   56.026131   9.004748   
18    False    49  0.776200      0.904213  ...  298.336277  -7.152362   
19     True     6 -0.215692     -1.041856  ...  126.265667  13.089080   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.031309  0.025628  1426.094850  59024.384803  60450.479653   
1   0.000178  0.000101  1316.732049  58665.451759  59982.183808   
2   0.037010  0.035571  1852.020660  58637.313287  60489.333947   
3   0.000242  0.000104   709.022998  59248.160347  59957.183345   
4   0.000155  0.000150   841.913796  58436.226401  59278.140197   
5   0.000108  0.000090  1313.327512  58765.107095  60078.434606   
6   0.042200  0.021079  2041.689954  58322.490521  60364.180475   
7   0.090553  0.085000  2129.157361  58348.197581  60477.354942   
8   0.065013  0.060104  2163.098530  58374.171053  60537.269583   
9   0.022920  0.021759  1480.994769  58987.401181  60468.395949   
10  0.026841  0.025817  1240.784745  59248.549676  60489.334421   
11  0.000092  0.000080  1630.755081  58607.426134  60238.181215   
12  0.088488  0.085000  1823.966030  58584.484502  60408.450532   
13  0.000082  0.000103  1760.134514  58365.290486  60125.425000   
14  0.000109  0.000093  1969.764826  58288.377407  60258.142234   
15  0.000071  0.000112  1160.074954  58883.212025  60043.286979   
16  0.210562  0.065000  1911.961551  58428.322755  60340.284306   
17  0.000139  0.000130    26.014248  59223.187917  59249.202164   
18  0.000069  0.000105   891.698982  59321.491331  60213.190313   
19  0.066734  0.065000  2004.676806  58428.520567  60433.197373   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1              1.1.6    False            False  
2           24.5.2a6    False            False  
3              1.1.6    False            False  
4   correction_0.0.1    False            False  
5              1.2.0    False            False  
6              1.1.6    False            False  
7             24.5.1    False            False  
8           24.5.2a6    False            False  
9             24.5.1    False            False  
10          24.5.2a6    False            False  
11             1.2.1    False            False  
12             1.1.6    False            False  
13             1.2.0    False            False  
14             1.2.1    False            False  
15             1.1.6    False            False  
16             1.1.6    False            False  
17  correction_0.0.1    False            False  
18             1.2.1    False            False  
19            24.4.1    False             True  

[20 rows x 22 columns]]",,8.461713790893555,2025-05-19T19:00:50,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,5,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.773942232131958,2025-04-29T13:24:38,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aafsato        40      1473  58428.520567  60433.197373       True   
1   ZTF23aajhhog       144       682  58487.500000  60077.250000       True   
2   ZTF19aaeounf       560      1844  58236.459641  60396.436424       True   
3   ZTF19abapmmk       352      1366  58277.377280  60498.210069       True   
4   ZTF20abgjgkd        98      5948  58232.414745  60404.386632       True   
5   ZTF20aakzdyt       929      2346  58156.500000  59729.500000       True   
6   ZTF19abxfkdk        31       921  58709.250000  59727.250000       True   
7   ZTF19aapgais       245      3005  58581.341412  60477.387662       True   
8   ZTF21aaxiygn       205      2099  58306.250000  60135.250000       True   
9   ZTF20acutajd       106       965  58288.250000  60119.250000      False   
10  ZTF18aajbpbw       700      2873  58198.442338  60389.510058       True   
11  ZTF19abyaelz       117      1275  58574.460243  60477.335243       True   
12  ZTF18aamsimy       132      6514  58129.500000  60111.250000       True   
13  ZTF19abbatjm       121      2107  58581.444352  60537.267685       True   
14  ZTF19aayuqjr        56      1667  58432.000000  60209.250000       True   
15  ZTF20aaigiic       188      3281  58277.250000  60222.250000      False   
16  ZTF21aalnivw        57       402  58568.250000  60100.250000       True   
17  ZTF19aayqxyw        44      1282  58304.250000  59727.500000       True   
18  ZTF21aagzdrx       210      1895  58350.250000  60032.500000      False   
19  ZTF20aaeikta      1027      2308  58315.188843  60291.452083       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True     6 -0.215692     -1.041856  ...  126.265667  13.089080   
1     False    12  0.476488     79.178986  ...  160.510420 -20.321246   
2     False   184  0.547868      0.453262  ...  270.516316   7.135130   
3     False   135  0.309800      0.119472  ...  253.866821 -25.362358   
4     False    48  0.158000      0.335176  ...  237.685177  58.402840   
5     False    42  0.199600      0.288499  ...  215.917955  46.597132   
6     False    10  0.187508      0.463919  ...  257.863655  84.415097   
7     False    87  0.071800      0.010857  ...  270.601804  52.303892   
8     False    53  2.350100      1.799002  ...  259.551617 -20.558018   
9     False    45  2.821868      1.756035  ...  210.484026   5.912937   
10    False   150  0.337057      0.643453  ...  270.058301  43.231621   
11    False    52  1.320142      1.919491  ...  264.967557  -9.090238   
12    False    37  0.668707      0.946496  ...  185.746674  51.211552   
13    False    39  2.366435      2.415442  ...  270.354330  -5.755360   
14    False    22  0.510297      0.729903  ...  283.541388  28.229013   
15    False    30  0.397714     -1.787030  ...  285.384143  15.693638   
16    False    30  0.279200      0.198516  ...  192.751772 -19.991689   
17    False     8  1.467206      1.290780  ...  279.441993   7.467494   
18    False    11  0.739626     81.905730  ...  293.111287   9.342187   
19    False   390  0.372500      0.177019  ...  194.627891  66.424211   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  step_id_corr  \
0   0.066734  0.065000  2004.676806  58428.520567  60433.197373        24.4.1   
1   0.000122  0.000050    27.977384  60049.210417  60077.187801         1.2.0   
2   0.020118  0.019963  2067.220266  58337.207535  60404.427801         1.1.6   
3   0.022110  0.019979  1802.991192  58695.218877  60498.210069      24.5.2a6   
4   0.124059  0.065000  1395.165394  59009.221238  60404.386632         1.2.1   
5   0.000103  0.000091   853.858414  58875.530382  59729.388796         1.1.2   
6   0.001550  0.000108  1018.153113  58709.196701  59727.349815         1.1.2   
7   0.023861  0.014590  1156.939873  59320.447789  60477.387662        24.5.1   
8   0.000084  0.000089   812.793322  59322.438565  60135.231887         1.2.0   
9   0.000058  0.000076   933.648009  59185.556782  60119.204792         1.2.0   
10  0.116663  0.085000  2142.099526  58247.410532  60389.510058         1.1.6   
11  0.086081  0.085000  1742.100255  58735.234988  60477.335243        24.5.1   
12  0.000130  0.000055  1826.059583  58285.180336  60111.239919         1.2.0   
13  0.085431  0.085000  1544.848727  58992.418958  60537.267685      24.5.2a6   
14  0.000067  0.000060  1570.867639  58638.297558  60209.165197         1.2.1   
15  0.000156  0.000082  1177.923877  59044.246493  60222.170370         1.2.1   
16  0.000114  0.000118   842.812303  59257.380463  60100.192766         1.2.0   
17  0.000072  0.000055   477.822778  59249.572002  59727.394780         1.1.2   
18  0.000157  0.000064   783.882951  59248.565093  60032.448044         1.1.6   
19  0.078018  0.031204  1806.984190  58508.487292  60315.471482         1.2.0   

    diffpos reference_change  
0     False             True  
1     False            False  
2     False            False  
3     False            False  
4     False            False  
5     False            False  
6     False            False  
7     False            False  
8     False            False  
9      True            False  
10    False            False  
11    False            False  
12    False            False  
13    False            False  
14    False            False  
15    False            False  
16    False            False  
17    False            False  
18    False            False  
19    False            False  

[20 rows x 22 columns]]",,8.831696033477783,2025-05-19T19:01:04,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,6,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.7577598094940186,2025-04-29T13:24:42,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20aaeikta      1027      2308  58315.188843  60291.452083       True   
1   ZTF21aalnjow       257      4122  58227.250000  59884.500000      False   
2   ZTF18acbwejf       381      2422  58199.250000  60092.250000       True   
3   ZTF18aakikcc        52      2861  58210.250000  60077.500000       True   
4   ZTF18acnixqh        67      1734  58438.237349  60499.361053       True   
5   ZTF18aberniu        37      2966  58231.250000  60188.250000       True   
6   ZTF20abzghri       159      2676  58493.500000  60086.250000       True   
7   ZTF20ablxsmj       183      2622  58340.500000  60108.500000       True   
8   ZTF19aavufqq       100      4978  58219.382824  60314.560822       True   
9   ZTF19aclkiuy       143      2110  58361.348426  60439.485937       True   
10  ZTF19abnhwxi        32      2044  58426.318044  60287.213056       True   
11  ZTF18aaufukx        87      3924  58230.376447  60391.488380       True   
12  ZTF19abotmya       238      2753  58350.401065  59250.183819       True   
13  ZTF19adcfssu       115      1839  58846.547535  60407.321100       True   
14  ZTF19aagymye       173      2268  58310.500000  60231.250000       True   
15  ZTF19adbgham        70      2042  58488.158773  60533.277604       True   
16  ZTF18achjwai       120      3306  58434.198623  60471.479630       True   
17  ZTF19aalzvll       194      2105  58314.207512  60475.339352       True   
18  ZTF18absrsaz       145      3140  58365.171111  60457.416482       True   
19  ZTF21aahakoa        32       329  58757.387465  59275.236458      False   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False   390  0.372500      0.177019  ...  194.627891  66.424211   
1     False    21 -0.380174      0.497143  ...  185.950327  60.782300   
2     False   168  1.925447      1.323786  ...  168.895107  73.492227   
3     False    11  1.485565      0.932808  ...  224.702311  57.357290   
4     False    31  1.158245      0.891826  ...  317.981836  15.563255   
5     False     8  2.430750      0.355979  ...  246.070099  25.987752   
6     False    33  1.737538      0.816232  ...  256.898203  15.369127   
7     False    84  0.911100      1.101458  ...   25.823594  51.234688   
8     False    13  0.398999      0.363801  ...  261.761573  22.433617   
9     False   113  1.204000      0.693629  ...   16.312307  45.578659   
10    False    18  0.965353      0.510359  ...   14.784612  45.422853   
11    False    12 -0.666815      0.179893  ...  262.606349  25.266967   
12    False    12  0.750952     78.206870  ...    4.007761  44.241056   
13    False    20 -0.388900      0.812542  ...  192.765704  18.596720   
14    False    99  0.451476      0.615650  ...   33.729373  68.049259   
15    False    38  1.089382      0.592404  ...    9.549451  49.873283   
16    False    42  2.960479      1.200307  ...   35.158401  27.436239   
17    False    63  0.444544      0.653499  ...  243.341923  28.529721   
18    False    88  0.289068      0.812259  ...  270.872148   1.429814   
19    False     7  0.565755     76.876010  ...   84.509894 -10.010809   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.078018  0.031204  1806.984190  58508.487292  60315.471482   
1   0.000161  0.000073   621.155440  59263.362014  59884.517454   
2   0.000476  0.000102  1536.146979  58556.219641  60092.366620   
3   0.000205  0.000101  1607.880266  58469.506505  60077.386771   
4   0.067474  0.065000  2061.123704  58438.237349  60499.361053   
5   0.000095  0.000092  1311.680648  58876.537627  60188.218275   
6   0.000111  0.000111   869.726898  59216.560197  60086.287095   
7   0.000191  0.000072  1063.002269  59045.457766  60108.460035   
8   0.091959  0.085000  1358.098750  58956.462072  60314.560822   
9   0.121441  0.085000  1678.202975  58761.282963  60439.485937   
10  0.092610  0.065000  1538.952824  58748.260232  60287.213056   
11  0.071877  0.065000  1395.155463  58996.332917  60391.488380   
12  0.000186  0.000075   525.778750  58724.405069  59250.183819   
13  0.039595  0.037528  1560.773565  58846.547535  60407.321100   
14  0.000125  0.000044  1717.193993  58514.139768  60231.333762   
15  0.080116  0.051633  1702.159815  58831.117789  60533.277604   
16  0.095772  0.085000  2037.281007  58434.198623  60471.479630   
17  0.025620  0.022509  1927.820741  58547.518611  60475.339352   
18  0.024575  0.024568  2092.245370  58365.171111  60457.416482   
19  0.000261  0.000053    51.031435  59224.205023  59275.236458   

        step_id_corr  diffpos reference_change  
0              1.2.0    False            False  
1              1.1.6    False            False  
2              1.2.0    False            False  
3              1.2.0    False            False  
4           24.5.2a6    False            False  
5              1.2.0    False            False  
6              1.2.0     True            False  
7              1.2.0    False            False  
8              1.1.2    False            False  
9             24.4.1    False            False  
10             1.2.1     True            False  
11             1.2.0    False            False  
12  correction_0.0.1    False            False  
13             1.1.6    False            False  
14             1.2.1    False            False  
15          24.5.2a6    False            False  
16            24.5.1    False             True  
17            24.5.1    False            False  
18            24.4.1    False            False  
19  correction_0.0.1    False            False  

[20 rows x 22 columns]]",,8.865797281265259,2025-05-19T19:01:18,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,7,"
SELECT *
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.3424723148345947,2025-04-29T13:24:45,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF21aahakoa        32       329  58757.387465  59275.236458      False   
1   ZTF20aapcvoy       800      1521  58255.500000  59729.500000      False   
2   ZTF18aakvizj       232      2913  58198.500000  60221.250000       True   
3   ZTF20aakgxqz       174      2004  58482.250000  60241.500000      False   
4   ZTF21aahcfdj       131       454  58584.154641  59250.294688      False   
5   ZTF19aaxmmmu       504      1320  58511.557662  60515.362049       True   
6   ZTF20aahhlim       644      1702  58236.480023  60522.286123       True   
7   ZTF19aavqxuv       212      2319  58487.531632  60409.160556       True   
8   ZTF20aaevszk       162      2521  58208.329919  60463.300937       True   
9   ZTF19aadeivy       283      1954  58461.537836  60411.263542       True   
10  ZTF18aahvcfz       544      2022  58186.351921  60411.326597       True   
11  ZTF20acyrobv       100       871  58274.366667  60390.448264       True   
12  ZTF18aatiprs        85      4008  58288.250000  60172.250000       True   
13  ZTF18acvwcss       667      1657  58272.250000  60093.250000       True   
14  ZTF19aagcfhu        34       421  58512.500000  59727.250000       True   
15  ZTF21abbeydz       114       548  58547.335486  60353.442431       True   
16  ZTF20abizesw       619      2411  58203.502755  60319.562222      False   
17  ZTF20abaknmy       310      3193  58726.166065  60458.270475       True   
18  ZTF18abkaswe        71      4752  58328.324410  60485.247535       True   
19  ZTF18ackauna       129      3693  58370.311991  60443.486146       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False     7  0.565755     76.876010  ...   84.509894 -10.010809   
1     False   181  0.793287      0.760947  ...  292.297467  54.516061   
2     False    55  0.575790      1.056617  ...  232.497049  34.899619   
3     False    24  0.006401      0.105709  ...  114.421812   1.054106   
4     False    10  0.188700     -0.744321  ...  132.290236   1.456486   
5     False   127  1.719800      1.879278  ...  263.509240 -13.003647   
6     False    68  1.937900      1.994533  ...  274.981929   3.978258   
7     False    32 -0.370459     -0.003785  ...  186.202009  29.457938   
8     False    33  0.284794      0.379422  ...  191.185539  66.930591   
9      True    76  0.568200      0.764197  ...  175.401831  24.727747   
10    False   198  0.952500     78.292950  ...  188.283962  12.184121   
11    False    28  1.606600      0.824847  ...  211.575465  -5.085881   
12    False    30  0.432491      0.224669  ...  229.728121   8.150620   
13    False   307  0.864200      0.420913  ...  193.287620  19.134996   
14    False    22  0.472603      0.672905  ...  208.413783 -17.782275   
15    False    37  0.674718     77.014565  ...  190.162557 -12.581958   
16    False    50  0.748540      0.469860  ...  269.987736  20.355668   
17    False    87  0.048600     -0.997133  ...  232.784789  10.699953   
18    False    46 -0.066345      0.429815  ...  286.487176  79.986013   
19    False    28  1.602700      1.186796  ...   12.029614  29.929498   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000261  0.000053    51.031435  59224.205023  59275.236458   
1   0.000206  0.000048   830.923785  58898.527836  59729.451620   
2   0.000094  0.000064  1255.730474  58965.404664  60221.135139   
3   0.000179  0.000074  1377.280544  58864.191690  60241.472234   
4   0.000129  0.000067    29.952026  59220.342662  59250.294688   
5   0.020998  0.020459  1872.045625  58643.316424  60515.362049   
6   0.021321  0.021270  1258.756354  59263.529769  60522.286123   
7   0.097621  0.085000  1580.609016  58828.551539  60409.160556   
8   0.131769  0.051633  1609.770660  58853.530278  60463.300937   
9   0.006231  0.005659  1924.779560  58486.483981  60411.263542   
10  0.034320  0.033547  2169.074248  58242.252350  60411.326597   
11  0.065257  0.065000  1204.882558  59185.565706  60390.448264   
12  0.000119  0.000123  1632.802430  58539.372384  60172.174815   
13  0.000055  0.000056  1644.805949  58448.512986  60093.318935   
14  0.000159  0.000144  1214.771898  58512.502535  59727.274433   
15  0.052904  0.051633  1032.190556  59321.251875  60353.442431   
16  0.090662  0.085000  1307.247720  59012.312049  60319.559768   
17  0.020573  0.020215  1493.912025  58964.358449  60458.270475   
18  0.296932  0.051633  2016.091632  58469.155903  60485.247535   
19  0.049040  0.042500  2008.218565  58435.267581  60443.486146   

        step_id_corr  diffpos reference_change  
0   correction_0.0.1    False            False  
1              1.1.2     True            False  
2              1.2.1     True            False  
3              1.2.1    False            False  
4   correction_0.0.1    False            False  
5           24.5.2a6    False            False  
6           24.5.2a6    False            False  
7             24.4.1    False            False  
8             24.5.1    False            False  
9             24.4.1    False            False  
10            24.4.1    False            False  
11             1.2.0     True            False  
12             1.2.0    False            False  
13             1.2.0    False            False  
14             1.1.2    False             True  
15             1.2.0    False            False  
16               dev    False            False  
17            24.4.1    False            False  
18            24.5.1    False             True  
19            24.4.1    False            False  

[20 rows x 22 columns]]",,9.148213148117065,2025-05-19T19:01:32,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,8,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.695644855499268,2025-04-29T13:24:48,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18ackauna       129      3693  58370.311991  60443.486146       True   
1   ZTF19aacnjtf        62      2139  58316.376887  60470.421123       True   
2   ZTF20abgboeg       471      2294  58271.453843  60537.301979       True   
3   ZTF21aahfskh        64      1162  59156.080451  60398.446678       True   
4   ZTF23aajhxfi        68       870  58487.500000  60077.250000      False   
5   ZTF19abdfryq        49      1835  58344.155926  60531.271030       True   
6   ZTF18abjxlgk        32      5596  58307.500000  60258.250000       True   
7   ZTF19abchlps       203      1199  58262.400313  60448.356620       True   
8   ZTF20acpbpwj        51       828  58376.211505  59250.554306       True   
9   ZTF18abrrkzm        33      4608  58285.500000  60090.500000       True   
10  ZTF20aauiarr       586      1716  58208.500000  60118.500000      False   
11  ZTF21abbdakp       292      3099  58235.405822  60500.330231       True   
12  ZTF20aayukuv        61      2386  58436.086134  60519.269271       True   
13  ZTF20aahgkxg       448      2200  58441.500000  59914.500000      False   
14  ZTF18abmroct        32      1886  58344.250000  60223.250000       True   
15  ZTF18aaznyge        53       488  58274.250000  60117.250000       True   
16  ZTF20aahbgqk       150       924  58450.250000  60223.500000       True   
17  ZTF17aadhkqv        41      1222  58045.355474  60293.393241       True   
18  ZTF21aalpegm        91      1019  58461.072905  59540.128970       True   
19  ZTF20aajnkgx       209      1060  58609.184838  59319.196921       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    28  1.602700      1.186796  ...   12.029614  29.929498   
1     False    41  0.151506      0.461330  ...  309.050701  21.487981   
2     False   222  0.704000      0.880189  ...  306.996741  41.004444   
3     False    23  1.480300      2.095955  ...  266.590673 -11.249207   
4     False     9  0.727400     77.590250  ...  185.325293 -13.201318   
5     False    14  0.890777      1.721743  ...  267.553580   0.756131   
6     False    30  0.666872      0.735382  ...  296.892367  22.467456   
7     False    52  1.903624      2.195040  ...  267.747261 -12.460309   
8     False     6  1.385374      0.492860  ...  282.457289  18.205831   
9     False    13  3.139376      2.698915  ...  296.947165  22.684228   
10    False    26  1.797356      1.548181  ...  299.197738  32.714206   
11    False    60  0.127100      0.540191  ...  283.793045  31.938863   
12    False    44  1.345052      1.191026  ...  294.723159  10.465423   
13    False    67  0.402000      0.758766  ...  209.439772  61.681590   
14    False    15 -0.835414      0.685797  ...  293.933007  11.036380   
15    False    20  0.228157      0.279187  ...  203.288363  14.618605   
16    False    23  0.177572     77.935970  ...   74.712501   2.196279   
17    False    26  2.118752      0.994022  ...   73.072601  25.215768   
18    False     5  1.114335     79.876540  ...  296.211569   3.218260   
19    False    49  0.263290      0.289508  ...  128.457538  15.782134   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.049040  0.042500  2008.218565  58435.267581  60443.486146   
1   0.069855  0.065000  1637.297095  58833.124028  60470.421123   
2   0.058476  0.044129  1545.869653  58991.432326  60537.301979   
3   0.086665  0.085000  1149.887488  59248.559190  60398.446678   
4   0.000132  0.000094    26.937975  60050.291412  60077.229387   
5   0.085007  0.085000  1862.954664  58668.316366  60531.271030   
6   0.000236  0.000117  1951.803924  58306.339722  60258.143646   
7   0.021131  0.020633  1426.105556  59022.251065  60448.356620   
8   0.000172  0.000055   121.367523  59129.186782  59250.554306   
9   0.000140  0.000097   945.325660  59145.119664  60090.445324   
10  0.000153  0.000041  1177.914132  58940.487164  60118.401296   
11  0.039531  0.033547  1180.884410  59319.445822  60500.330231   
12  0.029288  0.028801  1350.109688  59169.159583  60519.269271   
13  0.000320  0.000072  1063.961319  58850.513762  59914.475081   
14  0.000113  0.000109  1878.795567  58344.349931  60223.145498   
15  0.000078  0.000074  1843.065671  58274.192396  60117.258067   
16  0.000148  0.000089  1362.215706  58861.190903  60223.406609   
17  0.044688  0.040430  1838.069930  58455.323310  60293.393241   
18  0.000152  0.000077   277.565868  59262.563102  59540.128970   
19  0.000052  0.000049   177.721968  59141.474954  59319.196921   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1             24.5.1    False            False  
2           24.5.2a6     True            False  
3              1.2.0    False            False  
4              1.2.0    False            False  
5           24.5.2a6    False            False  
6              1.2.1    False            False  
7             24.4.1    False            False  
8   correction_0.0.1    False            False  
9              1.2.0    False            False  
10             1.2.0    False            False  
11          24.5.2a6    False            False  
12          24.5.2a6     True            False  
13             1.1.6     True            False  
14             1.2.1    False            False  
15             1.2.0    False             True  
16             1.2.1    False            False  
17             1.2.0    False            False  
18  correction_1.0.6    False            False  
19  correction_0.0.1    False            False  

[20 rows x 22 columns]]",,8.831432580947876,2025-05-19T19:01:46,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,9,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.774667501449585,2025-04-29T13:24:52,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20aajnkgx       209      1060  58609.184838  59319.196921       True   
1   ZTF21aahjnem        37       630  58598.144884  59251.317002       True   
2   ZTF18adayxpb        88      1620  58102.563599  59511.484502       True   
3   ZTF19aauispm       317      2167  58596.213947  60323.477627       True   
4   ZTF19aarosyw       570      2533  58494.500000  60139.250000       True   
5   ZTF18acjsujp        96      1394  58435.250000  59991.250000       True   
6   ZTF21aahskci       145      1071  58693.500000  60168.500000       True   
7   ZTF19abjpeid       136      2185  58693.500000  59730.500000       True   
8   ZTF20acekugc        98       742  58735.460822  59518.321389       True   
9   ZTF21aaicdbk        84       345  58581.250000  59987.500000      False   
10  ZTF20aazplhp       322      2683  58898.500000  59730.250000       True   
11  ZTF20aaxwlqb        49      4133  58351.250000  60109.250000       True   
12  ZTF19acbjdjn       458      3670  58310.250000  59878.250000       True   
13  ZTF19abfykco        35      1320  58605.500000  60064.500000       True   
14  ZTF19acvuraq       109      2068  58814.073252  60535.249375       True   
15  ZTF21aahrfzz       231      1702  58244.500000  59727.500000       True   
16  ZTF20aczfxdh        40       276  59199.500000  59734.250000       True   
17  ZTF21aakhuvx       206      1427  58580.250000  59747.250000       True   
18  ZTF20aaivvio       470      1824  58430.404363  60352.191620       True   
19  ZTF20acueboq       799      1114  58262.438599  60460.395683       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    49  0.263290      0.289508  ...  128.457538  15.782134   
1     False     7  0.582535     77.443540  ...  125.501584 -19.486191   
2      True     9  2.200368      0.428563  ...  114.611057   8.186056   
3     False   120 -0.434100     -0.180450  ...  203.624527  33.712150   
4     False   137 -0.123400     -0.106477  ...  208.509374  49.346589   
5     False    21  0.819123      1.213975  ...   21.154943  53.351128   
6     False     8  0.550700     78.345470  ...   42.430810  16.707705   
7     False    60  0.740063      0.887031  ...   13.430963  56.493200   
8      True    44  0.467200     -0.026395  ...   61.883535  -4.777172   
9     False    11  0.389398      1.339739  ...  171.773916 -13.250664   
10    False    69 -0.097800      0.086738  ...  232.855080  38.039813   
11    False     9  0.765016      0.831749  ...  257.017968  49.193733   
12    False   124  0.020723      0.035398  ...  259.744476  52.115050   
13    False     6  0.978000      1.067626  ...  288.350681  24.372047   
14    False    17  1.049622      1.629036  ...  286.845988  -3.637429   
15    False    24  3.118100      2.700787  ...  288.769617  13.893385   
16    False    29 -0.013197      0.132982  ...  184.928690 -18.131691   
17    False    54  0.041172      0.074281  ...  189.526072  18.779478   
18    False   123 -0.013615     76.238914  ...   82.898262 -19.442268   
19    False    73  1.705600      1.945968  ...  297.239768  -7.027873   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000052  0.000049   177.721968  59141.474954  59319.196921   
1   0.000162  0.000140    28.862002  59222.455000  59251.317002   
2   0.000151  0.000129  1039.015660  58472.468843  59511.484502   
3   0.045114  0.037528  1727.263680  58596.213947  60323.477627   
4   0.000101  0.000053   962.708843  59176.512662  60139.221505   
5   0.000265  0.000102  1555.983900  58435.223391  59991.207292   
6   0.000212  0.000078   942.269468  59226.152593  60168.422060   
7   0.000188  0.000113  1038.027766  58693.435359  59731.463125   
8   0.000063  0.000066   426.884931  59091.436458  59518.321389   
9   0.000176  0.000032   760.914988  59226.483391  59987.398380   
10  0.000083  0.000050   505.817095  59224.547141  59730.364236   
11  0.000160  0.000036  1112.035891  58997.306192  60109.342083   
12  0.000097  0.000051  1135.031736  58743.153727  59878.185463   
13  0.000072  0.000036   811.916412  59252.551725  60064.468137   
14  0.085172  0.085000  1565.812801  58969.436574  60535.249375   
15  0.000196  0.000103   478.834444  59248.565093  59727.399537   
16  0.000090  0.000064   534.662836  59199.521250  59734.184086   
17  0.000047  0.000049   515.740764  59231.457280  59747.198044   
18  0.031064  0.029293  1489.042361  58863.149259  60352.191620   
19  0.025671  0.025478  1154.934653  59305.461030  60460.395683   

        step_id_corr  diffpos reference_change  
0   correction_0.0.1    False            False  
1   correction_0.0.1    False            False  
2   correction_1.0.6    False            False  
3              1.2.0    False            False  
4              1.2.0     True            False  
5              1.1.6     True            False  
6              1.2.0    False            False  
7              1.1.2    False            False  
8   correction_1.0.6    False            False  
9              1.1.6    False            False  
10             1.1.2     True            False  
11             1.2.0    False            False  
12             1.1.6     True            False  
13             1.2.0    False            False  
14          24.5.2a6    False            False  
15             1.1.2     True            False  
16             1.1.2     True            False  
17             1.1.2    False            False  
18             1.2.1    False            False  
19            24.5.1    False            False  

[20 rows x 22 columns]]",,9.08458662033081,2025-05-19T19:02:00,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,10,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.805142879486084,2025-04-29T13:24:55,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acueboq       799      1114  58262.438599  60460.395683       True   
1   ZTF21aaekhjs        41      1172  59224.500000  59775.250000       True   
2   ZTF18acukqiw        35      1081  58432.500000  60261.500000       True   
3   ZTF20acjeeyn       217      1199  58673.458438  60293.153009      False   
4   ZTF19acoseie       143      3093  58320.500000  60211.500000      False   
5   ZTF20abbufoh       184       631  58912.500000  59762.250000       True   
6   ZTF21aafdzgs        33      2200  59230.572627  60537.210486       True   
7   ZTF19aapbcpp       103      2418  58349.250000  59750.250000       True   
8   ZTF20aalrkip        37       882  58881.500000  60046.250000      False   
9   ZTF19aawgzeh       117      1186  58491.519444  59376.212523      False   
10  ZTF20abcehmj       471      3218  58582.500000  59818.250000       True   
11  ZTF20abcnrcb       461      2601  58378.250000  59765.250000       True   
12  ZTF19aaxtzgt       165      1272  58262.400313  60507.315880       True   
13  ZTF20aazpnry       361      4225  58962.500000  60140.250000       True   
14  ZTF21abpodbw       419      1549  58198.437072  60287.568102       True   
15  ZTF19aadtweu        50      3970  58503.514248  60485.253264       True   
16  ZTF19aaoufvz        30      3979  58344.161435  60485.253264       True   
17  ZTF21aaixmrm       585      2802  58708.500000  60259.500000      False   
18  ZTF20abiklyt        33       492  59026.250000  59730.250000       True   
19  ZTF21aaiyhhf       142      1023  58540.170926  60729.247292       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    73  1.705600      1.945968  ...  297.239768  -7.027873   
1     False    24  1.655409      0.730484  ...  217.581706  16.120818   
2     False     6  0.651367     80.451530  ...   96.052546   3.753080   
3     False    12  0.118675     75.922165  ...   47.763059  31.574372   
4     False    22  5.420400      3.305649  ...   58.541894  38.411996   
5     False    96 -0.233700     -0.073283  ...  244.553824  -1.421680   
6     False    15  0.115376      0.820736  ...  254.119540  -6.115996   
7     False    51  1.185334      1.377981  ...  280.862978  34.458112   
8     False    40  0.317700      0.395571  ...  213.464716   3.039474   
9     False    19  0.376184     -0.930030  ...  214.255787   1.051731   
10    False   118 -0.131314      0.138303  ...  259.791356  34.667055   
11    False   140 -0.875800     -0.374359  ...  257.384209  23.536976   
12    False    68  0.015075      0.629453  ...  268.722869 -13.202297   
13    False    65  0.723700      1.054375  ...  252.901147  48.987971   
14    False    31 -0.100199      0.193570  ...  228.817158  14.894802   
15    False    40  0.455012      0.568103  ...  250.226185   0.878285   
16    False    21  0.997650      0.850774  ...  250.331952   0.948658   
17    False    19  0.012900      0.217712  ...   73.561236  -6.243942   
18    False    20  2.566447      1.592867  ...  240.977530  -9.463199   
19    False    11  0.556541     79.417336  ...  116.633742 -20.141012   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.025671  0.025478  1154.934653  59305.461030  60460.395683   
1   0.000068  0.000061   547.714167  59227.499595  59775.213762   
2   0.000080  0.000032  1008.178623  59253.278137  60261.456759   
3   0.038147  0.032500  1181.777558  59111.375451  60293.153009   
4   0.000180  0.000112   985.265660  59226.213599  60211.479259   
5   0.000074  0.000064   795.832824  58966.376771  59762.209595   
6   0.085487  0.085000  1306.637859  59230.572627  60537.210486   
7   0.000060  0.000047  1169.850324  58580.488889  59750.339213   
8   0.000239  0.000047  1164.792361  58881.502315  60046.294676   
9   0.000101  0.000056   144.768495  59231.444028  59376.212523   
10  0.000066  0.000052   832.775799  58985.422974  59818.198773   
11  0.000082  0.000070   797.852558  58967.436285  59765.288843   
12  0.045327  0.044129  1866.961470  58640.354410  60507.315880   
13  0.000075  0.000050  1098.998646  59041.263912  60140.262558   
14  0.087955  0.085000   888.376887  59399.191215  60287.568102   
15  0.065008  0.065000  1981.739016  58503.514248  60485.253264   
16  0.065009  0.065000  1907.791076  58577.462188  60485.253264   
17  0.000125  0.000060  1035.164850  59224.233692  60259.398542   
18  0.000088  0.000096   704.019456  59026.254074  59730.273530   
19  0.022655  0.021270  1504.953762  59224.293530  60729.247292   

        step_id_corr  diffpos reference_change  
0             24.5.1    False            False  
1                dev    False            False  
2              1.2.1    False            False  
3    corr_bulk_0.0.1    False            False  
4              1.2.1    False            False  
5              1.1.2     True            False  
6           24.5.2a6     True            False  
7              1.1.2    False            False  
8              1.1.6    False            False  
9   correction_0.0.1    False            False  
10               dev    False            False  
11               dev     True            False  
12          24.5.2a6    False            False  
13             1.2.0    False            False  
14             1.2.0    False            False  
15            24.5.1    False            False  
16            24.5.1    False            False  
17             1.2.1    False            False  
18             1.1.2    False            False  
19            27.4.0    False            False  

[20 rows x 22 columns]]",,9.154317855834961,2025-05-19T19:02:15,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,78,0,"SELECT
    *
FROM
    taxonomy
WHERE
    classifier_name = 'lc_classifier'",,,,,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,3.457486867904663,2025-05-19T19:02:20,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,1,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.140097618103028,2025-04-29T13:24:57,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.943644046783447,2025-05-19T19:02:35,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,2,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.65638279914856,2025-04-29T13:25:00,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,8.062567472457886,2025-05-19T19:02:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,3,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.57718563079834,2025-04-29T13:25:03,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.844336748123169,2025-05-19T19:03:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,4,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.782160997390747,2025-04-29T13:25:06,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,8.32633113861084,2025-05-19T19:03:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,5,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.38597059249878,2025-04-29T13:25:09,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.970603942871094,2025-05-19T19:03:24,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,6,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.6676831245422363,2025-04-29T13:25:12,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,8.740212440490723,2025-05-19T19:03:37,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,7,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.6202428340911865,2025-04-29T13:25:16,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.929067850112915,2025-05-19T19:03:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,8,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.852095365524292,2025-04-29T13:25:19,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,8.043349742889404,2025-05-19T19:04:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,9,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.158719539642334,2025-04-29T13:25:22,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,8.165127992630005,2025-05-19T19:04:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,10,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.232168197631836,2025-04-29T13:25:24,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,8.684725999832153,2025-05-19T19:04:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,39,0,"SELECT
  sq.oid, sq.meanra, sq.meandec,
  detection.candid, detection.fid as f_id,detection.magpsf, detection.sigmapsf_corr, detection.sigmapsf_corr_ext
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier_stochastic'
    AND probability.class_name='CV/Nova'
    AND probability.ranking = 1
) AS sq
  INNER JOIN detection
  ON sq.oid = detection.oid
WHERE
  sq.ndet < 50
  AND detection.fid = 2
ORDER BY oid
LIMIT 1000
",,,,,"[              oid      meanra    meandec               candid  f_id  \
0    ZTF17aaaaanb  324.816860  45.593583   537475640115015008     2   
1    ZTF17aaaaanb  324.816860  45.593583   607270780115015027     2   
2    ZTF17aaaaanb  324.816860  45.593583   613325340115010003     2   
3    ZTF17aaaaanb  324.816860  45.593583   536383390115015014     2   
4    ZTF17aaaaanb  324.816860  45.593583   529390300115015005     2   
..            ...         ...        ...                  ...   ...   
995  ZTF17aaadgdr  116.399044  32.744831  1496215692515015015     2   
996  ZTF17aaadgdr  116.399044  32.744831  1563162532515010015     2   
997  ZTF17aaadgdr  116.399044  32.744831  1582202532515015009     2   
998  ZTF17aaadgdr  116.399044  32.744831  1563162532515020015     2   
999  ZTF17aaadgdr  116.399044  32.744831  1097435112515015025     2   

        magpsf  sigmapsf_corr  sigmapsf_corr_ext  
0    19.760700       0.021343           0.031418  
1    19.648392       0.026439           0.034795  
2    19.791729       0.025855           0.043814  
3    19.882864       0.022219           0.032339  
4    19.678644     100.000000           0.019559  
..         ...            ...                ...  
995  19.048782     100.000000           0.004847  
996  16.900568       0.001213           0.020301  
997  18.424658     100.000000           0.008501  
998  16.900600       0.001202           0.020300  
999  18.897345     100.000000           0.008676  

[1000 rows x 8 columns]]",,6.868046998977661,2025-05-19T19:04:35,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,39,1,"
WITH probability_filter AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
detection_r_band AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_r_band AS (
    SELECT oid, (magmax_corr - magmin_corr) AS max_rise
    FROM magstat
    WHERE fid = 2
)
SELECT o.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, m.max_rise
FROM object o
INNER JOIN probability_filter p ON o.oid = p.oid
INNER JOIN detection_r_band d ON o.oid = d.oid
INNER JOIN magstat_r_band m ON o.oid = m.oid
WHERE o.ndet <= 50
ORDER BY o.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,3337.5917880535126,2025-04-29T14:21:02,"[              oid               candid          ra        dec  magpsf_corr  \
0    ZTF17aaaeiey  2885158510215015004  330.679508  59.055687    16.763890   
1    ZTF17aaaeiey  2753365990215015010  330.679506  59.055684    16.678577   
2    ZTF17aaaeiey  2750406430215015009  330.679496  59.055695    16.434649   
3    ZTF17aaaeiey  2747369280215015008  330.679514  59.055682    15.784806   
4    ZTF17aaaeiey  2745411680215015016  330.679496  59.055681    15.836052   
..            ...                  ...         ...        ...          ...   
995  ZTF18aahwzxb  2981432390715015004  181.618881  30.247599    15.969115   
996  ZTF18aahwzxb  2480522580715010067  181.618750  30.247461    16.471304   
997  ZTF18aahwzxb  2480527410715010053  181.618739  30.247630    17.261583   
998  ZTF18aahwzxb  2480517730715015039  181.618858  30.247674    15.998968   
999  ZTF18aahwzxb  1750526750715015079  181.618671  30.247646    15.531468   

        magpsf  max_rise  
0    16.866314  0.000000  
1    16.772915  0.000000  
2    16.509335  0.000000  
3    15.825217  0.000000  
4    15.878455  0.000000  
..         ...       ...  
995  17.577915  1.730115  
996  18.080200  1.730115  
997  16.791960  1.730115  
998  17.715908  1.730115  
999  16.320255  1.730115  

[1000 rows x 7 columns]]",,30.22498846054077,2025-05-19T19:05:11,0.0,0.0,0.375,0.42857142857142855,0.0,0.0
0.16.3,gpt-4o,v1,39,2,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT o.oid
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.ndet <= 50
),
detection_subquery AS (
    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection d
    INNER JOIN object_subquery o ON d.oid = o.oid
    WHERE d.fid = 2
),
magstat_subquery AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    INNER JOIN object_subquery o ON m.oid = o.oid
    WHERE m.fid = 2
),
final_result AS (
    SELECT d.oid, d.candid, d.f_id, d.ra, d.dec, d.magpsf_corr, d.magpsf,
           (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM detection_subquery d
    INNER JOIN magstat_subquery m ON d.oid = m.oid
)
SELECT *
FROM final_result
ORDER BY oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,30.317638874053955,2025-04-29T14:56:11,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   
996  ZTF17aaaddnz  1518206503615015001     2   82.263432  42.077485   
997  ZTF17aaaddnz  1509196183615010017     2   82.263429  42.077311   
998  ZTF17aaaddnz  1187184203615015004     2   82.263398  42.077486   
999  ZTF17aaaddnz   605476743615015034     2   82.263321  42.077453   

     magpsf_corr     magpsf  max_rise  
0      17.878054  19.760700  0.524338  
1      17.857359  19.648392  0.524338  
2      18.342743  19.791729  0.524338  
3      17.898651  19.882864  0.524338  
4      17.863106  19.678644  0.524338  
..           ...        ...       ...  
995    16.820160  18.601990  0.312553  
996    16.943000  19.474024  0.312553  
997    17.132713  19.942310  0.312553  
998    16.846552  18.745659  0.312553  
999    16.895739  19.064772  0.312553  

[1000 rows x 8 columns]]",,142.94497871398926,2025-05-19T19:07:38,0.964,0.971,0.5,0.5,0.0,0.0
0.16.3,gpt-4o,v1,39,3,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_subquery AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 2
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, (m.magmax_corr - m.magmin_corr) AS max_rise
FROM probability_subquery p
INNER JOIN object_subquery o ON p.oid = o.oid
INNER JOIN detection_subquery d ON o.oid = d.oid
INNER JOIN magstat_subquery m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.265557765960693,2025-04-29T14:56:32,"[              oid               candid         ra        dec  magpsf_corr  \
0    ZTF17aaaagbn   602505115315010004  86.961817  36.581604    16.853638   
1    ZTF17aaaagbn   702246145315010012  86.961790  36.581644    16.385958   
2    ZTF17aaaagbn   681360755315015646  86.961912  36.581611    16.173563   
3    ZTF17aaaagbn   671426215315010008  86.961799  36.581603    16.408390   
4    ZTF17aaaagbn   615513935315010005  86.961809  36.581595    16.416248   
..            ...                  ...        ...        ...          ...   
995  ZTF17aabgtns  1439277445715015006  81.825653  29.578663          NaN   
996  ZTF17aabgtns   741279895715015027  81.825638  29.578649          NaN   
997  ZTF17aabgtns  1441348515715015004  81.825673  29.578642          NaN   
998  ZTF17aabgtns   615515785715015011  81.825640  29.578652          NaN   
999  ZTF17aabgtns  1079260545715015006  81.825675  29.578558          NaN   

        magpsf  max_rise  
0    17.187000  0.995937  
1    18.616300  0.995937  
2    19.026300  0.995937  
3    18.455600  0.995937  
4    18.405200  0.995937  
..         ...       ...  
995  18.822277       NaN  
996  18.423044       NaN  
997  19.047470       NaN  
998  19.167915       NaN  
999  19.825552       NaN  

[1000 rows x 7 columns]]",,43.7382550239563,2025-05-19T19:08:27,0.107,0.079,0.375,0.42857142857142855,0.0,0.0
0.16.3,gpt-4o,v1,39,4,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
max_rise_subquery AS (
    SELECT oid, MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise
    FROM detection
    WHERE fid = 2
    GROUP BY oid
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, mrs.max_rise
FROM detection_subquery d
JOIN probability_subquery p ON d.oid = p.oid
JOIN object_subquery o ON d.oid = o.oid
JOIN max_rise_subquery mrs ON d.oid = mrs.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,19.52840805053711,2025-04-29T14:56:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
max_rise_subquery AS (
    SELECT oid, MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise
    FROM detection
    WHERE fid = 2
    GROUP BY oid
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, mrs.max_rise
FROM (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection_subquery d
    JOIN probability_subquery p ON d.oid = p.oid
    JOIN object_subquery o ON d.oid = o.oid
) AS d
JOIN max_rise_subquery mrs ON d.oid = mrs.oid
ORDER BY d.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.1272611618042,2025-05-19T19:12:44,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,39,5,"
-- Sub-query to filter objects classified as 'CV/Nova' with the highest probability using 'lc_classifier_stochastic'
WITH cv_nova_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'CV/Nova'
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier_stochastic'
),

-- Main query to retrieve the required information
result AS (
    SELECT 
        o.oid,
        d.candid,
        d.fid AS f_id,
        d.ra,
        d.dec,
        d.magpsf_corr,
        d.magpsf,
        ms.magmax_corr,
        ms.magmin_corr,
        (ms.magmax_corr - ms.magmin_corr) AS max_rise_from_min
    FROM cv_nova_objects cno
    INNER JOIN object o ON cno.oid = o.oid
    INNER JOIN detection d ON o.oid = d.oid
    INNER JOIN magstat ms ON o.oid = ms.oid AND d.fid = ms.fid
    WHERE o.ndet <= 50
      AND d.fid = 2 -- r-band filter
      AND ms.fid = 2 -- r-band filter
)

-- Final selection and ordering
SELECT *
FROM result
ORDER BY oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,33.05397891998291,2025-04-29T14:57:25,"[              oid               candid  f_id         ra        dec  \
0    ZTF17aaaagbn   602505115315010004     2  86.961817  36.581604   
1    ZTF17aaaagbn   702246145315010012     2  86.961790  36.581644   
2    ZTF17aaaagbn   681360755315015646     2  86.961912  36.581611   
3    ZTF17aaaagbn   671426215315010008     2  86.961799  36.581603   
4    ZTF17aaaagbn   615513935315010005     2  86.961809  36.581595   
..            ...                  ...   ...        ...        ...   
995  ZTF17aabgtns  1439277445715015006     2  81.825653  29.578663   
996  ZTF17aabgtns   741279895715015027     2  81.825638  29.578649   
997  ZTF17aabgtns  1441348515715015004     2  81.825673  29.578642   
998  ZTF17aabgtns   615515785715015011     2  81.825640  29.578652   
999  ZTF17aabgtns  1079260545715015006     2  81.825675  29.578558   

     magpsf_corr     magpsf  magmax_corr  magmin_corr  max_rise_from_min  
0      16.853638  17.187000      17.1861    16.190163           0.995937  
1      16.385958  18.616300      17.1861    16.190163           0.995937  
2      16.173563  19.026300      17.1861    16.190163           0.995937  
3      16.408390  18.455600      17.1861    16.190163           0.995937  
4      16.416248  18.405200      17.1861    16.190163           0.995937  
..           ...        ...          ...          ...                ...  
995          NaN  18.822277          NaN          NaN                NaN  
996          NaN  18.423044          NaN          NaN                NaN  
997          NaN  19.047470          NaN          NaN                NaN  
998          NaN  19.167915          NaN          NaN                NaN  
999          NaN  19.825552          NaN          NaN                NaN  

[1000 rows x 10 columns]]",,12.334493160247803,2025-05-19T19:13:01,0.107,0.079,0.5,0.4,0.0,0.0
0.16.3,gpt-4o,v1,39,6,"
WITH probability_filter AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_filter AS (
    SELECT o.oid
    FROM object o
    INNER JOIN probability_filter pf ON o.oid = pf.oid
    WHERE o.ndet <= 50
),
detection_filter AS (
    SELECT d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection d
    INNER JOIN object_filter of ON d.oid = of.oid
    WHERE d.fid = 2
),
magstat_filter AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    INNER JOIN object_filter of ON m.oid = of.oid
    WHERE m.fid = 2
)
SELECT df.oid, df.candid, df.fid AS f_id, df.ra, df.dec, df.magpsf_corr, df.magpsf, 
       (mf.magmax_corr - mf.magmin_corr) AS max_rise_from_min
FROM detection_filter df
INNER JOIN magstat_filter mf ON df.oid = mf.oid
ORDER BY df.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,21.78544569015503,2025-04-29T14:57:47,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   
996  ZTF17aaaddnz  1518206503615015001     2   82.263432  42.077485   
997  ZTF17aaaddnz  1509196183615010017     2   82.263429  42.077311   
998  ZTF17aaaddnz  1187184203615015004     2   82.263398  42.077486   
999  ZTF17aaaddnz   605476743615015034     2   82.263321  42.077453   

     magpsf_corr     magpsf  max_rise_from_min  
0      17.878054  19.760700           0.524338  
1      17.857359  19.648392           0.524338  
2      18.342743  19.791729           0.524338  
3      17.898651  19.882864           0.524338  
4      17.863106  19.678644           0.524338  
..           ...        ...                ...  
995    16.820160  18.601990           0.312553  
996    16.943000  19.474024           0.312553  
997    17.132713  19.942310           0.312553  
998    16.846552  18.745659           0.312553  
999    16.895739  19.064772           0.312553  

[1000 rows x 8 columns]]",,204.39782786369324,2025-05-19T19:16:30,0.964,0.971,0.5,0.5,0.0,0.0
0.16.3,gpt-4o,v1,39,7,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_subquery AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 2
),
combined_subquery AS (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, 
           (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM detection_subquery d
    INNER JOIN magstat_subquery m ON d.oid = m.oid
    WHERE d.oid IN (SELECT oid FROM probability_subquery)
      AND d.oid IN (SELECT oid FROM object_subquery)
)
SELECT *
FROM combined_subquery
ORDER BY oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.586743116378784,2025-04-29T14:58:10,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_subquery AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 2
),
combined_subquery AS (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, 
           (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM detection_subquery d
    INNER JOIN magstat_subquery m ON d.oid = m.oid
    WHERE d.oid IN (SELECT oid FROM probability_subquery)
      AND d.oid IN (SELECT oid FROM object_subquery)
)
SELECT *
FROM combined_subquery
ORDER BY oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",256.4947910308838,2025-05-19T19:21:00,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,39,8,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_subquery AS (
    SELECT oid, (magmax_corr - magmin_corr) AS max_rise
    FROM magstat
    WHERE fid = 2
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, m.max_rise
FROM detection_subquery d
INNER JOIN probability_subquery p ON d.oid = p.oid
INNER JOIN object_subquery o ON d.oid = o.oid
INNER JOIN magstat_subquery m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,33.03245401382446,2025-04-29T14:58:43,"[              oid               candid         ra        dec  magpsf_corr  \
0    ZTF17aaaagbn   602505115315010004  86.961817  36.581604    16.853638   
1    ZTF17aaaagbn   702246145315010012  86.961790  36.581644    16.385958   
2    ZTF17aaaagbn   681360755315015646  86.961912  36.581611    16.173563   
3    ZTF17aaaagbn   671426215315010008  86.961799  36.581603    16.408390   
4    ZTF17aaaagbn   615513935315010005  86.961809  36.581595    16.416248   
..            ...                  ...        ...        ...          ...   
995  ZTF17aabgtns  1439277445715015006  81.825653  29.578663          NaN   
996  ZTF17aabgtns   741279895715015027  81.825638  29.578649          NaN   
997  ZTF17aabgtns  1441348515715015004  81.825673  29.578642          NaN   
998  ZTF17aabgtns   615515785715015011  81.825640  29.578652          NaN   
999  ZTF17aabgtns  1079260545715015006  81.825675  29.578558          NaN   

        magpsf  max_rise  
0    17.187000  0.995937  
1    18.616300  0.995937  
2    19.026300  0.995937  
3    18.455600  0.995937  
4    18.405200  0.995937  
..         ...       ...  
995  18.822277       NaN  
996  18.423044       NaN  
997  19.047470       NaN  
998  19.167915       NaN  
999  19.825552       NaN  

[1000 rows x 7 columns]]",,15.416965246200562,2025-05-19T19:21:20,0.107,0.079,0.375,0.42857142857142855,0.0,0.0
0.16.3,gpt-4o,v1,39,9,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND ranking = 1
      AND classifier_name = 'lc_classifier_stochastic'
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr
    FROM detection d
    INNER JOIN object_subquery o ON d.oid = o.oid
    WHERE d.fid = 2
),
magstat_subquery AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    INNER JOIN object_subquery o ON m.oid = o.oid
    WHERE m.fid = 2
)
SELECT d.oid, d.candid, d.f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr, 
       (m.magmax_corr - m.magmin_corr) AS max_rise
FROM detection_subquery d
INNER JOIN magstat_subquery m ON d.oid = m.oid
INNER JOIN probability_subquery p ON d.oid = p.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.438241958618164,2025-04-29T14:59:04,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND ranking = 1
      AND classifier_name = 'lc_classifier_stochastic'
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr
    FROM detection d
    WHERE d.fid = 2
      AND EXISTS (SELECT 1 FROM object_subquery o WHERE d.oid = o.oid)
),
magstat_subquery AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    WHERE m.fid = 2
      AND EXISTS (SELECT 1 FROM object_subquery o WHERE m.oid = o.oid)
)
SELECT d.oid, d.candid, d.f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr, 
       (m.magmax_corr - m.magmin_corr) AS max_rise
FROM detection_subquery d
INNER JOIN magstat_subquery m ON d.oid = m.oid
WHERE EXISTS (SELECT 1 FROM probability_subquery p WHERE d.oid = p.oid)
ORDER BY d.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",255.28356289863586,2025-05-19T19:25:40,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,39,10,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection d
    INNER JOIN object_subquery o ON d.oid = o.oid
    WHERE d.fid = 2
),
magstat_subquery AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    INNER JOIN object_subquery o ON m.oid = o.oid
    WHERE m.fid = 2
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, 
       (m.magmax_corr - m.magmin_corr) AS max_rise
FROM detection_subquery d
INNER JOIN magstat_subquery m ON d.oid = m.oid
INNER JOIN probability_subquery p ON d.oid = p.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.59269618988037,2025-04-29T14:59:27,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection d
    WHERE d.fid = 2
      AND EXISTS (SELECT 1 FROM object_subquery o WHERE d.oid = o.oid)
),
magstat_subquery AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    WHERE m.fid = 2
      AND EXISTS (SELECT 1 FROM object_subquery o WHERE m.oid = o.oid)
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, 
       (m.magmax_corr - m.magmin_corr) AS max_rise
FROM detection_subquery d
INNER JOIN magstat_subquery m ON d.oid = m.oid
INNER JOIN probability_subquery p ON d.oid = p.oid
ORDER BY d.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.9701726436615,2025-05-19T19:29:57,0.0,0.0,0.0,0.0,0.0,0.0
